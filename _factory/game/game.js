!function(b,c){"object"==typeof module&&"object"==typeof module.exports?module.exports=b.document?c(b,!0):function(b){if(!b.document)throw Error("jQuery requires a window with a document");return c(b)}:c(b)}("undefined"!=typeof window?window:this,function(b,c){function e(b,c,f){var d,e,g=(f=f||R).createElement("script");if(g.text=b,c)for(d in gb)(e=c[d]||c.getAttribute&&c.getAttribute(d))&&g.setAttribute(d,e);f.head.appendChild(g).parentNode.removeChild(g)}function d(b){return null==b?b+"":"object"==
typeof b||"function"==typeof b?Za[pb.call(b)]||"object":typeof b}function j(b){var c=!!b&&"length"in b&&b.length,f=d(b);return!P(b)&&!Ea(b)&&("array"===f||0===c||"number"==typeof c&&0<c&&c-1 in b)}function g(b,c){return b.nodeName&&b.nodeName.toLowerCase()===c.toLowerCase()}function p(b,c){return c?"\x00"===b?"\ufffd":b.slice(0,-1)+"\\"+b.charCodeAt(b.length-1).toString(16)+" ":"\\"+b}function l(b,c,f){return P(c)?q.grep(b,function(b,V){return!!c.call(b,V,b)!==f}):c.nodeType?q.grep(b,function(b){return b===
c!==f}):"string"!=typeof c?q.grep(b,function(b){return-1<za.call(c,b)!==f}):q.filter(c,b,f)}function f(b,c){for(;(b=b[c])&&1!==b.nodeType;);return b}function m(b){return b}function n(b){throw b;}function r(b,c,f,d){var e;try{b&&P(e=b.promise)?e.call(b).done(c).fail(f):b&&P(e=b.then)?e.call(b,c,f):c.apply(void 0,[b].slice(d))}catch(g){f.apply(void 0,[g])}}function s(){R.removeEventListener("DOMContentLoaded",s);b.removeEventListener("load",s);q.ready()}function t(b,c){return c.toUpperCase()}function u(b){return b.replace(Gc,
"ms-").replace(Hc,t)}function v(){this.expando=q.expando+v.uid++}function z(b,c,f){var d,e;if(void 0===f&&1===b.nodeType)if(d="data-"+c.replace(Ic,"-$&").toLowerCase(),"string"==typeof(f=b.getAttribute(d))){try{f="true"===(e=f)||"false"!==e&&("null"===e?null:e===+e+""?+e:Jc.test(e)?JSON.parse(e):e)}catch(g){}ra.set(b,c,f)}else f=void 0;return f}function x(b,c,f,d){var e,g,n=20,m=d?function(){return d.cur()}:function(){return q.css(b,c,"")},j=m(),l=f&&f[3]||(q.cssNumber[c]?"":"px"),r=b.nodeType&&(q.cssNumber[c]||
"px"!==l&&+j)&&hb.exec(q.css(b,c));if(r&&r[3]!==l){j/=2;l=l||r[3];for(r=+j||1;n--;)q.style(b,c,r+l),0>=(1-g)*(1-(g=m()/j||0.5))&&(n=0),r/=g;r*=2;q.style(b,c,r+l);f=f||[]}return f&&(r=+r||+j||0,e=f[1]?r+(f[1]+1)*f[2]:+f[2],d&&(d.unit=l,d.start=r,d.end=e)),e}function C(b,c){for(var f,d,e,g,n,m,j,l=[],r=0,s=b.length;r<s;r++)(d=b[r]).style&&(f=d.style.display,c?("none"===f&&(l[r]=K.get(d,"display")||null,l[r]||(d.style.display="")),""===d.style.display&&qb(d)&&(l[r]=(j=n=g=void 0,n=(e=d).ownerDocument,
m=e.nodeName,(j=Xb[m])||(g=n.body.appendChild(n.createElement(m)),j=q.css(g,"display"),g.parentNode.removeChild(g),"none"===j&&(j="block"),Xb[m]=j)))):"none"!==f&&(l[r]="none",K.set(d,"display",f)));for(r=0;r<s;r++)null!=l[r]&&(b[r].style.display=l[r]);return b}function B(b,c){var f;return f="undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(c||"*"):"undefined"!=typeof b.querySelectorAll?b.querySelectorAll(c||"*"):[],void 0===c||c&&g(b,c)?q.merge([b],f):f}function E(b,c){for(var f=
0,d=b.length;f<d;f++)K.set(b[f],"globalEval",!c||K.get(c[f],"globalEval"))}function I(b,c,f,e,g){for(var n,m,j,l,r=c.createDocumentFragment(),s=[],p=0,t=b.length;p<t;p++)if((n=b[p])||0===n)if("object"===d(n))q.merge(s,n.nodeType?[n]:n);else if(Kc.test(n)){m=m||r.appendChild(c.createElement("div"));j=(Yb.exec(n)||["",""])[1].toLowerCase();j=ua[j]||ua._default;m.innerHTML=j[1]+q.htmlPrefilter(n)+j[2];for(j=j[0];j--;)m=m.lastChild;q.merge(s,m.childNodes);(m=r.firstChild).textContent=""}else s.push(c.createTextNode(n));
r.textContent="";for(p=0;n=s[p++];)if(e&&-1<q.inArray(n,e))g&&g.push(n);else if(l=$a(n),m=B(r.appendChild(n),"script"),l&&E(m),f)for(j=0;n=m[j++];)Zb.test(n.type||"")&&f.push(n);return r}function y(){return!0}function D(){return!1}function H(b,c,f,d,e,g){var n,m;if("object"==typeof c){for(m in"string"!=typeof f&&(d=d||f,f=void 0),c)H(b,m,f,d,c[m],g);return b}if(null==d&&null==e?(e=f,d=f=void 0):null==e&&("string"==typeof f?(e=d,d=void 0):(e=d,d=f,f=void 0)),!1===e)e=D;else if(!e)return b;return 1===
g&&(n=e,(e=function(b){return q().off(b),n.apply(this,arguments)}).guid=n.guid||(n.guid=q.guid++)),b.each(function(){q.event.add(this,c,e,d,f)})}function M(b,c,f){f?(K.set(b,c,!1),q.event.add(b,c,{namespace:!1,handler:function(b){var V,f=K.get(this,c);if(1&b.isTrigger&&this[c])if(f)(q.event.special[c]||{}).delegateType&&b.stopPropagation();else{if(f=pa.call(arguments),K.set(this,c,f),this[c](),V=K.get(this,c),K.set(this,c,!1),f!==V)return b.stopImmediatePropagation(),b.preventDefault(),V}else f&&
(K.set(this,c,q.event.trigger(f[0],f.slice(1),this)),b.stopPropagation(),b.isImmediatePropagationStopped=y)}})):void 0===K.get(b,c)&&q.event.add(b,c,y)}function S(b,c){return g(b,"table")&&g(11!==c.nodeType?c:c.firstChild,"tr")&&q(b).children("tbody")[0]||b}function Q(b){return b.type=(null!==b.getAttribute("type"))+"/"+b.type,b}function L(b){return"true/"===(b.type||"").slice(0,5)?b.type=b.type.slice(5):b.removeAttribute("type"),b}function W(b,c){var f,d,e,g,n,m;if(1===c.nodeType){if(K.hasData(b)&&
(m=K.get(b).events))for(e in K.remove(c,"handle events"),m){f=0;for(d=m[e].length;f<d;f++)q.event.add(c,e,m[e][f])}ra.hasData(b)&&(g=ra.access(b),n=q.extend({},g),ra.set(c,n))}}function aa(b,c,f,d){c=rb(c);var g,n,m,j,l=0,r=b.length,s=r-1,p=c[0],t=P(p);if(t||1<r&&"string"==typeof p&&!O.checkClone&&Lc.test(p))return b.each(function(e){var g=b.eq(e);t&&(c[0]=p.call(this,e,g.html()));aa(g,c,f,d)});if(r&&(n=(g=I(c,b[0].ownerDocument,!1,b,d)).firstChild,1===g.childNodes.length&&(g=n),n||d)){for(m=(n=q.map(B(g,
"script"),Q)).length;l<r;l++)j=g,l!==s&&(j=q.clone(j,!0,!0),m&&q.merge(n,B(j,"script"))),f.call(b[l],j,l);if(m){g=n[n.length-1].ownerDocument;q.map(n,L);for(l=0;l<m;l++)j=n[l],Zb.test(j.type||"")&&!K.access(j,"globalEval")&&q.contains(g,j)&&(j.src&&"module"!==(j.type||"").toLowerCase()?q._evalUrl&&!j.noModule&&q._evalUrl(j.src,{nonce:j.nonce||j.getAttribute("nonce")},g):e(j.textContent.replace(Nc,""),j,g))}}return b}function G(b,c,f){for(var d=c?q.filter(c,b):b,e=0;null!=(c=d[e]);e++)f||1!==c.nodeType||
q.cleanData(B(c)),c.parentNode&&(f&&$a(c)&&E(B(c,"script")),c.parentNode.removeChild(c));return b}function F(b,c,f){var d,e,g,n,m=Hb.test(c),j=b.style;return(f=f||sb(b))&&(n=f.getPropertyValue(c)||f[c],m&&n&&(n=n.replace(Pa,"$1")||void 0),""!==n||$a(b)||(n=q.style(b,c)),!O.pixelBoxStyles()&&Ib.test(n)&&Oc.test(c)&&(d=j.width,e=j.minWidth,g=j.maxWidth,j.minWidth=j.maxWidth=j.width=n,n=f.width,j.width=d,j.minWidth=e,j.maxWidth=g)),void 0!==n?n+"":n}function ka(b,c){return{get:function(){if(!b())return(this.get=
c).apply(this,arguments);delete this.get}}}function Z(b){var c;if(!(c=q.cssProps[b]||$b[b])){if(!(b in ac)){c=$b;var f;a:{f=b;for(var d=f[0].toUpperCase()+f.slice(1),e=bc.length;e--;)if((f=bc[e]+d)in ac)break a;f=void 0}b=c[b]=f||b}c=b}return c}function N(b,c,f){return(b=hb.exec(c))?Math.max(0,b[2]-(f||0))+(b[3]||"px"):c}function T(b,c,f,d,e,g){var n="width"===c?1:0,m=0,j=0,l=0;if(f===(d?"border":"content"))return 0;for(;4>n;n+=2)"margin"===f&&(l+=q.css(b,f+Ia[n],!0,e)),d?("content"===f&&(j-=q.css(b,
"padding"+Ia[n],!0,e)),"margin"!==f&&(j-=q.css(b,"border"+Ia[n]+"Width",!0,e))):(j+=q.css(b,"padding"+Ia[n],!0,e),"padding"!==f?j+=q.css(b,"border"+Ia[n]+"Width",!0,e):m+=q.css(b,"border"+Ia[n]+"Width",!0,e));return!d&&0<=g&&(j+=Math.max(0,Math.ceil(b["offset"+c[0].toUpperCase()+c.slice(1)]-g-j-m-0.5))||0),j+l}function J(b,c,f){var d=sb(b),e=(!O.boxSizingReliable()||f)&&"border-box"===q.css(b,"boxSizing",!1,d),n=e,m=F(b,c,d),j="offset"+c[0].toUpperCase()+c.slice(1);if(Ib.test(m)){if(!f)return m;m=
"auto"}return(!O.boxSizingReliable()&&e||!O.reliableTrDimensions()&&g(b,"tr")||"auto"===m||!parseFloat(m)&&"inline"===q.css(b,"display",!1,d))&&b.getClientRects().length&&(e="border-box"===q.css(b,"boxSizing",!1,d),(n=j in b)&&(m=b[j])),(m=parseFloat(m)||0)+T(b,c,f||(e?"border":"content"),n,d,m)+"px"}function U(b,c,f,d,e){return new U.prototype.init(b,c,f,d,e)}function ha(){tb&&(!1===R.hidden&&b.requestAnimationFrame?b.requestAnimationFrame(ha):b.setTimeout(ha,q.fx.interval),q.fx.tick())}function va(){return b.setTimeout(function(){ab=
void 0}),ab=Date.now()}function wa(b,c){var f,d=0,e={height:b};for(c=c?1:0;4>d;d+=2-c)e["margin"+(f=Ia[d])]=e["padding"+f]=b;return c&&(e.opacity=e.width=b),e}function ea(b,c,f){for(var d,e=(ba.tweeners[c]||[]).concat(ba.tweeners["*"]),g=0,n=e.length;g<n;g++)if(d=e[g].call(f,c,b))return d}function ba(b,c,f){var d,e,g=0,n=ba.prefilters.length,m=q.Deferred().always(function(){delete j.elem}),j=function(){if(e)return!1;for(var c=ab||va(),c=Math.max(0,l.startTime+l.duration-c),f=1-(c/l.duration||0),d=
0,g=l.tweens.length;d<g;d++)l.tweens[d].run(f);return m.notifyWith(b,[l,f,c]),1>f&&g?c:(g||m.notifyWith(b,[l,1,0]),m.resolveWith(b,[l]),!1)},l=m.promise({elem:b,props:q.extend({},c),opts:q.extend(!0,{specialEasing:{},easing:q.easing._default},f),originalProperties:c,originalOptions:f,startTime:ab||va(),duration:f.duration,tweens:[],createTween:function(c,f){var d=q.Tween(b,l.opts,c,f,l.opts.specialEasing[c]||l.opts.easing);return l.tweens.push(d),d},stop:function(c){var f=0,d=c?l.tweens.length:0;
if(e)return this;for(e=!0;f<d;f++)l.tweens[f].run(1);return c?(m.notifyWith(b,[l,1,0]),m.resolveWith(b,[l,c])):m.rejectWith(b,[l,c]),this}});c=l.props;f=l.opts.specialEasing;var r,s,p,t;for(d in c)if(s=f[r=u(d)],p=c[d],Array.isArray(p)&&(s=p[1],p=c[d]=p[0]),d!==r&&(c[r]=p,delete c[d]),(t=q.cssHooks[r])&&"expand"in t)for(d in p=t.expand(p),delete c[r],p)d in c||(c[d]=p[d],f[d]=s);else f[r]=s;for(!0;g<n;g++)if(d=ba.prefilters[g].call(l,b,c,l.opts))return P(d.stop)&&(q._queueHooks(l.elem,l.opts.queue).stop=
d.stop.bind(d)),d;return q.map(c,ea,l),P(l.opts.start)&&l.opts.start.call(b,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),q.fx.timer(q.extend(j,{elem:b,anim:l,queue:l.opts.queue})),l}function A(b){return(b.match(Fa)||[]).join(" ")}function ia(b){return b.getAttribute&&b.getAttribute("class")||""}function oa(b){return Array.isArray(b)?b:"string"==typeof b&&b.match(Fa)||[]}function da(b,c,f,e){var g;if(Array.isArray(c))q.each(c,function(c,d){f||
Pc.test(b)?e(b,d):da(b+"["+("object"==typeof d&&null!=d?c:"")+"]",d,f,e)});else if(f||"object"!==d(c))e(b,c);else for(g in c)da(b+"["+g+"]",c[g],f,e)}function Qa(b){return function(c,f){"string"!=typeof c&&(f=c,c="*");var d,e=0,g=c.toLowerCase().match(Fa)||[];if(P(f))for(;d=g[e++];)"+"===d[0]?(d=d.slice(1)||"*",(b[d]=b[d]||[]).unshift(f)):(b[d]=b[d]||[]).push(f)}}function Aa(b,c,f,d){function e(m){var j;return g[m]=!0,q.each(b[m]||[],function(b,V){var m=V(c,f,d);return"string"!=typeof m||n||g[m]?
n?!(j=m):void 0:(c.dataTypes.unshift(m),e(m),!1)}),j}var g={},n=b===Jb;return e(c.dataTypes[0])||!g["*"]&&e("*")}function Ga(b,c){var f,d,e=q.ajaxSettings.flatOptions||{};for(f in c)void 0!==c[f]&&((e[f]?b:d||(d={}))[f]=c[f]);return d&&q.extend(!0,b,d),b}var la=[],ub=Object.getPrototypeOf,pa=la.slice,rb=la.flat?function(b){return la.flat.call(b)}:function(b){return la.concat.apply([],b)},Ra=la.push,za=la.indexOf,Za={},pb=Za.toString,Wa=Za.hasOwnProperty,vb=Wa.toString,Kb=vb.call(Object),O={},P=function(b){return"function"==
typeof b&&"number"!=typeof b.nodeType&&"function"!=typeof b.item},Ea=function(b){return null!=b&&b===b.window},R=b.document,gb={type:!0,src:!0,nonce:!0,noModule:!0},bb=/HTML$/i,q=function(b,c){return new q.fn.init(b,c)};q.fn=q.prototype={jquery:"3.7.0",constructor:q,length:0,toArray:function(){return pa.call(this)},get:function(b){return null==b?pa.call(this):0>b?this[b+this.length]:this[b]},pushStack:function(b){b=q.merge(this.constructor(),b);return b.prevObject=this,b},each:function(b){return q.each(this,
b)},map:function(b){return this.pushStack(q.map(this,function(c,f){return b.call(c,f,c)}))},slice:function(){return this.pushStack(pa.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(q.grep(this,function(b,c){return(c+1)%2}))},odd:function(){return this.pushStack(q.grep(this,function(b,c){return c%2}))},eq:function(b){var c=this.length;b=+b+(0>b?c:0);return this.pushStack(0<=b&&b<c?[this[b]]:[])},end:function(){return this.prevObject||
this.constructor()},push:Ra,sort:la.sort,splice:la.splice};q.extend=q.fn.extend=function(){var b,c,f,d,e,g,n=arguments[0]||{},m=1,j=arguments.length,l=!1;"boolean"==typeof n&&(l=n,n=arguments[m]||{},m++);"object"==typeof n||P(n)||(n={});for(m===j&&(n=this,m--);m<j;m++)if(null!=(b=arguments[m]))for(c in b)d=b[c],"__proto__"!==c&&n!==d&&(l&&d&&(q.isPlainObject(d)||(e=Array.isArray(d)))?(f=n[c],g=e&&!Array.isArray(f)?[]:e||q.isPlainObject(f)?f:{},e=!1,n[c]=q.extend(l,g,d)):void 0!==d&&(n[c]=d));return n};
q.extend({expando:"jQuery"+("3.7.0"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(b){throw Error(b);},noop:function(){},isPlainObject:function(b){var c,f;return!(!b||"[object Object]"!==pb.call(b))&&(!(c=ub(b))||"function"==typeof(f=Wa.call(c,"constructor")&&c.constructor)&&vb.call(f)===Kb)},isEmptyObject:function(b){for(var c in b)return!1;return!0},globalEval:function(b,c,f){e(b,{nonce:c&&c.nonce},f)},each:function(b,c){var f,d=0;if(j(b))for(f=b.length;d<f&&!1!==c.call(b[d],d,b[d]);d++);
else for(d in b)if(!1===c.call(b[d],d,b[d]))break;return b},text:function(b){var c,f="",d=0;if(c=b.nodeType){if(1===c||9===c||11===c)return b.textContent;if(3===c||4===c)return b.nodeValue}else for(;c=b[d++];)f+=q.text(c);return f},makeArray:function(b,c){var f=c||[];return null!=b&&(j(Object(b))?q.merge(f,"string"==typeof b?[b]:b):Ra.call(f,b)),f},inArray:function(b,c,f){return null==c?-1:za.call(c,b,f)},isXMLDoc:function(b){var c=b&&(b.ownerDocument||b).documentElement;return!bb.test(b&&b.namespaceURI||
c&&c.nodeName||"HTML")},merge:function(b,c){for(var f=+c.length,d=0,e=b.length;d<f;d++)b[e++]=c[d];return b.length=e,b},grep:function(b,c,f){var d=[],e=0,g=b.length;for(f=!f;e<g;e++)!c(b[e],e)!==f&&d.push(b[e]);return d},map:function(b,c,f){var d,e,g=0,n=[];if(j(b))for(d=b.length;g<d;g++)null!=(e=c(b[g],g,f))&&n.push(e);else for(g in b)null!=(e=c(b[g],g,f))&&n.push(e);return rb(n)},guid:1,support:O});"function"==typeof Symbol&&(q.fn[Symbol.iterator]=la[Symbol.iterator]);q.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),
function(b,c){Za["[object "+c+"]"]=c.toLowerCase()});var wb=la.pop,cb=la.sort,Sa=la.splice,Pa=/^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g;q.contains=function(b,c){var f=c&&c.parentNode;return b===f||!(!f||1!==f.nodeType||!(b.contains?b.contains(f):b.compareDocumentPosition&&16&b.compareDocumentPosition(f)))};var Ta=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;q.escapeSelector=function(b){return(b+"").replace(Ta,p)};var sa=R,Y=function(b,c,f,d){var e,g,n,m,j,l=c&&c.ownerDocument;g=
c?c.nodeType:9;if(f=f||[],"string"!=typeof b||!b||1!==g&&9!==g&&11!==g)return f;if(!d&&(Ua(c),c=c||ca,Ba)){if(11!==g&&(j=Qc.exec(b)))if(e=j[1])if(9===g){if(!(n=c.getElementById(e)))return f;if(n.id===e)return Ca.call(f,n),f}else{if(l&&(n=l.getElementById(e))&&Y.contains(c,n)&&n.id===e)return Ca.call(f,n),f}else{if(j[2])return Ca.apply(f,c.getElementsByTagName(b)),f;if((e=j[3])&&c.getElementsByClassName)return Ca.apply(f,c.getElementsByClassName(e)),f}if(!(xb[b+" "]||qa&&qa.test(b))){if(e=b,l=c,1===
g&&(Rc.test(b)||cc.test(b))){(l=Lb.test(b)&&Ja(c.parentNode)||c)==c&&O.scope||((m=c.getAttribute("id"))?m=q.escapeSelector(m):c.setAttribute("id",m=fa));for(g=(e=yb(b)).length;g--;)e[g]=(m?"#"+m:":scope")+" "+zb(e[g]);e=e.join(",")}try{return Ca.apply(f,l.querySelectorAll(e)),f}catch(r){xb(b,!0)}finally{m===fa&&c.removeAttribute("id")}}}return dc(b.replace(Pa,"$1"),c,f,d)},Da=function(){var b=[];return function ja(c,f){return b.push(c+" ")>X.cacheLength&&delete ja[b.shift()],ja[c+" "]=f}},ma=function(b){return b[fa]=
!0,b},ta=function(b){var c=ca.createElement("fieldset");try{return!!b(c)}catch(f){return!1}finally{c.parentNode&&c.parentNode.removeChild(c)}},Ab=function(b){return function(c){return g(c,"input")&&c.type===b}},Ka=function(b){return function(c){return(g(c,"input")||g(c,"button"))&&c.type===b}},La=function(b){return function(c){return"form"in c?c.parentNode&&!1===c.disabled?"label"in c?"label"in c.parentNode?c.parentNode.disabled===b:c.disabled===b:c.isDisabled===b||c.isDisabled!==!b&&Sc(c)===b:c.disabled===
b:"label"in c&&c.disabled===b}},ga=function(b){return ma(function(c){return c=+c,ma(function(f,d){for(var e,g=b([],f.length,c),n=g.length;n--;)f[e=g[n]]&&(f[e]=!(d[e]=f[e]))})})},Ja=function(b){return b&&"undefined"!=typeof b.getElementsByTagName&&b},Ua=function(b){var c;b=b?b.ownerDocument||b:sa;return b!=ca&&9===b.nodeType&&b.documentElement&&(Va=(ca=b).documentElement,Ba=!q.isXMLDoc(ca),Mb=Va.matches||Va.webkitMatchesSelector||Va.msMatchesSelector,sa!=ca&&(c=ca.defaultView)&&c.top!==c&&c.addEventListener("unload",
Tc),O.getById=ta(function(b){return Va.appendChild(b).id=q.expando,!ca.getElementsByName||!ca.getElementsByName(q.expando).length}),O.disconnectedMatch=ta(function(b){return Mb.call(b,"*")}),O.scope=ta(function(){return ca.querySelectorAll(":scope")}),O.cssHas=ta(function(){try{return ca.querySelector(":has(*,:jqfake)"),!1}catch(b){return!0}}),O.getById?(X.filter.ID=function(b){var c=b.replace(Ma,Na);return function(b){return b.getAttribute("id")===c}},X.find.ID=function(b,c){if("undefined"!=typeof c.getElementById&&
Ba){var f=c.getElementById(b);return f?[f]:[]}}):(X.filter.ID=function(b){var c=b.replace(Ma,Na);return function(b){return(b="undefined"!=typeof b.getAttributeNode&&b.getAttributeNode("id"))&&b.value===c}},X.find.ID=function(b,c){if("undefined"!=typeof c.getElementById&&Ba){var f,d,e,V=c.getElementById(b);if(V){if((f=V.getAttributeNode("id"))&&f.value===b)return[V];e=c.getElementsByName(b);for(d=0;V=e[d++];)if((f=V.getAttributeNode("id"))&&f.value===b)return[V]}return[]}}),X.find.TAG=function(b,c){return"undefined"!=
typeof c.getElementsByTagName?c.getElementsByTagName(b):c.querySelectorAll(b)},X.find.CLASS=function(b,c){if("undefined"!=typeof c.getElementsByClassName&&Ba)return c.getElementsByClassName(b)},qa=[],ta(function(b){var c;Va.appendChild(b).innerHTML="<a id='"+fa+"' href='' disabled='disabled'></a><select id='"+fa+"-\r\\' disabled='disabled'><option selected=''></option></select>";b.querySelectorAll("[selected]").length||qa.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|"+ec+")");b.querySelectorAll("[id~="+
fa+"-]").length||qa.push("~=");b.querySelectorAll("a#"+fa+"+*").length||qa.push(".#.+[+~]");b.querySelectorAll(":checked").length||qa.push(":checked");(c=ca.createElement("input")).setAttribute("type","hidden");b.appendChild(c).setAttribute("name","D");Va.appendChild(b).disabled=!0;2!==b.querySelectorAll(":disabled").length&&qa.push(":enabled",":disabled");(c=ca.createElement("input")).setAttribute("name","");b.appendChild(c);b.querySelectorAll("[name='']").length||qa.push("\\[[\\x20\\t\\r\\n\\f]*name[\\x20\\t\\r\\n\\f]*=[\\x20\\t\\r\\n\\f]*(?:''|\"\")")}),
O.cssHas||qa.push(":has"),qa=qa.length&&RegExp(qa.join("|")),Nb=function(b,c){if(b===c)return Bb=!0,0;var f=!b.compareDocumentPosition-!c.compareDocumentPosition;return f||(1&(f=(b.ownerDocument||b)==(c.ownerDocument||c)?b.compareDocumentPosition(c):1)||!O.sortDetached&&c.compareDocumentPosition(b)===f?b===ca||b.ownerDocument==sa&&Y.contains(sa,b)?-1:c===ca||c.ownerDocument==sa&&Y.contains(sa,c)?1:ib?za.call(ib,b)-za.call(ib,c):0:4&f?-1:1)}),ca},fc=function(){},yb=function(b,c){var f,d,e,g,n,m,j;
if(n=gc[b+" "])return c?0:n.slice(0);n=b;m=[];for(j=X.preFilter;n;){for(g in f&&!(d=Uc.exec(n))||(d&&(n=n.slice(d[0].length)||n),m.push(e=[])),f=!1,(d=cc.exec(n))&&(f=d.shift(),e.push({value:f,type:d[0].replace(Pa," ")}),n=n.slice(f.length)),X.filter)!(d=Cb[g].exec(n))||j[g]&&!(d=j[g](d))||(f=d.shift(),e.push({value:f,type:g,matches:d}),n=n.slice(f.length));if(!f)break}return c?n.length:n?Y.error(b):gc(b,m).slice(0)},zb=function(b){for(var c=0,f=b.length,d="";c<f;c++)d+=b[c].value;return d},Db=function(b,
c,f){var d=c.dir,e=c.next,n=e||d,m=f&&"parentNode"===n,j=Vc++;return c.first?function(c,f,e){for(;c=c[d];)if(1===c.nodeType||m)return b(c,f,e);return!1}:function(c,f,l){var r,s,na=[Ha,j];if(l)for(;c=c[d];){if((1===c.nodeType||m)&&b(c,f,l))return!0}else for(;c=c[d];)if(1===c.nodeType||m)if(s=c[fa]||(c[fa]={}),e&&g(c,e))c=c[d]||c;else{if((r=s[n])&&r[0]===Ha&&r[1]===j)return na[2]=r[2];if((s[n]=na)[2]=b(c,f,l))return!0}return!1}},Ob=function(b){return 1<b.length?function(c,f,d){for(var e=b.length;e--;)if(!b[e](c,
f,d))return!1;return!0}:b[0]},Eb=function(b,c,f,d,e){for(var g,n=[],m=0,j=b.length,l=null!=c;m<j;m++)(g=b[m])&&(f&&!f(g,d,e)||(n.push(g),l&&c.push(m)));return n},Pb=function(b,c,f,d,e,g){return d&&!d[fa]&&(d=Pb(d)),e&&!e[fa]&&(e=Pb(e,g)),ma(function(g,n,m,j){var l,r,s,p=[],t=[],A=n.length,q;if(!(q=g)){q=c||"*";for(var u=m.nodeType?[m]:m,v=[],ia=0,z=u.length;ia<z;ia++)Y(q,u[ia],v);q=v}q=!b||!g&&c?q:Eb(q,p,b,m,j);if(f?f(q,s=e||(g?b:A||d)?[]:n,m,j):s=q,d){l=Eb(s,t);d(l,[],m,j);for(m=l.length;m--;)(r=
l[m])&&(s[t[m]]=!(q[t[m]]=r))}if(g){if(e||b){if(e){l=[];for(m=s.length;m--;)(r=s[m])&&l.push(q[m]=r);e(null,s=[],l,j)}for(m=s.length;m--;)(r=s[m])&&-1<(l=e?za.call(g,r):p[m])&&(g[l]=!(n[l]=r))}}else s=Eb(s===n?s.splice(A,s.length):s),e?e(null,n,s,j):Ca.apply(n,s)})},xa=function(b){var c,f,d,e=b.length,g=X.relative[b[0].type];f=g||X.relative[" "];for(var n=g?1:0,m=Db(function(b){return b===c},f,!0),j=Db(function(b){return-1<za.call(c,b)},f,!0),l=[function(b,f,d){b=!g&&(d||f!=Fb)||((c=f).nodeType?m(b,
f,d):j(b,f,d));return c=null,b}];n<e;n++)if(f=X.relative[b[n].type])l=[Db(Ob(l),f)];else{if((f=X.filter[b[n].type].apply(null,b[n].matches))[fa]){for(d=++n;d<e&&!X.relative[b[d].type];d++);return Pb(1<n&&Ob(l),1<n&&zb(b.slice(0,n-1).concat({value:" "===b[n-2].type?"*":""})).replace(Pa,"$1"),f,n<d&&xa(b.slice(n,d)),d<e&&xa(b=b.slice(d)),d<e&&zb(b))}l.push(f)}return Ob(l)},Qb=function(b,c){var f,d,e,g,n=[],m=[],j=hc[b+" "];if(!j){c||(c=yb(b));for(f=c.length;f--;)(j=xa(c[f]))[fa]?n.push(j):m.push(j);
(j=hc(b,(d=0<n.length,e=0<m.length,g=function(b,c,f,g,V){var j,l,r,s=0,na="0",p=b&&[],t=[],A=Fb,ja=b||e&&X.find.TAG("*",V),u=Ha+=null==A?1:Math.random()||0.1,v=ja.length;for(V&&(Fb=c==ca||c||V);na!==v&&null!=(j=ja[na]);na++){if(e&&j){l=0;for(c||j.ownerDocument==ca||(Ua(j),f=!Ba);r=m[l++];)if(r(j,c||ca,f)){Ca.call(g,j);break}V&&(Ha=u)}d&&((j=!r&&j)&&s--,b&&p.push(j))}if(s+=na,d&&na!==s){for(l=0;r=n[l++];)r(p,t,c,f);if(b){if(0<s)for(;na--;)p[na]||t[na]||(t[na]=wb.call(g));t=Eb(t)}Ca.apply(g,t);V&&!b&&
0<t.length&&1<s+n.length&&q.uniqueSort(g)}return V&&(Ha=u,Fb=A),p},d?ma(g):g))).selector=b}return j},dc=function(b,c,f,d){var e,g,n,m,j,l="function"==typeof b&&b,r=!d&&yb(b=l.selector||b);if(f=f||[],1===r.length){if(2<(g=r[0]=r[0].slice(0)).length&&"ID"===(n=g[0]).type&&9===c.nodeType&&Ba&&X.relative[g[1].type]){if(!(c=(X.find.ID(n.matches[0].replace(Ma,Na),c)||[])[0]))return f;l&&(c=c.parentNode);b=b.slice(g.shift().value.length)}for(e=Cb.needsContext.test(b)?0:g.length;e--&&!(n=g[e],X.relative[m=
n.type]);)if((j=X.find[m])&&(d=j(n.matches[0].replace(Ma,Na),Lb.test(g[0].type)&&Ja(c.parentNode)||c))){if(g.splice(e,1),!(b=d.length&&zb(g)))return Ca.apply(f,d),f;break}}return(l||Qb(b,r))(d,c,!Ba,f,!c||Lb.test(b)&&Ja(c.parentNode)||c),f},db,X,Fb,ib,Bb,ca,Va,Ba,qa,Mb,Ca=Ra,fa=q.expando,Ha=0,Vc=0,ic=Da(),gc=Da(),hc=Da(),xb=Da(),Nb=function(b,c){return b===c&&(Bb=!0),0},ec="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",
Wc=/[\x20\t\r\n\f]+/g,Uc=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,cc=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,Rc=/[\x20\t\r\n\f]|>/,Xc=RegExp(":((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),
Yc=/^(?:\\[\da-fA-F]{1,6}[\x20\t\r\n\f]?|\\[^\r\n\f]|[\w-]|[^\x00-\x7f])+$/,Cb={ID:/^#((?:\\[\da-fA-F]{1,6}[\x20\t\r\n\f]?|\\[^\r\n\f]|[\w-]|[^\x00-\x7f])+)/,CLASS:/^\.((?:\\[\da-fA-F]{1,6}[\x20\t\r\n\f]?|\\[^\r\n\f]|[\w-]|[^\x00-\x7f])+)/,TAG:/^((?:\\[\da-fA-F]{1,6}[\x20\t\r\n\f]?|\\[^\r\n\f]|[\w-]|[^\x00-\x7f])+|[*])/,ATTR:RegExp("^\\[[\\x20\\t\\r\\n\\f]*((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+))|)[\\x20\\t\\r\\n\\f]*\\]"),
PSEUDO:RegExp("^:((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),
CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:RegExp("^(?:"+ec+")$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},Zc=/^(?:input|select|textarea|button)$/i,$c=/^h\d$/i,Qc=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Lb=/[+~]/,
Ma=/\\[\da-fA-F]{1,6}[\x20\t\r\n\f]?|\\([^\r\n\f])/g,Na=function(b,c){var f="0x"+b.slice(1)-65536;return c||(0>f?String.fromCharCode(f+65536):String.fromCharCode(f>>10|55296,1023&f|56320))},Tc=function(){Ua()},Sc=Db(function(b){return!0===b.disabled&&g(b,"fieldset")},{dir:"parentNode",next:"legend"});try{Ca.apply(la=pa.call(sa.childNodes),sa.childNodes),la[sa.childNodes.length].nodeType}catch(zd){Ca={apply:function(b,c){Ra.apply(b,pa.call(c))},call:function(b){Ra.apply(b,pa.call(arguments,1))}}}for(db in Y.matches=
function(b,c){return Y(b,null,null,c)},Y.matchesSelector=function(b,c){if(Ua(b),Ba&&!xb[c+" "]&&(!qa||!qa.test(c)))try{var f=Mb.call(b,c);if(f||O.disconnectedMatch||b.document&&11!==b.document.nodeType)return f}catch(d){xb(c,!0)}return 0<Y(c,ca,null,[b]).length},Y.contains=function(b,c){return(b.ownerDocument||b)!=ca&&Ua(b),q.contains(b,c)},Y.attr=function(b,c){(b.ownerDocument||b)!=ca&&Ua(b);var f=X.attrHandle[c.toLowerCase()],f=f&&Wa.call(X.attrHandle,c.toLowerCase())?f(b,c,!Ba):void 0;return void 0!==
f?f:b.getAttribute(c)},Y.error=function(b){throw Error("Syntax error, unrecognized expression: "+b);},q.uniqueSort=function(b){var c,f=[],d=0,e=0;if(Bb=!O.sortStable,ib=!O.sortStable&&pa.call(b,0),cb.call(b,Nb),Bb){for(;c=b[e++];)c===b[e]&&(d=f.push(e));for(;d--;)Sa.call(b,f[d],1)}return ib=null,b},q.fn.uniqueSort=function(){return this.pushStack(q.uniqueSort(pa.apply(this)))},(X=q.expr={cacheLength:50,createPseudo:ma,match:Cb,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},
"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(b){return b[1]=b[1].replace(Ma,Na),b[3]=(b[3]||b[4]||b[5]||"").replace(Ma,Na),"~="===b[2]&&(b[3]=" "+b[3]+" "),b.slice(0,4)},CHILD:function(b){return b[1]=b[1].toLowerCase(),"nth"===b[1].slice(0,3)?(b[3]||Y.error(b[0]),b[4]=+(b[4]?b[5]+(b[6]||1):2*("even"===b[3]||"odd"===b[3])),b[5]=+(b[7]+b[8]||"odd"===b[3])):b[3]&&Y.error(b[0]),b},PSEUDO:function(b){var c,f=!b[6]&&b[2];return Cb.CHILD.test(b[0])?null:(b[3]?
b[2]=b[4]||b[5]||"":f&&Xc.test(f)&&(c=yb(f,!0))&&(c=f.indexOf(")",f.length-c)-f.length)&&(b[0]=b[0].slice(0,c),b[2]=f.slice(0,c)),b.slice(0,3))}},filter:{TAG:function(b){var c=b.replace(Ma,Na).toLowerCase();return"*"===b?function(){return!0}:function(b){return g(b,c)}},CLASS:function(b){var c=ic[b+" "];return c||(c=RegExp("(^|[\\x20\\t\\r\\n\\f])"+b+"([\\x20\\t\\r\\n\\f]|$)"))&&ic(b,function(b){return c.test("string"==typeof b.className&&b.className||"undefined"!=typeof b.getAttribute&&b.getAttribute("class")||
"")})},ATTR:function(b,c,f){return function(d){d=Y.attr(d,b);return null==d?"!="===c:!c||(d+="","="===c?d===f:"!="===c?d!==f:"^="===c?f&&0===d.indexOf(f):"*="===c?f&&-1<d.indexOf(f):"$="===c?f&&d.slice(-f.length)===f:"~="===c?-1<(" "+d.replace(Wc," ")+" ").indexOf(f):"|="===c&&(d===f||d.slice(0,f.length+1)===f+"-"))}},CHILD:function(b,c,f,d,e){var n="nth"!==b.slice(0,3),m="last"!==b.slice(-4),j="of-type"===c;return 1===d&&0===e?function(b){return!!b.parentNode}:function(c,f,l){var r,s,p,na;f=n!==
m?"nextSibling":"previousSibling";var t=c.parentNode,q=j&&c.nodeName.toLowerCase(),A=!l&&!j,ja=!1;if(t){if(n){for(;f;){for(s=c;s=s[f];)if(j?g(s,q):1===s.nodeType)return!1;na=f="only"===b&&!na&&"nextSibling"}return!0}if(na=[m?t.firstChild:t.lastChild],m&&A){ja=(p=(r=(l=t[fa]||(t[fa]={}))[b]||[])[0]===Ha&&r[1])&&r[2];for(s=p&&t.childNodes[p];s=++p&&s&&s[f]||(ja=p=0)||na.pop();)if(1===s.nodeType&&++ja&&s===c){l[b]=[Ha,p,ja];break}}else if(A&&(ja=p=(r=(c[fa]||(c[fa]={}))[b]||[])[0]===Ha&&r[1]),!1===ja)for(;(s=
++p&&s&&s[f]||(ja=p=0)||na.pop())&&(!(j?g(s,q):1===s.nodeType)||!++ja||!(A&&((l=s[fa]||(s[fa]={}))[b]=[Ha,ja]),s===c)););return(ja-=e)===d||0==ja%d&&0<=ja/d}}},PSEUDO:function(b,c){var f,d=X.pseudos[b]||X.setFilters[b.toLowerCase()]||Y.error("unsupported pseudo: "+b);return d[fa]?d(c):1<d.length?(f=[b,b,"",c],X.setFilters.hasOwnProperty(b.toLowerCase())?ma(function(b,f){for(var e,g=d(b,c),n=g.length;n--;)b[e=za.call(b,g[n])]=!(f[e]=g[n])}):function(b){return d(b,0,f)}):d}},pseudos:{not:ma(function(b){var c=
[],f=[],d=Qb(b.replace(Pa,"$1"));return d[fa]?ma(function(b,c,f,e){var g;f=d(b,null,e,[]);for(e=b.length;e--;)(g=f[e])&&(b[e]=!(c[e]=g))}):function(b,e,g){return c[0]=b,d(c,null,g,f),c[0]=null,!f.pop()}}),has:ma(function(b){return function(c){return 0<Y(b,c).length}}),contains:ma(function(b){return b=b.replace(Ma,Na),function(c){return-1<(c.textContent||q.text(c)).indexOf(b)}}),lang:ma(function(b){return Yc.test(b||"")||Y.error("unsupported lang: "+b),b=b.replace(Ma,Na).toLowerCase(),function(c){var f;
do if(f=Ba?c.lang:c.getAttribute("xml:lang")||c.getAttribute("lang"))return(f=f.toLowerCase())===b||0===f.indexOf(b+"-");while((c=c.parentNode)&&1===c.nodeType);return!1}}),target:function(c){var f=b.location&&b.location.hash;return f&&f.slice(1)===c.id},root:function(b){return b===Va},focus:function(b){var c;a:{try{c=ca.activeElement;break a}catch(f){}c=void 0}return b===c&&ca.hasFocus()&&!(!b.type&&!b.href&&!~b.tabIndex)},enabled:La(!1),disabled:La(!0),checked:function(b){return g(b,"input")&&!!b.checked||
g(b,"option")&&!!b.selected},selected:function(b){return b.parentNode&&b.parentNode.selectedIndex,!0===b.selected},empty:function(b){for(b=b.firstChild;b;b=b.nextSibling)if(6>b.nodeType)return!1;return!0},parent:function(b){return!X.pseudos.empty(b)},header:function(b){return $c.test(b.nodeName)},input:function(b){return Zc.test(b.nodeName)},button:function(b){return g(b,"input")&&"button"===b.type||g(b,"button")},text:function(b){var c;return g(b,"input")&&"text"===b.type&&(null==(c=b.getAttribute("type"))||
"text"===c.toLowerCase())},first:ga(function(){return[0]}),last:ga(function(b,c){return[c-1]}),eq:ga(function(b,c,f){return[0>f?f+c:f]}),even:ga(function(b,c){for(var f=0;f<c;f+=2)b.push(f);return b}),odd:ga(function(b,c){for(var f=1;f<c;f+=2)b.push(f);return b}),lt:ga(function(b,c,f){for(c=0>f?f+c:c<f?c:f;0<=--c;)b.push(c);return b}),gt:ga(function(b,c,f){for(f=0>f?f+c:f;++f<c;)b.push(f);return b})}}).pseudos.nth=X.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})X.pseudos[db]=Ab(db);
for(db in{submit:!0,reset:!0})X.pseudos[db]=Ka(db);fc.prototype=X.filters=X.pseudos;X.setFilters=new fc;O.sortStable=fa.split("").sort(Nb).join("")===fa;Ua();O.sortDetached=ta(function(b){return 1&b.compareDocumentPosition(ca.createElement("fieldset"))});q.find=Y;q.expr[":"]=q.expr.pseudos;q.unique=q.uniqueSort;Y.compile=Qb;Y.select=dc;Y.setDocument=Ua;Y.escape=q.escapeSelector;Y.getText=q.text;Y.isXML=q.isXMLDoc;Y.selectors=q.expr;Y.support=q.support;Y.uniqueSort=q.uniqueSort;!0;var eb=function(b,
c,f){for(var d=[],e=void 0!==f;(b=b[c])&&9!==b.nodeType;)if(1===b.nodeType){if(e&&q(b).is(f))break;d.push(b)}return d},jc=function(b,c){for(var f=[];b;b=b.nextSibling)1===b.nodeType&&b!==c&&f.push(b);return f},kc=q.expr.match.needsContext,lc=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;q.filter=function(b,c,f){var d=c[0];return f&&(b=":not("+b+")"),1===c.length&&1===d.nodeType?q.find.matchesSelector(d,b)?[d]:[]:q.find.matches(b,q.grep(c,function(b){return 1===b.nodeType}))};q.fn.extend({find:function(b){var c,
f,d=this.length,e=this;if("string"!=typeof b)return this.pushStack(q(b).filter(function(){for(c=0;c<d;c++)if(q.contains(e[c],this))return!0}));f=this.pushStack([]);for(c=0;c<d;c++)q.find(b,e[c],f);return 1<d?q.uniqueSort(f):f},filter:function(b){return this.pushStack(l(this,b||[],!1))},not:function(b){return this.pushStack(l(this,b||[],!0))},is:function(b){return!!l(this,"string"==typeof b&&kc.test(b)?q(b):b||[],!1).length}});var mc,ad=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(q.fn.init=function(b,c,
f){var d,e;if(!b)return this;if(f=f||mc,"string"==typeof b){if(!(d="<"===b[0]&&">"===b[b.length-1]&&3<=b.length?[null,b,null]:ad.exec(b))||!d[1]&&c)return!c||c.jquery?(c||f).find(b):this.constructor(c).find(b);if(d[1]){if(c=c instanceof q?c[0]:c,q.merge(this,q.parseHTML(d[1],c&&c.nodeType?c.ownerDocument||c:R,!0)),lc.test(d[1])&&q.isPlainObject(c))for(d in c)P(this[d])?this[d](c[d]):this.attr(d,c[d]);return this}return(e=R.getElementById(d[2]))&&(this[0]=e,this.length=1),this}return b.nodeType?(this[0]=
b,this.length=1,this):P(b)?void 0!==f.ready?f.ready(b):b(q):q.makeArray(b,this)}).prototype=q.fn;mc=q(R);var bd=/^(?:parents|prev(?:Until|All))/,cd={children:!0,contents:!0,next:!0,prev:!0};q.fn.extend({has:function(b){var c=q(b,this),f=c.length;return this.filter(function(){for(var b=0;b<f;b++)if(q.contains(this,c[b]))return!0})},closest:function(b,c){var f,d=0,e=this.length,g=[],n="string"!=typeof b&&q(b);if(!kc.test(b))for(;d<e;d++)for(f=this[d];f&&f!==c;f=f.parentNode)if(11>f.nodeType&&(n?-1<
n.index(f):1===f.nodeType&&q.find.matchesSelector(f,b))){g.push(f);break}return this.pushStack(1<g.length?q.uniqueSort(g):g)},index:function(b){return b?"string"==typeof b?za.call(q(b),this[0]):za.call(this,b.jquery?b[0]:b):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(b,c){return this.pushStack(q.uniqueSort(q.merge(this.get(),q(b,c))))},addBack:function(b){return this.add(null==b?this.prevObject:this.prevObject.filter(b))}});q.each({parent:function(b){return(b=b.parentNode)&&
11!==b.nodeType?b:null},parents:function(b){return eb(b,"parentNode")},parentsUntil:function(b,c,f){return eb(b,"parentNode",f)},next:function(b){return f(b,"nextSibling")},prev:function(b){return f(b,"previousSibling")},nextAll:function(b){return eb(b,"nextSibling")},prevAll:function(b){return eb(b,"previousSibling")},nextUntil:function(b,c,f){return eb(b,"nextSibling",f)},prevUntil:function(b,c,f){return eb(b,"previousSibling",f)},siblings:function(b){return jc((b.parentNode||{}).firstChild,b)},
children:function(b){return jc(b.firstChild)},contents:function(b){return null!=b.contentDocument&&ub(b.contentDocument)?b.contentDocument:(g(b,"template")&&(b=b.content||b),q.merge([],b.childNodes))}},function(b,c){q.fn[b]=function(f,d){var e=q.map(this,c,f);return"Until"!==b.slice(-5)&&(d=f),d&&"string"==typeof d&&(e=q.filter(d,e)),1<this.length&&(cd[b]||q.uniqueSort(e),bd.test(b)&&e.reverse()),this.pushStack(e)}});var Fa=/[^\x20\t\r\n\f]+/g;q.Callbacks=function(b){var c,f;b="string"==typeof b?
(c=b,f={},q.each(c.match(Fa)||[],function(b,c){f[c]=!0}),f):q.extend({},b);var e,g,n,m,j=[],l=[],r=-1,s=function(){m=m||b.once;for(n=e=!0;l.length;r=-1)for(g=l.shift();++r<j.length;)!1===j[r].apply(g[0],g[1])&&b.stopOnFalse&&(r=j.length,g=!1);b.memory||(g=!1);e=!1;m&&(j=g?[]:"")},p={add:function(){return j&&(g&&!e&&(r=j.length-1,l.push(g)),function Mc(c){q.each(c,function(c,f){P(f)?b.unique&&p.has(f)||j.push(f):f&&f.length&&"string"!==d(f)&&Mc(f)})}(arguments),g&&!e&&s()),this},remove:function(){return q.each(arguments,
function(b,c){for(var f;-1<(f=q.inArray(c,j,f));)j.splice(f,1),f<=r&&r--}),this},has:function(b){return b?-1<q.inArray(b,j):0<j.length},empty:function(){return j&&(j=[]),this},disable:function(){return m=l=[],j=g="",this},disabled:function(){return!j},lock:function(){return m=l=[],g||e||(j=g=""),this},locked:function(){return!!m},fireWith:function(b,c){return m||(c=[b,(c=c||[]).slice?c.slice():c],l.push(c),e||s()),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!n}};
return p};q.extend({Deferred:function(c){var f=[["notify","progress",q.Callbacks("memory"),q.Callbacks("memory"),2],["resolve","done",q.Callbacks("once memory"),q.Callbacks("once memory"),0,"resolved"],["reject","fail",q.Callbacks("once memory"),q.Callbacks("once memory"),1,"rejected"]],d="pending",e={state:function(){return d},always:function(){return g.done(arguments).fail(arguments),this},"catch":function(b){return e.then(null,b)},pipe:function(){var b=arguments;return q.Deferred(function(c){q.each(f,
function(f,d){var e=P(b[d[4]])&&b[d[4]];g[d[1]](function(){var b=e&&e.apply(this,arguments);b&&P(b.promise)?b.promise().progress(c.notify).done(c.resolve).fail(c.reject):c[d[0]+"With"](this,e?[b]:arguments)})});b=null}).promise()},then:function(c,d,e){function g(c,f,d,e){return function(){var l=this,r=arguments,V=function(){var b,V;if(!(c<j)){if((b=d.apply(l,r))===f.promise())throw new TypeError("Thenable self-resolution");V=b&&("object"==typeof b||"function"==typeof b)&&b.then;P(V)?e?V.call(b,g(j,
f,m,e),g(j,f,n,e)):(j++,V.call(b,g(j,f,m,e),g(j,f,n,e),g(j,f,m,f.notifyWith))):(d!==m&&(l=void 0,r=[b]),(e||f.resolveWith)(l,r))}},s=e?V:function(){try{V()}catch(b){q.Deferred.exceptionHook&&q.Deferred.exceptionHook(b,s.error),j<=c+1&&(d!==n&&(l=void 0,r=[b]),f.rejectWith(l,r))}};c?s():(q.Deferred.getErrorHook?s.error=q.Deferred.getErrorHook():q.Deferred.getStackHook&&(s.error=q.Deferred.getStackHook()),b.setTimeout(s))}}var j=0;return q.Deferred(function(b){f[0][3].add(g(0,b,P(e)?e:m,b.notifyWith));
f[1][3].add(g(0,b,P(c)?c:m));f[2][3].add(g(0,b,P(d)?d:n))}).promise()},promise:function(b){return null!=b?q.extend(b,e):e}},g={};return q.each(f,function(b,c){var n=c[2],m=c[5];e[c[1]]=n.add;m&&n.add(function(){d=m},f[3-b][2].disable,f[3-b][3].disable,f[0][2].lock,f[0][3].lock);n.add(c[3].fire);g[c[0]]=function(){return g[c[0]+"With"](this===g?void 0:this,arguments),this};g[c[0]+"With"]=n.fireWith}),e.promise(g),c&&c.call(g,g),g},when:function(b){var c=arguments.length,f=c,d=Array(f),e=pa.call(arguments),
g=q.Deferred(),n=function(b){return function(f){d[b]=this;e[b]=1<arguments.length?pa.call(arguments):f;--c||g.resolveWith(d,e)}};if(1>=c&&(r(b,g.done(n(f)).resolve,g.reject,!c),"pending"===g.state()||P(e[f]&&e[f].then)))return g.then();for(;f--;)r(e[f],n(f),g.reject);return g.promise()}});var dd=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;q.Deferred.exceptionHook=function(c,f){b.console&&b.console.warn&&c&&dd.test(c.name)&&b.console.warn("jQuery.Deferred exception: "+c.message,c.stack,
f)};q.readyException=function(c){b.setTimeout(function(){throw c;})};var Rb=q.Deferred();q.fn.ready=function(b){return Rb.then(b)["catch"](function(b){q.readyException(b)}),this};q.extend({isReady:!1,readyWait:1,ready:function(b){(!0===b?--q.readyWait:q.isReady)||(q.isReady=!0)!==b&&0<--q.readyWait||Rb.resolveWith(R,[q])}});q.ready.then=Rb.then;"complete"===R.readyState||"loading"!==R.readyState&&!R.documentElement.doScroll?b.setTimeout(q.ready):(R.addEventListener("DOMContentLoaded",s),b.addEventListener("load",
s));var Oa=function(b,c,f,e,g,n,m){var j=0,l=b.length,r=null==f;if("object"===d(f))for(j in g=!0,f)Oa(b,c,j,f[j],!0,n,m);else if(void 0!==e&&(g=!0,P(e)||(m=!0),r&&(m?(c.call(b,e),c=null):(r=c,c=function(b,c,f){return r.call(q(b),f)})),c))for(;j<l;j++)c(b[j],f,m?e:e.call(b[j],j,c(b[j],f)));return g?b:r?c.call(b):l?c(b[0],f):n},Gc=/^-ms-/,Hc=/-([a-z])/g,jb=function(b){return 1===b.nodeType||9===b.nodeType||!+b.nodeType};v.uid=1;v.prototype={cache:function(b){var c=b[this.expando];return c||(c={},jb(b)&&
(b.nodeType?b[this.expando]=c:Object.defineProperty(b,this.expando,{value:c,configurable:!0}))),c},set:function(b,c,f){var d;b=this.cache(b);if("string"==typeof c)b[u(c)]=f;else for(d in c)b[u(d)]=c[d];return b},get:function(b,c){return void 0===c?this.cache(b):b[this.expando]&&b[this.expando][u(c)]},access:function(b,c,f){return void 0===c||c&&"string"==typeof c&&void 0===f?this.get(b,c):(this.set(b,c,f),void 0!==f?f:c)},remove:function(b,c){var f,d=b[this.expando];if(void 0!==d){if(void 0!==c){f=
(c=Array.isArray(c)?c.map(u):(c=u(c))in d?[c]:c.match(Fa)||[]).length;for(;f--;)delete d[c[f]]}(void 0===c||q.isEmptyObject(d))&&(b.nodeType?b[this.expando]=void 0:delete b[this.expando])}},hasData:function(b){b=b[this.expando];return void 0!==b&&!q.isEmptyObject(b)}};var K=new v,ra=new v,Jc=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ic=/[A-Z]/g;q.extend({hasData:function(b){return ra.hasData(b)||K.hasData(b)},data:function(b,c,f){return ra.access(b,c,f)},removeData:function(b,c){ra.remove(b,c)},_data:function(b,
c,f){return K.access(b,c,f)},_removeData:function(b,c){K.remove(b,c)}});q.fn.extend({data:function(b,c){var f,d,e,g=this[0],n=g&&g.attributes;if(void 0===b){if(this.length&&(e=ra.get(g),1===g.nodeType&&!K.get(g,"hasDataAttrs"))){for(f=n.length;f--;)n[f]&&0===(d=n[f].name).indexOf("data-")&&(d=u(d.slice(5)),z(g,d,e[d]));K.set(g,"hasDataAttrs",!0)}return e}return"object"==typeof b?this.each(function(){ra.set(this,b)}):Oa(this,function(c){var f;if(g&&void 0===c)return void 0!==(f=ra.get(g,b))?f:void 0!==
(f=z(g,b))?f:void 0;this.each(function(){ra.set(this,b,c)})},null,c,1<arguments.length,null,!0)},removeData:function(b){return this.each(function(){ra.remove(this,b)})}});q.extend({queue:function(b,c,f){var d;if(b)return c=(c||"fx")+"queue",d=K.get(b,c),f&&(!d||Array.isArray(f)?d=K.access(b,c,q.makeArray(f)):d.push(f)),d||[]},dequeue:function(b,c){c=c||"fx";var f=q.queue(b,c),d=f.length,e=f.shift(),g=q._queueHooks(b,c);"inprogress"===e&&(e=f.shift(),d--);e&&("fx"===c&&f.unshift("inprogress"),delete g.stop,
e.call(b,function(){q.dequeue(b,c)},g));!d&&g&&g.empty.fire()},_queueHooks:function(b,c){var f=c+"queueHooks";return K.get(b,f)||K.access(b,f,{empty:q.Callbacks("once memory").add(function(){K.remove(b,[c+"queue",f])})})}});q.fn.extend({queue:function(b,c){var f=2;return"string"!=typeof b&&(c=b,b="fx",f--),arguments.length<f?q.queue(this[0],b):void 0===c?this:this.each(function(){var f=q.queue(this,b,c);q._queueHooks(this,b);"fx"===b&&"inprogress"!==f[0]&&q.dequeue(this,b)})},dequeue:function(b){return this.each(function(){q.dequeue(this,
b)})},clearQueue:function(b){return this.queue(b||"fx",[])},promise:function(b,c){var f,d=1,e=q.Deferred(),g=this,n=this.length,m=function(){--d||e.resolveWith(g,[g])};"string"!=typeof b&&(c=b,b=void 0);for(b=b||"fx";n--;)(f=K.get(g[n],b+"queueHooks"))&&f.empty&&(d++,f.empty.add(m));return m(),e.promise(c)}});var nc=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,hb=RegExp("^(?:([+-])=|)("+nc+")([a-z%]*)$","i"),Ia=["Top","Right","Bottom","Left"],Xa=R.documentElement,$a=function(b){return q.contains(b.ownerDocument,
b)},ed={composed:!0};Xa.getRootNode&&($a=function(b){return q.contains(b.ownerDocument,b)||b.getRootNode(ed)===b.ownerDocument});var qb=function(b,c){return"none"===(b=c||b).style.display||""===b.style.display&&$a(b)&&"none"===q.css(b,"display")},Xb={};q.fn.extend({show:function(){return C(this,!0)},hide:function(){return C(this)},toggle:function(b){return"boolean"==typeof b?b?this.show():this.hide():this.each(function(){qb(this)?q(this).show():q(this).hide()})}});var Ya,Gb,kb=/^(?:checkbox|radio)$/i,
Yb=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Zb=/^$|^module$|\/(?:java|ecma)script/i;Ya=R.createDocumentFragment().appendChild(R.createElement("div"));(Gb=R.createElement("input")).setAttribute("type","radio");Gb.setAttribute("checked","checked");Gb.setAttribute("name","t");Ya.appendChild(Gb);O.checkClone=Ya.cloneNode(!0).cloneNode(!0).lastChild.checked;Ya.innerHTML="<textarea>x</textarea>";O.noCloneChecked=!!Ya.cloneNode(!0).lastChild.defaultValue;Ya.innerHTML="<option></option>";O.option=!!Ya.lastChild;
var ua={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ua.tbody=ua.tfoot=ua.colgroup=ua.caption=ua.thead;ua.th=ua.td;O.option||(ua.optgroup=ua.option=[1,"<select multiple='multiple'>","</select>"]);var Kc=/<|&#?\w+;/,oc=/^([^.]*)(?:\.(.+)|)/;q.event={global:{},add:function(b,c,f,d,e){var g,n,m,j,l,r,s,p,t,A;l=K.get(b);if(jb(b)){f.handler&&(f=(g=f).handler,
e=g.selector);e&&q.find.matchesSelector(Xa,e);f.guid||(f.guid=q.guid++);(j=l.events)||(j=l.events=Object.create(null));(n=l.handle)||(n=l.handle=function(c){return"undefined"!=typeof q&&q.event.triggered!==c.type?q.event.dispatch.apply(b,arguments):void 0});for(l=(c=(c||"").match(Fa)||[""]).length;l--;)t=A=(m=oc.exec(c[l])||[])[1],m=(m[2]||"").split(".").sort(),t&&(s=q.event.special[t]||{},t=(e?s.delegateType:s.bindType)||t,s=q.event.special[t]||{},r=q.extend({type:t,origType:A,data:d,handler:f,guid:f.guid,
selector:e,needsContext:e&&q.expr.match.needsContext.test(e),namespace:m.join(".")},g),(p=j[t])||((p=j[t]=[]).delegateCount=0,s.setup&&!1!==s.setup.call(b,d,m,n)||b.addEventListener&&b.addEventListener(t,n)),s.add&&(s.add.call(b,r),r.handler.guid||(r.handler.guid=f.guid)),e?p.splice(p.delegateCount++,0,r):p.push(r),q.event.global[t]=!0)}},remove:function(b,c,f,d,e){var g,n,m,j,l,r,s,p,t,A,u,v=K.hasData(b)&&K.get(b);if(v&&(j=v.events)){for(l=(c=(c||"").match(Fa)||[""]).length;l--;)if(t=u=(m=oc.exec(c[l])||
[])[1],A=(m[2]||"").split(".").sort(),t){s=q.event.special[t]||{};p=j[t=(d?s.delegateType:s.bindType)||t]||[];m=m[2]&&RegExp("(^|\\.)"+A.join("\\.(?:.*\\.|)")+"(\\.|$)");for(n=g=p.length;g--;)r=p[g],!e&&u!==r.origType||f&&f.guid!==r.guid||m&&!m.test(r.namespace)||d&&d!==r.selector&&("**"!==d||!r.selector)||(p.splice(g,1),r.selector&&p.delegateCount--,s.remove&&s.remove.call(b,r));n&&!p.length&&(s.teardown&&!1!==s.teardown.call(b,A,v.handle)||q.removeEvent(b,t,v.handle),delete j[t])}else for(t in j)q.event.remove(b,
t+c[l],f,d,!0);q.isEmptyObject(j)&&K.remove(b,"handle events")}},dispatch:function(b){var c,f,d,e,g,n,m=Array(arguments.length),j=q.event.fix(b);f=(K.get(this,"events")||Object.create(null))[j.type]||[];var l=q.event.special[j.type]||{};m[0]=j;for(c=1;c<arguments.length;c++)m[c]=arguments[c];if(j.delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,j)){n=q.event.handlers.call(this,j,f);for(c=0;(e=n[c++])&&!j.isPropagationStopped();){j.currentTarget=e.elem;for(f=0;(g=e.handlers[f++])&&
!j.isImmediatePropagationStopped();)j.rnamespace&&!1!==g.namespace&&!j.rnamespace.test(g.namespace)||(j.handleObj=g,j.data=g.data,void 0!==(d=((q.event.special[g.origType]||{}).handle||g.handler).apply(e.elem,m))&&!1===(j.result=d)&&(j.preventDefault(),j.stopPropagation()))}return l.postDispatch&&l.postDispatch.call(this,j),j.result}},handlers:function(b,c){var f,d,e,g,n,m=[],j=c.delegateCount,l=b.target;if(j&&l.nodeType&&!("click"===b.type&&1<=b.button))for(;l!==this;l=l.parentNode||this)if(1===
l.nodeType&&("click"!==b.type||!0!==l.disabled)){g=[];n={};for(f=0;f<j;f++)void 0===n[e=(d=c[f]).selector+" "]&&(n[e]=d.needsContext?-1<q(e,this).index(l):q.find(e,this,null,[l]).length),n[e]&&g.push(d);g.length&&m.push({elem:l,handlers:g})}return l=this,j<c.length&&m.push({elem:l,handlers:c.slice(j)}),m},addProp:function(b,c){Object.defineProperty(q.Event.prototype,b,{enumerable:!0,configurable:!0,get:P(c)?function(){if(this.originalEvent)return c(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[b]},
set:function(c){Object.defineProperty(this,b,{enumerable:!0,configurable:!0,writable:!0,value:c})}})},fix:function(b){return b[q.expando]?b:new q.Event(b)},special:{load:{noBubble:!0},click:{setup:function(b){b=this||b;return kb.test(b.type)&&b.click&&g(b,"input")&&M(b,"click",!0),!1},trigger:function(b){b=this||b;return kb.test(b.type)&&b.click&&g(b,"input")&&M(b,"click"),!0},_default:function(b){b=b.target;return kb.test(b.type)&&b.click&&g(b,"input")&&K.get(b,"click")||g(b,"a")}},beforeunload:{postDispatch:function(b){void 0!==
b.result&&b.originalEvent&&(b.originalEvent.returnValue=b.result)}}}};q.removeEvent=function(b,c,f){b.removeEventListener&&b.removeEventListener(c,f)};q.Event=function(b,c){if(!(this instanceof q.Event))return new q.Event(b,c);b&&b.type?(this.originalEvent=b,this.type=b.type,this.isDefaultPrevented=b.defaultPrevented||void 0===b.defaultPrevented&&!1===b.returnValue?y:D,this.target=b.target&&3===b.target.nodeType?b.target.parentNode:b.target,this.currentTarget=b.currentTarget,this.relatedTarget=b.relatedTarget):
this.type=b;c&&q.extend(this,c);this.timeStamp=b&&b.timeStamp||Date.now();this[q.expando]=!0};q.Event.prototype={constructor:q.Event,isDefaultPrevented:D,isPropagationStopped:D,isImmediatePropagationStopped:D,isSimulated:!1,preventDefault:function(){var b=this.originalEvent;this.isDefaultPrevented=y;b&&!this.isSimulated&&b.preventDefault()},stopPropagation:function(){var b=this.originalEvent;this.isPropagationStopped=y;b&&!this.isSimulated&&b.stopPropagation()},stopImmediatePropagation:function(){var b=
this.originalEvent;this.isImmediatePropagationStopped=y;b&&!this.isSimulated&&b.stopImmediatePropagation();this.stopPropagation()}};q.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},q.event.addProp);
q.each({focus:"focusin",blur:"focusout"},function(b,c){function f(b){if(R.documentMode){var d=K.get(this,"handle"),e=q.event.fix(b);e.type="focusin"===b.type?"focus":"blur";e.isSimulated=!0;d(b);e.target===e.currentTarget&&d(e)}else q.event.simulate(c,b.target,q.event.fix(b))}q.event.special[b]={setup:function(){var d;if(M(this,b,!0),!R.documentMode)return!1;(d=K.get(this,c))||this.addEventListener(c,f);K.set(this,c,(d||0)+1)},trigger:function(){return M(this,b),!0},teardown:function(){var b;if(!R.documentMode)return!1;
(b=K.get(this,c)-1)?K.set(this,c,b):(this.removeEventListener(c,f),K.remove(this,c))},_default:function(c){return K.get(c.target,b)},delegateType:c};q.event.special[c]={setup:function(){var d=this.ownerDocument||this.document||this,e=R.documentMode?this:d,g=K.get(e,c);g||(R.documentMode?this.addEventListener(c,f):d.addEventListener(b,f,!0));K.set(e,c,(g||0)+1)},teardown:function(){var d=this.ownerDocument||this.document||this,e=R.documentMode?this:d,g=K.get(e,c)-1;g?K.set(e,c,g):(R.documentMode?this.removeEventListener(c,
f):d.removeEventListener(b,f,!0),K.remove(e,c))}}});q.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(b,c){q.event.special[b]={delegateType:c,bindType:c,handle:function(b){var f,d=b.relatedTarget,e=b.handleObj;return d&&(d===this||q.contains(this,d))||(b.type=e.origType,f=e.handler.apply(this,arguments),b.type=c),f}}});q.fn.extend({on:function(b,c,f,d){return H(this,b,c,f,d)},one:function(b,c,f,d){return H(this,b,c,f,d,1)},off:function(b,
c,f){var d,e;if(b&&b.preventDefault&&b.handleObj)return d=b.handleObj,q(b.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof b){for(e in b)this.off(e,c,b[e]);return this}return!1!==c&&"function"!=typeof c||(f=c,c=void 0),!1===f&&(f=D),this.each(function(){q.event.remove(this,b,f,c)})}});var fd=/<script|<style|<link/i,Lc=/checked\s*(?:[^=]|=\s*.checked.)/i,Nc=/^\s*<!\[CDATA\[|\]\]>\s*$/g;q.extend({htmlPrefilter:function(b){return b},
clone:function(b,c,f){var d,e,g,n,m,j,l,r=b.cloneNode(!0),s=$a(b);if(!O.noCloneChecked&&!(1!==b.nodeType&&11!==b.nodeType||q.isXMLDoc(b))){n=B(r);d=0;for(e=(g=B(b)).length;d<e;d++)m=g[d],j=n[d],void 0,"input"===(l=j.nodeName.toLowerCase())&&kb.test(m.type)?j.checked=m.checked:"input"!==l&&"textarea"!==l||(j.defaultValue=m.defaultValue)}if(c)if(f){g=g||B(b);n=n||B(r);d=0;for(e=g.length;d<e;d++)W(g[d],n[d])}else W(b,r);return 0<(n=B(r,"script")).length&&E(n,!s&&B(b,"script")),r},cleanData:function(b){for(var c,
f,d,e=q.event.special,g=0;void 0!==(f=b[g]);g++)if(jb(f)){if(c=f[K.expando]){if(c.events)for(d in c.events)e[d]?q.event.remove(f,d):q.removeEvent(f,d,c.handle);f[K.expando]=void 0}f[ra.expando]&&(f[ra.expando]=void 0)}}});q.fn.extend({detach:function(b){return G(this,b,!0)},remove:function(b){return G(this,b)},text:function(b){return Oa(this,function(b){return void 0===b?q.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=b)})},null,
b,arguments.length)},append:function(){return aa(this,arguments,function(b){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||S(this,b).appendChild(b)})},prepend:function(){return aa(this,arguments,function(b){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var c=S(this,b);c.insertBefore(b,c.firstChild)}})},before:function(){return aa(this,arguments,function(b){this.parentNode&&this.parentNode.insertBefore(b,this)})},after:function(){return aa(this,arguments,function(b){this.parentNode&&
this.parentNode.insertBefore(b,this.nextSibling)})},empty:function(){for(var b,c=0;null!=(b=this[c]);c++)1===b.nodeType&&(q.cleanData(B(b,!1)),b.textContent="");return this},clone:function(b,c){return b=null!=b&&b,c=null==c?b:c,this.map(function(){return q.clone(this,b,c)})},html:function(b){return Oa(this,function(b){var c=this[0]||{},f=0,d=this.length;if(void 0===b&&1===c.nodeType)return c.innerHTML;if("string"==typeof b&&!fd.test(b)&&!ua[(Yb.exec(b)||["",""])[1].toLowerCase()]){b=q.htmlPrefilter(b);
try{for(;f<d;f++)1===(c=this[f]||{}).nodeType&&(q.cleanData(B(c,!1)),c.innerHTML=b);c=0}catch(e){}}c&&this.empty().append(b)},null,b,arguments.length)},replaceWith:function(){var b=[];return aa(this,arguments,function(c){var f=this.parentNode;0>q.inArray(this,b)&&(q.cleanData(B(this)),f&&f.replaceChild(c,this))},b)}});q.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(b,c){q.fn[b]=function(b){for(var f=[],d=q(b),e=d.length-1,
g=0;g<=e;g++)b=g===e?this:this.clone(!0),q(d[g])[c](b),Ra.apply(f,b.get());return this.pushStack(f)}});var Ib=RegExp("^("+nc+")(?!px)[a-z%]+$","i"),Hb=/^--/,sb=function(c){var f=c.ownerDocument.defaultView;return f&&f.opener||(f=b),f.getComputedStyle(c)},pc=function(b,c,f){var d,e={};for(d in c)e[d]=b.style[d],b.style[d]=c[d];for(d in f=f.call(b),c)b.style[d]=e[d];return f},Oc=RegExp(Ia.join("|"),"i"),lb=function(){if(ya){Sb.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0";
ya.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%";Xa.appendChild(Sb).appendChild(ya);var c=b.getComputedStyle(ya);qc="1%"!==c.top;rc=12===Math.round(parseFloat(c.marginLeft));ya.style.right="60%";sc=36===Math.round(parseFloat(c.right));tc=36===Math.round(parseFloat(c.width));ya.style.position="absolute";uc=12===Math.round(parseFloat(ya.offsetWidth/3));Xa.removeChild(Sb);ya=null}},qc,tc,uc,sc,Tb,rc,Sb=R.createElement("div"),
ya=R.createElement("div");ya.style&&(ya.style.backgroundClip="content-box",ya.cloneNode(!0).style.backgroundClip="",O.clearCloneStyle="content-box"===ya.style.backgroundClip,q.extend(O,{boxSizingReliable:function(){return lb(),tc},pixelBoxStyles:function(){return lb(),sc},pixelPosition:function(){return lb(),qc},reliableMarginLeft:function(){return lb(),rc},scrollboxSize:function(){return lb(),uc},reliableTrDimensions:function(){var c,f,d,e;return null==Tb&&(c=R.createElement("table"),f=R.createElement("tr"),
d=R.createElement("div"),c.style.cssText="position:absolute;left:-11111px;border-collapse:separate",f.style.cssText="border:1px solid",f.style.height="1px",d.style.height="9px",d.style.display="block",Xa.appendChild(c).appendChild(f).appendChild(d),e=b.getComputedStyle(f),Tb=parseInt(e.height,10)+parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10)===f.offsetHeight,Xa.removeChild(c)),Tb}}));!0;var bc=["Webkit","Moz","ms"],ac=R.createElement("div").style,$b={},gd=/^(none|table(?!-c[ea]).+)/,
hd={position:"absolute",visibility:"hidden",display:"block"},vc={letterSpacing:"0",fontWeight:"400"};q.extend({cssHooks:{opacity:{get:function(b,c){if(c){var f=F(b,"opacity");return""===f?"1":f}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,
zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(b,c,f,d){if(b&&3!==b.nodeType&&8!==b.nodeType&&b.style){var e,g,n,m=u(c),j=Hb.test(c),l=b.style;if(j||(c=Z(m)),n=q.cssHooks[c]||q.cssHooks[m],void 0===f)return n&&"get"in n&&void 0!==(e=n.get(b,!1,d))?e:l[c];"string"===(g=typeof f)&&(e=hb.exec(f))&&e[1]&&(f=x(b,c,e),g="number");null!=f&&f==f&&("number"!==g||j||(f+=e&&e[3]||(q.cssNumber[m]?"":"px")),O.clearCloneStyle||""!==f||0!==
c.indexOf("background")||(l[c]="inherit"),n&&"set"in n&&void 0===(f=n.set(b,f,d))||(j?l.setProperty(c,f):l[c]=f))}},css:function(b,c,f,d){var e,g,n,m=u(c);return Hb.test(c)||(c=Z(m)),(n=q.cssHooks[c]||q.cssHooks[m])&&"get"in n&&(e=n.get(b,!0,f)),void 0===e&&(e=F(b,c,d)),"normal"===e&&c in vc&&(e=vc[c]),""===f||f?(g=parseFloat(e),!0===f||isFinite(g)?g||0:e):e}});q.each(["height","width"],function(b,c){q.cssHooks[c]={get:function(b,f,d){if(f)return!gd.test(q.css(b,"display"))||b.getClientRects().length&&
b.getBoundingClientRect().width?J(b,c,d):pc(b,hd,function(){return J(b,c,d)})},set:function(b,f,d){var e,g=sb(b),n=!O.scrollboxSize()&&"absolute"===g.position,m=(n||d)&&"border-box"===q.css(b,"boxSizing",!1,g);d=d?T(b,c,d,m,g):0;return m&&n&&(d-=Math.ceil(b["offset"+c[0].toUpperCase()+c.slice(1)]-parseFloat(g[c])-T(b,c,"border",!1,g)-0.5)),d&&(e=hb.exec(f))&&"px"!==(e[3]||"px")&&(b.style[c]=f,f=q.css(b,c)),N(0,f,d)}}});q.cssHooks.marginLeft=ka(O.reliableMarginLeft,function(b,c){if(c)return(parseFloat(F(b,
"marginLeft"))||b.getBoundingClientRect().left-pc(b,{marginLeft:0},function(){return b.getBoundingClientRect().left}))+"px"});q.each({margin:"",padding:"",border:"Width"},function(b,c){q.cssHooks[b+c]={expand:function(f){var d=0,e={};for(f="string"==typeof f?f.split(" "):[f];4>d;d++)e[b+Ia[d]+c]=f[d]||f[d-2]||f[0];return e}};"margin"!==b&&(q.cssHooks[b+c].set=N)});q.fn.extend({css:function(b,c){return Oa(this,function(b,c,f){var d,e={},g=0;if(Array.isArray(c)){f=sb(b);for(d=c.length;g<d;g++)e[c[g]]=
q.css(b,c[g],!1,f);return e}return void 0!==f?q.style(b,c,f):q.css(b,c)},b,c,1<arguments.length)}});((q.Tween=U).prototype={constructor:U,init:function(b,c,f,d,e,g){this.elem=b;this.prop=f;this.easing=e||q.easing._default;this.options=c;this.start=this.now=this.cur();this.end=d;this.unit=g||(q.cssNumber[f]?"":"px")},cur:function(){var b=U.propHooks[this.prop];return b&&b.get?b.get(this):U.propHooks._default.get(this)},run:function(b){var c,f=U.propHooks[this.prop];return this.options.duration?this.pos=
c=q.easing[this.easing](b,this.options.duration*b,0,1,this.options.duration):this.pos=c=b,this.now=(this.end-this.start)*c+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),f&&f.set?f.set(this):U.propHooks._default.set(this),this}}).init.prototype=U.prototype;(U.propHooks={_default:{get:function(b){var c;return 1!==b.elem.nodeType||null!=b.elem[b.prop]&&null==b.elem.style[b.prop]?b.elem[b.prop]:(c=q.css(b.elem,b.prop,""))&&"auto"!==c?c:0},set:function(b){q.fx.step[b.prop]?
q.fx.step[b.prop](b):1!==b.elem.nodeType||!q.cssHooks[b.prop]&&null==b.elem.style[Z(b.prop)]?b.elem[b.prop]=b.now:q.style(b.elem,b.prop,b.now+b.unit)}}}).scrollTop=U.propHooks.scrollLeft={set:function(b){b.elem.nodeType&&b.elem.parentNode&&(b.elem[b.prop]=b.now)}};q.easing={linear:function(b){return b},swing:function(b){return 0.5-Math.cos(b*Math.PI)/2},_default:"swing"};q.fx=U.prototype.init;q.fx.step={};var ab,tb,fb,wc,id=/^(?:toggle|show|hide)$/,jd=/queueHooks$/;q.Animation=q.extend(ba,{tweeners:{"*":[function(b,
c){var f=this.createTween(b,c);return x(f.elem,b,hb.exec(c),f),f}]},tweener:function(b,c){P(b)?(c=b,b=["*"]):b=b.match(Fa);for(var f,d=0,e=b.length;d<e;d++)f=b[d],ba.tweeners[f]=ba.tweeners[f]||[],ba.tweeners[f].unshift(c)},prefilters:[function(b,c,f){var d,e,g,n,m,j,l,r="width"in c||"height"in c,s=this,p={},t=b.style,A=b.nodeType&&qb(b),u=K.get(b,"fxshow");for(d in f.queue||(null==(n=q._queueHooks(b,"fx")).unqueued&&(n.unqueued=0,m=n.empty.fire,n.empty.fire=function(){n.unqueued||m()}),n.unqueued++,
s.always(function(){s.always(function(){n.unqueued--;q.queue(b,"fx").length||n.empty.fire()})})),c)if(e=c[d],id.test(e)){if(delete c[d],g=g||"toggle"===e,e===(A?"hide":"show")){if("show"!==e||!u||void 0===u[d])continue;A=!0}p[d]=u&&u[d]||q.style(b,d)}if((c=!q.isEmptyObject(c))||!q.isEmptyObject(p))for(d in r&&1===b.nodeType&&(f.overflow=[t.overflow,t.overflowX,t.overflowY],null==(j=u&&u.display)&&(j=K.get(b,"display")),"none"===(l=q.css(b,"display"))&&(j?l=j:(C([b],!0),j=b.style.display||j,l=q.css(b,
"display"),C([b]))),("inline"===l||"inline-block"===l&&null!=j)&&"none"===q.css(b,"float")&&(c||(s.done(function(){t.display=j}),null==j&&(l=t.display,j="none"===l?"":l)),t.display="inline-block")),f.overflow&&(t.overflow="hidden",s.always(function(){t.overflow=f.overflow[0];t.overflowX=f.overflow[1];t.overflowY=f.overflow[2]})),c=!1,p)c||(u?"hidden"in u&&(A=u.hidden):u=K.access(b,"fxshow",{display:j}),g&&(u.hidden=!A),A&&C([b],!0),s.done(function(){for(d in A||C([b]),K.remove(b,"fxshow"),p)q.style(b,
d,p[d])})),c=ea(A?u[d]:0,d,s),d in u||(u[d]=c.start,A&&(c.end=c.start,c.start=0))}],prefilter:function(b,c){c?ba.prefilters.unshift(b):ba.prefilters.push(b)}});q.speed=function(b,c,f){var d=b&&"object"==typeof b?q.extend({},b):{complete:f||!f&&c||P(b)&&b,duration:b,easing:f&&c||c&&!P(c)&&c};return q.fx.off?d.duration=0:"number"!=typeof d.duration&&(d.duration in q.fx.speeds?d.duration=q.fx.speeds[d.duration]:d.duration=q.fx.speeds._default),null!=d.queue&&!0!==d.queue||(d.queue="fx"),d.old=d.complete,
d.complete=function(){P(d.old)&&d.old.call(this);d.queue&&q.dequeue(this,d.queue)},d};q.fn.extend({fadeTo:function(b,c,f,d){return this.filter(qb).css("opacity",0).show().end().animate({opacity:c},b,f,d)},animate:function(b,c,f,d){var e=q.isEmptyObject(b),g=q.speed(c,f,d);c=function(){var c=ba(this,q.extend({},b),g);(e||K.get(this,"finish"))&&c.stop(!0)};return c.finish=c,e||!1===g.queue?this.each(c):this.queue(g.queue,c)},stop:function(b,c,f){var d=function(b){var c=b.stop;delete b.stop;c(f)};return"string"!=
typeof b&&(f=c,c=b,b=void 0),c&&this.queue(b||"fx",[]),this.each(function(){var c=!0,e=null!=b&&b+"queueHooks",g=q.timers,n=K.get(this);if(e)n[e]&&n[e].stop&&d(n[e]);else for(e in n)n[e]&&n[e].stop&&jd.test(e)&&d(n[e]);for(e=g.length;e--;)g[e].elem!==this||null!=b&&g[e].queue!==b||(g[e].anim.stop(f),c=!1,g.splice(e,1));!c&&f||q.dequeue(this,b)})},finish:function(b){return!1!==b&&(b=b||"fx"),this.each(function(){var c,f=K.get(this),d=f[b+"queue"];c=f[b+"queueHooks"];var e=q.timers,g=d?d.length:0;f.finish=
!0;q.queue(this,b,[]);c&&c.stop&&c.stop.call(this,!0);for(c=e.length;c--;)e[c].elem===this&&e[c].queue===b&&(e[c].anim.stop(!0),e.splice(c,1));for(c=0;c<g;c++)d[c]&&d[c].finish&&d[c].finish.call(this);delete f.finish})}});q.each(["toggle","show","hide"],function(b,c){var f=q.fn[c];q.fn[c]=function(b,d,e){return null==b||"boolean"==typeof b?f.apply(this,arguments):this.animate(wa(c,!0),b,d,e)}});q.each({slideDown:wa("show"),slideUp:wa("hide"),slideToggle:wa("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},
fadeToggle:{opacity:"toggle"}},function(b,c){q.fn[b]=function(b,f,d){return this.animate(c,b,f,d)}});q.timers=[];q.fx.tick=function(){var b,c=0,f=q.timers;for(ab=Date.now();c<f.length;c++)(b=f[c])()||f[c]!==b||f.splice(c--,1);f.length||q.fx.stop();ab=void 0};q.fx.timer=function(b){q.timers.push(b);q.fx.start()};q.fx.interval=13;q.fx.start=function(){tb||(tb=!0,ha())};q.fx.stop=function(){tb=null};q.fx.speeds={slow:600,fast:200,_default:400};q.fn.delay=function(c,f){return c=q.fx&&q.fx.speeds[c]||
c,f=f||"fx",this.queue(f,function(f,d){var e=b.setTimeout(f,c);d.stop=function(){b.clearTimeout(e)}})};fb=R.createElement("input");wc=R.createElement("select").appendChild(R.createElement("option"));fb.type="checkbox";O.checkOn=""!==fb.value;O.optSelected=wc.selected;(fb=R.createElement("input")).value="t";fb.type="radio";O.radioValue="t"===fb.value;var xc,mb=q.expr.attrHandle;q.fn.extend({attr:function(b,c){return Oa(this,q.attr,b,c,1<arguments.length)},removeAttr:function(b){return this.each(function(){q.removeAttr(this,
b)})}});q.extend({attr:function(b,c,f){var d,e,g=b.nodeType;if(3!==g&&8!==g&&2!==g)return"undefined"==typeof b.getAttribute?q.prop(b,c,f):(1===g&&q.isXMLDoc(b)||(e=q.attrHooks[c.toLowerCase()]||(q.expr.match.bool.test(c)?xc:void 0)),void 0!==f?null===f?void q.removeAttr(b,c):e&&"set"in e&&void 0!==(d=e.set(b,f,c))?d:(b.setAttribute(c,f+""),f):e&&"get"in e&&null!==(d=e.get(b,c))?d:null==(d=q.find.attr(b,c))?void 0:d)},attrHooks:{type:{set:function(b,c){if(!O.radioValue&&"radio"===c&&g(b,"input")){var f=
b.value;return b.setAttribute("type",c),f&&(b.value=f),c}}}},removeAttr:function(b,c){var f,d=0,e=c&&c.match(Fa);if(e&&1===b.nodeType)for(;f=e[d++];)b.removeAttribute(f)}});xc={set:function(b,c,f){return!1===c?q.removeAttr(b,f):b.setAttribute(f,f),f}};q.each(q.expr.match.bool.source.match(/\w+/g),function(b,c){var f=mb[c]||q.find.attr;mb[c]=function(b,c,d){var e,g,n=c.toLowerCase();return d||(g=mb[n],mb[n]=e,e=null!=f(b,c,d)?n:null,mb[n]=g),e}});var kd=/^(?:input|select|textarea|button)$/i,ld=/^(?:a|area)$/i;
q.fn.extend({prop:function(b,c){return Oa(this,q.prop,b,c,1<arguments.length)},removeProp:function(b){return this.each(function(){delete this[q.propFix[b]||b]})}});q.extend({prop:function(b,c,f){var d,e,g=b.nodeType;if(3!==g&&8!==g&&2!==g)return 1===g&&q.isXMLDoc(b)||(c=q.propFix[c]||c,e=q.propHooks[c]),void 0!==f?e&&"set"in e&&void 0!==(d=e.set(b,f,c))?d:b[c]=f:e&&"get"in e&&null!==(d=e.get(b,c))?d:b[c]},propHooks:{tabIndex:{get:function(b){var c=q.find.attr(b,"tabindex");return c?parseInt(c,10):
kd.test(b.nodeName)||ld.test(b.nodeName)&&b.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}});O.optSelected||(q.propHooks.selected={get:function(b){b=b.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null},set:function(b){b=b.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex)}});q.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),function(){q.propFix[this.toLowerCase()]=this});q.fn.extend({addClass:function(b){var c,
f,d,e,g,n;return P(b)?this.each(function(c){q(this).addClass(b.call(this,c,ia(this)))}):(c=oa(b)).length?this.each(function(){if(d=ia(this),f=1===this.nodeType&&" "+A(d)+" "){for(g=0;g<c.length;g++)e=c[g],0>f.indexOf(" "+e+" ")&&(f+=e+" ");n=A(f);d!==n&&this.setAttribute("class",n)}}):this},removeClass:function(b){var c,f,d,e,g,n;return P(b)?this.each(function(c){q(this).removeClass(b.call(this,c,ia(this)))}):arguments.length?(c=oa(b)).length?this.each(function(){if(d=ia(this),f=1===this.nodeType&&
" "+A(d)+" "){for(g=0;g<c.length;g++)for(e=c[g];-1<f.indexOf(" "+e+" ");)f=f.replace(" "+e+" "," ");n=A(f);d!==n&&this.setAttribute("class",n)}}):this:this.attr("class","")},toggleClass:function(b,c){var f,d,e,g,n=typeof b,m="string"===n||Array.isArray(b);return P(b)?this.each(function(f){q(this).toggleClass(b.call(this,f,ia(this),c),c)}):"boolean"==typeof c&&m?c?this.addClass(b):this.removeClass(b):(f=oa(b),this.each(function(){if(m){g=q(this);for(e=0;e<f.length;e++)d=f[e],g.hasClass(d)?g.removeClass(d):
g.addClass(d)}else void 0!==b&&"boolean"!==n||((d=ia(this))&&K.set(this,"__className__",d),this.setAttribute&&this.setAttribute("class",d||!1===b?"":K.get(this,"__className__")||""))}))},hasClass:function(b){var c,f=0;for(b=" "+b+" ";c=this[f++];)if(1===c.nodeType&&-1<(" "+A(ia(c))+" ").indexOf(b))return!0;return!1}});var md=/\r/g;q.fn.extend({val:function(b){var c,f,d,e=this[0];return arguments.length?(d=P(b),this.each(function(f){var e;1===this.nodeType&&(null==(e=d?b.call(this,f,q(this).val()):
b)?e="":"number"==typeof e?e+="":Array.isArray(e)&&(e=q.map(e,function(b){return null==b?"":b+""})),(c=q.valHooks[this.type]||q.valHooks[this.nodeName.toLowerCase()])&&"set"in c&&void 0!==c.set(this,e,"value")||(this.value=e))})):e?(c=q.valHooks[e.type]||q.valHooks[e.nodeName.toLowerCase()])&&"get"in c&&void 0!==(f=c.get(e,"value"))?f:"string"==typeof(f=e.value)?f.replace(md,""):null==f?"":f:void 0}});q.extend({valHooks:{option:{get:function(b){var c=q.find.attr(b,"value");return null!=c?c:A(q.text(b))}},
select:{get:function(b){var c,f,d=b.options,e=b.selectedIndex,n="select-one"===b.type,m=n?null:[],j=n?e+1:d.length;for(f=0>e?j:n?e:0;f<j;f++)if(((c=d[f]).selected||f===e)&&!c.disabled&&(!c.parentNode.disabled||!g(c.parentNode,"optgroup"))){if(b=q(c).val(),n)return b;m.push(b)}return m},set:function(b,c){for(var f,d,e=b.options,g=q.makeArray(c),n=e.length;n--;)((d=e[n]).selected=-1<q.inArray(q.valHooks.option.get(d),g))&&(f=!0);return f||(b.selectedIndex=-1),g}}}});q.each(["radio","checkbox"],function(){q.valHooks[this]=
{set:function(b,c){if(Array.isArray(c))return b.checked=-1<q.inArray(q(b).val(),c)}};O.checkOn||(q.valHooks[this].get=function(b){return null===b.getAttribute("value")?"on":b.value})});var nb=b.location,yc=Date.now(),Ub=/\?/;q.parseXML=function(c){var f,d;if(!c||"string"!=typeof c)return null;try{f=(new b.DOMParser).parseFromString(c,"text/xml")}catch(e){}return d=f&&f.getElementsByTagName("parsererror")[0],f&&!d||q.error("Invalid XML: "+(d?q.map(d.childNodes,function(b){return b.textContent}).join("\n"):
c)),f};var zc=/^(?:focusinfocus|focusoutblur)$/,Ac=function(b){b.stopPropagation()};q.extend(q.event,{trigger:function(c,f,d,e){var g,n,m,j,l,r,s,p,t=[d||R],A=Wa.call(c,"type")?c.type:c;g=Wa.call(c,"namespace")?c.namespace.split("."):[];if(n=p=m=d=d||R,3!==d.nodeType&&8!==d.nodeType&&!zc.test(A+q.event.triggered)&&(-1<A.indexOf(".")&&(A=(g=A.split(".")).shift(),g.sort()),l=0>A.indexOf(":")&&"on"+A,(c=c[q.expando]?c:new q.Event(A,"object"==typeof c&&c)).isTrigger=e?2:3,c.namespace=g.join("."),c.rnamespace=
c.namespace?RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,c.result=void 0,c.target||(c.target=d),f=null==f?[c]:q.makeArray(f,[c]),s=q.event.special[A]||{},e||!s.trigger||!1!==s.trigger.apply(d,f))){if(!e&&!s.noBubble&&!Ea(d)){j=s.delegateType||A;for(zc.test(j+A)||(n=n.parentNode);n;n=n.parentNode)t.push(n),m=n;m===(d.ownerDocument||R)&&t.push(m.defaultView||m.parentWindow||b)}for(g=0;(n=t[g++])&&!c.isPropagationStopped();)p=n,c.type=1<g?j:s.bindType||A,(r=(K.get(n,"events")||Object.create(null))[c.type]&&
K.get(n,"handle"))&&r.apply(n,f),(r=l&&n[l])&&r.apply&&jb(n)&&(c.result=r.apply(n,f),!1===c.result&&c.preventDefault());return c.type=A,e||c.isDefaultPrevented()||s._default&&!1!==s._default.apply(t.pop(),f)||!jb(d)||l&&P(d[A])&&!Ea(d)&&((m=d[l])&&(d[l]=null),q.event.triggered=A,c.isPropagationStopped()&&p.addEventListener(A,Ac),d[A](),c.isPropagationStopped()&&p.removeEventListener(A,Ac),q.event.triggered=void 0,m&&(d[l]=m)),c.result}},simulate:function(b,c,f){b=q.extend(new q.Event,f,{type:b,isSimulated:!0});
q.event.trigger(b,null,c)}});q.fn.extend({trigger:function(b,c){return this.each(function(){q.event.trigger(b,c,this)})},triggerHandler:function(b,c){var f=this[0];if(f)return q.event.trigger(b,c,f,!0)}});var Pc=/\[\]$/,Bc=/\r?\n/g,nd=/^(?:submit|button|image|reset|file)$/i,od=/^(?:input|select|textarea|keygen)/i;q.param=function(b,c){var f,d=[],e=function(b,c){var f=P(c)?c():c;d[d.length]=encodeURIComponent(b)+"="+encodeURIComponent(null==f?"":f)};if(null==b)return"";if(Array.isArray(b)||b.jquery&&
!q.isPlainObject(b))q.each(b,function(){e(this.name,this.value)});else for(f in b)da(f,b[f],c,e);return d.join("&")};q.fn.extend({serialize:function(){return q.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var b=q.prop(this,"elements");return b?q.makeArray(b):this}).filter(function(){var b=this.type;return this.name&&!q(this).is(":disabled")&&od.test(this.nodeName)&&!nd.test(b)&&(this.checked||!kb.test(b))}).map(function(b,c){var f=q(this).val();return null==f?
null:Array.isArray(f)?q.map(f,function(b){return{name:c.name,value:b.replace(Bc,"\r\n")}}):{name:c.name,value:f.replace(Bc,"\r\n")}}).get()}});var pd=/%20/g,qd=/#.*$/,rd=/([?&])_=[^&]*/,sd=/^(.*?):[ \t]*([^\r\n]*)$/gm,td=/^(?:GET|HEAD)$/,ud=/^\/\//,Cc={},Jb={},Dc="*/".concat("*"),Vb=R.createElement("a");Vb.href=nb.href;q.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:nb.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(nb.protocol),global:!0,processData:!0,
async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Dc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":q.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(b,c){return c?Ga(Ga(b,q.ajaxSettings),
c):Ga(q.ajaxSettings,b)},ajaxPrefilter:Qa(Cc),ajaxTransport:Qa(Jb),ajax:function(c,f){function d(c,f,m,l){var p,t,J,oa,ga=f;if(!r){r=!0;j&&b.clearTimeout(j);e=void 0;n=l||"";x.readyState=0<c?4:0;l=200<=c&&300>c||304===c;if(m){J=A;for(var V=x,y,N,M,L,C=J.contents,F=J.dataTypes;"*"===F[0];)F.shift(),void 0===y&&(y=J.mimeType||V.getResponseHeader("Content-Type"));if(y)for(N in C)if(C[N]&&C[N].test(y)){F.unshift(N);break}if(F[0]in m)M=F[0];else{for(N in m){if(!F[0]||J.converters[N+" "+F[0]]){M=N;break}L||
(L=N)}M=M||L}m=M?(M!==F[0]&&F.unshift(M),m[M]):void 0;J=m}!l&&-1<q.inArray("script",A.dataTypes)&&0>q.inArray("json",A.dataTypes)&&(A.converters["text script"]=function(){});var U;a:{m=A;y=J;N=x;M=l;var G,Ja,xa;J={};V=m.dataTypes.slice();if(V[1])for(G in m.converters)J[G.toLowerCase()]=m.converters[G];for(L=V.shift();L;)if(m.responseFields[L]&&(N[m.responseFields[L]]=y),!xa&&M&&m.dataFilter&&(y=m.dataFilter(y,m.dataType)),xa=L,L=V.shift())if("*"===L)L=xa;else if("*"!==xa&&xa!==L){if(!(G=J[xa+" "+
L]||J["* "+L]))for(U in J)if((Ja=U.split(" "))[1]===L&&(G=J[xa+" "+Ja[0]]||J["* "+Ja[0]])){!0===G?G=J[U]:!0!==J[U]&&(L=Ja[0],V.unshift(Ja[1]));break}if(!0!==G)if(G&&m["throws"])y=G(y);else try{y=G(y)}catch(D){U={state:"parsererror",error:G?D:"No conversion from "+xa+" to "+L};break a}}U={state:"success",data:y}}J=U;l?(A.ifModified&&((oa=x.getResponseHeader("Last-Modified"))&&(q.lastModified[g]=oa),(oa=x.getResponseHeader("etag"))&&(q.etag[g]=oa)),204===c||"HEAD"===A.type?ga="nocontent":304===c?ga=
"notmodified":(ga=J.state,p=J.data,l=!(t=J.error))):(t=ga,!c&&ga||(ga="error",0>c&&(c=0)));x.status=c;x.statusText=(f||ga)+"";l?ia.resolveWith(u,[p,ga,x]):ia.rejectWith(u,[x,ga,t]);x.statusCode(T);T=void 0;s&&v.trigger(l?"ajaxSuccess":"ajaxError",[x,A,l?p:t]);z.fireWith(u,[x,ga]);s&&(v.trigger("ajaxComplete",[x,A]),--q.active||q.event.trigger("ajaxStop"))}}"object"==typeof c&&(f=c,c=void 0);f=f||{};var e,g,n,m,j,l,r,s,p,t,A=q.ajaxSetup({},f),u=A.context||A,v=A.context&&(u.nodeType||u.jquery)?q(u):
q.event,ia=q.Deferred(),z=q.Callbacks("once memory"),T=A.statusCode||{},J={},oa={},ga="canceled",x={readyState:0,getResponseHeader:function(b){var c;if(r){if(!m)for(m={};c=sd.exec(n);)m[c[1].toLowerCase()+" "]=(m[c[1].toLowerCase()+" "]||[]).concat(c[2]);c=m[b.toLowerCase()+" "]}return null==c?null:c.join(", ")},getAllResponseHeaders:function(){return r?n:null},setRequestHeader:function(b,c){return null==r&&(b=oa[b.toLowerCase()]=oa[b.toLowerCase()]||b,J[b]=c),this},overrideMimeType:function(b){return null==
r&&(A.mimeType=b),this},statusCode:function(b){var c;if(b)if(r)x.always(b[x.status]);else for(c in b)T[c]=[T[c],b[c]];return this},abort:function(b){b=b||ga;return e&&e.abort(b),d(0,b),this}};if(ia.promise(x),A.url=((c||A.url||nb.href)+"").replace(ud,nb.protocol+"//"),A.type=f.method||f.type||A.method||A.type,A.dataTypes=(A.dataType||"*").toLowerCase().match(Fa)||[""],null==A.crossDomain){l=R.createElement("a");try{l.href=A.url,l.href=l.href,A.crossDomain=Vb.protocol+"//"+Vb.host!=l.protocol+"//"+
l.host}catch(y){A.crossDomain=!0}}if(A.data&&A.processData&&"string"!=typeof A.data&&(A.data=q.param(A.data,A.traditional)),Aa(Cc,A,f,x),r)return x;for(p in(s=q.event&&A.global)&&0==q.active++&&q.event.trigger("ajaxStart"),A.type=A.type.toUpperCase(),A.hasContent=!td.test(A.type),g=A.url.replace(qd,""),A.hasContent?A.data&&A.processData&&0===(A.contentType||"").indexOf("application/x-www-form-urlencoded")&&(A.data=A.data.replace(pd,"+")):(t=A.url.slice(g.length),A.data&&(A.processData||"string"==
typeof A.data)&&(g+=(Ub.test(g)?"&":"?")+A.data,delete A.data),!1===A.cache&&(g=g.replace(rd,"$1"),t=(Ub.test(g)?"&":"?")+"_="+yc++ +t),A.url=g+t),A.ifModified&&(q.lastModified[g]&&x.setRequestHeader("If-Modified-Since",q.lastModified[g]),q.etag[g]&&x.setRequestHeader("If-None-Match",q.etag[g])),(A.data&&A.hasContent&&!1!==A.contentType||f.contentType)&&x.setRequestHeader("Content-Type",A.contentType),x.setRequestHeader("Accept",A.dataTypes[0]&&A.accepts[A.dataTypes[0]]?A.accepts[A.dataTypes[0]]+
("*"!==A.dataTypes[0]?", "+Dc+"; q=0.01":""):A.accepts["*"]),A.headers)x.setRequestHeader(p,A.headers[p]);if(A.beforeSend&&(!1===A.beforeSend.call(u,x,A)||r))return x.abort();if(ga="abort",z.add(A.complete),x.done(A.success),x.fail(A.error),e=Aa(Jb,A,f,x)){if(x.readyState=1,s&&v.trigger("ajaxSend",[x,A]),r)return x;A.async&&0<A.timeout&&(j=b.setTimeout(function(){x.abort("timeout")},A.timeout));try{r=!1,e.send(J,d)}catch(N){if(r)throw N;d(-1,N)}}else d(-1,"No Transport");return x},getJSON:function(b,
c,f){return q.get(b,c,f,"json")},getScript:function(b,c){return q.get(b,void 0,c,"script")}});q.each(["get","post"],function(b,c){q[c]=function(b,f,d,e){return P(f)&&(e=e||d,d=f,f=void 0),q.ajax(q.extend({url:b,type:c,dataType:e,data:f,success:d},q.isPlainObject(b)&&b))}});q.ajaxPrefilter(function(b){for(var c in b.headers)"content-type"===c.toLowerCase()&&(b.contentType=b.headers[c]||"")});q._evalUrl=function(b,c,f){return q.ajax({url:b,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},
dataFilter:function(b){q.globalEval(b,c,f)}})};q.fn.extend({wrapAll:function(b){var c;return this[0]&&(P(b)&&(b=b.call(this[0])),c=q(b,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&c.insertBefore(this[0]),c.map(function(){for(var b=this;b.firstElementChild;)b=b.firstElementChild;return b}).append(this)),this},wrapInner:function(b){return P(b)?this.each(function(c){q(this).wrapInner(b.call(this,c))}):this.each(function(){var c=q(this),f=c.contents();f.length?f.wrapAll(b):c.append(b)})},
wrap:function(b){var c=P(b);return this.each(function(f){q(this).wrapAll(c?b.call(this,f):b)})},unwrap:function(b){return this.parent(b).not("body").each(function(){q(this).replaceWith(this.childNodes)}),this}});q.expr.pseudos.hidden=function(b){return!q.expr.pseudos.visible(b)};q.expr.pseudos.visible=function(b){return!(!b.offsetWidth&&!b.offsetHeight&&!b.getClientRects().length)};q.ajaxSettings.xhr=function(){try{return new b.XMLHttpRequest}catch(c){}};var vd={"0":200,1223:204},ob=q.ajaxSettings.xhr();
O.cors=!!ob&&"withCredentials"in ob;O.ajax=ob=!!ob;q.ajaxTransport(function(c){var f,d;if(O.cors||ob&&!c.crossDomain)return{send:function(e,g){var n,m=c.xhr();if(m.open(c.type,c.url,c.async,c.username,c.password),c.xhrFields)for(n in c.xhrFields)m[n]=c.xhrFields[n];for(n in c.mimeType&&m.overrideMimeType&&m.overrideMimeType(c.mimeType),c.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)m.setRequestHeader(n,e[n]);f=function(b){return function(){f&&(f=d=m.onload=m.onerror=
m.onabort=m.ontimeout=m.onreadystatechange=null,"abort"===b?m.abort():"error"===b?"number"!=typeof m.status?g(0,"error"):g(m.status,m.statusText):g(vd[m.status]||m.status,m.statusText,"text"!==(m.responseType||"text")||"string"!=typeof m.responseText?{binary:m.response}:{text:m.responseText},m.getAllResponseHeaders()))}};m.onload=f();d=m.onerror=m.ontimeout=f("error");void 0!==m.onabort?m.onabort=d:m.onreadystatechange=function(){4===m.readyState&&b.setTimeout(function(){f&&d()})};f=f("abort");try{m.send(c.hasContent&&
c.data||null)}catch(j){if(f)throw j;}},abort:function(){f&&f()}}});q.ajaxPrefilter(function(b){b.crossDomain&&(b.contents.script=!1)});q.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(b){return q.globalEval(b),b}}});q.ajaxPrefilter("script",function(b){void 0===b.cache&&(b.cache=!1);b.crossDomain&&(b.type="GET")});q.ajaxTransport("script",function(b){var c,
f;if(b.crossDomain||b.scriptAttrs)return{send:function(d,e){c=q("<script>").attr(b.scriptAttrs||{}).prop({charset:b.scriptCharset,src:b.url}).on("load error",f=function(b){c.remove();f=null;b&&e("error"===b.type?404:200,b.type)});R.head.appendChild(c[0])},abort:function(){f&&f()}}});var Ec,Fc=[],Wb=/(=)\?(?=&|$)|\?\?/;q.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var b=Fc.pop()||q.expando+"_"+yc++;return this[b]=!0,b}});q.ajaxPrefilter("json jsonp",function(c,f,d){var e,g,n,m=!1!==c.jsonp&&
(Wb.test(c.url)?"url":"string"==typeof c.data&&0===(c.contentType||"").indexOf("application/x-www-form-urlencoded")&&Wb.test(c.data)&&"data");if(m||"jsonp"===c.dataTypes[0])return e=c.jsonpCallback=P(c.jsonpCallback)?c.jsonpCallback():c.jsonpCallback,m?c[m]=c[m].replace(Wb,"$1"+e):!1!==c.jsonp&&(c.url+=(Ub.test(c.url)?"&":"?")+c.jsonp+"="+e),c.converters["script json"]=function(){return n||q.error(e+" was not called"),n[0]},c.dataTypes[0]="json",g=b[e],b[e]=function(){n=arguments},d.always(function(){void 0===
g?q(b).removeProp(e):b[e]=g;c[e]&&(c.jsonpCallback=f.jsonpCallback,Fc.push(e));n&&P(g)&&g(n[0]);n=g=void 0}),"script"});O.createHTMLDocument=((Ec=R.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Ec.childNodes.length);q.parseHTML=function(b,c,f){return"string"!=typeof b?[]:("boolean"==typeof c&&(f=c,c=!1),c||(O.createHTMLDocument?((d=(c=R.implementation.createHTMLDocument("")).createElement("base")).href=R.location.href,c.head.appendChild(d)):c=R),g=!f&&[],(e=
lc.exec(b))?[c.createElement(e[1])]:(e=I([b],c,g),g&&g.length&&q(g).remove(),q.merge([],e.childNodes)));var d,e,g};q.fn.load=function(b,c,f){var d,e,g,n=this,m=b.indexOf(" ");return-1<m&&(d=A(b.slice(m)),b=b.slice(0,m)),P(c)?(f=c,c=void 0):c&&"object"==typeof c&&(e="POST"),0<n.length&&q.ajax({url:b,type:e||"GET",dataType:"html",data:c}).done(function(b){g=arguments;n.html(d?q("<div>").append(q.parseHTML(b)).find(d):b)}).always(f&&function(b,c){n.each(function(){f.apply(this,g||[b.responseText,c,b])})}),
this};q.expr.pseudos.animated=function(b){return q.grep(q.timers,function(c){return b===c.elem}).length};q.offset={setOffset:function(b,c,f){var d,e,g,n,m,j,l=q.css(b,"position"),r=q(b),s={};"static"===l&&(b.style.position="relative");m=r.offset();g=q.css(b,"top");j=q.css(b,"left");("absolute"===l||"fixed"===l)&&-1<(g+j).indexOf("auto")?(n=(d=r.position()).top,e=d.left):(n=parseFloat(g)||0,e=parseFloat(j)||0);P(c)&&(c=c.call(b,f,q.extend({},m)));null!=c.top&&(s.top=c.top-m.top+n);null!=c.left&&(s.left=
c.left-m.left+e);"using"in c?c.using.call(b,s):r.css(s)}};q.fn.extend({offset:function(b){if(arguments.length)return void 0===b?this:this.each(function(c){q.offset.setOffset(this,b,c)});var c,f,d=this[0];return d?d.getClientRects().length?(c=d.getBoundingClientRect(),f=d.ownerDocument.defaultView,{top:c.top+f.pageYOffset,left:c.left+f.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var b,c,f,d=this[0],e={top:0,left:0};if("fixed"===q.css(d,"position"))c=d.getBoundingClientRect();
else{c=this.offset();f=d.ownerDocument;for(b=d.offsetParent||f.documentElement;b&&(b===f.body||b===f.documentElement)&&"static"===q.css(b,"position");)b=b.parentNode;b&&b!==d&&1===b.nodeType&&((e=q(b).offset()).top+=q.css(b,"borderTopWidth",!0),e.left+=q.css(b,"borderLeftWidth",!0))}return{top:c.top-e.top-q.css(d,"marginTop",!0),left:c.left-e.left-q.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var b=this.offsetParent;b&&"static"===q.css(b,"position");)b=b.offsetParent;
return b||Xa})}});q.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var f="pageYOffset"===c;q.fn[b]=function(d){return Oa(this,function(b,d,e){var g;if(Ea(b)?g=b:9===b.nodeType&&(g=b.defaultView),void 0===e)return g?g[c]:b[d];g?g.scrollTo(f?g.pageXOffset:e,f?e:g.pageYOffset):b[d]=e},b,d,arguments.length)}});q.each(["top","left"],function(b,c){q.cssHooks[c]=ka(O.pixelPosition,function(b,f){if(f)return f=F(b,c),Ib.test(f)?q(b).position()[c]+"px":f})});q.each({Height:"height",Width:"width"},
function(b,c){q.each({padding:"inner"+b,content:c,"":"outer"+b},function(f,d){q.fn[d]=function(e,g){var n=arguments.length&&(f||"boolean"!=typeof e),m=f||(!0===e||!0===g?"margin":"border");return Oa(this,function(c,f,e){var g;return Ea(c)?0===d.indexOf("outer")?c["inner"+b]:c.document.documentElement["client"+b]:9===c.nodeType?(g=c.documentElement,Math.max(c.body["scroll"+b],g["scroll"+b],c.body["offset"+b],g["offset"+b],g["client"+b])):void 0===e?q.css(c,f,m):q.style(c,f,e,m)},c,n?e:void 0,n)}})});
q.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(b,c){q.fn[c]=function(b){return this.on(c,b)}});q.fn.extend({bind:function(b,c,f){return this.on(b,null,c,f)},unbind:function(b,c){return this.off(b,null,c)},delegate:function(b,c,f,d){return this.on(c,b,f,d)},undelegate:function(b,c,f){return 1===arguments.length?this.off(b,"**"):this.off(c,b||"**",f)},hover:function(b,c){return this.mouseenter(b).mouseleave(c||b)}});q.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),
function(b,c){q.fn[c]=function(b,f){return 0<arguments.length?this.on(c,null,b,f):this.trigger(c)}});var wd=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;q.proxy=function(b,c){var f,d,e;if("string"==typeof c&&(f=b[c],c=b,b=f),P(b))return d=pa.call(arguments,2),(e=function(){return b.apply(c||this,d.concat(pa.call(arguments)))}).guid=b.guid=b.guid||q.guid++,e};q.holdReady=function(b){b?q.readyWait++:q.ready(!0)};q.isArray=Array.isArray;q.parseJSON=JSON.parse;q.nodeName=g;q.isFunction=P;q.isWindow=
Ea;q.camelCase=u;q.type=d;q.now=Date.now;q.isNumeric=function(b){var c=q.type(b);return("number"===c||"string"===c)&&!isNaN(b-parseFloat(b))};q.trim=function(b){return null==b?"":(b+"").replace(wd,"$1")};"function"==typeof define&&define.amd&&define("jquery",[],function(){return q});var xd=b.jQuery,yd=b.$;return q.noConflict=function(c){return b.$===q&&(b.$=yd),c&&b.jQuery===q&&(b.jQuery=xd),q},"undefined"==typeof c&&(b.jQuery=b.$=q),q});!function(b,c){"object"==typeof exports&&"undefined"!=typeof module?module.exports=c():"function"==typeof define&&define.amd?define(c):b.PointerEventsPolyfill=c()}(this,function(){function b(b,c){c=c||Object.create(null);var d=document.createEvent("Event");d.initEvent(b,c.bubbles||!1,c.cancelable||!1);for(var e,g=2;g<f.length;g++)e=f[g],d[e]=c[e]||m[g];d.buttons=c.buttons||0;e=0;return e=c.pressure&&d.buttons?c.pressure:d.buttons?0.5:0,d.x=d.clientX,d.y=d.clientY,d.pointerId=c.pointerId||0,d.width=
c.width||0,d.height=c.height||0,d.pressure=e,d.tiltX=c.tiltX||0,d.tiltY=c.tiltY||0,d.twist=c.twist||0,d.tangentialPressure=c.tangentialPressure||0,d.pointerType=c.pointerType||"",d.hwTimestamp=c.hwTimestamp||0,d.isPrimary=c.isPrimary||!1,d}function c(){this.array=[];this.size=0}function e(b,c,f,d){this.addCallback=b.bind(d);this.removeCallback=c.bind(d);this.changedCallback=f.bind(d);I&&(this.observer=new I(this.mutationWatcher.bind(this)))}function d(b){return"body /shadow-deep/ "+j(b)}function j(b){return'[touch-action="'+
b+'"]'}function g(b){return"{ -ms-touch-action: "+b+"; touch-action: "+b+"; }"}function p(b){if(!v.pointermap.has(b))throw b=Error("InvalidPointerId"),b.name="InvalidPointerId",b;}function l(b){for(var c=b.parentNode;c&&c!==b.ownerDocument;)c=c.parentNode;if(!c)throw b=Error("InvalidStateError"),b.name="InvalidStateError",b;}var f="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget pageX pageY".split(" "),m=[!1,!1,null,null,0,0,0,0,
!1,!1,!1,!1,0,null,0,0],n=window.Map&&window.Map.prototype.forEach?Map:c;c.prototype={set:function(b,c){return void 0===c?this["delete"](b):(this.has(b)||this.size++,void(this.array[b]=c))},has:function(b){return void 0!==this.array[b]},"delete":function(b){this.has(b)&&(delete this.array[b],this.size--)},get:function(b){return this.array[b]},clear:function(){this.size=this.array.length=0},forEach:function(b,c){return this.array.forEach(function(f,d){b.call(c,f,d,this)},this)}};var r="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget buttons pointerId width height pressure tiltX tiltY pointerType hwTimestamp isPrimary type target currentTarget which pageX pageY timeStamp".split(" "),
s=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],t={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},u="undefined"!=typeof SVGElementInstance,v={pointermap:new n,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(b,c){var f=c.events;f&&(f.forEach(function(b){c[b]&&(this.eventMap[b]=c[b].bind(c))},this),this.eventSources[b]=c,this.eventSourceList.push(c))},register:function(b){for(var c,
f=this.eventSourceList.length,d=0;d<f&&(c=this.eventSourceList[d]);d++)c.register.call(c,b)},unregister:function(b){for(var c,f=this.eventSourceList.length,d=0;d<f&&(c=this.eventSourceList[d]);d++)c.unregister.call(c,b)},contains:function(b,c){try{return b.contains(c)}catch(f){return!1}},down:function(b){b.bubbles=!0;this.fireEvent("pointerdown",b)},move:function(b){b.bubbles=!0;this.fireEvent("pointermove",b)},up:function(b){b.bubbles=!0;this.fireEvent("pointerup",b)},enter:function(b){b.bubbles=
!1;this.fireEvent("pointerenter",b)},leave:function(b){b.bubbles=!1;this.fireEvent("pointerleave",b)},over:function(b){b.bubbles=!0;this.fireEvent("pointerover",b)},out:function(b){b.bubbles=!0;this.fireEvent("pointerout",b)},cancel:function(b){b.bubbles=!0;this.fireEvent("pointercancel",b)},leaveOut:function(b){this.out(b);this.propagate(b,this.leave,!1)},enterOver:function(b){this.over(b);this.propagate(b,this.enter,!0)},eventHandler:function(b){if(!b._handledByPE){var c=b.type;(c=this.eventMap&&
this.eventMap[c])&&c(b);b._handledByPE=!0}},listen:function(b,c){c.forEach(function(c){this.addEvent(b,c)},this)},unlisten:function(b,c){c.forEach(function(c){this.removeEvent(b,c)},this)},addEvent:function(b,c){b.addEventListener(c,this.boundHandler)},removeEvent:function(b,c){b.removeEventListener(c,this.boundHandler)},makeEvent:function(c,f){this.captureInfo[f.pointerId]&&(f.relatedTarget=null);var d=new b(c,f);return f.preventDefault&&(d.preventDefault=f.preventDefault),d._target=d._target||f.target,
d},fireEvent:function(b,c){var f=this.makeEvent(b,c);return this.dispatchEvent(f)},cloneEvent:function(b){for(var c,f=Object.create(null),d=0;d<r.length;d++)c=r[d],f[c]=b[c]||s[d],!u||"target"!==c&&"relatedTarget"!==c||f[c]instanceof SVGElementInstance&&(f[c]=f[c].correspondingUseElement);return b.preventDefault&&(f.preventDefault=function(){b.preventDefault()}),f},getTarget:function(b){var c=this.captureInfo[b.pointerId];return c?b._target!==c&&b.type in t?void 0:c:b._target},propagate:function(b,
c,f){for(var d=b.target,e=[];d!==document&&!d.contains(b.relatedTarget);)if(e.push(d),d=d.parentNode,!d)return;f&&e.reverse();e.forEach(function(f){b.target=f;c.call(this,b)},this)},setCapture:function(c,f,d){this.captureInfo[c]&&this.releaseCapture(c,d);this.captureInfo[c]=f;this.implicitRelease=this.releaseCapture.bind(this,c,d);document.addEventListener("pointerup",this.implicitRelease);document.addEventListener("pointercancel",this.implicitRelease);var e=new b("gotpointercapture");e.pointerId=
c;e._target=f;d||this.asyncDispatchEvent(e)},releaseCapture:function(c,f){var d=this.captureInfo[c];if(d){this.captureInfo[c]=void 0;document.removeEventListener("pointerup",this.implicitRelease);document.removeEventListener("pointercancel",this.implicitRelease);var e=new b("lostpointercapture");e.pointerId=c;e._target=d;f||this.asyncDispatchEvent(e)}},dispatchEvent:function(b){var c=this.getTarget(b);if(c)return c.dispatchEvent(b)},asyncDispatchEvent:function(b){requestAnimationFrame(this.dispatchEvent.bind(this,
b))}};v.boundHandler=v.eventHandler.bind(v);var z={shadow:function(b){if(b)return b.shadowRoot||b.webkitShadowRoot},canTarget:function(b){return b&&Boolean(b.elementFromPoint)},targetingShadow:function(b){b=this.shadow(b);if(this.canTarget(b))return b},olderShadow:function(b){var c=b.olderShadowRoot;c||(b=b.querySelector("shadow"))&&(c=b.olderShadowRoot);return c},allShadows:function(b){var c=[];for(b=this.shadow(b);b;)c.push(b),b=this.olderShadow(b);return c},searchRoot:function(b,c,f){if(b){var d,
e=b.elementFromPoint(c,f);for(d=this.targetingShadow(e);d;){if(b=d.elementFromPoint(c,f))return d=this.targetingShadow(b),this.searchRoot(d,c,f)||b;d=this.olderShadow(d)}return e}},owner:function(b){for(;b.parentNode;)b=b.parentNode;return b.nodeType!==Node.DOCUMENT_NODE&&b.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(b=document),b},findTarget:function(b){var c=b.clientX,f=b.clientY;b=this.owner(b.target);return b.elementFromPoint(c,f)||(b=document),this.searchRoot(b,c,f)}},x=Array.prototype.forEach.call.bind(Array.prototype.forEach),
C=Array.prototype.map.call.bind(Array.prototype.map),B=Array.prototype.slice.call.bind(Array.prototype.slice),E=Array.prototype.filter.call.bind(Array.prototype.filter),I=window.MutationObserver||window.WebKitMutationObserver,y={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};e.prototype={watchSubtree:function(b){this.observer&&z.canTarget(b)&&this.observer.observe(b,y)},enableOnSubtree:function(b){this.watchSubtree(b);b===document&&"complete"!==document.readyState?
this.installOnLoad():this.installNewSubtree(b)},installNewSubtree:function(b){x(this.findElements(b),this.addElement,this)},findElements:function(b){return b.querySelectorAll?b.querySelectorAll("[touch-action]"):[]},removeElement:function(b){this.removeCallback(b)},addElement:function(b){this.addCallback(b)},elementChanged:function(b,c){this.changedCallback(b,c)},concatLists:function(b,c){return b.concat(B(c))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===
document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(b){return b.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(b){var c=C(b,this.findElements,this);return c.push(E(b,this.isElement)),c.reduce(this.concatLists,[])},mutationWatcher:function(b){b.forEach(this.mutationHandler,this)},mutationHandler:function(b){"childList"===b.type?(this.flattenMutationTree(b.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(b.removedNodes).forEach(this.removeElement,
this)):"attributes"===b.type&&this.elementChanged(b.target,b.oldValue)}};var D=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],H="",M=window.PointerEvent||window.MSPointerEvent,S=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,Q=v.pointermap,L=[1,4,2,8,16],W=!1;try{W=1===(new MouseEvent("test",{buttons:1})).buttons}catch(aa){}var G,F={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(b){v.listen(b,
this.events)},unregister:function(b){v.unlisten(b,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(b){var c,f=this.lastTouches,d=b.clientX;b=b.clientY;for(var e=0,g=f.length;e<g&&(c=f[e]);e++){var n=Math.abs(d-c.x),m=Math.abs(b-c.y);if(25>=n&&25>=m)return!0}},prepareEvent:function(b){var c=v.cloneEvent(b),f=c.preventDefault;return c.preventDefault=function(){b.preventDefault();f()},c.pointerId=this.POINTER_ID,c.isPrimary=!0,c.pointerType=this.POINTER_TYPE,c},prepareButtonsForMove:function(b,
c){var f=Q.get(this.POINTER_ID);0!==c.which&&f?b.buttons=f.buttons:b.buttons=0;c.buttons=b.buttons},mousedown:function(b){if(!this.isEventSimulatedFromTouch(b)){var c=Q.get(this.POINTER_ID),f=this.prepareEvent(b);W||(f.buttons=L[f.button],c&&(f.buttons|=c.buttons),b.buttons=f.buttons);Q.set(this.POINTER_ID,b);c&&0!==c.buttons?v.move(f):v.down(f)}},mousemove:function(b){if(!this.isEventSimulatedFromTouch(b)){var c=this.prepareEvent(b);W||this.prepareButtonsForMove(c,b);c.button=-1;Q.set(this.POINTER_ID,
b);v.move(c)}},mouseup:function(b){if(!this.isEventSimulatedFromTouch(b)){var c=Q.get(this.POINTER_ID),f=this.prepareEvent(b);if(!W){var d=L[f.button];f.buttons=c?c.buttons&~d:0;b.buttons=f.buttons}Q.set(this.POINTER_ID,b);f.buttons&=~L[f.button];0===f.buttons?v.up(f):v.move(f)}},mouseover:function(b){if(!this.isEventSimulatedFromTouch(b)){var c=this.prepareEvent(b);W||this.prepareButtonsForMove(c,b);c.button=-1;Q.set(this.POINTER_ID,b);v.enterOver(c)}},mouseout:function(b){if(!this.isEventSimulatedFromTouch(b)){var c=
this.prepareEvent(b);W||this.prepareButtonsForMove(c,b);c.button=-1;v.leaveOut(c)}},cancel:function(b){b=this.prepareEvent(b);v.cancel(b);this.deactivateMouse()},deactivateMouse:function(){Q["delete"](this.POINTER_ID)}},ka=v.captureInfo,Z=z.findTarget.bind(z),N=z.allShadows.bind(z),T=v.pointermap,J={events:["touchstart","touchmove","touchend","touchcancel"],register:function(b){G.enableOnSubtree(b)},unregister:function(){},elementAdded:function(b){var c=b.getAttribute("touch-action"),f=this.touchActionToScrollType(c);
f&&(b._scrollType=f,v.listen(b,this.events),N(b).forEach(function(b){b._scrollType=f;v.listen(b,this.events)},this))},elementRemoved:function(b){b._scrollType=void 0;v.unlisten(b,this.events);N(b).forEach(function(b){b._scrollType=void 0;v.unlisten(b,this.events)},this)},elementChanged:function(b,c){var f=b.getAttribute("touch-action"),d=this.touchActionToScrollType(f),f=this.touchActionToScrollType(c);d&&f?(b._scrollType=d,N(b).forEach(function(b){b._scrollType=d},this)):f?this.elementRemoved(b):
d&&this.elementAdded(b)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(b){var c=this.scrollTypes;return"none"===b?"none":b===c.XSCROLLER?"X":b===c.YSCROLLER?"Y":c.SCROLLER.exec(b)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(b){return this.firstTouch===b.identifier},setPrimaryTouch:function(b){(0===T.size||1===T.size&&T.has(1))&&(this.firstTouch=b.identifier,this.firstXY=
{X:b.clientX,Y:b.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(b){b.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var b=function(){this.clickCount=0;this.resetId=null}.bind(this);this.resetId=setTimeout(b,200)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(b){return 0},touchToPointer:function(b){var c=this.currentTouchEvent,
f=v.cloneEvent(b),d=f.pointerId=b.identifier+2;f.target=ka[d]||Z(f);f.bubbles=!0;f.cancelable=!0;f.detail=this.clickCount;f.button=0;f.buttons=this.typeToButtons(c.type);f.width=2*(b.radiusX||b.webkitRadiusX||0);f.height=2*(b.radiusY||b.webkitRadiusY||0);f.pressure=b.force||b.webkitForce||0.5;f.isPrimary=this.isPrimaryTouch(b);f.pointerType=this.POINTER_TYPE;f.altKey=c.altKey;f.ctrlKey=c.ctrlKey;f.metaKey=c.metaKey;f.shiftKey=c.shiftKey;var e=this;return f.preventDefault=function(){e.scrolling=!1;
e.firstXY=null;c.preventDefault()},f},processTouches:function(b,c){var f=b.changedTouches;this.currentTouchEvent=b;for(var d,e=0;e<f.length;e++)d=f[e],c.call(this,this.touchToPointer(d))},shouldScroll:function(b){if(this.firstXY){var c;c=b.currentTarget._scrollType;if("none"===c)c=!1;else if("XY"===c)c=!0;else{b=b.changedTouches[0];var f="Y"===c?"X":"Y";c=Math.abs(b["client"+c]-this.firstXY[c]);b=Math.abs(b["client"+f]-this.firstXY[f]);c=c>=b}return this.firstXY=null,c}},findTouch:function(b,c){for(var f,
d=0,e=b.length;d<e&&(f=b[d]);d++)if(f.identifier===c)return!0},vacuumTouches:function(b){var c=b.touches;if(T.size>=c.length){var f=[];T.forEach(function(b,d){1!==d&&!this.findTouch(c,d-2)&&f.push(b.out)},this);f.forEach(this.cancelOut,this)}},touchstart:function(b){this.vacuumTouches(b);this.setPrimaryTouch(b.changedTouches[0]);this.dedupSynthMouse(b);this.scrolling||(this.clickCount++,this.processTouches(b,this.overDown))},overDown:function(b){T.set(b.pointerId,{target:b.target,out:b,outTarget:b.target});
v.enterOver(b);v.down(b)},touchmove:function(b){this.scrolling||(this.shouldScroll(b)?(this.scrolling=!0,this.touchcancel(b)):(b.preventDefault(),this.processTouches(b,this.moveOverOut)))},moveOverOut:function(b){var c=T.get(b.pointerId);if(c){var f=c.out,d=c.outTarget;v.move(b);f&&d!==b.target&&(f.relatedTarget=b.target,b.relatedTarget=d,f.target=d,b.target?(v.leaveOut(f),v.enterOver(b)):(b.target=d,b.relatedTarget=null,this.cancelOut(b)));c.out=b;c.outTarget=b.target}},touchend:function(b){this.dedupSynthMouse(b);
this.processTouches(b,this.upOut)},upOut:function(b){this.scrolling||(v.up(b),v.leaveOut(b));this.cleanUpPointer(b)},touchcancel:function(b){this.processTouches(b,this.cancelOut)},cancelOut:function(b){v.cancel(b);v.leaveOut(b);this.cleanUpPointer(b)},cleanUpPointer:function(b){T["delete"](b.pointerId);this.removePrimaryPointer(b)},dedupSynthMouse:function(b){var c=F.lastTouches;b=b.changedTouches[0];this.isPrimaryTouch(b)&&(b={x:b.clientX,y:b.clientY},c.push(b),c=function(b,c){var f=b.indexOf(c);
-1<f&&b.splice(f,1)}.bind(null,c,b),setTimeout(c,2500))}};G=new e(J.elementAdded,J.elementRemoved,J.elementChanged,J);var U,ha,va,wa=v.pointermap,ea=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,ba={events:"MSPointerDown MSPointerMove MSPointerUp MSPointerOut MSPointerOver MSPointerCancel MSGotPointerCapture MSLostPointerCapture".split(" "),register:function(b){v.listen(b,this.events)},unregister:function(b){v.unlisten(b,this.events)},POINTER_TYPES:["","unavailable",
"touch","pen","mouse"],prepareEvent:function(b){var c=b;return ea&&(c=v.cloneEvent(b),c.pointerType=this.POINTER_TYPES[b.pointerType]),c},cleanup:function(b){wa["delete"](b)},MSPointerDown:function(b){wa.set(b.pointerId,b);b=this.prepareEvent(b);v.down(b)},MSPointerMove:function(b){b=this.prepareEvent(b);v.move(b)},MSPointerUp:function(b){var c=this.prepareEvent(b);v.up(c);this.cleanup(b.pointerId)},MSPointerOut:function(b){b=this.prepareEvent(b);v.leaveOut(b)},MSPointerOver:function(b){b=this.prepareEvent(b);
v.enterOver(b)},MSPointerCancel:function(b){var c=this.prepareEvent(b);v.cancel(c);this.cleanup(b.pointerId)},MSLostPointerCapture:function(b){b=v.makeEvent("lostpointercapture",b);v.dispatchEvent(b)},MSGotPointerCapture:function(b){b=v.makeEvent("gotpointercapture",b);v.dispatchEvent(b)}};window.navigator.msPointerEnabled?(U=function(b){p(b);l(this);0!==v.pointermap.get(b).buttons&&(v.setCapture(b,this,!0),this.msSetPointerCapture(b))},ha=function(b){p(b);v.releaseCapture(b,!0);this.msReleasePointerCapture(b)}):
(U=function(b){p(b);l(this);0!==v.pointermap.get(b).buttons&&v.setCapture(b,this)},ha=function(b){p(b);v.releaseCapture(b)});va=function(b){return!!v.captureInfo[b]};M&&(D.forEach(function(b){String(b)===b?(H+=j(b)+g(b)+"\n",S&&(H+=d(b)+g(b)+"\n")):(H+=b.selectors.map(j)+g(b.rule)+"\n",S&&(H+=b.selectors.map(d)+g(b.rule)+"\n"))}),D=document.createElement("style"),D.textContent=H,document.head.appendChild(D));window.PointerEvent||((window.PointerEvent=b,window.navigator.msPointerEnabled)?(Object.defineProperty(window.navigator,
"maxTouchPoints",{value:window.navigator.msMaxTouchPoints,enumerable:!0}),v.registerSource("ms",ba)):(Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),v.registerSource("mouse",F),void 0!==window.ontouchstart&&v.registerSource("touch",J)),v.register(document));window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:U},releasePointerCapture:{value:ha},hasPointerCapture:{value:va}});return{dispatcher:v,
Installer:e,PointerEvent:b,PointerMap:n,targetFinding:z}});window.wgl={modules:{}};!function(b){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=b();else{var c;"undefined"!=typeof window?c=window:"undefined"!=typeof global?c=global:"undefined"!=typeof self&&(c=self);c.CANNON=b()}}(function(){return function c(e,d,j){function g(f,m){if(!d[f]){if(!e[f]){var n="function"==typeof require&&require;if(!m&&n)return n(f,!0);if(p)return p(f,!0);throw Error("Cannot find module '"+f+"'");}n=d[f]={exports:{}};e[f][0].call(n.exports,function(c){var d=e[f][1][c];return g(d?
d:c)},n,n.exports,c,e,d,j)}return d[f].exports}for(var p="function"==typeof require&&require,l=0;l<j.length;l++)g(j[l]);return g}({1:[function(c,e){e.exports={name:"cannon",version:"0.6.2",description:"A lightweight 3D physics engine written in JavaScript.",homepage:"https://github.com/schteppe/cannon.js",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["cannon.js","cannon","physics","engine","3d"],main:"./build/cannon.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/cannon.js.git"},
bugs:{url:"https://github.com/schteppe/cannon.js/issues"},licenses:[{type:"MIT"}],devDependencies:{jshint:"latest","uglify-js":"latest",nodeunit:"^0.9.0",grunt:"~0.4.0","grunt-contrib-jshint":"~0.1.1","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-concat":"~0.1.3","grunt-contrib-uglify":"^0.5.1","grunt-browserify":"^2.1.4","grunt-contrib-yuidoc":"^0.5.2",browserify:"*"},dependencies:{}}},{}],2:[function(c,e){e.exports={version:c("../package.json").version,AABB:c("./collision/AABB"),ArrayCollisionMatrix:c("./collision/ArrayCollisionMatrix"),
Body:c("./objects/Body"),Box:c("./shapes/Box"),Broadphase:c("./collision/Broadphase"),Constraint:c("./constraints/Constraint"),ContactEquation:c("./equations/ContactEquation"),Narrowphase:c("./world/Narrowphase"),ConeTwistConstraint:c("./constraints/ConeTwistConstraint"),ContactMaterial:c("./material/ContactMaterial"),ConvexPolyhedron:c("./shapes/ConvexPolyhedron"),Cylinder:c("./shapes/Cylinder"),DistanceConstraint:c("./constraints/DistanceConstraint"),Equation:c("./equations/Equation"),EventTarget:c("./utils/EventTarget"),
FrictionEquation:c("./equations/FrictionEquation"),GSSolver:c("./solver/GSSolver"),GridBroadphase:c("./collision/GridBroadphase"),Heightfield:c("./shapes/Heightfield"),HingeConstraint:c("./constraints/HingeConstraint"),LockConstraint:c("./constraints/LockConstraint"),Mat3:c("./math/Mat3"),Material:c("./material/Material"),NaiveBroadphase:c("./collision/NaiveBroadphase"),ObjectCollisionMatrix:c("./collision/ObjectCollisionMatrix"),Pool:c("./utils/Pool"),Particle:c("./shapes/Particle"),Plane:c("./shapes/Plane"),
PointToPointConstraint:c("./constraints/PointToPointConstraint"),Quaternion:c("./math/Quaternion"),Ray:c("./collision/Ray"),RaycastVehicle:c("./objects/RaycastVehicle"),RaycastResult:c("./collision/RaycastResult"),RigidVehicle:c("./objects/RigidVehicle"),RotationalEquation:c("./equations/RotationalEquation"),RotationalMotorEquation:c("./equations/RotationalMotorEquation"),SAPBroadphase:c("./collision/SAPBroadphase"),SPHSystem:c("./objects/SPHSystem"),Shape:c("./shapes/Shape"),Solver:c("./solver/Solver"),
Sphere:c("./shapes/Sphere"),SplitSolver:c("./solver/SplitSolver"),Spring:c("./objects/Spring"),Trimesh:c("./shapes/Trimesh"),Vec3:c("./math/Vec3"),Vec3Pool:c("./utils/Vec3Pool"),World:c("./world/World")}},{"../package.json":1,"./collision/AABB":3,"./collision/ArrayCollisionMatrix":4,"./collision/Broadphase":5,"./collision/GridBroadphase":6,"./collision/NaiveBroadphase":7,"./collision/ObjectCollisionMatrix":8,"./collision/Ray":9,"./collision/RaycastResult":10,"./collision/SAPBroadphase":11,"./constraints/ConeTwistConstraint":12,
"./constraints/Constraint":13,"./constraints/DistanceConstraint":14,"./constraints/HingeConstraint":15,"./constraints/LockConstraint":16,"./constraints/PointToPointConstraint":17,"./equations/ContactEquation":19,"./equations/Equation":20,"./equations/FrictionEquation":21,"./equations/RotationalEquation":22,"./equations/RotationalMotorEquation":23,"./material/ContactMaterial":24,"./material/Material":25,"./math/Mat3":27,"./math/Quaternion":28,"./math/Vec3":30,"./objects/Body":31,"./objects/RaycastVehicle":32,
"./objects/RigidVehicle":33,"./objects/SPHSystem":34,"./objects/Spring":35,"./shapes/Box":37,"./shapes/ConvexPolyhedron":38,"./shapes/Cylinder":39,"./shapes/Heightfield":40,"./shapes/Particle":41,"./shapes/Plane":42,"./shapes/Shape":43,"./shapes/Sphere":44,"./shapes/Trimesh":45,"./solver/GSSolver":46,"./solver/Solver":47,"./solver/SplitSolver":48,"./utils/EventTarget":49,"./utils/Pool":51,"./utils/Vec3Pool":54,"./world/Narrowphase":55,"./world/World":56}],3:[function(c,e){function d(c){c=c||{};this.lowerBound=
new j;c.lowerBound&&this.lowerBound.copy(c.lowerBound);this.upperBound=new j;c.upperBound&&this.upperBound.copy(c.upperBound)}var j=c("../math/Vec3");c("../utils/Utils");e.exports=d;var g=new j;d.prototype.setFromPoints=function(c,f,d,e){var j=this.lowerBound,s=this.upperBound;j.copy(c[0]);d&&d.vmult(j,j);s.copy(j);for(var p=1;p<c.length;p++){var u=c[p];d&&(d.vmult(u,g),u=g);u.x>s.x&&(s.x=u.x);u.x<j.x&&(j.x=u.x);u.y>s.y&&(s.y=u.y);u.y<j.y&&(j.y=u.y);u.z>s.z&&(s.z=u.z);u.z<j.z&&(j.z=u.z)}f&&(f.vadd(j,
j),f.vadd(s,s));e&&(j.x-=e,j.y-=e,j.z-=e,s.x+=e,s.y+=e,s.z+=e);return this};d.prototype.copy=function(c){this.lowerBound.copy(c.lowerBound);this.upperBound.copy(c.upperBound);return this};d.prototype.clone=function(){return(new d).copy(this)};d.prototype.extend=function(c){var f=c.lowerBound.x;this.lowerBound.x>f&&(this.lowerBound.x=f);f=c.upperBound.x;this.upperBound.x<f&&(this.upperBound.x=f);f=c.lowerBound.y;this.lowerBound.y>f&&(this.lowerBound.y=f);f=c.upperBound.y;this.upperBound.y<f&&(this.upperBound.y=
f);f=c.lowerBound.z;this.lowerBound.z>f&&(this.lowerBound.z=f);f=c.upperBound.z;this.upperBound.z<f&&(this.upperBound.z=f)};d.prototype.overlaps=function(c){var f=this.lowerBound,d=this.upperBound,e=c.lowerBound;c=c.upperBound;return(e.x<=d.x&&d.x<=c.x||f.x<=c.x&&c.x<=d.x)&&(e.y<=d.y&&d.y<=c.y||f.y<=c.y&&c.y<=d.y)&&(e.z<=d.z&&d.z<=c.z||f.z<=c.z&&c.z<=d.z)};d.prototype.contains=function(c){var f=this.lowerBound,d=this.upperBound,e=c.lowerBound;c=c.upperBound;return f.x<=e.x&&d.x>=c.x&&f.y<=e.y&&d.y>=
c.y&&f.z<=e.z&&d.z>=c.z};d.prototype.getCorners=function(c,f,d,e,g,j,p,u){var v=this.lowerBound,z=this.upperBound;c.copy(v);f.set(z.x,v.y,v.z);d.set(z.x,z.y,v.z);e.set(v.x,z.y,z.z);g.set(z.x,v.y,v.z);j.set(v.x,z.y,v.z);p.set(v.x,v.y,z.z);u.copy(z)};var p=[new j,new j,new j,new j,new j,new j,new j,new j];d.prototype.toLocalFrame=function(c,f){this.getCorners(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7]);for(var d=0;8!==d;d++){var e=p[d];c.pointToLocal(e,e)}return f.setFromPoints(p)};d.prototype.toWorldFrame=
function(c,f){this.getCorners(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7]);for(var d=0;8!==d;d++){var e=p[d];c.pointToWorld(e,e)}return f.setFromPoints(p)}},{"../math/Vec3":30,"../utils/Utils":53}],4:[function(c,e){function d(){this.matrix=[]}e.exports=d;d.prototype.get=function(c,d){c=c.index;d=d.index;if(d>c){var e=d;d=c;c=e}return this.matrix[(c*(c+1)>>1)+d-1]};d.prototype.set=function(c,d,e){c=c.index;d=d.index;if(d>c){var l=d;d=c;c=l}this.matrix[(c*(c+1)>>1)+d-1]=e?1:0};d.prototype.reset=function(){for(var c=
0,d=this.matrix.length;c!==d;c++)this.matrix[c]=0};d.prototype.setNumObjects=function(c){this.matrix.length=c*(c-1)>>1}},{}],5:[function(c,e){function d(){this.world=null;this.useBoundingBoxes=!1;this.dirty=!0}var j=c("../objects/Body"),g=c("../math/Vec3"),p=c("../math/Quaternion");c("../shapes/Shape");c("../shapes/Plane");e.exports=d;d.prototype.collisionPairs=function(){throw Error("collisionPairs not implemented for this BroadPhase class!");};var l=j.STATIC|j.KINEMATIC;d.prototype.needBroadphaseCollision=
function(c,f){return 0===(c.collisionFilterGroup&f.collisionFilterMask)||0===(f.collisionFilterGroup&c.collisionFilterMask)||(0!==(c.type&l)||c.sleepState===j.SLEEPING)&&(0!==(f.type&l)||f.sleepState===j.SLEEPING)?!1:!0};d.prototype.intersectionTest=function(c,f,d,e){this.useBoundingBoxes?this.doBoundingBoxBroadphase(c,f,d,e):this.doBoundingSphereBroadphase(c,f,d,e)};var f=new g;new g;new p;new g;d.prototype.doBoundingSphereBroadphase=function(c,d,e,g){d.position.vsub(c.position,f);var n=Math.pow(c.boundingRadius+
d.boundingRadius,2);f.norm2()<n&&(e.push(c),g.push(d))};d.prototype.doBoundingBoxBroadphase=function(c,f,d,e){c.aabbNeedsUpdate&&c.computeAABB();f.aabbNeedsUpdate&&f.computeAABB();c.aabb.overlaps(f.aabb)&&(d.push(c),e.push(f))};var m={keys:[]},n=[],r=[];d.prototype.makePairsUnique=function(c,f){for(var d=c.length,e=0;e!==d;e++)n[e]=c[e],r[e]=f[e];c.length=0;for(e=f.length=0;e!==d;e++){var g=n[e].id,j=r[e].id,g=g<j?g+","+j:j+","+g;m[g]=e;m.keys.push(g)}for(e=0;e!==m.keys.length;e++)g=m.keys.pop(),
d=m[g],c.push(n[d]),f.push(r[d]),delete m[g]};d.prototype.setWorld=function(){};var s=new g;d.boundingSphereCheck=function(c,f){c.position.vsub(f.position,s);return Math.pow(c.shape.boundingSphereRadius+f.shape.boundingSphereRadius,2)>s.norm2()};d.prototype.aabbQuery=function(){console.warn(".aabbQuery is not implemented in this Broadphase subclass.");return[]}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Plane":42,"../shapes/Shape":43}],6:[function(c,e){function d(c,
d,e,l,s){j.apply(this);this.nx=e||10;this.ny=l||10;this.nz=s||10;this.aabbMin=c||new g(100,100,100);this.aabbMax=d||new g(-100,-100,-100);c=this.nx*this.ny*this.nz;if(0>=c)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[];this.binLengths=[];this.bins.length=c;this.binLengths.length=c;for(d=0;d<c;d++)this.bins[d]=[],this.binLengths[d]=0}e.exports=d;var j=c("./Broadphase"),g=c("../math/Vec3"),p=c("../shapes/Shape");d.prototype=new j;d.prototype.constructor=d;var l=new g;new g;d.prototype.collisionPairs=
function(c,d,e){function g(c,f,d,e,n,m,j){c=(c-H)*Q|0;f=(f-M)*L|0;d=(d-S)*W|0;e=T((e-H)*Q);n=T((n-M)*L);m=T((m-S)*W);0>c?c=0:c>=v&&(c=v-1);0>f?f=0:f>=z&&(f=z-1);0>d?d=0:d>=x&&(d=x-1);0>e?e=0:e>=v&&(e=v-1);0>n?n=0:n>=z&&(n=z-1);0>m?m=0:m>=x&&(m=x-1);c*=C;f*=B;d*=E;e*=C;n*=B;for(m*=E;c<=e;c+=C)for(var l=f;l<=n;l+=B)for(var r=d;r<=m;r+=E){var s=c+l+r;Z[s][N[s]++]=j}}var j=c.numObjects();c=c.bodies;for(var t=this.aabbMax,u=this.aabbMin,v=this.nx,z=this.ny,x=this.nz,C=z*x,B=x,E=1,I=t.x,y=t.y,D=t.z,H=u.x,
M=u.y,S=u.z,Q=v/(I-H),L=z/(y-M),W=x/(D-S),I=(I-H)/v,aa=(y-M)/z,D=(D-S)/x,G=0.5*Math.sqrt(I*I+aa*aa+D*D),y=p.types,F=y.SPHERE,ka=y.PLANE,Z=this.bins,N=this.binLengths,y=this.bins.length,u=0;u!==y;u++)N[u]=0;for(var T=Math.ceil,u=Math.min,t=Math.max,u=0;u!==j;u++){var t=c[u],J=t.shape;switch(J.type){case F:var U=t.position.x,ha=t.position.y,va=t.position.z,J=J.radius;g(U-J,ha-J,va-J,U+J,ha+J,va+J,t);break;case ka:J.worldNormalNeedsUpdate&&J.computeWorldNormal(t.quaternion);var va=J.worldNormal,J=M+
0.5*aa-t.position.y,wa=S+0.5*D-t.position.z,ea=l;ea.set(H+0.5*I-t.position.x,J,wa);for(var ba=U=0;U!==v;U++,ba+=C,ea.y=J,ea.x+=I)for(var A=ha=0;ha!==z;ha++,A+=B,ea.z=wa,ea.y+=aa)for(var ia=0,oa=0;ia!==x;ia++,oa+=E,ea.z+=D)if(ea.dot(va)<G){var da=ba+A+oa;Z[da][N[da]++]=t}break;default:t.aabbNeedsUpdate&&t.computeAABB(),g(t.aabb.lowerBound.x,t.aabb.lowerBound.y,t.aabb.lowerBound.z,t.aabb.upperBound.x,t.aabb.upperBound.y,t.aabb.upperBound.z,t)}}for(u=0;u!==y;u++)if(j=N[u],1<j){c=Z[u];for(U=0;U!==j;U++){t=
c[U];for(ha=0;ha!==U;ha++)I=c[ha],this.needBroadphaseCollision(t,I)&&this.intersectionTest(t,I,d,e)}}this.makePairsUnique(d,e)}},{"../math/Vec3":30,"../shapes/Shape":43,"./Broadphase":5}],7:[function(c,e){function d(){j.apply(this)}e.exports=d;var j=c("./Broadphase"),g=c("./AABB");d.prototype=new j;d.prototype.constructor=d;d.prototype.collisionPairs=function(c,d,f){c=c.bodies;var e=c.length,g,j,s,t;for(g=0;g!==e;g++)for(j=0;j!==g;j++)s=c[g],t=c[j],this.needBroadphaseCollision(s,t)&&this.intersectionTest(s,
t,d,f)};new g;d.prototype.aabbQuery=function(c,d,f){f=f||[];for(var e=0;e<c.bodies.length;e++){var g=c.bodies[e];g.aabbNeedsUpdate&&g.computeAABB();g.aabb.overlaps(d)&&f.push(g)}return f}},{"./AABB":3,"./Broadphase":5}],8:[function(c,e){function d(){this.matrix={}}e.exports=d;d.prototype.get=function(c,d){c=c.id;d=d.id;if(d>c){var e=d;d=c;c=e}return c+"-"+d in this.matrix};d.prototype.set=function(c,d,e){c=c.id;d=d.id;if(d>c){var l=d;d=c;c=l}e?this.matrix[c+"-"+d]=!0:delete this.matrix[c+"-"+d]};
d.prototype.reset=function(){this.matrix={}};d.prototype.setNumObjects=function(){}},{}],9:[function(c,e){function d(c,e){this.from=c?c.clone():new g;this.to=e?e.clone():new g;this._direction=new g;this.precision=1E-4;this.checkCollisionResponse=!0;this.skipBackfaces=!1;this.collisionFilterGroup=this.collisionFilterMask=-1;this.mode=d.ANY;this.result=new f;this.hasHit=!1;this.callback=function(){}}function j(c,f,d,e){e.vsub(f,Z);d.vsub(f,t);c.vsub(f,u);c=Z.dot(Z);f=Z.dot(t);d=Z.dot(u);e=t.dot(t);
var g=t.dot(u),n,m;return 0<=(n=e*d-f*g)&&0<=(m=c*g-f*d)&&n+m<c*e-f*f}e.exports=d;var g=c("../math/Vec3"),p=c("../math/Quaternion"),l=c("../math/Transform");c("../shapes/ConvexPolyhedron");c("../shapes/Box");var f=c("../collision/RaycastResult"),m=c("../shapes/Shape"),n=c("../collision/AABB");d.prototype.constructor=d;d.CLOSEST=1;d.ANY=2;d.ALL=4;var r=new n,s=[];d.prototype.intersectWorld=function(c,e){this.mode=e.mode||d.ANY;this.result=e.result||new f;this.skipBackfaces=!!e.skipBackfaces;this.collisionFilterMask=
"undefined"!==typeof e.collisionFilterMask?e.collisionFilterMask:-1;this.collisionFilterGroup="undefined"!==typeof e.collisionFilterGroup?e.collisionFilterGroup:-1;e.from&&this.from.copy(e.from);e.to&&this.to.copy(e.to);this.callback=e.callback||function(){};this.hasHit=!1;this.result.reset();this._updateDirection();this.getAABB(r);s.length=0;c.broadphase.aabbQuery(c,r,s);this.intersectBodies(s);return this.hasHit};var t=new g,u=new g;d.pointInTriangle=j;var v=new g,z=new p;d.prototype.intersectBody=
function(c,f){f&&(this.result=f,this._updateDirection());var d=this.checkCollisionResponse;if(!d||c.collisionResponse)if(!(0===(this.collisionFilterGroup&c.collisionFilterMask)||0===(c.collisionFilterGroup&this.collisionFilterMask)))for(var e=0,g=c.shapes.length;e<g;e++){var n=c.shapes[e];if(!d||n.collisionResponse)if(c.quaternion.mult(c.shapeOrientations[e],z),c.quaternion.vmult(c.shapeOffsets[e],v),v.vadd(c.position,v),this.intersectShape(n,z,v,c),this.result._shouldStop)break}};d.prototype.intersectBodies=
function(c,f){f&&(this.result=f,this._updateDirection());for(var d=0,e=c.length;!this.result._shouldStop&&d<e;d++)this.intersectBody(c[d])};d.prototype._updateDirection=function(){this.to.vsub(this.from,this._direction);this._direction.normalize()};d.prototype.intersectShape=function(c,f,d,e){var g=this.from,n=this._direction;d.vsub(g,Z);var m=Z.dot(n);n.mult(m,N);N.vadd(g,N);d.distanceTo(N)>c.boundingSphereRadius||(g=this[c.type])&&g.call(this,c,f,d,e)};new g;new g;var x=new g,C=new g,B=new g,E=
new g;new g;new f;d.prototype.intersectBox=function(c,f,d,e){return this.intersectConvex(c.convexPolyhedronRepresentation,f,d,e)};d.prototype[m.types.BOX]=d.prototype.intersectBox;d.prototype.intersectPlane=function(c,f,d,e){var n=this.from,m=this.to,j=this._direction,l=new g(0,0,1);f.vmult(l,l);var r=new g;n.vsub(d,r);f=r.dot(l);m.vsub(d,r);r=r.dot(l);if(!(0<f*r)&&!(n.distanceTo(m)<f)&&(r=l.dot(j),!(Math.abs(r)<this.precision))){var s=new g,m=new g;f=new g;n.vsub(d,s);d=-l.dot(s)/r;j.scale(d,m);
n.vadd(m,f);this.reportIntersection(l,f,c,e,-1)}};d.prototype[m.types.PLANE]=d.prototype.intersectPlane;d.prototype.getAABB=function(c){var f=this.to,d=this.from;c.lowerBound.x=Math.min(f.x,d.x);c.lowerBound.y=Math.min(f.y,d.y);c.lowerBound.z=Math.min(f.z,d.z);c.upperBound.x=Math.max(f.x,d.x);c.upperBound.y=Math.max(f.y,d.y);c.upperBound.z=Math.max(f.z,d.z)};var I={faceList:[0]};d.prototype.intersectHeightfield=function(c,f,e,n){var m=new g,j=new d(this.from,this.to);l.pointToLocalFrame(e,f,j.from,
j.from);l.pointToLocalFrame(e,f,j.to,j.to);var r=[],s=null,p=null,t=null,u=null,v=c.getIndexOfPosition(j.from.x,j.from.y,r,!1);v&&(s=r[0],p=r[1],t=r[0],u=r[1]);if(v=c.getIndexOfPosition(j.to.x,j.to.y,r,!1)){if(null===s||r[0]<s)s=r[0];if(null===t||r[0]>t)t=r[0];if(null===p||r[1]<p)p=r[1];if(null===u||r[1]>u)u=r[1]}if(null!==s){c.getRectMinMax(s,p,t,u,[]);for(j=s;j<=t;j++)for(r=p;r<=u;r++){if(this.result._shouldStop)return;c.getConvexTrianglePillar(j,r,!1);l.pointToWorldFrame(e,f,c.pillarOffset,m);
this.intersectConvex(c.pillarConvex,f,m,n,I);if(this.result._shouldStop)return;c.getConvexTrianglePillar(j,r,!0);l.pointToWorldFrame(e,f,c.pillarOffset,m);this.intersectConvex(c.pillarConvex,f,m,n,I)}}};d.prototype[m.types.HEIGHTFIELD]=d.prototype.intersectHeightfield;var y=new g,D=new g;d.prototype.intersectSphere=function(c,f,d,e){f=this.from;var g=this.to,n=c.radius,m=Math.pow(g.x-f.x,2)+Math.pow(g.y-f.y,2)+Math.pow(g.z-f.z,2),j=2*((g.x-f.x)*(f.x-d.x)+(g.y-f.y)*(f.y-d.y)+(g.z-f.z)*(f.z-d.z)),n=
Math.pow(f.x-d.x,2)+Math.pow(f.y-d.y,2)+Math.pow(f.z-d.z,2)-Math.pow(n,2),l=Math.pow(j,2)-4*m*n;0>l||(0===l?(f.lerp(g,l,y),y.vsub(d,D),D.normalize(),this.reportIntersection(D,y,c,e,-1)):(n=(-j-Math.sqrt(l))/(2*m),m=(-j+Math.sqrt(l))/(2*m),0<=n&&1>=n&&(f.lerp(g,n,y),y.vsub(d,D),D.normalize(),this.reportIntersection(D,y,c,e,-1)),!this.result._shouldStop&&(0<=m&&1>=m)&&(f.lerp(g,m,y),y.vsub(d,D),D.normalize(),this.reportIntersection(D,y,c,e,-1))))};d.prototype[m.types.SPHERE]=d.prototype.intersectSphere;
var H=new g;new g;new g;var M=new g;d.prototype.intersectConvex=function(c,f,d,e,g){g=g&&g.faceList||null;for(var n=c.faces,m=c.vertices,l=c.faceNormals,r=this._direction,s=this.from,p=s.distanceTo(this.to),t=g?g.length:n.length,u=this.result,v=0;!u._shouldStop&&v<t;v++){var z=g?g[v]:v,y=n[z],N=l[z],L=f,F=d;M.copy(m[y[0]]);L.vmult(M,M);M.vadd(F,M);M.vsub(s,M);L.vmult(N,H);N=r.dot(H);if(!(Math.abs(N)<this.precision)&&(N=H.dot(M)/N,!(0>N))){r.mult(N,x);x.vadd(s,x);C.copy(m[y[0]]);L.vmult(C,C);F.vadd(C,
C);for(N=1;!u._shouldStop&&N<y.length-1;N++){B.copy(m[y[N]]);E.copy(m[y[N+1]]);L.vmult(B,B);L.vmult(E,E);F.vadd(B,B);F.vadd(E,E);var G=x.distanceTo(s);!j(x,C,B,E)&&!j(x,B,C,E)||G>p||this.reportIntersection(H,x,c,e,z)}}}};d.prototype[m.types.CONVEXPOLYHEDRON]=d.prototype.intersectConvex;var S=new g,Q=new g,L=new g,W=new g,aa=new g,G=new g;new n;var F=[],ka=new l;d.prototype.intersectTrimesh=function(c,f,d,e){var g=c.indices,n=this.from,m=this.to,r=this._direction;ka.position.copy(d);ka.quaternion.copy(f);
l.vectorToLocalFrame(d,f,r,Q);l.pointToLocalFrame(d,f,n,L);l.pointToLocalFrame(d,f,m,W);n=L.distanceSquared(W);c.tree.rayQuery(this,ka,F);m=0;for(r=F.length;!this.result._shouldStop&&m!==r;m++){var s=F[m];c.getNormal(s,S);c.getVertex(g[3*s],C);C.vsub(L,M);var p=Q.dot(S),p=S.dot(M)/p;0>p||(Q.scale(p,x),x.vadd(L,x),c.getVertex(g[3*s+1],B),c.getVertex(g[3*s+2],E),p=x.distanceSquared(L),!j(x,B,C,E)&&!j(x,C,B,E)||p>n||(l.vectorToWorldFrame(f,S,aa),l.pointToWorldFrame(d,f,x,G),this.reportIntersection(aa,
G,c,e,s)))}F.length=0};d.prototype[m.types.TRIMESH]=d.prototype.intersectTrimesh;d.prototype.reportIntersection=function(c,f,e,g,n){var m=this.from,j=this.to,l=m.distanceTo(f),r=this.result;if(!(this.skipBackfaces&&0<c.dot(this._direction)))switch(r.hitFaceIndex="undefined"!==typeof n?n:-1,this.mode){case d.ALL:this.hasHit=!0;r.set(m,j,c,f,e,g,l);r.hasHit=!0;this.callback(r);break;case d.CLOSEST:if(l<r.distance||!r.hasHit)this.hasHit=!0,r.hasHit=!0,r.set(m,j,c,f,e,g,l);break;case d.ANY:this.hasHit=
!0,r.hasHit=!0,r.set(m,j,c,f,e,g,l),r._shouldStop=!0}};var Z=new g,N=new g},{"../collision/AABB":3,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/Box":37,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43}],10:[function(c,e){function d(){this.rayFromWorld=new j;this.rayToWorld=new j;this.hitNormalWorld=new j;this.hitPointWorld=new j;this.hasHit=!1;this.body=this.shape=null;this.distance=this.hitFaceIndex=-1;this._shouldStop=!1}var j=c("../math/Vec3");
e.exports=d;d.prototype.reset=function(){this.rayFromWorld.setZero();this.rayToWorld.setZero();this.hitNormalWorld.setZero();this.hitPointWorld.setZero();this.hasHit=!1;this.body=this.shape=null;this.distance=this.hitFaceIndex=-1;this._shouldStop=!1};d.prototype.abort=function(){this._shouldStop=!0};d.prototype.set=function(c,d,e,f,m,n,j){this.rayFromWorld.copy(c);this.rayToWorld.copy(d);this.hitNormalWorld.copy(e);this.hitPointWorld.copy(f);this.shape=m;this.body=n;this.distance=j}},{"../math/Vec3":30}],
11:[function(c,e){function d(c){j.apply(this);this.axisList=[];this.world=null;this.axisIndex=0;var d=this.axisList;this._addBodyHandler=function(c){d.push(c.body)};this._removeBodyHandler=function(c){c=d.indexOf(c.body);-1!==c&&d.splice(c,1)};c&&this.setWorld(c)}c("../shapes/Shape");var j=c("../collision/Broadphase");e.exports=d;d.prototype=new j;d.prototype.setWorld=function(c){for(var d=this.axisList.length=0;d<c.bodies.length;d++)this.axisList.push(c.bodies[d]);c.removeEventListener("addBody",
this._addBodyHandler);c.removeEventListener("removeBody",this._removeBodyHandler);c.addEventListener("addBody",this._addBodyHandler);c.addEventListener("removeBody",this._removeBodyHandler);this.world=c;this.dirty=!0};d.insertionSortX=function(c){for(var d=1,e=c.length;d<e;d++){for(var f=c[d],m=d-1;0<=m&&!(c[m].aabb.lowerBound.x<=f.aabb.lowerBound.x);m--)c[m+1]=c[m];c[m+1]=f}return c};d.insertionSortY=function(c){for(var d=1,e=c.length;d<e;d++){for(var f=c[d],m=d-1;0<=m&&!(c[m].aabb.lowerBound.y<=
f.aabb.lowerBound.y);m--)c[m+1]=c[m];c[m+1]=f}return c};d.insertionSortZ=function(c){for(var d=1,e=c.length;d<e;d++){for(var f=c[d],m=d-1;0<=m&&!(c[m].aabb.lowerBound.z<=f.aabb.lowerBound.z);m--)c[m+1]=c[m];c[m+1]=f}return c};d.prototype.collisionPairs=function(c,e,j){c=this.axisList;var f=c.length,m=this.axisIndex,n,r;this.dirty&&(this.sortList(),this.dirty=!1);for(n=0;n!==f;n++){var s=c[n];for(r=n+1;r<f;r++){var t=c[r];if(this.needBroadphaseCollision(s,t)){if(!d.checkBounds(s,t,m))break;this.intersectionTest(s,
t,e,j)}}}};d.prototype.sortList=function(){for(var c=this.axisList,e=this.axisIndex,j=c.length,f=0;f!==j;f++){var m=c[f];m.aabbNeedsUpdate&&m.computeAABB()}0===e?d.insertionSortX(c):1===e?d.insertionSortY(c):2===e&&d.insertionSortZ(c)};d.checkBounds=function(c,d,e){var f,m;0===e?(f=c.position.x,m=d.position.x):1===e?(f=c.position.y,m=d.position.y):2===e&&(f=c.position.z,m=d.position.z);return m-d.boundingRadius<f+c.boundingRadius};d.prototype.autoDetectAxis=function(){for(var c=0,d=0,e=0,f=0,m=0,
n=0,j=this.axisList,s=j.length,t=1/s,u=0;u!==s;u++)var v=j[u],z=v.position.x,c=c+z,d=d+z*z,z=v.position.y,e=e+z,f=f+z*z,v=v.position.z,m=m+v,n=n+v*v;c=d-c*c*t;e=f-e*e*t;m=n-m*m*t;this.axisIndex=c>e?c>m?0:2:e>m?1:2};d.prototype.aabbQuery=function(c,d,e){e=e||[];this.dirty&&(this.sortList(),this.dirty=!1);c=this.axisList;for(var f=0;f<c.length;f++){var m=c[f];m.aabbNeedsUpdate&&m.computeAABB();m.aabb.overlaps(d)&&e.push(m)}return e}},{"../collision/Broadphase":5,"../shapes/Shape":43}],12:[function(c,
e){function d(c,d,e){e=e||{};var r="undefined"!==typeof e.maxForce?e.maxForce:1E6,s=e.pivotA?e.pivotA.clone():new l,t=e.pivotB?e.pivotB.clone():new l;this.axisA=e.axisA?e.axisA.clone():new l;this.axisB=e.axisB?e.axisB.clone():new l;j.call(this,c,s,d,t,r);this.collideConnected=!!e.collideConnected;this.angle="undefined"!==typeof e.angle?e.angle:0;s=this.coneEquation=new g(c,d,e);c=this.twistEquation=new p(c,d,e);this.twistAngle="undefined"!==typeof e.twistAngle?e.twistAngle:0;s.maxForce=0;s.minForce=
-r;c.maxForce=0;c.minForce=-r;this.equations.push(s,c)}e.exports=d;c("./Constraint");var j=c("./PointToPointConstraint"),g=c("../equations/ConeEquation"),p=c("../equations/RotationalEquation");c("../equations/ContactEquation");var l=c("../math/Vec3");d.prototype=new j;d.constructor=d;new l;new l;d.prototype.update=function(){var c=this.bodyA,d=this.bodyB,e=this.coneEquation,g=this.twistEquation;j.prototype.update.call(this);c.vectorToWorldFrame(this.axisA,e.axisA);d.vectorToWorldFrame(this.axisB,
e.axisB);this.axisA.tangents(g.axisA,g.axisA);c.vectorToWorldFrame(g.axisA,g.axisA);this.axisB.tangents(g.axisB,g.axisB);d.vectorToWorldFrame(g.axisB,g.axisB);e.angle=this.angle;g.maxAngle=this.twistAngle}},{"../equations/ConeEquation":18,"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],13:[function(c,e){function d(c,e,l){l=j.defaults(l,{collideConnected:!0,wakeUpBodies:!0});this.equations=[];this.bodyA=c;this.bodyB=
e;this.id=d.idCounter++;this.collideConnected=l.collideConnected;l.wakeUpBodies&&(c&&c.wakeUp(),e&&e.wakeUp())}e.exports=d;var j=c("../utils/Utils");d.prototype.update=function(){throw Error("method update() not implmemented in this Constraint subclass!");};d.prototype.enable=function(){for(var c=this.equations,d=0;d<c.length;d++)c[d].enabled=!0};d.prototype.disable=function(){for(var c=this.equations,d=0;d<c.length;d++)c[d].enabled=!1};d.idCounter=0},{"../utils/Utils":53}],14:[function(c,e){function d(c,
d,f,e){j.call(this,c,d);"undefined"===typeof f&&(f=c.position.distanceTo(d.position));"undefined"===typeof e&&(e=1E6);this.distance=f;c=this.distanceEquation=new g(c,d);this.equations.push(c);c.minForce=-e;c.maxForce=e}e.exports=d;var j=c("./Constraint"),g=c("../equations/ContactEquation");d.prototype=new j;d.prototype.update=function(){var c=this.distanceEquation,d=0.5*this.distance,f=c.ni;this.bodyB.position.vsub(this.bodyA.position,f);f.normalize();f.mult(d,c.ri);f.mult(-d,c.rj)}},{"../equations/ContactEquation":19,
"./Constraint":13}],15:[function(c,e){function d(c,f,d){d=d||{};var e="undefined"!==typeof d.maxForce?d.maxForce:1E6,m=d.pivotA?d.pivotA.clone():new l,v=d.pivotB?d.pivotB.clone():new l;j.call(this,c,m,f,v,e);(this.axisA=d.axisA?d.axisA.clone():new l(1,0,0)).normalize();(this.axisB=d.axisB?d.axisB.clone():new l(1,0,0)).normalize();m=this.rotationalEquation1=new g(c,f,d);d=this.rotationalEquation2=new g(c,f,d);c=this.motorEquation=new p(c,f,e);c.enabled=!1;this.equations.push(m,d,c)}e.exports=d;c("./Constraint");
var j=c("./PointToPointConstraint"),g=c("../equations/RotationalEquation"),p=c("../equations/RotationalMotorEquation");c("../equations/ContactEquation");var l=c("../math/Vec3");d.prototype=new j;d.constructor=d;d.prototype.enableMotor=function(){this.motorEquation.enabled=!0};d.prototype.disableMotor=function(){this.motorEquation.enabled=!1};d.prototype.setMotorSpeed=function(c){this.motorEquation.targetVelocity=c};d.prototype.setMotorMaxForce=function(c){this.motorEquation.maxForce=c;this.motorEquation.minForce=
-c};var f=new l,m=new l;d.prototype.update=function(){var c=this.bodyA,d=this.bodyB,e=this.motorEquation,g=this.rotationalEquation1,l=this.rotationalEquation2,p=this.axisA,z=this.axisB;j.prototype.update.call(this);c.quaternion.vmult(p,f);d.quaternion.vmult(z,m);f.tangents(g.axisA,l.axisA);g.axisB.copy(m);l.axisB.copy(m);this.motorEquation.enabled&&(c.quaternion.vmult(this.axisA,e.axisA),d.quaternion.vmult(this.axisB,e.axisB))}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,
"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],16:[function(c,e){function d(c,f,d){d=d||{};var e="undefined"!==typeof d.maxForce?d.maxForce:1E6,r=new p,s=new p,t=new p;c.position.vadd(f.position,t);t.scale(0.5,t);f.pointToLocalFrame(t,s);c.pointToLocalFrame(t,r);j.call(this,c,r,f,s,e);e=this.rotationalEquation1=new g(c,f,d);r=this.rotationalEquation2=new g(c,f,d);c=this.rotationalEquation3=new g(c,f,d);this.equations.push(e,r,c)}e.exports=
d;c("./Constraint");var j=c("./PointToPointConstraint"),g=c("../equations/RotationalEquation");c("../equations/RotationalMotorEquation");c("../equations/ContactEquation");var p=c("../math/Vec3");d.prototype=new j;d.constructor=d;new p;new p;d.prototype.update=function(){var c=this.bodyA,f=this.bodyB,d=this.rotationalEquation1,e=this.rotationalEquation2,g=this.rotationalEquation3;j.prototype.update.call(this);c.vectorToWorldFrame(p.UNIT_X,d.axisA);f.vectorToWorldFrame(p.UNIT_Y,d.axisB);c.vectorToWorldFrame(p.UNIT_Y,
e.axisA);f.vectorToWorldFrame(p.UNIT_Z,e.axisB);c.vectorToWorldFrame(p.UNIT_Z,g.axisA);f.vectorToWorldFrame(p.UNIT_X,g.axisB)}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],17:[function(c,e){function d(c,f,d,e,r){j.call(this,c,d);r="undefined"!==typeof r?r:1E6;this.pivotA=f?f.clone():new p;this.pivotB=e?e.clone():new p;f=this.equationX=new g(c,d);e=this.equationY=
new g(c,d);c=this.equationZ=new g(c,d);this.equations.push(f,e,c);f.minForce=e.minForce=c.minForce=-r;f.maxForce=e.maxForce=c.maxForce=r;f.ni.set(1,0,0);e.ni.set(0,1,0);c.ni.set(0,0,1)}e.exports=d;var j=c("./Constraint"),g=c("../equations/ContactEquation"),p=c("../math/Vec3");d.prototype=new j;d.prototype.update=function(){var c=this.bodyB,f=this.equationX,d=this.equationY,e=this.equationZ;this.bodyA.quaternion.vmult(this.pivotA,f.ri);c.quaternion.vmult(this.pivotB,f.rj);d.ri.copy(f.ri);d.rj.copy(f.rj);
e.ri.copy(f.ri);e.rj.copy(f.rj)}},{"../equations/ContactEquation":19,"../math/Vec3":30,"./Constraint":13}],18:[function(c,e){function d(c,d,e){e=e||{};var l="undefined"!==typeof e.maxForce?e.maxForce:1E6;g.call(this,c,d,-l,l);this.axisA=e.axisA?e.axisA.clone():new j(1,0,0);this.axisB=e.axisB?e.axisB.clone():new j(0,1,0);this.angle="undefined"!==typeof e.angle?e.angle:0}e.exports=d;var j=c("../math/Vec3");c("../math/Mat3");var g=c("./Equation");d.prototype=new g;d.prototype.constructor=d;var p=new j,
l=new j;d.prototype.computeB=function(c){var d=this.a,e=this.b,g=this.axisA,j=this.axisB,t=this.jacobianElementA,u=this.jacobianElementB;g.cross(j,p);j.cross(g,l);t.rotational.copy(l);u.rotational.copy(p);g=Math.cos(this.angle)-g.dot(j);j=this.computeGW();t=this.computeGiMf();return-g*d-j*e-c*t}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],19:[function(c,e){function d(c,f,d){j.call(this,c,f,0,"undefined"!==typeof d?d:1E6);this.restitution=0;this.ri=new g;this.rj=new g;this.ni=new g}e.exports=
d;var j=c("./Equation"),g=c("../math/Vec3");c("../math/Mat3");d.prototype=new j;d.prototype.constructor=d;var p=new g,l=new g,f=new g;d.prototype.computeB=function(c){var d=this.a,e=this.b,g=this.bi,n=this.bj,m=this.ri,j=this.rj,r=g.velocity,s=g.angularVelocity,t=n.velocity,H=n.angularVelocity,M=this.jacobianElementA,S=this.jacobianElementB,Q=this.ni;m.cross(Q,p);j.cross(Q,l);Q.negate(M.spatial);p.negate(M.rotational);S.spatial.copy(Q);S.rotational.copy(l);f.copy(n.position);f.vadd(j,f);f.vsub(g.position,
f);f.vsub(m,f);g=Q.dot(f);n=this.restitution+1;r=n*t.dot(Q)-n*r.dot(Q)+H.dot(l)-s.dot(p);s=this.computeGiMf();return-g*d-r*e-c*s};var m=new g,n=new g,r=new g,s=new g,t=new g;d.prototype.getImpactVelocityAlongNormal=function(){this.bi.position.vadd(this.ri,r);this.bj.position.vadd(this.rj,s);this.bi.getVelocityAtWorldPoint(r,m);this.bj.getVelocityAtWorldPoint(s,n);m.vsub(n,t);return this.ni.dot(t)}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],20:[function(c,e){function d(c,f,e,g){this.id=
d.id++;this.minForce="undefined"===typeof e?-1E6:e;this.maxForce="undefined"===typeof g?1E6:g;this.bi=c;this.bj=f;this.eps=this.b=this.a=0;this.jacobianElementA=new j;this.jacobianElementB=new j;this.enabled=!0;this.setSpookParams(1E7,4,1/60)}e.exports=d;var j=c("../math/JacobianElement"),g=c("../math/Vec3");d.prototype.constructor=d;d.id=0;d.prototype.setSpookParams=function(c,f,d){this.a=4/(d*(1+4*f));this.b=4*f/(1+4*f);this.eps=4/(d*d*c*(1+4*f))};d.prototype.computeB=function(c,f,d){var e=this.computeGW(),
g=this.computeGq(),n=this.computeGiMf();return-g*c-e*f-n*d};d.prototype.computeGq=function(){var c=this.jacobianElementB,f=this.bj.position;return this.jacobianElementA.spatial.dot(this.bi.position)+c.spatial.dot(f)};var p=new g;d.prototype.computeGW=function(){var c=this.jacobianElementB,f=this.bi,d=this.bj,e=d.velocity,d=d.angularVelocity||p;return this.jacobianElementA.multiplyVectors(f.velocity,f.angularVelocity||p)+c.multiplyVectors(e,d)};d.prototype.computeGWlambda=function(){var c=this.jacobianElementB,
f=this.bi,d=this.bj,e=d.vlambda,d=d.wlambda||p;return this.jacobianElementA.multiplyVectors(f.vlambda,f.wlambda||p)+c.multiplyVectors(e,d)};var l=new g,f=new g,m=new g,n=new g;d.prototype.computeGiMf=function(){var c=this.jacobianElementA,d=this.jacobianElementB,e=this.bi,g=this.bj,j=e.force,r=e.torque,s=g.force,p=g.torque,I=e.invMassSolve,y=g.invMassSolve;e.invInertiaWorldSolve?e.invInertiaWorldSolve.vmult(r,m):m.set(0,0,0);g.invInertiaWorldSolve?g.invInertiaWorldSolve.vmult(p,n):n.set(0,0,0);j.mult(I,
l);s.mult(y,f);return c.multiplyVectors(l,m)+d.multiplyVectors(f,n)};var r=new g;d.prototype.computeGiMGt=function(){var c=this.jacobianElementA,f=this.jacobianElementB,d=this.bi,e=this.bj,g=d.invInertiaWorldSolve,n=e.invInertiaWorldSolve,d=d.invMassSolve+e.invMassSolve;g&&(g.vmult(c.rotational,r),d+=r.dot(c.rotational));n&&(n.vmult(f.rotational,r),d+=r.dot(f.rotational));return d};var s=new g;new g;new g;new g;new g;new g;d.prototype.addToWlambda=function(c){var f=this.jacobianElementA,d=this.jacobianElementB,
e=this.bi,g=this.bj;f.spatial.mult(e.invMassSolve*c,s);e.vlambda.vadd(s,e.vlambda);d.spatial.mult(g.invMassSolve*c,s);g.vlambda.vadd(s,g.vlambda);e.invInertiaWorldSolve&&(e.invInertiaWorldSolve.vmult(f.rotational,s),s.mult(c,s),e.wlambda.vadd(s,e.wlambda));g.invInertiaWorldSolve&&(g.invInertiaWorldSolve.vmult(d.rotational,s),s.mult(c,s),g.wlambda.vadd(s,g.wlambda))};d.prototype.computeC=function(){return this.computeGiMGt()+this.eps}},{"../math/JacobianElement":26,"../math/Vec3":30}],21:[function(c,
e){function d(c,d,e){j.call(this,c,d,-e,e);this.ri=new g;this.rj=new g;this.t=new g}e.exports=d;var j=c("./Equation"),g=c("../math/Vec3");c("../math/Mat3");d.prototype=new j;d.prototype.constructor=d;var p=new g,l=new g;d.prototype.computeB=function(c){var d=this.b,e=this.rj,g=this.t;this.ri.cross(g,p);e.cross(g,l);var e=this.jacobianElementA,j=this.jacobianElementB;g.negate(e.spatial);p.negate(e.rotational);j.spatial.copy(g);j.rotational.copy(l);g=this.computeGW();e=this.computeGiMf();return-g*d-
c*e}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],22:[function(c,e){function d(c,d,e){e=e||{};var l="undefined"!==typeof e.maxForce?e.maxForce:1E6;g.call(this,c,d,-l,l);this.axisA=e.axisA?e.axisA.clone():new j(1,0,0);this.axisB=e.axisB?e.axisB.clone():new j(0,1,0);this.maxAngle=Math.PI/2}e.exports=d;var j=c("../math/Vec3");c("../math/Mat3");var g=c("./Equation");d.prototype=new g;d.prototype.constructor=d;var p=new j,l=new j;d.prototype.computeB=function(c){var d=this.a,e=this.b,g=this.axisA,
j=this.axisB,t=this.jacobianElementA,u=this.jacobianElementB;g.cross(j,p);j.cross(g,l);t.rotational.copy(l);u.rotational.copy(p);g=Math.cos(this.maxAngle)-g.dot(j);j=this.computeGW();t=this.computeGiMf();return-g*d-j*e-c*t}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],23:[function(c,e){function d(c,d,f){f="undefined"!==typeof f?f:1E6;g.call(this,c,d,-f,f);this.axisA=new j;this.axisB=new j;this.targetVelocity=0}e.exports=d;var j=c("../math/Vec3");c("../math/Mat3");var g=c("./Equation");
d.prototype=new g;d.prototype.constructor=d;d.prototype.computeB=function(c){var d=this.b,f=this.axisB,e=this.jacobianElementB;this.jacobianElementA.rotational.copy(this.axisA);f.negate(e.rotational);f=this.computeGW()-this.targetVelocity;e=this.computeGiMf();return-f*d-c*e}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],24:[function(c,e){function d(c,e,l){l=j.defaults(l,{friction:0.3,restitution:0.3,contactEquationStiffness:1E7,contactEquationRelaxation:3,frictionEquationStiffness:1E7,frictionEquationRelaxation:3});
this.id=d.idCounter++;this.materials=[c,e];this.friction=l.friction;this.restitution=l.restitution;this.contactEquationStiffness=l.contactEquationStiffness;this.contactEquationRelaxation=l.contactEquationRelaxation;this.frictionEquationStiffness=l.frictionEquationStiffness;this.frictionEquationRelaxation=l.frictionEquationRelaxation}var j=c("../utils/Utils");e.exports=d;d.idCounter=0},{"../utils/Utils":53}],25:[function(c,e){function d(c){var e="";c=c||{};"string"===typeof c?(e=c,c={}):"object"===
typeof c&&(e="");this.name=e;this.id=d.idCounter++;this.friction="undefined"!==typeof c.friction?c.friction:-1;this.restitution="undefined"!==typeof c.restitution?c.restitution:-1}e.exports=d;d.idCounter=0},{}],26:[function(c,e){function d(){this.spatial=new j;this.rotational=new j}e.exports=d;var j=c("./Vec3");d.prototype.multiplyElement=function(c){return c.spatial.dot(this.spatial)+c.rotational.dot(this.rotational)};d.prototype.multiplyVectors=function(c,d){return c.dot(this.spatial)+d.dot(this.rotational)}},
{"./Vec3":30}],27:[function(c,e){function d(c){this.elements=c?c:[0,0,0,0,0,0,0,0,0]}e.exports=d;var j=c("./Vec3");d.prototype.identity=function(){var c=this.elements;c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=1;c[5]=0;c[6]=0;c[7]=0;c[8]=1};d.prototype.setZero=function(){var c=this.elements;c[0]=0;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=0;c[6]=0;c[7]=0;c[8]=0};d.prototype.setTrace=function(c){var d=this.elements;d[0]=c.x;d[4]=c.y;d[8]=c.z};d.prototype.getTrace=function(c){c=c||new j;var d=this.elements;c.x=d[0];c.y=
d[4];c.z=d[8]};d.prototype.vmult=function(c,d){d=d||new j;var e=this.elements,f=c.x,m=c.y,n=c.z;d.x=e[0]*f+e[1]*m+e[2]*n;d.y=e[3]*f+e[4]*m+e[5]*n;d.z=e[6]*f+e[7]*m+e[8]*n;return d};d.prototype.smult=function(c){for(var d=0;d<this.elements.length;d++)this.elements[d]*=c};d.prototype.mmult=function(c,e){for(var j=e||new d,f=0;3>f;f++)for(var m=0;3>m;m++){for(var n=0,r=0;3>r;r++)n+=c.elements[f+3*r]*this.elements[r+3*m];j.elements[f+3*m]=n}return j};d.prototype.scale=function(c,e){e=e||new d;for(var j=
this.elements,f=e.elements,m=0;3!==m;m++)f[3*m+0]=c.x*j[3*m+0],f[3*m+1]=c.y*j[3*m+1],f[3*m+2]=c.z*j[3*m+2];return e};d.prototype.solve=function(c,d){d=d||new j;for(var e=[],f=0;12>f;f++)e.push(0);for(var m,f=0;3>f;f++)for(m=0;3>m;m++)e[f+4*m]=this.elements[f+3*m];e[3]=c.x;e[7]=c.y;e[11]=c.z;var n=3,r=n,s,t;do{f=r-n;if(0===e[f+4*f])for(m=f+1;m<r;m++)if(0!==e[f+4*m]){s=4;do t=4-s,e[t+4*f]+=e[t+4*m];while(--s);break}if(0!==e[f+4*f])for(m=f+1;m<r;m++){var u=e[f+4*m]/e[f+4*f];s=4;do t=4-s,e[t+4*m]=t<=
f?0:e[t+4*m]-e[t+4*f]*u;while(--s)}}while(--n);d.z=e[11]/e[10];d.y=(e[7]-e[6]*d.z)/e[5];d.x=(e[3]-e[2]*d.z-e[1]*d.y)/e[0];if(isNaN(d.x)||isNaN(d.y)||isNaN(d.z)||Infinity===d.x||Infinity===d.y||Infinity===d.z)throw"Could not solve equation! Got x=["+d.toString()+"], b=["+c.toString()+"], A=["+this.toString()+"]";return d};d.prototype.e=function(c,d,e){if(void 0===e)return this.elements[d+3*c];this.elements[d+3*c]=e};d.prototype.copy=function(c){for(var d=0;d<c.elements.length;d++)this.elements[d]=
c.elements[d];return this};d.prototype.toString=function(){for(var c="",d=0;9>d;d++)c+=this.elements[d]+",";return c};d.prototype.reverse=function(c){c=c||new d;for(var e=[],j=0;18>j;j++)e.push(0);for(var f,j=0;3>j;j++)for(f=0;3>f;f++)e[j+6*f]=this.elements[j+3*f];e[3]=1;e[9]=0;e[15]=0;e[4]=0;e[10]=1;e[16]=0;e[5]=0;e[11]=0;e[17]=1;var m=3,n=m,r,s;do{j=n-m;if(0===e[j+6*j])for(f=j+1;f<n;f++)if(0!==e[j+6*f]){r=6;do s=6-r,e[s+6*j]+=e[s+6*f];while(--r);break}if(0!==e[j+6*j])for(f=j+1;f<n;f++){var t=e[j+
6*f]/e[j+6*j];r=6;do s=6-r,e[s+6*f]=s<=j?0:e[s+6*f]-e[s+6*j]*t;while(--r)}}while(--m);j=2;do{f=j-1;do{t=e[j+6*f]/e[j+6*j];r=6;do s=6-r,e[s+6*f]-=e[s+6*j]*t;while(--r)}while(f--)}while(--j);j=2;do{t=1/e[j+6*j];r=6;do s=6-r,e[s+6*j]*=t;while(--r)}while(j--);j=2;do{f=2;do{s=e[3+f+6*j];if(isNaN(s)||Infinity===s)throw"Could not reverse! A=["+this.toString()+"]";c.e(j,f,s)}while(f--)}while(j--);return c};d.prototype.setRotationFromQuaternion=function(c){var d=c.x,e=c.y,f=c.z,j=c.w,n=d+d,r=e+e,s=f+f;c=d*
n;var t=d*r,d=d*s,u=e*r,e=e*s,f=f*s,n=j*n,r=j*r,j=j*s,s=this.elements;s[0]=1-(u+f);s[1]=t-j;s[2]=d+r;s[3]=t+j;s[4]=1-(c+f);s[5]=e-n;s[6]=d-r;s[7]=e+n;s[8]=1-(c+u);return this};d.prototype.transpose=function(c){c=c||new d;for(var e=c.elements,j=this.elements,f=0;3!==f;f++)for(var m=0;3!==m;m++)e[3*f+m]=j[3*m+f];return c}},{"./Vec3":30}],28:[function(c,e){function d(c,f,d,e){this.x=void 0!==c?c:0;this.y=void 0!==f?f:0;this.z=void 0!==d?d:0;this.w=void 0!==e?e:1}e.exports=d;var j=c("./Vec3");d.prototype.set=
function(c,f,d,e){this.x=c;this.y=f;this.z=d;this.w=e};d.prototype.toString=function(){return this.x+","+this.y+","+this.z+","+this.w};d.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]};d.prototype.setFromAxisAngle=function(c,f){var d=Math.sin(0.5*f);this.x=c.x*d;this.y=c.y*d;this.z=c.z*d;this.w=Math.cos(0.5*f)};d.prototype.toAxisAngle=function(c){c=c||new j;this.normalize();var f=2*Math.acos(this.w),d=Math.sqrt(1-this.w*this.w);0.001>d?(c.x=this.x,c.y=this.y,c.z=this.z):(c.x=this.x/
d,c.y=this.y/d,c.z=this.z/d);return[c,f]};var g=new j,p=new j;d.prototype.setFromVectors=function(c,f){if(c.isAntiparallelTo(f))c.tangents(g,p),this.setFromAxisAngle(g,Math.PI);else{var d=c.cross(f);this.x=d.x;this.y=d.y;this.z=d.z;this.w=Math.sqrt(Math.pow(c.norm(),2)*Math.pow(f.norm(),2))+c.dot(f);this.normalize()}};var l=new j,f=new j,m=new j;d.prototype.mult=function(c,e){e=e||new d;var g=this.w;l.set(this.x,this.y,this.z);f.set(c.x,c.y,c.z);e.w=g*c.w-l.dot(f);l.cross(f,m);e.x=g*f.x+c.w*l.x+m.x;
e.y=g*f.y+c.w*l.y+m.y;e.z=g*f.z+c.w*l.z+m.z;return e};d.prototype.inverse=function(c){var f=this.x,e=this.y,g=this.z,j=this.w;c=c||new d;this.conjugate(c);f=1/(f*f+e*e+g*g+j*j);c.x*=f;c.y*=f;c.z*=f;c.w*=f;return c};d.prototype.conjugate=function(c){c=c||new d;c.x=-this.x;c.y=-this.y;c.z=-this.z;c.w=this.w;return c};d.prototype.normalize=function(){var c=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);0===c?this.w=this.z=this.y=this.x=0:(c=1/c,this.x*=c,this.y*=c,this.z*=c,this.w*=
c)};d.prototype.normalizeFast=function(){var c=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;0===c?this.w=this.z=this.y=this.x=0:(this.x*=c,this.y*=c,this.z*=c,this.w*=c)};d.prototype.vmult=function(c,f){f=f||new j;var d=c.x,e=c.y,g=c.z,m=this.x,l=this.y,p=this.z,C=this.w,B=C*d+l*g-p*e,E=C*e+p*d-m*g,I=C*g+m*e-l*d,d=-m*d-l*e-p*g;f.x=B*C+d*-m+E*-p-I*-l;f.y=E*C+d*-l+I*-m-B*-p;f.z=I*C+d*-p+B*-l-E*-m;return f};d.prototype.copy=function(c){this.x=c.x;this.y=c.y;this.z=c.z;this.w=c.w;return this};
d.prototype.toEuler=function(c,f){f=f||"YZX";var d,e,g,j=this.x,m=this.y,l=this.z,p=this.w;switch(f){case "YZX":var B=j*m+l*p;0.499<B&&(d=2*Math.atan2(j,p),e=Math.PI/2,g=0);-0.499>B&&(d=-2*Math.atan2(j,p),e=-Math.PI/2,g=0);if(isNaN(d)){g=j*j;var E=l*l;d=Math.atan2(2*m*p-2*j*l,1-2*m*m-2*E);e=Math.asin(2*B);g=Math.atan2(2*j*p-2*m*l,1-2*g-2*E)}break;default:throw Error("Euler order "+f+" not supported yet.");}c.y=d;c.z=e;c.x=g};d.prototype.setFromEuler=function(c,f,d,e){e=e||"XYZ";var g=Math.cos(c/2),
j=Math.cos(f/2),m=Math.cos(d/2);c=Math.sin(c/2);f=Math.sin(f/2);d=Math.sin(d/2);"XYZ"===e?(this.x=c*j*m+g*f*d,this.y=g*f*m-c*j*d,this.z=g*j*d+c*f*m,this.w=g*j*m-c*f*d):"YXZ"===e?(this.x=c*j*m+g*f*d,this.y=g*f*m-c*j*d,this.z=g*j*d-c*f*m,this.w=g*j*m+c*f*d):"ZXY"===e?(this.x=c*j*m-g*f*d,this.y=g*f*m+c*j*d,this.z=g*j*d+c*f*m,this.w=g*j*m-c*f*d):"ZYX"===e?(this.x=c*j*m-g*f*d,this.y=g*f*m+c*j*d,this.z=g*j*d-c*f*m,this.w=g*j*m+c*f*d):"YZX"===e?(this.x=c*j*m+g*f*d,this.y=g*f*m+c*j*d,this.z=g*j*d-c*f*m,this.w=
g*j*m-c*f*d):"XZY"===e&&(this.x=c*j*m-g*f*d,this.y=g*f*m-c*j*d,this.z=g*j*d+c*f*m,this.w=g*j*m+c*f*d);return this};d.prototype.clone=function(){return new d(this.x,this.y,this.z,this.w)}},{"./Vec3":30}],29:[function(c,e){function d(c){c=c||{};this.position=new j;c.position&&this.position.copy(c.position);this.quaternion=new g;c.quaternion&&this.quaternion.copy(c.quaternion)}var j=c("./Vec3"),g=c("./Quaternion");e.exports=d;var p=new g;d.pointToLocalFrame=function(c,f,d,e){e=e||new j;d.vsub(c,e);f.conjugate(p);
p.vmult(e,e);return e};d.prototype.pointToLocal=function(c,f){return d.pointToLocalFrame(this.position,this.quaternion,c,f)};d.pointToWorldFrame=function(c,f,d,e){e=e||new j;f.vmult(d,e);e.vadd(c,e);return e};d.prototype.pointToWorld=function(c,f){return d.pointToWorldFrame(this.position,this.quaternion,c,f)};d.prototype.vectorToWorldFrame=function(c,f){f=f||new j;this.quaternion.vmult(c,f);return f};d.vectorToWorldFrame=function(c,f,d){c.vmult(f,d);return d};d.vectorToLocalFrame=function(c,f,d,e){e=
e||new j;f.w*=-1;f.vmult(d,e);f.w*=-1;return e}},{"./Quaternion":28,"./Vec3":30}],30:[function(c,e){function d(c,d,e){this.x=c||0;this.y=d||0;this.z=e||0}e.exports=d;var j=c("./Mat3");d.ZERO=new d(0,0,0);d.UNIT_X=new d(1,0,0);d.UNIT_Y=new d(0,1,0);d.UNIT_Z=new d(0,0,1);d.prototype.cross=function(c,e){var g=c.x,j=c.y,l=c.z,p=this.x,u=this.y,v=this.z;e=e||new d;e.x=u*l-v*j;e.y=v*g-p*l;e.z=p*j-u*g;return e};d.prototype.set=function(c,d,e){this.x=c;this.y=d;this.z=e;return this};d.prototype.setZero=function(){this.x=
this.y=this.z=0};d.prototype.vadd=function(c,e){if(e)e.x=c.x+this.x,e.y=c.y+this.y,e.z=c.z+this.z;else return new d(this.x+c.x,this.y+c.y,this.z+c.z)};d.prototype.vsub=function(c,e){if(e)e.x=this.x-c.x,e.y=this.y-c.y,e.z=this.z-c.z;else return new d(this.x-c.x,this.y-c.y,this.z-c.z)};d.prototype.crossmat=function(){return new j([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])};d.prototype.normalize=function(){var c=this.x,d=this.y,e=this.z,c=Math.sqrt(c*c+d*d+e*e);0<c?(d=1/c,this.x*=d,this.y*=
d,this.z*=d):this.z=this.y=this.x=0;return c};d.prototype.unit=function(c){c=c||new d;var e=this.x,g=this.y,j=this.z,l=Math.sqrt(e*e+g*g+j*j);0<l?(l=1/l,c.x=e*l,c.y=g*l,c.z=j*l):(c.x=1,c.y=0,c.z=0);return c};d.prototype.norm=function(){var c=this.x,d=this.y,e=this.z;return Math.sqrt(c*c+d*d+e*e)};d.prototype.length=d.prototype.norm;d.prototype.norm2=function(){return this.dot(this)};d.prototype.lengthSquared=d.prototype.norm2;d.prototype.distanceTo=function(c){var d=this.x,e=this.y,g=this.z,j=c.x,
l=c.y;c=c.z;return Math.sqrt((j-d)*(j-d)+(l-e)*(l-e)+(c-g)*(c-g))};d.prototype.distanceSquared=function(c){var d=this.x,e=this.y,g=this.z,j=c.x,l=c.y;c=c.z;return(j-d)*(j-d)+(l-e)*(l-e)+(c-g)*(c-g)};d.prototype.mult=function(c,e){e=e||new d;var g=this.y,j=this.z;e.x=c*this.x;e.y=c*g;e.z=c*j;return e};d.prototype.scale=d.prototype.mult;d.prototype.dot=function(c){return this.x*c.x+this.y*c.y+this.z*c.z};d.prototype.isZero=function(){return 0===this.x&&0===this.y&&0===this.z};d.prototype.negate=function(c){c=
c||new d;c.x=-this.x;c.y=-this.y;c.z=-this.z;return c};var g=new d,p=new d;d.prototype.tangents=function(c,d){var e=this.norm();0<e?(e=1/e,g.set(this.x*e,this.y*e,this.z*e),0.9>Math.abs(g.x)?p.set(1,0,0):p.set(0,1,0),g.cross(p,c),g.cross(c,d)):(c.set(1,0,0),d.set(0,1,0))};d.prototype.toString=function(){return this.x+","+this.y+","+this.z};d.prototype.toArray=function(){return[this.x,this.y,this.z]};d.prototype.copy=function(c){this.x=c.x;this.y=c.y;this.z=c.z;return this};d.prototype.lerp=function(c,
d,e){var g=this.x,j=this.y,l=this.z;e.x=g+(c.x-g)*d;e.y=j+(c.y-j)*d;e.z=l+(c.z-l)*d};d.prototype.almostEquals=function(c,d){void 0===d&&(d=1E-6);return Math.abs(this.x-c.x)>d||Math.abs(this.y-c.y)>d||Math.abs(this.z-c.z)>d?!1:!0};d.prototype.almostZero=function(c){void 0===c&&(c=1E-6);return Math.abs(this.x)>c||Math.abs(this.y)>c||Math.abs(this.z)>c?!1:!0};var l=new d;d.prototype.isAntiparallelTo=function(c,d){this.negate(l);return l.almostEquals(c,d)};d.prototype.clone=function(){return new d(this.x,
this.y,this.z)}},{"./Mat3":27}],31:[function(c,e){function d(c){c=c||{};j.apply(this);this.id=d.idCounter++;this.postStep=this.preStep=this.world=null;this.vlambda=new g;this.collisionFilterGroup="number"===typeof c.collisionFilterGroup?c.collisionFilterGroup:1;this.collisionFilterMask="number"===typeof c.collisionFilterMask?c.collisionFilterMask:1;this.collisionResponse=!0;this.position=new g;c.position&&this.position.copy(c.position);this.previousPosition=new g;this.initPosition=new g;this.velocity=
new g;c.velocity&&this.velocity.copy(c.velocity);this.initVelocity=new g;this.force=new g;var e="number"===typeof c.mass?c.mass:0;this.mass=e;this.invMass=0<e?1/e:0;this.material=c.material||null;this.linearDamping="number"===typeof c.linearDamping?c.linearDamping:0.01;this.type=0>=e?d.STATIC:d.DYNAMIC;typeof c.type===typeof d.STATIC&&(this.type=c.type);this.allowSleep="undefined"!==typeof c.allowSleep?c.allowSleep:!0;this.sleepState=0;this.sleepSpeedLimit="undefined"!==typeof c.sleepSpeedLimit?c.sleepSpeedLimit:
0.1;this.sleepTimeLimit="undefined"!==typeof c.sleepTimeLimit?c.sleepTimeLimit:1;this.timeLastSleepy=0;this._wakeUpAfterNarrowphase=!1;this.torque=new g;this.quaternion=new l;c.quaternion&&this.quaternion.copy(c.quaternion);this.initQuaternion=new l;this.angularVelocity=new g;c.angularVelocity&&this.angularVelocity.copy(c.angularVelocity);this.initAngularVelocity=new g;this.interpolatedPosition=new g;this.interpolatedQuaternion=new l;this.shapes=[];this.shapeOffsets=[];this.shapeOrientations=[];this.inertia=
new g;this.invInertia=new g;this.invInertiaWorld=new p;this.invMassSolve=0;this.invInertiaSolve=new g;this.invInertiaWorldSolve=new p;this.fixedRotation="undefined"!==typeof c.fixedRotation?c.fixedRotation:!1;this.angularDamping="undefined"!==typeof c.angularDamping?c.angularDamping:0.01;this.aabb=new f;this.aabbNeedsUpdate=!0;this.wlambda=new g;c.shape&&this.addShape(c.shape);this.updateMassProperties()}e.exports=d;var j=c("../utils/EventTarget");c("../shapes/Shape");var g=c("../math/Vec3"),p=c("../math/Mat3"),
l=c("../math/Quaternion");c("../material/Material");var f=c("../collision/AABB"),m=c("../shapes/Box");d.prototype=new j;d.prototype.constructor=d;d.DYNAMIC=1;d.STATIC=2;d.KINEMATIC=4;d.AWAKE=0;d.SLEEPY=1;d.SLEEPING=2;d.idCounter=0;d.prototype.wakeUp=function(){var c=this.sleepState;this.sleepState=0;c===d.SLEEPING&&this.dispatchEvent({type:"wakeup"})};d.prototype.sleep=function(){this.sleepState=d.SLEEPING;this.velocity.set(0,0,0);this.angularVelocity.set(0,0,0)};d.sleepyEvent={type:"sleepy"};d.sleepEvent=
{type:"sleep"};d.prototype.sleepTick=function(c){if(this.allowSleep){var f=this.sleepState,e=this.velocity.norm2()+this.angularVelocity.norm2(),g=Math.pow(this.sleepSpeedLimit,2);f===d.AWAKE&&e<g?(this.sleepState=d.SLEEPY,this.timeLastSleepy=c,this.dispatchEvent(d.sleepyEvent)):f===d.SLEEPY&&e>g?this.wakeUp():f===d.SLEEPY&&c-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(d.sleepEvent))}};d.prototype.updateSolveMassProperties=function(){this.sleepState===d.SLEEPING||this.type===
d.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))};d.prototype.pointToLocalFrame=function(c,d){d=d||new g;c.vsub(this.position,d);this.quaternion.conjugate().vmult(d,d);return d};d.prototype.vectorToLocalFrame=function(c,d){d=d||new g;this.quaternion.conjugate().vmult(c,d);return d};d.prototype.pointToWorldFrame=function(c,
d){d=d||new g;this.quaternion.vmult(c,d);d.vadd(this.position,d);return d};d.prototype.vectorToWorldFrame=function(c,d){d=d||new g;this.quaternion.vmult(c,d);return d};var n=new g,r=new l;d.prototype.addShape=function(c,d,f){var e=new g,j=new l;d&&e.copy(d);f&&j.copy(f);this.shapes.push(c);this.shapeOffsets.push(e);this.shapeOrientations.push(j);this.updateMassProperties();this.updateBoundingRadius();this.aabbNeedsUpdate=!0;return this};d.prototype.updateBoundingRadius=function(){for(var c=this.shapes,
d=this.shapeOffsets,f=c.length,e=0,g=0;g!==f;g++){var j=c[g];j.updateBoundingSphereRadius();var m=d[g].norm(),j=j.boundingSphereRadius;m+j>e&&(e=m+j)}this.boundingRadius=e};var s=new f;d.prototype.computeAABB=function(){for(var c=this.shapes,d=this.shapeOffsets,f=this.shapeOrientations,e=c.length,g=this.quaternion,j=this.aabb,m=0;m!==e;m++){var l=c[m];f[m].mult(g,r);r.vmult(d[m],n);n.vadd(this.position,n);l.calculateWorldAABB(n,r,s.lowerBound,s.upperBound);0===m?j.copy(s):j.extend(s)}this.aabbNeedsUpdate=
!1};var t=new p,u=new p;new p;d.prototype.updateInertiaWorld=function(c){var d=this.invInertia;d.x===d.y&&d.y===d.z&&!c||(t.setRotationFromQuaternion(this.quaternion),t.transpose(u),t.scale(d,t),t.mmult(u,this.invInertiaWorld))};var v=new g,z=new g;d.prototype.applyForce=function(c,f){this.type===d.DYNAMIC&&(f.vsub(this.position,v),v.cross(c,z),this.force.vadd(c,this.force),this.torque.vadd(z,this.torque))};var x=new g,C=new g;d.prototype.applyLocalForce=function(c,f){this.type===d.DYNAMIC&&(this.vectorToWorldFrame(c,
x),this.pointToWorldFrame(f,C),this.applyForce(x,C))};var B=new g,E=new g,I=new g;d.prototype.applyImpulse=function(c,f){this.type===d.DYNAMIC&&(f.vsub(this.position,B),E.copy(c),E.mult(this.invMass,E),this.velocity.vadd(E,this.velocity),B.cross(c,I),this.invInertiaWorld.vmult(I,I),this.angularVelocity.vadd(I,this.angularVelocity))};var y=new g,D=new g;d.prototype.applyLocalImpulse=function(c,f){this.type===d.DYNAMIC&&(this.vectorToWorldFrame(c,y),this.pointToWorldFrame(f,D),this.applyImpulse(y,D))};
var H=new g;d.prototype.updateMassProperties=function(){this.invMass=0<this.mass?1/this.mass:0;var c=this.inertia,d=this.fixedRotation;this.computeAABB();H.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2);m.calculateInertia(H,this.mass,c);this.invInertia.set(0<c.x&&!d?1/c.x:0,0<c.y&&!d?1/c.y:0,0<c.z&&!d?1/c.z:0);this.updateInertiaWorld(!0)};d.prototype.getVelocityAtWorldPoint=function(c,d){var f=
new g;c.vsub(this.position,f);this.angularVelocity.cross(f,d);this.velocity.vadd(d,d);return d}},{"../collision/AABB":3,"../material/Material":25,"../math/Mat3":27,"../math/Quaternion":28,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Shape":43,"../utils/EventTarget":49}],32:[function(c,e){function d(c){this.chassisBody=c.chassisBody;this.wheelInfos=[];this.sliding=!1;this.world=null;this.indexRightAxis="undefined"!==typeof c.indexRightAxis?c.indexRightAxis:1;this.indexForwardAxis="undefined"!==
typeof c.indexForwardAxis?c.indexForwardAxis:0;this.indexUpAxis="undefined"!==typeof c.indexUpAxis?c.indexUpAxis:2}function j(c,d,f){var e=I,g=y,j=D,m=H;d.vsub(c.position,e);e.cross(f,g);c.invInertiaWorld.vmult(g,m);m.cross(e,j);return c.invMass+f.dot(j)}c("./Body");var g=c("../math/Vec3"),p=c("../math/Quaternion");c("../collision/RaycastResult");var l=c("../collision/Ray"),f=c("../objects/WheelInfo");e.exports=d;new g;new g;new g;var m=new g,n=new g,r=new g;new l;d.prototype.addWheel=function(c){c=
c||{};c=new f(c);var d=this.wheelInfos.length;this.wheelInfos.push(c);return d};d.prototype.setSteeringValue=function(c,d){this.wheelInfos[d].steering=c};new g;d.prototype.applyEngineForce=function(c,d){this.wheelInfos[d].engineForce=c};d.prototype.setBrake=function(c,d){this.wheelInfos[d].brake=c};d.prototype.addToWorld=function(c){c.add(this.chassisBody);var d=this;this.preStepCallback=function(){d.updateVehicle(c.dt)};c.addEventListener("preStep",this.preStepCallback);this.world=c};d.prototype.getVehicleAxisWorld=
function(c,d){d.set(0===c?1:0,1===c?1:0,2===c?1:0);this.chassisBody.vectorToWorldFrame(d,d)};d.prototype.updateVehicle=function(c){for(var d=this.wheelInfos,f=d.length,e=this.chassisBody,j=0;j<f;j++)this.updateWheelTransform(j);this.currentVehicleSpeedKmHour=3.6*e.velocity.norm();j=new g;this.getVehicleAxisWorld(this.indexForwardAxis,j);0>j.dot(e.velocity)&&(this.currentVehicleSpeedKmHour*=-1);for(j=0;j<f;j++)this.castRay(d[j]);this.updateSuspension(c);for(var m=new g,n=new g,j=0;j<f;j++){var l=d[j],
r=l.suspensionForce;r>l.maxSuspensionForce&&(r=l.maxSuspensionForce);l.raycastResult.hitNormalWorld.scale(r*c,m);l.raycastResult.hitPointWorld.vsub(e.position,n);e.applyImpulse(m,l.raycastResult.hitPointWorld)}this.updateFriction(c);m=new g;n=new g;r=new g;for(j=0;j<f;j++){l=d[j];e.getVelocityAtWorldPoint(l.chassisConnectionPointWorld,r);var s=1;switch(this.indexUpAxis){case 1:s=-1}if(l.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,n);var p=n.dot(l.raycastResult.hitNormalWorld);l.raycastResult.hitNormalWorld.scale(p,
m);n.vsub(m,n);p=n.dot(r);l.deltaRotation=s*p*c/l.radius}if((l.sliding||!l.isInContact)&&0!==l.engineForce&&l.useCustomSlidingRotationalSpeed)l.deltaRotation=(0<l.engineForce?1:-1)*l.customSlidingRotationalSpeed*c;Math.abs(l.brake)>Math.abs(l.engineForce)&&(l.deltaRotation=0);l.rotation+=l.deltaRotation;l.deltaRotation*=0.99}};d.prototype.updateSuspension=function(){for(var c=this.chassisBody.mass,d=this.wheelInfos,f=d.length,e=0;e<f;e++){var g=d[e];if(g.isInContact){var j;j=g.suspensionStiffness*
(g.suspensionRestLength-g.suspensionLength)*g.clippedInvContactDotSuspension;var m=g.suspensionRelativeVelocity;j-=(0>m?g.dampingCompression:g.dampingRelaxation)*m;g.suspensionForce=j*c;0>g.suspensionForce&&(g.suspensionForce=0)}else g.suspensionForce=0}};d.prototype.removeFromWorld=function(c){c.remove(this.chassisBody);c.removeEventListener("preStep",this.preStepCallback);this.world=null};var s=new g,t=new g;d.prototype.castRay=function(c){this.updateWheelTransformWorld(c);var d=this.chassisBody,
f=-1;c.directionWorld.scale(c.suspensionRestLength+c.radius,s);var e=c.chassisConnectionPointWorld;e.vadd(s,t);var j=c.raycastResult;j.reset();var m=d.collisionResponse;d.collisionResponse=!1;this.world.rayTest(e,t,j);d.collisionResponse=m;e=j.body;c.raycastResult.groundObject=0;e?(f=j.distance,c.raycastResult.hitNormalWorld=j.hitNormalWorld,c.isInContact=!0,c.suspensionLength=j.distance-c.radius,j=c.suspensionRestLength-c.maxSuspensionTravel,e=c.suspensionRestLength+c.maxSuspensionTravel,c.suspensionLength<
j&&(c.suspensionLength=j),c.suspensionLength>e&&(c.suspensionLength=e,c.raycastResult.reset()),j=c.raycastResult.hitNormalWorld.dot(c.directionWorld),e=new g,d.getVelocityAtWorldPoint(c.raycastResult.hitPointWorld,e),d=c.raycastResult.hitNormalWorld.dot(e),-0.1<=j?(c.suspensionRelativeVelocity=0,c.clippedInvContactDotSuspension=10):(j=-1/j,c.suspensionRelativeVelocity=d*j,c.clippedInvContactDotSuspension=j)):(c.suspensionLength=c.suspensionRestLength+0*c.maxSuspensionTravel,c.suspensionRelativeVelocity=
0,c.directionWorld.scale(-1,c.raycastResult.hitNormalWorld),c.clippedInvContactDotSuspension=1);return f};d.prototype.updateWheelTransformWorld=function(c){c.isInContact=!1;var d=this.chassisBody;d.pointToWorldFrame(c.chassisConnectionPointLocal,c.chassisConnectionPointWorld);d.vectorToWorldFrame(c.directionLocal,c.directionWorld);d.vectorToWorldFrame(c.axleLocal,c.axleWorld)};d.prototype.updateWheelTransform=function(c){c=this.wheelInfos[c];this.updateWheelTransformWorld(c);c.directionLocal.scale(-1,
m);n.copy(c.axleLocal);m.cross(n,r);r.normalize();n.normalize();var d=c.steering,f=new p;f.setFromAxisAngle(m,d);d=new p;d.setFromAxisAngle(n,c.rotation);var e=c.worldTransform.quaternion;this.chassisBody.quaternion.mult(f,e);e.mult(d,e);e.normalize();f=c.worldTransform.position;f.copy(c.directionWorld);f.scale(c.suspensionLength,f);f.vadd(c.chassisConnectionPointWorld,f)};var u=[new g(1,0,0),new g(0,1,0),new g(0,0,1)];d.prototype.getWheelTransformWorld=function(c){return this.wheelInfos[c].worldTransform};
var v=new g,z=[],x=[];d.prototype.updateFriction=function(c){for(var d=this.wheelInfos,f=d.length,e=this.chassisBody,m=0,n=0;n<f;n++){var l=d[n],r=l.raycastResult.body;r&&m++;l.sideImpulse=0;l.forwardImpulse=0;x[n]||(x[n]=new g);z[n]||(z[n]=new g)}for(n=0;n<f;n++)if(l=d[n],r=l.raycastResult.body){var s=z[n];this.getWheelTransformWorld(n).vectorToWorldFrame(u[this.indexRightAxis],s);var m=l.raycastResult.hitNormalWorld,p=s.dot(m);m.scale(p,v);s.vsub(v,s);s.normalize();m.cross(s,x[n]);x[n].normalize();
m=l;var p=e,t=l.raycastResult.hitPointWorld,y=l.raycastResult.hitPointWorld,D=void 0;if(1.1<s.norm2())r=0;else{var D=M,H=S,ea=Q;p.getVelocityAtWorldPoint(t,D);r.getVelocityAtWorldPoint(y,H);D.vsub(H,ea);r=D=-0.2*s.dot(ea)*(1/(p.invMass+r.invMass))}m.sideImpulse=r;l.sideImpulse*=1}this.sliding=!1;for(n=0;n<f;n++){l=d[n];r=l.raycastResult.body;p=0;l.slipInfo=1;if(r){var m=l.brake?l.brake:0,D=e,t=r,y=l.raycastResult.hitPointWorld,s=x[n],p=m,H=0,H=y,ea=C,ba=B,A=E;D.getVelocityAtWorldPoint(H,ea);t.getVelocityAtWorldPoint(H,
ba);ea.vsub(ba,A);H=s.dot(A);D=j(D,y,s);t=j(t,y,s);H=-H*(1/(D+t));p<H&&(H=p);H<-p&&(H=-p);p=H;p+=l.engineForce*c;m/=p;l.slipInfo*=m}l.forwardImpulse=0;l.skidInfo=1;r&&(l.skidInfo=1,r=l.suspensionForce*c*l.frictionSlip,m=r*r,l.forwardImpulse=p,p=0.5*l.forwardImpulse,t=1*l.sideImpulse,p=p*p+t*t,l.sliding=!1,p>m&&(this.sliding=!0,l.sliding=!0,m=r/Math.sqrt(p),l.skidInfo*=m))}if(this.sliding)for(n=0;n<f;n++)l=d[n],0!==l.sideImpulse&&1>l.skidInfo&&(l.forwardImpulse*=l.skidInfo,l.sideImpulse*=l.skidInfo);
for(n=0;n<f;n++)l=d[n],c=new g,c.copy(l.raycastResult.hitPointWorld),0!==l.forwardImpulse&&(r=new g,x[n].scale(l.forwardImpulse,r),e.applyImpulse(r,c)),0!==l.sideImpulse&&(r=l.raycastResult.body,m=new g,m.copy(l.raycastResult.hitPointWorld),p=new g,z[n].scale(l.sideImpulse,p),e.pointToLocalFrame(c,c),c["xyz"[this.indexUpAxis]]*=l.rollInfluence,e.pointToWorldFrame(c,c),e.applyImpulse(p,c),p.scale(-1,p),r.applyImpulse(p,m))};var C=new g,B=new g,E=new g,I=new g,y=new g,D=new g,H=new g,M=new g,S=new g,
Q=new g},{"../collision/Ray":9,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Vec3":30,"../objects/WheelInfo":36,"./Body":31}],33:[function(c,e){function d(c){this.wheelBodies=[];this.coordinateSystem="undefined"===typeof c.coordinateSystem?new l(1,2,3):c.coordinateSystem.clone();this.chassisBody=c.chassisBody;this.chassisBody||(c=new p(new l(5,2,0.5)),this.chassisBody=new j(1,c));this.constraints=[];this.wheelAxes=[];this.wheelForces=[]}var j=c("./Body"),g=c("../shapes/Sphere"),
p=c("../shapes/Box"),l=c("../math/Vec3"),f=c("../constraints/HingeConstraint");e.exports=d;d.prototype.addWheel=function(c){c=c||{};var d=c.body;d||(d=new j(1,new g(1.2)));this.wheelBodies.push(d);this.wheelForces.push(0);new l;var e="undefined"!==typeof c.position?c.position.clone():new l,m=new l;this.chassisBody.pointToWorldFrame(e,m);d.position.set(m.x,m.y,m.z);c="undefined"!==typeof c.axis?c.axis.clone():new l(0,1,0);this.wheelAxes.push(c);d=new f(this.chassisBody,d,{pivotA:e,axisA:c,pivotB:l.ZERO,
axisB:c,collideConnected:!1});this.constraints.push(d);return this.wheelBodies.length-1};d.prototype.setSteeringValue=function(c,d){var f=this.wheelAxes[d],e=Math.cos(c),g=Math.sin(c),j=f.x,f=f.y;this.constraints[d].axisA.set(e*j-g*f,g*j+e*f,0)};d.prototype.setMotorSpeed=function(c,d){var f=this.constraints[d];f.enableMotor();f.motorTargetVelocity=c};d.prototype.disableMotor=function(c){this.constraints[c].disableMotor()};var m=new l;d.prototype.setWheelForce=function(c,d){this.wheelForces[d]=c};
d.prototype.applyWheelForce=function(c,d){var f=this.wheelBodies[d],e=f.torque;this.wheelAxes[d].scale(c,m);f.vectorToWorldFrame(m,m);e.vadd(m,e)};d.prototype.addToWorld=function(c){for(var d=this.constraints,f=this.wheelBodies.concat([this.chassisBody]),e=0;e<f.length;e++)c.add(f[e]);for(e=0;e<d.length;e++)c.addConstraint(d[e]);c.addEventListener("preStep",this._update.bind(this))};d.prototype._update=function(){for(var c=this.wheelForces,d=0;d<c.length;d++)this.applyWheelForce(c[d],d)};d.prototype.removeFromWorld=
function(c){for(var d=this.constraints,f=this.wheelBodies.concat([this.chassisBody]),e=0;e<f.length;e++)c.remove(f[e]);for(e=0;e<d.length;e++)c.removeConstraint(d[e])};var n=new l;d.prototype.getWheelSpeed=function(c){var d=this.wheelBodies[c].angularVelocity;this.chassisBody.vectorToWorldFrame(this.wheelAxes[c],n);return d.dot(n)}},{"../constraints/HingeConstraint":15,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Sphere":44,"./Body":31}],34:[function(c,e){function d(){this.particles=[];this.speedOfSound=
this.smoothingRadius=this.density=1;this.viscosity=0.01;this.eps=1E-6;this.pressures=[];this.densities=[];this.neighbors=[]}e.exports=d;c("../shapes/Shape");var j=c("../math/Vec3");c("../math/Quaternion");c("../shapes/Particle");c("../objects/Body");c("../material/Material");d.prototype.add=function(c){this.particles.push(c);this.neighbors.length<this.particles.length&&this.neighbors.push([])};d.prototype.remove=function(c){c=this.particles.indexOf(c);-1!==c&&(this.particles.splice(c,1),this.neighbors.length>
this.particles.length&&this.neighbors.pop())};var g=new j;d.prototype.getNeighbors=function(c,d){for(var f=this.particles.length,e=c.id,j=this.smoothingRadius*this.smoothingRadius,m=0;m!==f;m++){var n=this.particles[m];n.position.vsub(c.position,g);e!==n.id&&g.norm2()<j&&d.push(n)}};var p=new j,l=new j,f=new j,m=new j,n=new j,r=new j;d.prototype.update=function(){for(var c=this.particles.length,d=this.speedOfSound,e=this.eps,g=0;g!==c;g++){var j=this.particles[g],x=this.neighbors[g];x.length=0;this.getNeighbors(j,
x);x.push(this.particles[g]);for(var C=x.length,B=0,E=0;E!==C;E++){j.position.vsub(x[E].position,p);var I=p.norm(),I=this.w(I),B=B+x[E].mass*I}this.densities[g]=B;this.pressures[g]=d*d*(this.densities[g]-this.density)}for(g=0;g!==c;g++){d=this.particles[g];l.set(0,0,0);f.set(0,0,0);x=this.neighbors[g];C=x.length;for(E=0;E!==C;E++)B=x[E],d.position.vsub(B.position,n),I=n.norm(),j=-B.mass*(this.pressures[g]/(this.densities[g]*this.densities[g]+e)+this.pressures[E]/(this.densities[E]*this.densities[E]+
e)),this.gradw(n,m),m.mult(j,m),l.vadd(m,l),B.velocity.vsub(d.velocity,r),r.mult(1/(1E-4+this.densities[g]*this.densities[E])*this.viscosity*B.mass,r),j=this.nablaw(I),r.mult(j,r),f.vadd(r,f);f.mult(d.mass,f);l.mult(d.mass,l);d.force.vadd(f,d.force);d.force.vadd(l,d.force)}};d.prototype.w=function(c){var d=this.smoothingRadius;return 315/(64*Math.PI*Math.pow(d,9))*Math.pow(d*d-c*c,3)};d.prototype.gradw=function(c,d){var f=c.norm(),e=this.smoothingRadius;c.mult(945/(32*Math.PI*Math.pow(e,9))*Math.pow(e*
e-f*f,2),d)};d.prototype.nablaw=function(c){var d=this.smoothingRadius;return 945/(32*Math.PI*Math.pow(d,9))*(d*d-c*c)*(7*c*c-3*d*d)}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Particle":41,"../shapes/Shape":43}],35:[function(c,e){function d(c,d,f){f=f||{};this.restLength="number"===typeof f.restLength?f.restLength:1;this.stiffness=f.stiffness||100;this.damping=f.damping||1;this.bodyA=c;this.bodyB=d;this.localAnchorA=new j;this.localAnchorB=
new j;f.localAnchorA&&this.localAnchorA.copy(f.localAnchorA);f.localAnchorB&&this.localAnchorB.copy(f.localAnchorB);f.worldAnchorA&&this.setWorldAnchorA(f.worldAnchorA);f.worldAnchorB&&this.setWorldAnchorB(f.worldAnchorB)}var j=c("../math/Vec3");e.exports=d;d.prototype.setWorldAnchorA=function(c){this.bodyA.pointToLocalFrame(c,this.localAnchorA)};d.prototype.setWorldAnchorB=function(c){this.bodyB.pointToLocalFrame(c,this.localAnchorB)};d.prototype.getWorldAnchorA=function(c){this.bodyA.pointToWorldFrame(this.localAnchorA,
c)};d.prototype.getWorldAnchorB=function(c){this.bodyB.pointToWorldFrame(this.localAnchorB,c)};var g=new j,p=new j,l=new j,f=new j,m=new j,n=new j,r=new j,s=new j,t=new j,u=new j,v=new j;d.prototype.applyForce=function(){var c=this.stiffness,d=this.damping,e=this.restLength,j=this.bodyA,E=this.bodyB;this.getWorldAnchorA(m);this.getWorldAnchorB(n);m.vsub(j.position,r);n.vsub(E.position,s);n.vsub(m,g);var I=g.norm();p.copy(g);p.normalize();E.velocity.vsub(j.velocity,l);E.angularVelocity.cross(s,v);
l.vadd(v,l);j.angularVelocity.cross(r,v);l.vsub(v,l);p.mult(-c*(I-e)-d*l.dot(p),f);j.force.vsub(f,j.force);E.force.vadd(f,E.force);r.cross(f,t);s.cross(f,u);j.torque.vsub(t,j.torque);E.torque.vadd(u,E.torque)}},{"../math/Vec3":30}],36:[function(c,e){function d(c){c=l.defaults(c,{chassisConnectionPointLocal:new j,chassisConnectionPointWorld:new j,directionLocal:new j,directionWorld:new j,axleLocal:new j,axleWorld:new j,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,
dampingRelaxation:10,frictionSlip:1E4,steering:0,rotation:0,deltaRotation:0,rollInfluence:0.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-0.1});this.maxSuspensionTravel=c.maxSuspensionTravel;this.customSlidingRotationalSpeed=c.customSlidingRotationalSpeed;this.useCustomSlidingRotationalSpeed=c.useCustomSlidingRotationalSpeed;
this.sliding=!1;this.chassisConnectionPointLocal=c.chassisConnectionPointLocal.clone();this.chassisConnectionPointWorld=c.chassisConnectionPointWorld.clone();this.directionLocal=c.directionLocal.clone();this.directionWorld=c.directionWorld.clone();this.axleLocal=c.axleLocal.clone();this.axleWorld=c.axleWorld.clone();this.suspensionRestLength=c.suspensionRestLength;this.suspensionMaxLength=c.suspensionMaxLength;this.radius=c.radius;this.suspensionStiffness=c.suspensionStiffness;this.dampingCompression=
c.dampingCompression;this.dampingRelaxation=c.dampingRelaxation;this.frictionSlip=c.frictionSlip;this.deltaRotation=this.rotation=this.steering=0;this.rollInfluence=c.rollInfluence;this.maxSuspensionForce=c.maxSuspensionForce;this.brake=this.engineForce=0;this.isFrontWheel=c.isFrontWheel;this.clippedInvContactDotSuspension=1;this.forwardImpulse=this.sideImpulse=this.suspensionLength=this.skidInfo=this.suspensionForce=this.suspensionRelativeVelocity=0;this.raycastResult=new p;this.worldTransform=new g;
this.isInContact=!1}var j=c("../math/Vec3"),g=c("../math/Transform"),p=c("../collision/RaycastResult"),l=c("../utils/Utils");e.exports=d;var f=new j,m=new j,f=new j;d.prototype.updateWheel=function(c){var d=this.raycastResult;if(this.isInContact){var e=d.hitNormalWorld.dot(d.directionWorld);d.hitPointWorld.vsub(c.position,m);c.getVelocityAtWorldPoint(m,f);c=d.hitNormalWorld.dot(f);-0.1<=e?(this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=10):(e=-1/e,this.suspensionRelativeVelocity=
c*e,this.clippedInvContactDotSuspension=e)}else d.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,d.directionWorld.scale(-1,d.hitNormalWorld),this.clippedInvContactDotSuspension=1}},{"../collision/RaycastResult":10,"../math/Transform":29,"../math/Vec3":30,"../utils/Utils":53}],37:[function(c,e){function d(c){j.call(this);this.type=j.types.BOX;this.halfExtents=c;this.convexPolyhedronRepresentation=null;this.updateConvexPolyhedronRepresentation();this.updateBoundingSphereRadius()}
e.exports=d;var j=c("./Shape"),g=c("../math/Vec3"),p=c("./ConvexPolyhedron");d.prototype=new j;d.prototype.constructor=d;d.prototype.updateConvexPolyhedronRepresentation=function(){var c=this.halfExtents.x,d=this.halfExtents.y,f=this.halfExtents.z,c=[new g(-c,-d,-f),new g(c,-d,-f),new g(c,d,-f),new g(-c,d,-f),new g(-c,-d,f),new g(c,-d,f),new g(c,d,f),new g(-c,d,f)];new g(0,0,1);new g(0,1,0);new g(1,0,0);this.convexPolyhedronRepresentation=c=new p(c,[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,
3],[1,2,6,5]]);c.material=this.material};d.prototype.calculateLocalInertia=function(c,f){f=f||new g;d.calculateInertia(this.halfExtents,c,f);return f};d.calculateInertia=function(c,d,f){f.x=1/12*d*(4*c.y*c.y+4*c.z*c.z);f.y=1/12*d*(4*c.x*c.x+4*c.z*c.z);f.z=1/12*d*(4*c.y*c.y+4*c.x*c.x)};d.prototype.getSideNormals=function(c,d){var f=this.halfExtents;c[0].set(f.x,0,0);c[1].set(0,f.y,0);c[2].set(0,0,f.z);c[3].set(-f.x,0,0);c[4].set(0,-f.y,0);c[5].set(0,0,-f.z);if(void 0!==d)for(f=0;f!==c.length;f++)d.vmult(c[f],
c[f]);return c};d.prototype.volume=function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.halfExtents.norm()};var l=new g;new g;d.prototype.forEachWorldCorner=function(c,d,f){for(var e=this.halfExtents,e=[[e.x,e.y,e.z],[-e.x,e.y,e.z],[-e.x,-e.y,e.z],[-e.x,-e.y,-e.z],[e.x,-e.y,-e.z],[e.x,e.y,-e.z],[-e.x,e.y,-e.z],[e.x,-e.y,e.z]],g=0;g<e.length;g++)l.set(e[g][0],e[g][1],e[g][2]),d.vmult(l,l),c.vadd(l,
l),f(l.x,l.y,l.z)};var f=[new g,new g,new g,new g,new g,new g,new g,new g];d.prototype.calculateWorldAABB=function(c,d,e,g){var j=this.halfExtents;f[0].set(j.x,j.y,j.z);f[1].set(-j.x,j.y,j.z);f[2].set(-j.x,-j.y,j.z);f[3].set(-j.x,-j.y,-j.z);f[4].set(j.x,-j.y,-j.z);f[5].set(j.x,j.y,-j.z);f[6].set(-j.x,j.y,-j.z);f[7].set(j.x,-j.y,j.z);var l=f[0];d.vmult(l,l);c.vadd(l,l);g.copy(l);e.copy(l);for(j=1;8>j;j++){l=f[j];d.vmult(l,l);c.vadd(l,l);var p=l.x,z=l.y,l=l.z;p>g.x&&(g.x=p);z>g.y&&(g.y=z);l>g.z&&(g.z=
l);p<e.x&&(e.x=p);z<e.y&&(e.y=z);l<e.z&&(e.z=l)}}},{"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],38:[function(c,e){function d(c,d,f){j.call(this);this.type=j.types.CONVEXPOLYHEDRON;this.vertices=c||[];this.worldVertices=[];this.worldVerticesNeedsUpdate=!0;this.faces=d||[];this.faceNormals=[];this.computeNormals();this.worldFaceNormalsNeedsUpdate=!0;this.worldFaceNormals=[];this.uniqueEdges=[];this.uniqueAxes=f?f.slice():null;this.computeEdges();this.updateBoundingSphereRadius()}e.exports=
d;var j=c("./Shape"),g=c("../math/Vec3");c("../math/Quaternion");var p=c("../math/Transform");d.prototype=new j;d.prototype.constructor=d;var l=new g;d.prototype.computeEdges=function(){for(var c=this.faces,d=this.vertices,f=this.uniqueEdges,e=f.length=0;e!==c.length;e++)for(var g=c[e],j=g.length,m=0;m!==j;m++){d[g[m]].vsub(d[g[(m+1)%j]],l);l.normalize();for(var n=!1,r=0;r!==f.length;r++)if(f[r].almostEquals(l)||f[r].almostEquals(l)){n=!0;break}n||f.push(l.clone())}};d.prototype.computeNormals=function(){this.faceNormals.length=
this.faces.length;for(var c=0;c<this.faces.length;c++){for(var d=0;d<this.faces[c].length;d++)if(!this.vertices[this.faces[c][d]])throw Error("Vertex "+this.faces[c][d]+" not found!");d=this.faceNormals[c]||new g;this.getFaceNormal(c,d);d.negate(d);this.faceNormals[c]=d;if(0>d.dot(this.vertices[this.faces[c][0]])){console.error(".faceNormals["+c+"] = Vec3("+d.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");
for(d=0;d<this.faces[c].length;d++)console.warn(".vertices["+this.faces[c][d]+"] = Vec3("+this.vertices[this.faces[c][d]].toString()+")")}}};var f=new g,m=new g;d.computeNormal=function(c,d,e,g){d.vsub(c,m);e.vsub(d,f);f.cross(m,g);g.isZero()||g.normalize()};d.prototype.getFaceNormal=function(c,f){var e=this.faces[c];return d.computeNormal(this.vertices[e[0]],this.vertices[e[1]],this.vertices[e[2]],f)};var n=new g;d.prototype.clipAgainstHull=function(c,d,f,e,j,m,l,r,s){for(var p=-1,t=-Number.MAX_VALUE,
u=0;u<f.faces.length;u++){n.copy(f.faceNormals[u]);j.vmult(n,n);var v=n.dot(m);v>t&&(t=v,p=u)}for(var t=[],u=f.faces[p],v=u.length,y=0;y<v;y++){var z=f.vertices[u[y]],x=new g;x.copy(z);j.vmult(x,x);e.vadd(x,x);t.push(x)}0<=p&&this.clipFaceAgainstHull(m,c,d,t,l,r,s)};var r=new g,s=new g,t=new g,u=new g,v=new g,z=new g;d.prototype.findSeparatingAxis=function(c,d,f,e,g,j,m,n){var l=Number.MAX_VALUE,p=0;if(this.uniqueAxes)for(x=0;x!==this.uniqueAxes.length;x++){f.vmult(this.uniqueAxes[x],r);D=this.testSepAxis(r,
c,d,f,e,g);if(!1===D)return!1;D<l&&(l=D,j.copy(r))}else for(var y=m?m.length:this.faces.length,x=0;x<y;x++){D=m?m[x]:x;r.copy(this.faceNormals[D]);f.vmult(r,r);var D=this.testSepAxis(r,c,d,f,e,g);if(!1===D)return!1;D<l&&(l=D,j.copy(r))}if(c.uniqueAxes)for(x=0;x!==c.uniqueAxes.length;x++){g.vmult(c.uniqueAxes[x],s);p++;D=this.testSepAxis(s,c,d,f,e,g);if(!1===D)return!1;D<l&&(l=D,j.copy(s))}else{m=n?n.length:c.faces.length;for(x=0;x<m;x++){D=n?n[x]:x;s.copy(c.faceNormals[D]);g.vmult(s,s);p++;D=this.testSepAxis(s,
c,d,f,e,g);if(!1===D)return!1;D<l&&(l=D,j.copy(s))}}for(n=0;n!==this.uniqueEdges.length;n++){f.vmult(this.uniqueEdges[n],u);for(p=0;p!==c.uniqueEdges.length;p++)if(g.vmult(c.uniqueEdges[p],v),u.cross(v,z),!z.almostZero()){z.normalize();x=this.testSepAxis(z,c,d,f,e,g);if(!1===x)return!1;x<l&&(l=x,j.copy(z))}}e.vsub(d,t);0<t.dot(j)&&j.negate(j);return!0};var x=[],C=[];d.prototype.testSepAxis=function(c,f,e,g,j,m){d.project(this,c,e,g,x);d.project(f,c,j,m,C);e=x[0];c=x[1];f=C[0];g=C[1];if(e<g||f<c)return!1;
e-=g;c=f-c;return e<c?e:c};var B=new g,E=new g;d.prototype.calculateLocalInertia=function(c,d){this.computeLocalAABB(B,E);var f=E.x-B.x,e=E.y-B.y,g=E.z-B.z;d.x=1/12*c*(4*e*e+4*g*g);d.y=1/12*c*(4*f*f+4*g*g);d.z=1/12*c*(4*e*e+4*f*f)};d.prototype.getPlaneConstantOfFace=function(c){return-this.faceNormals[c].dot(this.vertices[this.faces[c][0]])};var I=new g,y=new g,D=new g,H=new g,M=new g,S=new g,Q=new g,L=new g;d.prototype.clipFaceAgainstHull=function(c,d,f,e,g,j,m){for(var n=[],l=-1,r=Number.MAX_VALUE,
s=0;s<this.faces.length;s++){I.copy(this.faceNormals[s]);f.vmult(I,I);var p=I.dot(c);p<r&&(r=p,l=s)}if(!(0>l)){c=this.faces[l];c.connectedFaces=[];for(r=0;r<this.faces.length;r++)for(s=0;s<this.faces[r].length;s++)-1!==c.indexOf(this.faces[r][s])&&(r!==l&&-1===c.connectedFaces.indexOf(r))&&c.connectedFaces.push(r);r=c.length;for(s=0;s<r;s++){p=this.vertices[c[s]];p.vsub(this.vertices[c[(s+1)%r]],y);D.copy(y);f.vmult(D,D);d.vadd(D,D);H.copy(this.faceNormals[l]);f.vmult(H,H);d.vadd(H,H);D.cross(H,M);
M.negate(M);S.copy(p);f.vmult(S,S);d.vadd(S,S);S.dot(M);p=c.connectedFaces[s];Q.copy(this.faceNormals[p]);p=this.getPlaneConstantOfFace(p);L.copy(Q);f.vmult(L,L);p-=L.dot(d);for(this.clipFaceAgainstPlane(e,n,L,p);e.length;)e.shift();for(;n.length;)e.push(n.shift())}Q.copy(this.faceNormals[l]);p=this.getPlaneConstantOfFace(l);L.copy(Q);f.vmult(L,L);p-=L.dot(d);for(r=0;r<e.length;r++)d=L.dot(e[r])+p,d<=g&&(console.log("clamped: depth="+d+" to minDist="+(g+"")),d=g),d<=j&&(f=e[r],0>=d&&m.push({point:f,
normal:L,depth:d}))}};d.prototype.clipFaceAgainstPlane=function(c,d,f,e){var j,m,n=c.length;if(2>n)return d;var l=c[c.length-1],r=c[0];j=f.dot(l)+e;for(var s=0;s<n;s++){r=c[s];m=f.dot(r)+e;if(0>j){if(0>m){var p=new g;p.copy(r)}else p=new g,l.lerp(r,j/(j-m),p);d.push(p)}else 0>m&&(p=new g,l.lerp(r,j/(j-m),p),d.push(p),d.push(r));l=r;j=m}return d};d.prototype.computeWorldVertices=function(c,d){for(var f=this.vertices.length;this.worldVertices.length<f;)this.worldVertices.push(new g);for(var e=this.vertices,
j=this.worldVertices,m=0;m!==f;m++)d.vmult(e[m],j[m]),c.vadd(j[m],j[m]);this.worldVerticesNeedsUpdate=!1};new g;d.prototype.computeLocalAABB=function(c,d){var f=this.vertices.length,e=this.vertices;c.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);d.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var g=0;g<f;g++){var j=e[g];j.x<c.x?c.x=j.x:j.x>d.x&&(d.x=j.x);j.y<c.y?c.y=j.y:j.y>d.y&&(d.y=j.y);j.z<c.z?c.z=j.z:j.z>d.z&&(d.z=j.z)}};d.prototype.computeWorldFaceNormals=function(c){for(var d=
this.faceNormals.length;this.worldFaceNormals.length<d;)this.worldFaceNormals.push(new g);for(var f=this.faceNormals,e=this.worldFaceNormals,j=0;j!==d;j++)c.vmult(f[j],e[j]);this.worldFaceNormalsNeedsUpdate=!1};d.prototype.updateBoundingSphereRadius=function(){for(var c=0,d=this.vertices,f=0,e=d.length;f!==e;f++){var g=d[f].norm2();g>c&&(c=g)}this.boundingSphereRadius=Math.sqrt(c)};var W=new g;d.prototype.calculateWorldAABB=function(c,d,f,e){for(var g=this.vertices.length,j=this.vertices,m,n,l,r,
s,p,t=0;t<g;t++){W.copy(j[t]);d.vmult(W,W);c.vadd(W,W);var u=W;if(u.x<m||void 0===m)m=u.x;else if(u.x>r||void 0===r)r=u.x;if(u.y<n||void 0===n)n=u.y;else if(u.y>s||void 0===s)s=u.y;if(u.z<l||void 0===l)l=u.z;else if(u.z>p||void 0===p)p=u.z}f.set(m,n,l);e.set(r,s,p)};d.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3};d.prototype.getAveragePointLocal=function(c){c=c||new g;for(var d=this.vertices.length,f=this.vertices,e=0;e<d;e++)c.vadd(f[e],c);c.mult(1/d,c);return c};d.prototype.transformAllPoints=
function(c,d){var f=this.vertices.length,e=this.vertices;if(d){for(var g=0;g<f;g++){var j=e[g];d.vmult(j,j)}for(g=0;g<this.faceNormals.length;g++)j=this.faceNormals[g],d.vmult(j,j)}if(c)for(g=0;g<f;g++)j=e[g],j.vadd(c,j)};var aa=new g,G=new g,F=new g;d.prototype.pointIsInside=function(c){var d=this.vertices.length,f=this.vertices,e=this.faces,g=this.faceNormals,j=this.faces.length;this.getAveragePointLocal(aa);for(var m=0;m<j;m++){var d=g[m],n=f[e[m][0]],l=G;c.vsub(n,l);var l=d.dot(l),r=F;aa.vsub(n,
r);d=d.dot(r);if(0>l&&0<d||0<l&&0>d)return!1}return-1};new g;var ka=new g,Z=new g;d.project=function(c,d,f,e,g){var j=c.vertices.length,m=0,n=0;c=c.vertices;Z.setZero();p.vectorToLocalFrame(f,e,d,ka);p.pointToLocalFrame(f,e,Z,Z);d=Z.dot(ka);n=m=c[0].dot(ka);for(f=1;f<j;f++)e=c[f].dot(ka),e>m&&(m=e),e<n&&(n=e);n-=d;m-=d;n>m&&(j=n,n=m,m=j);g[0]=m;g[1]=n}},{"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"./Shape":43}],39:[function(c,e){function d(c,d,e,n){var r=[],s=[],t=[],u=[],v=
[],z=Math.cos,x=Math.sin;r.push(new g(d*z(0),d*x(0),0.5*-e));u.push(0);r.push(new g(c*z(0),c*x(0),0.5*e));v.push(1);for(var C=0;C<n;C++){var B=2*Math.PI/n*(C+1),E=2*Math.PI/n*(C+0.5);C<n-1?(r.push(new g(d*z(B),d*x(B),0.5*-e)),u.push(2*C+2),r.push(new g(c*z(B),c*x(B),0.5*e)),v.push(2*C+3),t.push([2*C+2,2*C+3,2*C+1,2*C])):t.push([0,1,2*C+1,2*C]);(1===n%2||C<n/2)&&s.push(new g(z(E),x(E),0))}t.push(v);s.push(new g(0,0,1));c=[];for(C=0;C<u.length;C++)c.push(u[u.length-C-1]);t.push(c);this.type=j.types.CONVEXPOLYHEDRON;
p.call(this,r,t,s)}e.exports=d;var j=c("./Shape"),g=c("../math/Vec3");c("../math/Quaternion");var p=c("./ConvexPolyhedron");d.prototype=new p},{"../math/Quaternion":28,"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],40:[function(c,e){function d(c,d){d=l.defaults(d,{maxValue:null,minValue:null,elementSize:1});this.data=c;this.maxValue=d.maxValue;this.minValue=d.minValue;this.elementSize=d.elementSize;null===d.minValue&&this.updateMinValue();null===d.maxValue&&this.updateMaxValue();this.cacheEnabled=
!0;j.call(this);this.pillarConvex=new g;this.pillarOffset=new p;this.type=j.types.HEIGHTFIELD;this.updateBoundingSphereRadius();this._cachedPillars={}}var j=c("./Shape"),g=c("./ConvexPolyhedron"),p=c("../math/Vec3"),l=c("../utils/Utils");e.exports=d;d.prototype=new j;d.prototype.update=function(){this._cachedPillars={}};d.prototype.updateMinValue=function(){for(var c=this.data,d=c[0][0],e=0;e!==c.length;e++)for(var g=0;g!==c[e].length;g++){var j=c[e][g];j<d&&(d=j)}this.minValue=d};d.prototype.updateMaxValue=
function(){for(var c=this.data,d=c[0][0],e=0;e!==c.length;e++)for(var g=0;g!==c[e].length;g++){var j=c[e][g];j>d&&(d=j)}this.maxValue=d};d.prototype.setHeightValueAtIndex=function(c,d,e){this.data[c][d]=e;this.clearCachedConvexTrianglePillar(c,d,!1);0<c&&(this.clearCachedConvexTrianglePillar(c-1,d,!0),this.clearCachedConvexTrianglePillar(c-1,d,!1));0<d&&(this.clearCachedConvexTrianglePillar(c,d-1,!0),this.clearCachedConvexTrianglePillar(c,d-1,!1));0<d&&0<c&&this.clearCachedConvexTrianglePillar(c-
1,d-1,!0)};d.prototype.getRectMinMax=function(c,d,e,g,j){j=j||[];for(var l=this.data,p=this.minValue;c<=e;c++)for(var v=d;v<=g;v++){var z=l[c][v];z>p&&(p=z)}j[0]=this.minValue;j[1]=p};d.prototype.getIndexOfPosition=function(c,d,e,g){var j=this.elementSize,l=this.data;c=Math.floor(c/j);d=Math.floor(d/j);e[0]=c;e[1]=d;g&&(0>c&&(c=0),0>d&&(d=0),c>=l.length-1&&(c=l.length-1),d>=l[0].length-1&&(d=l[0].length-1));return 0>c||0>d||c>=l.length-1||d>=l[0].length-1?!1:!0};d.prototype.getHeightAt=function(c,
d,e){var g=[];this.getIndexOfPosition(c,d,g,e);c=[];this.getRectMinMax(g[0],g[1]+1,g[0],g[1]+1,c);return(c[0]+c[1])/2};d.prototype.getCacheConvexTrianglePillarKey=function(c,d,e){return c+"_"+d+"_"+(e?1:0)};d.prototype.getCachedConvexTrianglePillar=function(c,d,e){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(c,d,e)]};d.prototype.setCachedConvexTrianglePillar=function(c,d,e,g,j){this._cachedPillars[this.getCacheConvexTrianglePillarKey(c,d,e)]={convex:g,offset:j}};d.prototype.clearCachedConvexTrianglePillar=
function(c,d,e){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(c,d,e)]};d.prototype.getConvexTrianglePillar=function(c,d,e){var j=this.pillarConvex,l=this.pillarOffset;if(this.cacheEnabled){var t=this.getCachedConvexTrianglePillar(c,d,e);if(t){this.pillarConvex=t.convex;this.pillarOffset=t.offset;return}j=new g;l=new p;this.pillarConvex=j;this.pillarOffset=l}var t=this.data,u=this.elementSize,v=j.faces;j.vertices.length=6;for(var z=0;6>z;z++)j.vertices[z]||(j.vertices[z]=new p);v.length=
5;for(z=0;5>z;z++)v[z]||(v[z]=[]);var z=j.vertices,x=(Math.min(t[c][d],t[c+1][d],t[c][d+1],t[c+1][d+1])-this.minValue)/2+this.minValue;e?(l.set((c+0.75)*u,(d+0.75)*u,x),z[0].set(0.25*u,0.25*u,t[c+1][d+1]-x),z[1].set(-0.75*u,0.25*u,t[c][d+1]-x),z[2].set(0.25*u,-0.75*u,t[c+1][d]-x),z[3].set(0.25*u,0.25*u,-x-1),z[4].set(-0.75*u,0.25*u,-x-1),z[5].set(0.25*u,-0.75*u,-x-1),v[0][0]=0,v[0][1]=1,v[0][2]=2,v[1][0]=5,v[1][1]=4,v[1][2]=3,v[2][0]=2,v[2][1]=5,v[2][2]=3,v[2][3]=0,v[3][0]=3,v[3][1]=4,v[3][2]=1,v[3][3]=
0,v[4][0]=1,v[4][1]=4,v[4][2]=5,v[4][3]=2):(l.set((c+0.25)*u,(d+0.25)*u,x),z[0].set(-0.25*u,-0.25*u,t[c][d]-x),z[1].set(0.75*u,-0.25*u,t[c+1][d]-x),z[2].set(-0.25*u,0.75*u,t[c][d+1]-x),z[3].set(-0.25*u,-0.25*u,-x-1),z[4].set(0.75*u,-0.25*u,-x-1),z[5].set(-0.25*u,0.75*u,-x-1),v[0][0]=0,v[0][1]=1,v[0][2]=2,v[1][0]=5,v[1][1]=4,v[1][2]=3,v[2][0]=0,v[2][1]=2,v[2][2]=5,v[2][3]=3,v[3][0]=1,v[3][1]=0,v[3][2]=3,v[3][3]=4,v[4][0]=4,v[4][1]=5,v[4][2]=2,v[4][3]=1);j.computeNormals();j.computeEdges();j.updateBoundingSphereRadius();
this.setCachedConvexTrianglePillar(c,d,e,j,l)};d.prototype.calculateLocalInertia=function(c,d){d=d||new p;d.set(0,0,0);return d};d.prototype.volume=function(){return Number.MAX_VALUE};d.prototype.calculateWorldAABB=function(c,d,e,g){e.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);g.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)};d.prototype.updateBoundingSphereRadius=function(){var c=this.data,d=this.elementSize;this.boundingSphereRadius=(new p(c.length*d,c[0].length*d,Math.max(Math.abs(this.maxValue),
Math.abs(this.minValue)))).norm()}},{"../math/Vec3":30,"../utils/Utils":53,"./ConvexPolyhedron":38,"./Shape":43}],41:[function(c,e){function d(){j.call(this);this.type=j.types.PARTICLE}e.exports=d;var j=c("./Shape"),g=c("../math/Vec3");d.prototype=new j;d.prototype.constructor=d;d.prototype.calculateLocalInertia=function(c,d){d=d||new g;d.set(0,0,0);return d};d.prototype.volume=function(){return 0};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=0};d.prototype.calculateWorldAABB=
function(c,d,f,e){f.copy(c);e.copy(c)}},{"../math/Vec3":30,"./Shape":43}],42:[function(c,e){function d(){j.call(this);this.type=j.types.PLANE;this.worldNormal=new g;this.worldNormalNeedsUpdate=!0;this.boundingSphereRadius=Number.MAX_VALUE}e.exports=d;var j=c("./Shape"),g=c("../math/Vec3");d.prototype=new j;d.prototype.constructor=d;d.prototype.computeWorldNormal=function(c){var d=this.worldNormal;d.set(0,0,1);c.vmult(d,d);this.worldNormalNeedsUpdate=!1};d.prototype.calculateLocalInertia=function(c,
d){return d=d||new g};d.prototype.volume=function(){return Number.MAX_VALUE};var p=new g;d.prototype.calculateWorldAABB=function(c,d,e,g){p.set(0,0,1);d.vmult(p,p);d=Number.MAX_VALUE;e.set(-d,-d,-d);g.set(d,d,d);1===p.x&&(g.x=c.x);1===p.y&&(g.y=c.y);1===p.z&&(g.z=c.z);-1===p.x&&(e.x=c.x);-1===p.y&&(e.y=c.y);-1===p.z&&(e.z=c.z)};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=Number.MAX_VALUE}},{"../math/Vec3":30,"./Shape":43}],43:[function(c,e){function d(){this.id=d.idCounter++;
this.boundingSphereRadius=this.type=0;this.collisionResponse=!0;this.material=null}e.exports=d;d=c("./Shape");c("../math/Vec3");c("../math/Quaternion");c("../material/Material");d.prototype.constructor=d;d.prototype.updateBoundingSphereRadius=function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type;};d.prototype.volume=function(){throw"volume() not implemented for shape type "+this.type;};d.prototype.calculateLocalInertia=function(){throw"calculateLocalInertia() not implemented for shape type "+
this.type;};d.idCounter=0;d.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"./Shape":43}],44:[function(c,e){function d(c){j.call(this);this.radius=void 0!==c?Number(c):1;this.type=j.types.SPHERE;if(0>this.radius)throw Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}e.exports=d;var j=c("./Shape"),g=c("../math/Vec3");d.prototype=new j;
d.prototype.constructor=d;d.prototype.calculateLocalInertia=function(c,d){d=d||new g;var f=2*c*this.radius*this.radius/5;d.x=f;d.y=f;d.z=f;return d};d.prototype.volume=function(){return 4*Math.PI*this.radius/3};d.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.radius};d.prototype.calculateWorldAABB=function(c,d,f,e){d=this.radius;for(var g=["x","y","z"],j=0;j<g.length;j++){var s=g[j];f[s]=c[s]-d;e[s]=c[s]+d}}},{"../math/Vec3":30,"./Shape":43}],45:[function(c,e){function d(c,
d){j.call(this);this.type=j.types.TRIMESH;this.vertices=new Float32Array(c);this.indices=new Int16Array(d);this.normals=new Float32Array(d.length);this.aabb=new l;this.edges=null;this.scale=new g(1,1,1);this.tree=new f;this.updateEdges();this.updateNormals();this.updateAABB();this.updateBoundingSphereRadius();this.updateTree()}e.exports=d;var j=c("./Shape"),g=c("../math/Vec3");c("../math/Quaternion");var p=c("../math/Transform"),l=c("../collision/AABB"),f=c("../utils/Octree");d.prototype=new j;d.prototype.constructor=
d;var m=new g;d.prototype.updateTree=function(){var c=this.tree;c.reset();c.aabb.copy(this.aabb);var d=this.scale;c.aabb.lowerBound.x*=1/d.x;c.aabb.lowerBound.y*=1/d.y;c.aabb.lowerBound.z*=1/d.z;c.aabb.upperBound.x*=1/d.x;c.aabb.upperBound.y*=1/d.y;c.aabb.upperBound.z*=1/d.z;for(var d=new l,f=new g,e=new g,j=new g,m=[f,e,j],n=0;n<this.indices.length/3;n++){var r=3*n;this._getUnscaledVertex(this.indices[r],f);this._getUnscaledVertex(this.indices[r+1],e);this._getUnscaledVertex(this.indices[r+2],j);
d.setFromPoints(m);c.insert(d,n)}c.removeEmptyNodes()};var n=new l;d.prototype.getTrianglesInAABB=function(c,d){n.copy(c);var f=this.scale,e=f.x,g=f.y,f=f.z,j=n.lowerBound,m=n.upperBound;j.x/=e;j.y/=g;j.z/=f;m.x/=e;m.y/=g;m.z/=f;return this.tree.aabbQuery(n,d)};d.prototype.setScale=function(c){var d=c.x===c.y===c.z;this.scale.x===this.scale.y===this.scale.z&&d||this.updateNormals();this.scale.copy(c);this.updateAABB();this.updateBoundingSphereRadius()};d.prototype.updateNormals=function(){for(var c=
this.normals,f=0;f<this.indices.length/3;f++){var e=3*f,g=this.indices[e+1],j=this.indices[e+2];this.getVertex(this.indices[e],v);this.getVertex(g,z);this.getVertex(j,x);d.computeNormal(z,v,x,m);c[e]=m.x;c[e+1]=m.y;c[e+2]=m.z}};d.prototype.updateEdges=function(){for(var c={},d=function(){c[g<j?g+"_"+j:j+"_"+g]=!0},f=0;f<this.indices.length/3;f++){var e=3*f,g=this.indices[e],j=this.indices[e+1],e=this.indices[e+2];d(g,j);d(j,e);d(e,g)}d=Object.keys(c);this.edges=new Int16Array(2*d.length);for(f=0;f<
d.length;f++)e=d[f].split("_"),this.edges[2*f]=parseInt(e[0],10),this.edges[2*f+1]=parseInt(e[1],10)};d.prototype.getEdgeVertex=function(c,d,f){this.getVertex(this.edges[2*c+(d?1:0)],f)};var r=new g,s=new g;d.prototype.getEdgeVector=function(c,d){this.getEdgeVertex(c,0,r);this.getEdgeVertex(c,1,s);s.vsub(r,d)};var t=new g,u=new g;d.computeNormal=function(c,d,f,e){d.vsub(c,u);f.vsub(d,t);t.cross(u,e);e.isZero()||e.normalize()};var v=new g,z=new g,x=new g;d.prototype.getVertex=function(c,d){var f=this.scale;
this._getUnscaledVertex(c,d);d.x*=f.x;d.y*=f.y;d.z*=f.z;return d};d.prototype._getUnscaledVertex=function(c,d){var f=3*c,e=this.vertices;return d.set(e[f],e[f+1],e[f+2])};d.prototype.getWorldVertex=function(c,d,f,e){this.getVertex(c,e);p.pointToWorldFrame(d,f,e,e);return e};d.prototype.getTriangleVertices=function(c,d,f,e){c*=3;this.getVertex(this.indices[c],d);this.getVertex(this.indices[c+1],f);this.getVertex(this.indices[c+2],e)};d.prototype.getNormal=function(c,d){var f=3*c;return d.set(this.normals[f],
this.normals[f+1],this.normals[f+2])};var C=new l;d.prototype.calculateLocalInertia=function(c,d){this.computeLocalAABB(C);var f=C.upperBound.x-C.lowerBound.x,e=C.upperBound.y-C.lowerBound.y,g=C.upperBound.z-C.lowerBound.z;return d.set(1/12*c*(4*e*e+4*g*g),1/12*c*(4*f*f+4*g*g),1/12*c*(4*e*e+4*f*f))};var B=new g;d.prototype.computeLocalAABB=function(c){var d=c.lowerBound;c=c.upperBound;var f=this.vertices.length;this.getVertex(0,B);d.copy(B);c.copy(B);for(var e=0;e!==f;e++)this.getVertex(e,B),B.x<
d.x?d.x=B.x:B.x>c.x&&(c.x=B.x),B.y<d.y?d.y=B.y:B.y>c.y&&(c.y=B.y),B.z<d.z?d.z=B.z:B.z>c.z&&(c.z=B.z)};d.prototype.updateAABB=function(){this.computeLocalAABB(this.aabb)};d.prototype.updateBoundingSphereRadius=function(){for(var c=0,d=this.vertices,f=new g,e=0,d=d.length/3;e!==d;e++){this.getVertex(e,f);var j=f.norm2();j>c&&(c=j)}this.boundingSphereRadius=Math.sqrt(c)};new g;var E=new p,I=new l;d.prototype.calculateWorldAABB=function(c,d,f,e){E.position=c;E.quaternion=d;this.aabb.toWorldFrame(E,I);
f.copy(I.lowerBound);e.copy(I.upperBound)};d.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3};d.createTorus=function(c,f,e,g,j){c=c||1;f=f||0.5;e=e||8;g=g||6;j=j||2*Math.PI;for(var m=[],n=[],l=0;l<=e;l++)for(var r=0;r<=g;r++){var s=r/g*j,p=2*l/e*Math.PI,t=(c+f*Math.cos(p))*Math.cos(s),s=(c+f*Math.cos(p))*Math.sin(s),p=f*Math.sin(p);m.push(t,s,p)}for(l=1;l<=e;l++)for(r=1;r<=g;r++)c=(g+1)*(l-1)+r-1,f=(g+1)*(l-1)+r,j=(g+1)*l+r,n.push((g+1)*l+r-1,c,j),n.push(c,f,j);return new d(m,
n)}},{"../collision/AABB":3,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../utils/Octree":50,"./Shape":43}],46:[function(c,e){function d(){j.call(this);this.iterations=10;this.tolerance=1E-7}e.exports=d;c("../math/Vec3");c("../math/Quaternion");var j=c("./Solver");d.prototype=new j;var g=[],p=[],l=[];d.prototype.solve=function(c,d){var e=0,j=this.iterations,s=this.tolerance*this.tolerance,t=this.equations,u=t.length,v=d.bodies,z=v.length,x,C,B,E,I;if(0!==u)for(B=0;B!==z;B++)v[B].updateSolveMassProperties();
p.length=u;l.length=u;g.length=u;for(B=0;B!==u;B++){var y=t[B];g[B]=0;l[B]=y.computeB(c);p[B]=1/y.computeC()}if(0!==u){for(B=0;B!==z;B++)y=v[B],e=y.wlambda,y.vlambda.set(0,0,0),e&&e.set(0,0,0);for(e=0;e!==j;e++){for(var D=B=0;D!==u;D++)y=t[D],x=l[D],C=p[D],I=g[D],E=y.computeGWlambda(),x=C*(x-E-y.eps*I),I+x<y.minForce?x=y.minForce-I:I+x>y.maxForce&&(x=y.maxForce-I),g[D]+=x,B+=0<x?x:-x,y.addToWlambda(x);if(B*B<s)break}for(B=0;B!==z;B++)y=v[B],j=y.velocity,s=y.angularVelocity,j.vadd(y.vlambda,j),s&&
s.vadd(y.wlambda,s)}return e}},{"../math/Quaternion":28,"../math/Vec3":30,"./Solver":47}],47:[function(c,e){function d(){this.equations=[]}e.exports=d;d.prototype.solve=function(){return 0};d.prototype.addEquation=function(c){c.enabled&&this.equations.push(c)};d.prototype.removeEquation=function(c){var d=this.equations;c=d.indexOf(c);-1!==c&&d.splice(c,1)};d.prototype.removeAllEquations=function(){this.equations.length=0}},{}],48:[function(c,e){function d(c){l.call(this);this.iterations=10;this.tolerance=
1E-7;this.subsolver=c;this.nodes=[];for(this.nodePool=[];128>this.nodePool.length;)this.nodePool.push(this.createNode())}function j(c){for(var d=c.length,f=0;f!==d;f++){var e=c[f];if(!e.visited&&!(e.body.type&s))return e}return!1}function g(c,d,f){d.push(c.body);d=c.eqs.length;for(var e=0;e!==d;e++){var g=c.eqs[e];-1===f.indexOf(g)&&f.push(g)}}function p(c,d){return d.id-c.id}e.exports=d;c("../math/Vec3");c("../math/Quaternion");var l=c("./Solver"),f=c("../objects/Body");d.prototype=new l;var m=[],
n=[],r={bodies:[]},s=f.STATIC,t=[];d.prototype.createNode=function(){return{body:null,children:[],eqs:[],visited:!1}};d.prototype.solve=function(c,d){for(var f=this.nodePool,e=d.bodies,l=this.equations,s=l.length,E=e.length,I=this.subsolver;f.length<E;)f.push(this.createNode());m.length=E;for(var y=0;y<E;y++)m[y]=f[y];for(y=0;y!==E;y++)f=m[y],f.body=e[y],f.children.length=0,f.eqs.length=0,f.visited=!1;for(E=0;E!==s;E++){var f=l[E],y=e.indexOf(f.bi),D=e.indexOf(f.bj),y=m[y],D=m[D];y.children.push(D);
y.eqs.push(f);D.children.push(y);D.eqs.push(f)}e=0;l=n;I.tolerance=this.tolerance;for(I.iterations=this.iterations;y=j(m);){l.length=0;r.bodies.length=0;f=y;y=g;s=r.bodies;E=l;t.push(f);f.visited=!0;for(y(f,s,E);t.length;)for(f=t.pop();D=j(f.children);)D.visited=!0,y(D,s,E),t.push(D);s=l.length;l=l.sort(p);for(y=0;y!==s;y++)I.addEquation(l[y]);I.solve(c,r);I.removeAllEquations();e++}return e}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"./Solver":47}],49:[function(c,e){var d=
function(){};e.exports=d;d.prototype={constructor:d,addEventListener:function(c,d){void 0===this._listeners&&(this._listeners={});var e=this._listeners;void 0===e[c]&&(e[c]=[]);-1===e[c].indexOf(d)&&e[c].push(d);return this},hasEventListener:function(c,d){if(void 0===this._listeners)return!1;var e=this._listeners;return void 0!==e[c]&&-1!==e[c].indexOf(d)?!0:!1},removeEventListener:function(c,d){if(void 0===this._listeners)return this;var e=this._listeners;if(void 0===e[c])return this;var l=e[c].indexOf(d);
-1!==l&&e[c].splice(l,1);return this},dispatchEvent:function(c){if(void 0===this._listeners)return this;var d=this._listeners[c.type];if(void 0!==d){c.target=this;for(var e=0,l=d.length;e<l;e++)d[e].call(this,c)}return this}}},{}],50:[function(c,e){function d(c){c=c||{};this.root=c.root||null;this.aabb=c.aabb?c.aabb.clone():new g;this.data=[];this.children=[]}function j(c,f){f=f||{};f.root=null;f.aabb=c;d.call(this,f);this.maxDepth="undefined"!==typeof f.maxDepth?f.maxDepth:8}var g=c("../collision/AABB"),
p=c("../math/Vec3");e.exports=j;j.prototype=new d;d.prototype.reset=function(){this.children.length=this.data.length=0};d.prototype.insert=function(c,d,f){var e=this.data;f=f||0;if(!this.aabb.contains(c))return!1;var g=this.children;if(f<(this.maxDepth||this.root.maxDepth)){var j=!1;g.length||(this.subdivide(),j=!0);for(var l=0;8!==l;l++)if(g[l].insert(c,d,f+1))return!0;j&&(g.length=0)}e.push(d);return!0};var l=new p;d.prototype.subdivide=function(){var c=this.aabb,f=c.lowerBound,e=c.upperBound,c=
this.children;c.push(new d({aabb:new g({lowerBound:new p(0,0,0)})}),new d({aabb:new g({lowerBound:new p(1,0,0)})}),new d({aabb:new g({lowerBound:new p(1,1,0)})}),new d({aabb:new g({lowerBound:new p(1,1,1)})}),new d({aabb:new g({lowerBound:new p(0,1,1)})}),new d({aabb:new g({lowerBound:new p(0,0,1)})}),new d({aabb:new g({lowerBound:new p(1,0,1)})}),new d({aabb:new g({lowerBound:new p(0,1,0)})}));e.vsub(f,l);l.scale(0.5,l);for(var e=this.root||this,j=0;8!==j;j++){var t=c[j];t.root=e;var u=t.aabb.lowerBound;
u.x*=l.x;u.y*=l.y;u.z*=l.z;u.vadd(f,u);u.vadd(l,t.aabb.upperBound)}};d.prototype.aabbQuery=function(c,d){for(var f=[this];f.length;){var e=f.pop();e.aabb.overlaps(c)&&Array.prototype.push.apply(d,e.data);Array.prototype.push.apply(f,e.children)}return d};var f=new g;d.prototype.rayQuery=function(c,d,e){c.getAABB(f);f.toLocalFrame(d,f);this.aabbQuery(f,e);return e};d.prototype.removeEmptyNodes=function(){for(var c=[this];c.length;){for(var d=c.pop(),f=d.children.length-1;0<=f;f--)d.children[f].data.length||
d.children.splice(f,1);Array.prototype.push.apply(c,d.children)}}},{"../collision/AABB":3,"../math/Vec3":30}],51:[function(c,e){function d(){this.objects=[];this.type=Object}e.exports=d;d.prototype.release=function(){for(var c=arguments.length,d=0;d!==c;d++)this.objects.push(arguments[d])};d.prototype.get=function(){return 0===this.objects.length?this.constructObject():this.objects.pop()};d.prototype.constructObject=function(){throw Error("constructObject() not implemented in this Pool subclass yet!");
}},{}],52:[function(c,e){function d(){this.data={keys:[]}}e.exports=d;d.prototype.get=function(c,d){if(c>d){var e=d;d=c;c=e}return this.data[c+"-"+d]};d.prototype.set=function(c,d,e){if(c>d){var l=d;d=c;c=l}l=c+"-"+d;this.get(c,d)||this.data.keys.push(l);this.data[l]=e};d.prototype.reset=function(){for(var c=this.data,d=c.keys;0<d.length;){var e=d.pop();delete c[e]}}},{}],53:[function(c,e){function d(){}e.exports=d;d.defaults=function(c,d){c=c||{};for(var e in d)e in c||(c[e]=d[e]);return c}},{}],
54:[function(c,e){function d(){g.call(this);this.type=j}e.exports=d;var j=c("../math/Vec3"),g=c("./Pool");d.prototype=new g;d.prototype.constructObject=function(){return new j}},{"../math/Vec3":30,"./Pool":51}],55:[function(c,e){function d(c){this.contactPointPool=[];this.frictionEquationPool=[];this.result=[];this.frictionResult=[];this.v3pool=new n;this.world=c;this.currentContactMaterial=null;this.enableFrictionReduction=!1}e.exports=d;var j=c("../collision/AABB"),g=c("../shapes/Shape"),p=c("../collision/Ray"),
l=c("../math/Vec3"),f=c("../math/Transform");c("../shapes/ConvexPolyhedron");var m=c("../math/Quaternion");c("../solver/Solver");var n=c("../utils/Vec3Pool"),r=c("../equations/ContactEquation"),s=c("../equations/FrictionEquation");d.prototype.createContactEquation=function(c,d,f,e,g,j){var m;this.contactPointPool.length?(m=this.contactPointPool.pop(),m.bi=c,m.bj=d):m=new r(c,d);m.enabled=c.collisionResponse&&d.collisionResponse&&f.collisionResponse&&e.collisionResponse;var n=this.currentContactMaterial;
m.restitution=n.restitution;m.setSpookParams(n.contactEquationStiffness,n.contactEquationRelaxation,this.world.dt);c=f.material||c.material;d=e.material||d.material;c&&(d&&0<=c.restitution&&0<=d.restitution)&&(m.restitution=c.restitution*d.restitution);m.si=g||f;m.sj=j||e;return m};d.prototype.createFrictionEquationsFromContact=function(c,d){var f=c.bi,e=c.bj,g=this.world,j=this.currentContactMaterial,m=j.friction,n=c.si.material||f.material,l=c.sj.material||e.material;n&&(l&&0<=n.friction&&0<=l.friction)&&
(m=n.friction*l.friction);if(0<m){m*=g.gravity.length();n=f.invMass+e.invMass;0<n&&(n=1/n);var r=this.frictionEquationPool,l=r.length?r.pop():new s(f,e,m*n),r=r.length?r.pop():new s(f,e,m*n);l.bi=r.bi=f;l.bj=r.bj=e;l.minForce=r.minForce=-m*n;l.maxForce=r.maxForce=m*n;l.ri.copy(c.ri);l.rj.copy(c.rj);r.ri.copy(c.ri);r.rj.copy(c.rj);c.ni.tangents(l.t,r.t);l.setSpookParams(j.frictionEquationStiffness,j.frictionEquationRelaxation,g.dt);r.setSpookParams(j.frictionEquationStiffness,j.frictionEquationRelaxation,
g.dt);l.enabled=r.enabled=c.enabled;d.push(l,r);return!0}return!1};var t=new l,u=new l,v=new l;d.prototype.createFrictionFromAverage=function(c){var d=this.result[this.result.length-1];if(this.createFrictionEquationsFromContact(d,this.frictionResult)&&1!==c){var f=this.frictionResult[this.frictionResult.length-2],e=this.frictionResult[this.frictionResult.length-1];t.setZero();u.setZero();v.setZero();for(var g=d.bi,j=0;j!==c;j++)d=this.result[this.result.length-1-j],d.bodyA!==g?(t.vadd(d.ni,t),u.vadd(d.ri,
u),v.vadd(d.rj,v)):(t.vsub(d.ni,t),u.vadd(d.rj,u),v.vadd(d.ri,v));c=1/c;u.scale(c,f.ri);v.scale(c,f.rj);e.ri.copy(f.ri);e.rj.copy(f.rj);t.normalize();t.tangents(f.t,e.t)}};var z=new l,x=new l,C=new m,B=new m;d.prototype.getContacts=function(c,d,f,e,g,j,m){this.contactPointPool=g;this.frictionEquationPool=m;this.result=e;this.frictionResult=j;e=0;for(g=c.length;e!==g;e++){j=c[e];m=d[e];var n=null;j.material&&m.material&&(n=f.getContactMaterial(j.material,m.material)||null);for(var l=0;l<j.shapes.length;l++){j.quaternion.mult(j.shapeOrientations[l],
C);j.quaternion.vmult(j.shapeOffsets[l],z);z.vadd(j.position,z);for(var r=j.shapes[l],s=0;s<m.shapes.length;s++){m.quaternion.mult(m.shapeOrientations[s],B);m.quaternion.vmult(m.shapeOffsets[s],x);x.vadd(m.position,x);var p=m.shapes[s];if(!(z.distanceTo(x)>r.boundingSphereRadius+p.boundingSphereRadius)){var q=null;r.material&&p.material&&(q=f.getContactMaterial(r.material,p.material)||null);this.currentContactMaterial=q||n||f.defaultContactMaterial;(q=this[r.type|p.type])&&(r.type<p.type?q.call(this,
r,p,z,x,C,B,j,m,r,p):q.call(this,p,r,x,z,B,C,m,j,r,p))}}}}};d.prototype[g.types.BOX|g.types.BOX]=d.prototype.boxBox=function(c,d,f,e,g,j,m,n){c.convexPolyhedronRepresentation.material=c.material;d.convexPolyhedronRepresentation.material=d.material;c.convexPolyhedronRepresentation.collisionResponse=c.collisionResponse;d.convexPolyhedronRepresentation.collisionResponse=d.collisionResponse;this.convexConvex(c.convexPolyhedronRepresentation,d.convexPolyhedronRepresentation,f,e,g,j,m,n,c,d)};d.prototype[g.types.BOX|
g.types.CONVEXPOLYHEDRON]=d.prototype.boxConvex=function(c,d,f,e,g,j,m,n){c.convexPolyhedronRepresentation.material=c.material;c.convexPolyhedronRepresentation.collisionResponse=c.collisionResponse;this.convexConvex(c.convexPolyhedronRepresentation,d,f,e,g,j,m,n,c,d)};d.prototype[g.types.BOX|g.types.PARTICLE]=d.prototype.boxParticle=function(c,d,f,e,g,j,m,n){c.convexPolyhedronRepresentation.material=c.material;c.convexPolyhedronRepresentation.collisionResponse=c.collisionResponse;this.convexParticle(c.convexPolyhedronRepresentation,
d,f,e,g,j,m,n,c,d)};d.prototype[g.types.SPHERE]=d.prototype.sphereSphere=function(c,d,f,e,g,j,m,n){g=this.createContactEquation(m,n,c,d);e.vsub(f,g.ni);g.ni.normalize();g.ri.copy(g.ni);g.rj.copy(g.ni);g.ri.mult(c.radius,g.ri);g.rj.mult(-d.radius,g.rj);g.ri.vadd(f,g.ri);g.ri.vsub(m.position,g.ri);g.rj.vadd(e,g.rj);g.rj.vsub(n.position,g.rj);this.result.push(g);this.createFrictionEquationsFromContact(g,this.frictionResult)};var E=new l,I=new l,y=new l;d.prototype[g.types.PLANE|g.types.TRIMESH]=d.prototype.planeTrimesh=
function(c,d,e,g,j,m,n,r){var s=new l;E.set(0,0,1);j.vmult(E,E);for(j=0;j<d.vertices.length/3;j++){d.getVertex(j,s);var p=new l;p.copy(s);f.pointToWorldFrame(g,m,p,s);p=I;s.vsub(e,p);if(0>=E.dot(p)){var q=this.createContactEquation(n,r,c,d);q.ni.copy(E);var t=y;E.scale(p.dot(E),t);s.vsub(t,t);q.ri.copy(t);q.ri.vsub(n.position,q.ri);q.rj.copy(s);q.rj.vsub(r.position,q.rj);this.result.push(q);this.createFrictionEquationsFromContact(q,this.frictionResult)}}};var D=new l,H=new l;new l;var M=new l,S=new l,
Q=new l,L=new l,W=new l,aa=new l,G=new l,F=new l,ka=new l,Z=new l,N=new l,T=new j,J=[];d.prototype[g.types.SPHERE|g.types.TRIMESH]=d.prototype.sphereTrimesh=function(c,d,e,g,j,m,n,l){f.pointToLocalFrame(g,m,e,G);j=c.radius;T.lowerBound.set(G.x-j,G.y-j,G.z-j);T.upperBound.set(G.x+j,G.y+j,G.z+j);d.getTrianglesInAABB(T,J);var r=c.radius*c.radius;for(j=0;j<J.length;j++)for(var s=0;3>s;s++)if(d.getVertex(d.indices[3*J[j]+s],M),M.vsub(G,H),H.norm2()<=r){S.copy(M);f.pointToWorldFrame(g,m,S,M);M.vsub(e,H);
var q=this.createContactEquation(n,l,c,d);q.ni.copy(H);q.ni.normalize();q.ri.copy(q.ni);q.ri.scale(c.radius,q.ri);q.ri.vadd(e,q.ri);q.ri.vsub(n.position,q.ri);q.rj.copy(M);q.rj.vsub(l.position,q.rj);this.result.push(q);this.createFrictionEquationsFromContact(q,this.frictionResult)}for(j=0;j<J.length;j++)for(s=0;3>s;s++)d.getVertex(d.indices[3*J[j]+s],Q),d.getVertex(d.indices[3*J[j]+(s+1)%3],L),L.vsub(Q,W),G.vsub(L,F),e=F.dot(W),G.vsub(Q,F),q=F.dot(W),0<q&&0>e&&(G.vsub(Q,F),aa.copy(W),aa.normalize(),
q=F.dot(aa),aa.scale(q,F),F.vadd(Q,F),e=F.distanceTo(G),e<c.radius&&(q=this.createContactEquation(n,l,c,d),F.vsub(G,q.ni),q.ni.normalize(),q.ni.scale(c.radius,q.ri),f.pointToWorldFrame(g,m,F,F),F.vsub(l.position,q.rj),f.vectorToWorldFrame(m,q.ni,q.ni),f.vectorToWorldFrame(m,q.ri,q.ri),this.result.push(q),this.createFrictionEquationsFromContact(q,this.frictionResult)));j=0;for(s=J.length;j!==s;j++)d.getTriangleVertices(J[j],ka,Z,N),d.getNormal(J[j],D),G.vsub(ka,F),e=F.dot(D),D.scale(e,F),G.vsub(F,
F),e=F.distanceTo(G),p.pointInTriangle(F,ka,Z,N)&&e<c.radius&&(q=this.createContactEquation(n,l,c,d),F.vsub(G,q.ni),q.ni.normalize(),q.ni.scale(c.radius,q.ri),f.pointToWorldFrame(g,m,F,F),F.vsub(l.position,q.rj),f.vectorToWorldFrame(m,q.ni,q.ni),f.vectorToWorldFrame(m,q.ri,q.ri),this.result.push(q),this.createFrictionEquationsFromContact(q,this.frictionResult));J.length=0};var U=new l,ha=new l;d.prototype[g.types.SPHERE|g.types.PLANE]=d.prototype.spherePlane=function(c,d,f,e,g,j,m,n){d=this.createContactEquation(m,
n,c,d);d.ni.set(0,0,1);j.vmult(d.ni,d.ni);d.ni.negate(d.ni);d.ni.normalize();d.ni.mult(c.radius,d.ri);f.vsub(e,U);d.ni.mult(d.ni.dot(U),ha);U.vsub(ha,d.rj);-U.dot(d.ni)<=c.radius&&(c=d.ri,j=d.rj,c.vadd(f,c),c.vsub(m.position,c),j.vadd(e,j),j.vsub(n.position,j),this.result.push(d),this.createFrictionEquationsFromContact(d,this.frictionResult))};var va=new l,wa=new l,ea=new l,ba=new l,A=new l,ia=new l,oa=new l,da=[new l,new l,new l,new l,new l,new l],Qa=new l,Aa=new l,Ga=new l,la=new l;d.prototype[g.types.SPHERE|
g.types.BOX]=d.prototype.sphereBox=function(c,d,f,e,g,j,m,n){g=this.v3pool;f.vsub(e,ba);d.getSideNormals(da,j);j=c.radius;for(var l=!1,r=null,s=0,p=0,q=0,t=null,u=0,v=da.length;u!==v&&!1===l;u++){var x=A;x.copy(da[u]);var z=x.norm();x.normalize();var y=ba.dot(x);if(y<z+j&&0<y){var G=ia,C=oa;G.copy(da[(u+1)%3]);C.copy(da[(u+2)%3]);var B=G.norm(),F=C.norm();G.normalize();C.normalize();var D=ba.dot(G),E=ba.dot(C);if(D<B&&(D>-B&&E<F&&E>-F)&&(y=Math.abs(y-z-j),null===t||y<t))t=y,p=D,q=E,r=z,Aa.copy(x),
Ga.copy(G),la.copy(C),s++}}s&&(l=!0,s=this.createContactEquation(m,n,c,d),Aa.mult(-j,s.ri),s.ni.copy(Aa),s.ni.negate(s.ni),Aa.mult(r,Aa),Ga.mult(p,Ga),Aa.vadd(Ga,Aa),la.mult(q,la),Aa.vadd(la,s.rj),s.ri.vadd(f,s.ri),s.ri.vsub(m.position,s.ri),s.rj.vadd(e,s.rj),s.rj.vsub(n.position,s.rj),this.result.push(s),this.createFrictionEquationsFromContact(s,this.frictionResult));y=g.get();for(r=0;2!==r&&!l;r++)for(p=0;2!==p&&!l;p++)for(q=0;2!==q&&!l;q++)y.set(0,0,0),r?y.vadd(da[0],y):y.vsub(da[0],y),p?y.vadd(da[1],
y):y.vsub(da[1],y),q?y.vadd(da[2],y):y.vsub(da[2],y),e.vadd(y,Qa),Qa.vsub(f,Qa),Qa.norm2()<j*j&&(l=!0,s=this.createContactEquation(m,n,c,d),s.ri.copy(Qa),s.ri.normalize(),s.ni.copy(s.ri),s.ri.mult(j,s.ri),s.rj.copy(y),s.ri.vadd(f,s.ri),s.ri.vsub(m.position,s.ri),s.rj.vadd(e,s.rj),s.rj.vsub(n.position,s.rj),this.result.push(s),this.createFrictionEquationsFromContact(s,this.frictionResult));g.release(y);t=g.get();u=g.get();s=g.get();v=g.get();y=g.get();x=da.length;for(r=0;r!==x&&!l;r++)for(p=0;p!==
x&&!l;p++)if(r%3!==p%3){da[p].cross(da[r],t);t.normalize();da[r].vadd(da[p],u);s.copy(f);s.vsub(u,s);s.vsub(e,s);z=s.dot(t);t.mult(z,v);for(q=0;q===r%3||q===p%3;)q++;y.copy(f);y.vsub(v,y);y.vsub(u,y);y.vsub(e,y);z=Math.abs(z);G=y.norm();z<da[q].norm()&&G<j&&(l=!0,q=this.createContactEquation(m,n,c,d),u.vadd(v,q.rj),q.rj.copy(q.rj),y.negate(q.ni),q.ni.normalize(),q.ri.copy(q.rj),q.ri.vadd(e,q.ri),q.ri.vsub(f,q.ri),q.ri.normalize(),q.ri.mult(j,q.ri),q.ri.vadd(f,q.ri),q.ri.vsub(m.position,q.ri),q.rj.vadd(e,
q.rj),q.rj.vsub(n.position,q.rj),this.result.push(q),this.createFrictionEquationsFromContact(q,this.frictionResult))}g.release(t,u,s,v,y)};var ub=new l,pa=new l,rb=new l,Ra=new l,za=new l,Za=new l,pb=new l,Wa=new l,vb=new l,Kb=new l;d.prototype[g.types.SPHERE|g.types.CONVEXPOLYHEDRON]=d.prototype.sphereConvex=function(c,d,f,e,g,j,m,n){g=this.v3pool;f.vsub(e,ub);for(var l=d.faceNormals,r=d.faces,s=d.vertices,p=c.radius,q=0;q!==s.length;q++){var t=za;j.vmult(s[q],t);e.vadd(t,t);var u=Ra;t.vsub(f,u);
if(u.norm2()<p*p){c=this.createContactEquation(m,n,c,d);c.ri.copy(u);c.ri.normalize();c.ni.copy(c.ri);c.ri.mult(p,c.ri);t.vsub(e,c.rj);c.ri.vadd(f,c.ri);c.ri.vsub(m.position,c.ri);c.rj.vadd(e,c.rj);c.rj.vsub(n.position,c.rj);this.result.push(c);this.createFrictionEquationsFromContact(c,this.frictionResult);return}}q=0;for(t=r.length;q!==t;q++){var u=r[q],v=Za;j.vmult(l[q],v);var x=pb;j.vmult(s[u[0]],x);x.vadd(e,x);var z=Wa;v.mult(-p,z);f.vadd(z,z);var y=vb;z.vsub(x,y);z=y.dot(v);y=Kb;f.vsub(x,y);
if(0>z&&0<y.dot(v)){for(var x=[],y=0,A=u.length;y!==A;y++){var G=g.get();j.vmult(s[u[y]],G);e.vadd(G,G);x.push(G)}a:{for(var y=x,A=v,G=f,C=null,B=y.length,F=0;F!==B;F++){var D=y[F],E=va;y[(F+1)%B].vsub(D,E);var T=wa;E.cross(A,T);E=ea;G.vsub(D,E);D=T.dot(E);if(null===C||0<D&&!0===C||0>=D&&!1===C)null===C&&(C=0<D);else{y=!1;break a}}y=!0}if(y){c=this.createContactEquation(m,n,c,d);v.mult(-p,c.ri);v.negate(c.ni);d=g.get();v.mult(-z,d);j=g.get();v.mult(-p,j);f.vsub(e,c.rj);c.rj.vadd(j,c.rj);c.rj.vadd(d,
c.rj);c.rj.vadd(e,c.rj);c.rj.vsub(n.position,c.rj);c.ri.vadd(f,c.ri);c.ri.vsub(m.position,c.ri);g.release(d);g.release(j);this.result.push(c);this.createFrictionEquationsFromContact(c,this.frictionResult);y=0;for(u=x.length;y!==u;y++)g.release(x[y]);break}else for(y=0;y!==u.length;y++){v=g.get();z=g.get();j.vmult(s[u[(y+1)%u.length]],v);j.vmult(s[u[(y+2)%u.length]],z);e.vadd(v,v);e.vadd(z,z);B=pa;z.vsub(v,B);C=rb;B.unit(C);A=g.get();G=g.get();f.vsub(v,G);F=G.dot(C);C.mult(F,A);A.vadd(v,A);C=g.get();
A.vsub(f,C);if(0<F&&F*F<B.norm2()&&C.norm2()<p*p){c=this.createContactEquation(m,n,c,d);A.vsub(e,c.rj);A.vsub(f,c.ni);c.ni.normalize();c.ni.mult(p,c.ri);c.rj.vadd(e,c.rj);c.rj.vsub(n.position,c.rj);c.ri.vadd(f,c.ri);c.ri.vsub(m.position,c.ri);this.result.push(c);this.createFrictionEquationsFromContact(c,this.frictionResult);y=0;for(u=x.length;y!==u;y++)g.release(x[y]);g.release(v);g.release(z);g.release(A);g.release(C);g.release(G);return}g.release(v);g.release(z);g.release(A);g.release(C);g.release(G)}y=
0;for(u=x.length;y!==u;y++)g.release(x[y])}}};new l;new l;d.prototype[g.types.PLANE|g.types.BOX]=d.prototype.planeBox=function(c,d,f,e,g,j,m,n){d.convexPolyhedronRepresentation.material=d.material;d.convexPolyhedronRepresentation.collisionResponse=d.collisionResponse;this.planeConvex(c,d.convexPolyhedronRepresentation,f,e,g,j,m,n)};var O=new l,P=new l,Ea=new l,R=new l;d.prototype[g.types.PLANE|g.types.CONVEXPOLYHEDRON]=d.prototype.planeConvex=function(c,d,f,e,g,j,m,n){P.set(0,0,1);g.vmult(P,P);for(var l=
g=0;l!==d.vertices.length;l++)if(O.copy(d.vertices[l]),j.vmult(O,O),e.vadd(O,O),O.vsub(f,Ea),0>=P.dot(Ea)){var r=this.createContactEquation(m,n,c,d),s=R;P.mult(P.dot(Ea),s);O.vsub(s,s);s.vsub(f,r.ri);r.ni.copy(P);O.vsub(e,r.rj);r.ri.vadd(f,r.ri);r.ri.vsub(m.position,r.ri);r.rj.vadd(e,r.rj);r.rj.vsub(n.position,r.rj);this.result.push(r);g++;this.enableFrictionReduction||this.createFrictionEquationsFromContact(r,this.frictionResult)}this.enableFrictionReduction&&g&&this.createFrictionFromAverage(g)};
var gb=new l,bb=new l;d.prototype[g.types.CONVEXPOLYHEDRON]=d.prototype.convexConvex=function(c,d,f,e,g,j,m,n,l,r,s,p){if(!(f.distanceTo(e)>c.boundingSphereRadius+d.boundingSphereRadius)&&c.findSeparatingAxis(d,f,g,e,j,gb,s,p)){s=[];c.clipAgainstHull(f,g,d,e,j,gb,-100,100,s);for(j=g=0;j!==s.length;j++){p=this.createContactEquation(m,n,c,d,l,r);var q=p.ri,t=p.rj;gb.negate(p.ni);s[j].normal.negate(bb);bb.mult(s[j].depth,bb);s[j].point.vadd(bb,q);t.copy(s[j].point);q.vsub(f,q);t.vsub(e,t);q.vadd(f,q);
q.vsub(m.position,q);t.vadd(e,t);t.vsub(n.position,t);this.result.push(p);g++;this.enableFrictionReduction||this.createFrictionEquationsFromContact(p,this.frictionResult)}this.enableFrictionReduction&&g&&this.createFrictionFromAverage(g)}};var q=new l,wb=new l,cb=new l;d.prototype[g.types.PLANE|g.types.PARTICLE]=d.prototype.planeParticle=function(c,d,f,e,g,j,m,n){q.set(0,0,1);m.quaternion.vmult(q,q);e.vsub(m.position,wb);0>=q.dot(wb)&&(c=this.createContactEquation(n,m,d,c),c.ni.copy(q),c.ni.negate(c.ni),
c.ri.set(0,0,0),q.mult(q.dot(e),cb),e.vsub(cb,cb),c.rj.copy(cb),this.result.push(c),this.createFrictionEquationsFromContact(c,this.frictionResult))};var Sa=new l;d.prototype[g.types.PARTICLE|g.types.SPHERE]=d.prototype.sphereParticle=function(c,d,f,e,g,j,m,n){Sa.set(0,0,1);e.vsub(f,Sa);Sa.norm2()<=c.radius*c.radius&&(d=this.createContactEquation(n,m,d,c),Sa.normalize(),d.rj.copy(Sa),d.rj.mult(c.radius,d.rj),d.ni.copy(Sa),d.ni.negate(d.ni),d.ri.set(0,0,0),this.result.push(d),this.createFrictionEquationsFromContact(d,
this.frictionResult))};var Pa=new m,Ta=new l;new l;var sa=new l,Y=new l,Da=new l;d.prototype[g.types.PARTICLE|g.types.CONVEXPOLYHEDRON]=d.prototype.convexParticle=function(c,d,f,e,g,j,m,n){var l=-1;j=null;var r=0;Ta.copy(e);Ta.vsub(f,Ta);g.conjugate(Pa);Pa.vmult(Ta,Ta);if(c.pointIsInside(Ta)){c.worldVerticesNeedsUpdate&&c.computeWorldVertices(f,g);c.worldFaceNormalsNeedsUpdate&&c.computeWorldFaceNormals(g);g=0;for(var s=c.faces.length;g!==s;g++){var p=c.worldFaceNormals[g];e.vsub(c.worldVertices[c.faces[g][0]],
Y);var q=-p.dot(Y);if(null===j||Math.abs(q)<Math.abs(j))j=q,l=g,sa.copy(p),r++}-1!==l?(c=this.createContactEquation(n,m,d,c),sa.mult(j,Da),Da.vadd(e,Da),Da.vsub(f,Da),c.rj.copy(Da),sa.negate(c.ni),c.ri.set(0,0,0),d=c.ri,j=c.rj,d.vadd(e,d),d.vsub(n.position,d),j.vadd(f,j),j.vsub(m.position,j),this.result.push(c),this.createFrictionEquationsFromContact(c,this.frictionResult)):console.warn("Point found inside convex, but did not find penetrating face!")}};d.prototype[g.types.BOX|g.types.HEIGHTFIELD]=
d.prototype.boxHeightfield=function(c,d,f,e,g,j,m,n){c.convexPolyhedronRepresentation.material=c.material;c.convexPolyhedronRepresentation.collisionResponse=c.collisionResponse;this.convexHeightfield(c.convexPolyhedronRepresentation,d,f,e,g,j,m,n)};var ma=new l,ta=new l,Ab=[0];d.prototype[g.types.CONVEXPOLYHEDRON|g.types.HEIGHTFIELD]=d.prototype.convexHeightfield=function(c,d,e,g,j,m,n,l){var r=d.data,s=d.elementSize,p=c.boundingSphereRadius;f.pointToLocalFrame(g,m,e,ma);var q=Math.floor((ma.x-p)/
s)-1,t=Math.ceil((ma.x+p)/s)+1,u=Math.floor((ma.y-p)/s)-1,s=Math.ceil((ma.y+p)/s)+1;if(!(0>t||0>s||q>r.length||u>r[0].length)){0>q&&(q=0);0>t&&(t=0);0>u&&(u=0);0>s&&(s=0);q>=r.length&&(q=r.length-1);t>=r.length&&(t=r.length-1);s>=r[0].length&&(s=r[0].length-1);u>=r[0].length&&(u=r[0].length-1);r=[];d.getRectMinMax(q,u,t,s,r);var v=r[0];if(!(ma.z-p>r[1]||ma.z+p<v))for(p=q;p<t;p++)for(q=u;q<s;q++)d.getConvexTrianglePillar(p,q,!1),f.pointToWorldFrame(g,m,d.pillarOffset,ta),e.distanceTo(ta)<d.pillarConvex.boundingSphereRadius+
c.boundingSphereRadius&&this.convexConvex(c,d.pillarConvex,e,ta,j,m,n,l,null,null,Ab,null),d.getConvexTrianglePillar(p,q,!0),f.pointToWorldFrame(g,m,d.pillarOffset,ta),e.distanceTo(ta)<d.pillarConvex.boundingSphereRadius+c.boundingSphereRadius&&this.convexConvex(c,d.pillarConvex,e,ta,j,m,n,l,null,null,Ab,null)}};var Ka=new l,La=new l;d.prototype[g.types.SPHERE|g.types.HEIGHTFIELD]=d.prototype.sphereHeightfield=function(c,d,e,g,j,m,n,l){var r=d.data,s=c.radius,p=d.elementSize;f.pointToLocalFrame(g,
m,e,Ka);var q=Math.floor((Ka.x-s)/p)-1,t=Math.ceil((Ka.x+s)/p)+1,u=Math.floor((Ka.y-s)/p)-1,p=Math.ceil((Ka.y+s)/p)+1;if(!(0>t||0>p||q>r.length||p>r[0].length)){0>q&&(q=0);0>t&&(t=0);0>u&&(u=0);0>p&&(p=0);q>=r.length&&(q=r.length-1);t>=r.length&&(t=r.length-1);p>=r[0].length&&(p=r[0].length-1);u>=r[0].length&&(u=r[0].length-1);r=[];d.getRectMinMax(q,u,t,p,r);var v=r[0];if(!(Ka.z-s>r[1]||Ka.z+s<v))for(s=this.result;q<t;q++)for(r=u;r<p;r++)if(v=s.length,d.getConvexTrianglePillar(q,r,!1),f.pointToWorldFrame(g,
m,d.pillarOffset,La),e.distanceTo(La)<d.pillarConvex.boundingSphereRadius+c.boundingSphereRadius&&this.sphereConvex(c,d.pillarConvex,e,La,j,m,n,l),d.getConvexTrianglePillar(q,r,!0),f.pointToWorldFrame(g,m,d.pillarOffset,La),e.distanceTo(La)<d.pillarConvex.boundingSphereRadius+c.boundingSphereRadius&&this.sphereConvex(c,d.pillarConvex,e,La,j,m,n,l),2<s.length-v)return}}},{"../collision/AABB":3,"../collision/Ray":9,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../math/Quaternion":28,
"../math/Transform":29,"../math/Vec3":30,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43,"../solver/Solver":47,"../utils/Vec3Pool":54}],56:[function(c,e){function d(){f.apply(this);this.dt=-1;this.allowSleep=!1;this.contacts=[];this.frictionEquations=[];this.quatNormalizeSkip=0;this.quatNormalizeFast=!1;this.stepnumber=this.time=0;this.default_dt=1/60;this.nextId=0;this.gravity=new j;this.broadphase=new x;this.bodies=[];this.solver=new p;this.constraints=[];this.narrowphase=new l(this);this.collisionMatrix=
new m;this.collisionMatrixPrevious=new m;this.materials=[];this.contactmaterials=[];this.contactMaterialTable=new t;this.defaultMaterial=new n("default");this.defaultContactMaterial=new r(this.defaultMaterial,this.defaultMaterial,{friction:0.3,restitution:0});this.doProfiling=!1;this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0};this.subsystems=[];this.addBodyEvent={type:"addBody",body:null};this.removeBodyEvent={type:"removeBody",body:null}}e.exports=d;c("../shapes/Shape");
var j=c("../math/Vec3"),g=c("../math/Quaternion"),p=c("../solver/GSSolver");c("../utils/Vec3Pool");c("../equations/ContactEquation");c("../equations/FrictionEquation");var l=c("./Narrowphase"),f=c("../utils/EventTarget"),m=c("../collision/ArrayCollisionMatrix"),n=c("../material/Material"),r=c("../material/ContactMaterial"),s=c("../objects/Body"),t=c("../utils/TupleDictionary"),u=c("../collision/RaycastResult"),v=c("../collision/AABB"),z=c("../collision/Ray"),x=c("../collision/NaiveBroadphase");d.prototype=
new f;new v;var C=new z;d.prototype.getContactMaterial=function(c,d){return this.contactMaterialTable.get(c.id,d.id)};d.prototype.numObjects=function(){return this.bodies.length};d.prototype.collisionMatrixTick=function(){var c=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix;this.collisionMatrix=c;this.collisionMatrix.reset()};d.prototype.add=d.prototype.addBody=function(c){-1===this.bodies.indexOf(c)&&(c.index=this.bodies.length,this.bodies.push(c),c.world=this,c.initPosition.copy(c.position),
c.initVelocity.copy(c.velocity),c.timeLastSleepy=this.time,c instanceof s&&(c.initAngularVelocity.copy(c.angularVelocity),c.initQuaternion.copy(c.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=c,this.dispatchEvent(this.addBodyEvent))};d.prototype.addConstraint=function(c){this.constraints.push(c)};d.prototype.removeConstraint=function(c){c=this.constraints.indexOf(c);-1!==c&&this.constraints.splice(c,1)};d.prototype.rayTest=function(c,d,f){f instanceof u?
this.raycastClosest(c,d,{skipBackfaces:!0},f):this.raycastAll(c,d,{skipBackfaces:!0},f)};d.prototype.raycastAll=function(c,d,f,e){f.mode=z.ALL;f.from=c;f.to=d;f.callback=e;return C.intersectWorld(this,f)};d.prototype.raycastAny=function(c,d,f,e){f.mode=z.ANY;f.from=c;f.to=d;f.result=e;return C.intersectWorld(this,f)};d.prototype.raycastClosest=function(c,d,f,e){f.mode=z.CLOSEST;f.from=c;f.to=d;f.result=e;return C.intersectWorld(this,f)};d.prototype.remove=function(c){c.world=null;var d=this.bodies.length-
1,f=this.bodies,e=f.indexOf(c);if(-1!==e){f.splice(e,1);for(e=0;e!==f.length;e++)f[e].index=e;this.collisionMatrix.setNumObjects(d);this.removeBodyEvent.body=c;this.dispatchEvent(this.removeBodyEvent)}};d.prototype.removeBody=d.prototype.remove;d.prototype.addMaterial=function(c){this.materials.push(c)};d.prototype.addContactMaterial=function(c){this.contactmaterials.push(c);this.contactMaterialTable.set(c.materials[0].id,c.materials[1].id,c)};"undefined"===typeof performance&&(performance={});if(!performance.now){var B=
Date.now();performance.timing&&performance.timing.navigationStart&&(B=performance.timing.navigationStart);performance.now=function(){return Date.now()-B}}var E=new j;d.prototype.step=function(c,d,f){f=f||10;d=d||0;if(0===d)this.internalStep(c),this.time+=c;else{var e=Math.floor((this.time+d)/c)-Math.floor(this.time/c),e=Math.min(e,f);f=performance.now();for(var g=0;g!==e&&!(this.internalStep(c),performance.now()-f>1E3*c);g++);this.time+=d;c=this.time%c/c;d=this.bodies;for(e=0;e!==d.length;e++)f=d[e],
f.type!==s.STATIC&&f.sleepState!==s.SLEEPING?(f.position.vsub(f.previousPosition,E),E.scale(c,E),f.position.vadd(E,f.interpolatedPosition)):(f.interpolatedPosition.copy(f.position),f.interpolatedQuaternion.copy(f.quaternion))}};var I={type:"postStep"},y={type:"preStep"},D={type:"collide",body:null,contact:null},H=[],M=[],S=[],Q=[];new j;new j;new j;new j;new j;new j;new j;new j;new j;new g;var L=new g,W=new g,aa=new j;d.prototype.internalStep=function(c){this.dt=c;var d=this.contacts,f=this.numObjects(),
e=this.bodies,g=this.solver,j=this.gravity,m=this.doProfiling,n=this.profile,l=s.DYNAMIC,r,p=this.constraints;j.norm();var t=j.x,u=j.y,v=j.z,j=0;m&&(r=performance.now());for(j=0;j!==f;j++){var x=e[j];if(x.type&l){var z=x.force,x=x.mass;z.x+=x*t;z.y+=x*u;z.z+=x*v}}j=0;for(x=this.subsystems.length;j!==x;j++)this.subsystems[j].update();m&&(r=performance.now());S.length=0;Q.length=0;this.broadphase.collisionPairs(this,S,Q);m&&(n.broadphase=performance.now()-r);x=p.length;for(j=0;j!==x;j++)if(t=p[j],!t.collideConnected)for(u=
S.length-1;0<=u;u-=1)if(t.bodyA===S[u]&&t.bodyB===Q[u]||t.bodyB===S[u]&&t.bodyA===Q[u])S.splice(u,1),Q.splice(u,1);this.collisionMatrixTick();m&&(r=performance.now());x=d.length;for(j=0;j!==x;j++)H.push(d[j]);d.length=0;x=this.frictionEquations.length;for(j=0;j!==x;j++)M.push(this.frictionEquations[j]);this.frictionEquations.length=0;this.narrowphase.getContacts(S,Q,this,d,H,this.frictionEquations,M);m&&(n.narrowphase=performance.now()-r);m&&(r=performance.now());for(j=0;j<this.frictionEquations.length;j++)g.addEquation(this.frictionEquations[j]);
j=d.length;for(u=0;u!==j;u++){t=d[u];x=t.bi;v=t.bj;x.material&&v.material&&this.getContactMaterial(x.material,v.material);x.material&&v.material&&(0<=x.material.restitution&&0<=v.material.restitution)&&(t.restitution=x.material.restitution*v.material.restitution);g.addEquation(t);if(x.allowSleep&&x.type===s.DYNAMIC&&x.sleepState===s.SLEEPING&&v.sleepState===s.AWAKE&&v.type!==s.STATIC){var z=v.velocity.norm2()+v.angularVelocity.norm2(),C=Math.pow(v.sleepSpeedLimit,2);z>=2*C&&(x._wakeUpAfterNarrowphase=
!0)}v.allowSleep&&(v.type===s.DYNAMIC&&v.sleepState===s.SLEEPING&&x.sleepState===s.AWAKE&&x.type!==s.STATIC)&&(z=x.velocity.norm2()+x.angularVelocity.norm2(),C=Math.pow(x.sleepSpeedLimit,2),z>=2*C&&(v._wakeUpAfterNarrowphase=!0));this.collisionMatrix.set(x,v,!0);this.collisionMatrixPrevious.get(x,v)||(D.body=v,D.contact=t,x.dispatchEvent(D),D.body=x,v.dispatchEvent(D))}m&&(n.makeContactConstraints=performance.now()-r,r=performance.now());for(j=0;j!==f;j++)x=e[j],x._wakeUpAfterNarrowphase&&(x.wakeUp(),
x._wakeUpAfterNarrowphase=!1);x=p.length;for(j=0;j!==x;j++){t=p[j];t.update();u=0;for(d=t.equations.length;u!==d;u++)g.addEquation(t.equations[u])}g.solve(c,this);m&&(n.solve=performance.now()-r);g.removeAllEquations();g=Math.pow;for(j=0;j!==f;j++)if(x=e[j],x.type&l&&(p=g(1-x.linearDamping,c),d=x.velocity,d.mult(p,d),p=x.angularVelocity))d=g(1-x.angularDamping,c),p.mult(d,p);this.dispatchEvent(y);for(j=0;j!==f;j++)x=e[j],x.preStep&&x.preStep.call(x);m&&(r=performance.now());l=s.DYNAMIC|s.KINEMATIC;
g=0===this.stepnumber%(this.quatNormalizeSkip+1);p=this.quatNormalizeFast;d=0.5*c;for(j=0;j!==f;j++)if(x=e[j],t=x.force,u=x.torque,x.type&l&&x.sleepState!==s.SLEEPING){var v=x.velocity,z=x.angularVelocity,C=x.position,B=x.quaternion,E=x.invMass,Ga=x.invInertiaWorld;v.x+=t.x*E*c;v.y+=t.y*E*c;v.z+=t.z*E*c;x.angularVelocity&&(Ga.vmult(u,aa),aa.mult(c,aa),aa.vadd(z,z));C.x+=v.x*c;C.y+=v.y*c;C.z+=v.z*c;x.angularVelocity&&(L.set(z.x,z.y,z.z,0),L.mult(B,W),B.x+=d*W.x,B.y+=d*W.y,B.z+=d*W.z,B.w+=d*W.w,g&&
(p?B.normalizeFast():B.normalize()));x.aabb&&(x.aabbNeedsUpdate=!0);x.updateInertiaWorld&&x.updateInertiaWorld()}this.clearForces();this.broadphase.dirty=!0;m&&(n.integrate=performance.now()-r);this.time+=c;this.stepnumber+=1;this.dispatchEvent(I);for(j=0;j!==f;j++)x=e[j],(c=x.postStep)&&c.call(x);if(this.allowSleep)for(j=0;j!==f;j++)e[j].sleepTick(this.time)};d.prototype.clearForces=function(){for(var c=this.bodies,d=c.length,f=0;f!==d;f++){var e=c[f];e.force.set(0,0,0);e.torque.set(0,0,0)}}},{"../collision/AABB":3,
"../collision/ArrayCollisionMatrix":4,"../collision/NaiveBroadphase":7,"../collision/Ray":9,"../collision/RaycastResult":10,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../material/ContactMaterial":24,"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Shape":43,"../solver/GSSolver":46,"../utils/EventTarget":49,"../utils/TupleDictionary":52,"../utils/Vec3Pool":54,"./Narrowphase":55}]},{},[2])(2)});function getInternetExplorerVersion(){var b=-1;"Microsoft Internet Explorer"==navigator.appName&&null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(b=parseFloat(RegExp.$1));return b}var ie=getInternetExplorerVersion();function getQueryVariable(b){for(var c=window.location.search.substring(1).split("&"),e=0;e<c.length;e++){var d=c[e].match(/([^=]+?)=(.+)/);if(d&&decodeURIComponent(d[1])==b)return decodeURIComponent(d[2])}};this.jukebox={};
jukebox.Player=function(b,c){this.id=++jukebox.__jukeboxId;this.origin=c||null;this.settings={};for(var e in this.defaults)this.settings[e]=this.defaults[e];if("[object Object]"===Object.prototype.toString.call(b))for(var d in b)this.settings[d]=b[d];"[object Function]"===Object.prototype.toString.call(jukebox.Manager)&&(jukebox.Manager=new jukebox.Manager);this.resource=this.isPlaying=null;this.resource="[object Object]"===Object.prototype.toString.call(jukebox.Manager)?jukebox.Manager.getPlayableResource(this.settings.resources):this.settings.resources[0]||
null;if(null===this.resource)throw"Your browser can't playback the given resources - or you have missed to include jukebox.Manager";this.__init();return this};jukebox.__jukeboxId=0;
jukebox.Player.prototype={defaults:{resources:[],autoplay:!1,spritemap:{},flashMediaElement:"./swf/FlashMediaElement.swf",timeout:1E3},__addToManager:function(){!0!==this.__wasAddedToManager&&(jukebox.Manager.add(this),this.__wasAddedToManager=!0)},__init:function(){var b=this,c=this.settings,e={},d;jukebox.Manager&&void 0!==jukebox.Manager.features&&(e=jukebox.Manager.features);if(!0===e.html5audio){this.context=new Audio;this.context.src=this.resource;if(null===this.origin){var j=function(c){b.__addToManager(c)};
this.context.addEventListener("canplaythrough",j,!0);window.setTimeout(function(){b.context.removeEventListener("canplaythrough",j,!0);j("timeout")},c.timeout)}this.context.autobuffer=!0;this.context.preload=!0;for(d in this.HTML5API)this[d]=this.HTML5API[d];1<e.channels?!0===c.autoplay?this.context.autoplay=!0:void 0!==c.spritemap[c.autoplay]&&this.play(c.autoplay):1===e.channels&&void 0!==c.spritemap[c.autoplay]&&(this.backgroundMusic=c.spritemap[c.autoplay],this.backgroundMusic.started=Date.now?
Date.now():+new Date,this.play(c.autoplay));1==e.channels&&!0!==c.canPlayBackground&&(window.addEventListener("pagehide",function(){null!==b.isPlaying&&(b.pause(),b.__wasAutoPaused=!0)}),window.addEventListener("pageshow",function(){b.__wasAutoPaused&&(b.resume(),delete b._wasAutoPaused)}))}else if(!0===e.flashaudio){for(d in this.FLASHAPI)this[d]=this.FLASHAPI[d];e=["id=jukebox-flashstream-"+this.id,"autoplay="+c.autoplay,"file="+window.encodeURIComponent(this.resource)];this.__initFlashContext(e);
!0===c.autoplay?this.play(0):c.spritemap[c.autoplay]&&this.play(c.autoplay)}else throw"Your Browser does not support Flash Audio or HTML5 Audio.";},__initFlashContext:function(b){var c,e=this.settings.flashMediaElement,d,j={flashvars:b.join("&"),quality:"high",bgcolor:"#000000",wmode:"transparent",allowscriptaccess:"always",allowfullscreen:"true"};if(navigator.userAgent.match(/MSIE/)){c=document.createElement("div");document.getElementsByTagName("body")[0].appendChild(c);var g=document.createElement("object");
g.id="jukebox-flashstream-"+this.id;g.setAttribute("type","application/x-shockwave-flash");g.setAttribute("classid","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000");g.setAttribute("width","0");g.setAttribute("height","0");j.movie=e+"?x="+(Date.now?Date.now():+new Date);j.flashvars=b.join("&amp;");for(d in j)b=document.createElement("param"),b.setAttribute("name",d),b.setAttribute("value",j[d]),g.appendChild(b);c.outerHTML=g.outerHTML;this.context=document.getElementById("jukebox-flashstream-"+this.id)}else{c=
document.createElement("embed");c.id="jukebox-flashstream-"+this.id;c.setAttribute("type","application/x-shockwave-flash");c.setAttribute("width","100");c.setAttribute("height","100");j.play=!1;j.loop=!1;j.src=e+"?x="+(Date.now?Date.now():+new Date);for(d in j)c.setAttribute(d,j[d]);document.getElementsByTagName("body")[0].appendChild(c);this.context=c}},backgroundHackForiOS:function(){if(void 0!==this.backgroundMusic){var b=Date.now?Date.now():+new Date;void 0===this.backgroundMusic.started?(this.backgroundMusic.started=
b,this.setCurrentTime(this.backgroundMusic.start)):(this.backgroundMusic.lastPointer=(b-this.backgroundMusic.started)/1E3%(this.backgroundMusic.end-this.backgroundMusic.start)+this.backgroundMusic.start,this.play(this.backgroundMusic.lastPointer))}},play:function(b,c){if(null!==this.isPlaying&&!0!==c)void 0!==jukebox.Manager&&jukebox.Manager.addToQueue(b,this.id);else{var e=this.settings.spritemap,d;if(void 0!==e[b])d=e[b].start;else if("number"===typeof b){d=b;for(var j in e)if(d>=e[j].start&&d<=
e[j].end){b=j;break}}void 0!==d&&"[object Object]"===Object.prototype.toString.call(e[b])&&(this.isPlaying=this.settings.spritemap[b],this.context.play&&this.context.play(),this.wasReady=this.setCurrentTime(d))}},stop:function(){this.__lastPosition=0;this.isPlaying=null;this.backgroundMusic?this.backgroundHackForiOS():this.context.pause();return!0},pause:function(){this.isPlaying=null;this.__lastPosition=this.getCurrentTime();this.context.pause();return this.__lastPosition},resume:function(b){b="number"===
typeof b?b:this.__lastPosition;if(null!==b)return this.play(b),this.__lastPosition=null,!0;this.context.play();return!1},HTML5API:{getVolume:function(){return this.context.volume||1},setVolume:function(b){this.context.volume=b;return 1E-4>Math.abs(this.context.volume-b)?!0:!1},getCurrentTime:function(){return this.context.currentTime||0},setCurrentTime:function(b){try{return this.context.currentTime=b,!0}catch(c){return!1}}},FLASHAPI:{getVolume:function(){return this.context&&"function"===typeof this.context.getVolume?
this.context.getVolume():1},setVolume:function(b){return this.context&&"function"===typeof this.context.setVolume?(this.context.setVolume(b),!0):!1},getCurrentTime:function(){return this.context&&"function"===typeof this.context.getCurrentTime?this.context.getCurrentTime():0},setCurrentTime:function(b){return this.context&&"function"===typeof this.context.setCurrentTime?this.context.setCurrentTime(b):!1}}};
if(void 0===this.jukebox)throw"jukebox.Manager requires jukebox.Player (Player.js) to run properly.";
jukebox.Manager=function(b){this.features={};this.codecs={};this.__players={};this.__playersLength=0;this.__clones={};this.__queue=[];this.settings={};for(var c in this.defaults)this.settings[c]=this.defaults[c];if("[object Object]"===Object.prototype.toString.call(b))for(var e in b)this.settings[e]=b[e];this.__detectFeatures();jukebox.Manager.__initialized=!1===this.settings.useGameLoop?window.setInterval(function(){jukebox.Manager.loop()},20):!0};
jukebox.Manager.prototype={defaults:{useFlash:!1,useGameLoop:!1},__detectFeatures:function(){var b=window.Audio&&new Audio;if(b&&b.canPlayType&&!1===this.settings.useFlash){for(var c=[{e:"3gp",m:["audio/3gpp","audio/amr"]},{e:"aac",m:["audio/aac","audio/aacp"]},{e:"amr",m:["audio/amr","audio/3gpp"]},{e:"caf",m:["audio/IMA-ADPCM","audio/x-adpcm",'audio/x-aiff; codecs="IMA-ADPCM, ADPCM"']},{e:"m4a",m:'audio/mp4{audio/mp4; codecs="mp4a.40.2,avc1.42E01E"{audio/mpeg4{audio/mpeg4-generic{audio/mp4a-latm{audio/MP4A-LATM{audio/x-m4a'.split("{")},
{e:"mp3",m:["audio/mp3","audio/mpeg",'audio/mpeg; codecs="mp3"',"audio/MPA","audio/mpa-robust"]},{e:"mpga",m:["audio/MPA","audio/mpa-robust","audio/mpeg","video/mpeg"]},{e:"mp4",m:["audio/mp4","video/mp4"]},{e:"ogg",m:["application/ogg","audio/ogg",'audio/ogg; codecs="theora, vorbis"',"video/ogg",'video/ogg; codecs="theora, vorbis"']},{e:"wav",m:["audio/wave","audio/wav",'audio/wav; codecs="1"',"audio/x-wav","audio/x-pn-wav"]},{e:"webm",m:["audio/webm",'audio/webm; codecs="vorbis"',"video/webm"]}],
e,d,j=0,g=c.length;j<g;j++)if(d=c[j].e,c[j].m.length&&"object"===typeof c[j].m)for(var p=0,l=c[j].m.length;p<l;p++)if(e=c[j].m[p],""!==b.canPlayType(e)){this.codecs[d]=e;break}else this.codecs[d]||(this.codecs[d]=!1);this.features.html5audio=!(!this.codecs.mp3&&!this.codecs.ogg&&!this.codecs.webm&&!this.codecs.wav);this.features.channels=8;b.volume=0.1337;this.features.volume=!!(1E-4>Math.abs(b.volume-0.1337));navigator.userAgent.match(/iPhone|iPod|iPad/i)&&(this.features.channels=1)}this.features.flashaudio=
!!navigator.mimeTypes["application/x-shockwave-flash"]||!!navigator.plugins["Shockwave Flash"]||!1;if(window.ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash.10"),this.features.flashaudio=!0}catch(f){}!0===this.settings.useFlash&&(this.features.flashaudio=!0);!0===this.features.flashaudio&&!this.features.html5audio&&(this.codecs.mp3="audio/mp3",this.codecs.mpga="audio/mpeg",this.codecs.mp4="audio/mp4",this.codecs.m4a="audio/mp4",this.codecs["3gp"]="audio/3gpp",this.codecs.amr="audio/amr",
this.features.volume=!0,this.features.channels=1)},__getPlayerById:function(b){return this.__players&&void 0!==this.__players[b]?this.__players[b]:null},__getClone:function(b,c){for(var e in this.__clones){var d=this.__clones[e];if(null===d.isPlaying&&d.origin===b)return d}if("[object Object]"===Object.prototype.toString.call(c)){e={};for(var j in c)e[j]=c[j];e.autoplay=!1;j=new jukebox.Player(e,b);j.isClone=!0;j.wasReady=!1;return this.__clones[j.id]=j}return null},loop:function(){if(0!==this.__playersLength)if(this.__queue.length&&
this.__playersLength<this.features.channels){var b=this.__queue[0],c=this.__getPlayerById(b.origin);if(null!==c){var e=this.__getClone(b.origin,c.settings);null!==e&&(!0===this.features.volume&&(c=this.__players[b.origin])&&e.setVolume(c.getVolume()),this.add(e),e.play(b.pointer,!0))}this.__queue.splice(0,1)}else for(e in this.__queue.length&&1===this.features.channels&&(b=this.__queue[0],c=this.__getPlayerById(b.origin),null!==c&&c.play(b.pointer,!0),this.__queue.splice(0,1)),this.__players)b=this.__players[e],
c=b.getCurrentTime()||0,b.isPlaying&&!1===b.wasReady?b.wasReady=b.setCurrentTime(b.isPlaying.start):b.isPlaying&&!0===b.wasReady?c>b.isPlaying.end&&(!0===b.isPlaying.loop?b.play(b.isPlaying.start,!0):b.stop()):b.isClone&&null===b.isPlaying?this.remove(b):void 0!==b.backgroundMusic&&null===b.isPlaying&&c>b.backgroundMusic.end&&b.backgroundHackForiOS()},getPlayableResource:function(b){"[object Array]"!==Object.prototype.toString.call(b)&&(b=[b]);for(var c=0,e=b.length;c<e;c++){var d=b[c],j=d.match(/\.([^\.]*)$/)[1];
if(j&&this.codecs[j])return d}return null},add:function(b){return b instanceof jukebox.Player&&void 0===this.__players[b.id]?(this.__playersLength++,this.__players[b.id]=b,!0):!1},remove:function(b){return b instanceof jukebox.Player&&void 0!==this.__players[b.id]?(this.__playersLength--,delete this.__players[b.id],!0):!1},addToQueue:function(b,c){return("string"===typeof b||"number"===typeof b)&&void 0!==this.__players[c]?(this.__queue.push({pointer:b,origin:c}),!0):!1}};(function(){var b=function(){this.init()};b.prototype={init:function(){var b=this||c;b._counter=1E3;b._html5AudioPool=[];b.html5PoolSize=10;b._codecs={};b._howls=[];b._muted=!1;b._volume=1;b._canPlayEvent="canplaythrough";b._navigator="undefined"!==typeof window&&window.navigator?window.navigator:null;b.masterGain=null;b.noAudio=!1;b.usingWebAudio=!0;b.autoSuspend=!1;b.ctx=null;b.autoUnlock=!0;b._setup();return b},volume:function(b){var d=this||c;b=parseFloat(b);d.ctx||l();if("undefined"!==typeof b&&
0<=b&&1>=b){d._volume=b;if(d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(b,c.ctx.currentTime);for(var e=0;e<d._howls.length;e++)if(!d._howls[e]._webAudio)for(var g=d._howls[e]._getSoundIds(),j=0;j<g.length;j++){var p=d._howls[e]._soundById(g[j]);p&&p._node&&(p._node.volume=p._volume*b)}return d}return d._volume},mute:function(b){var d=this||c;d.ctx||l();d._muted=b;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(b?0:d._volume,c.ctx.currentTime);for(var e=0;e<d._howls.length;e++)if(!d._howls[e]._webAudio)for(var g=
d._howls[e]._getSoundIds(),j=0;j<g.length;j++){var p=d._howls[e]._soundById(g[j]);p&&p._node&&(p._node.muted=b?!0:p._muted)}return d},stop:function(){for(var b=this||c,d=0;d<b._howls.length;d++)b._howls[d].stop();return b},unload:function(){for(var b=this||c,d=b._howls.length-1;0<=d;d--)b._howls[d].unload();b.usingWebAudio&&(b.ctx&&"undefined"!==typeof b.ctx.close)&&(b.ctx.close(),b.ctx=null,l());return b},codecs:function(b){return(this||c)._codecs[b.replace(/^x-/,"")]},_setup:function(){var b=this||
c;b.state=b.ctx?b.ctx.state||"suspended":"suspended";b._autoSuspend();if(!b.usingWebAudio)if("undefined"!==typeof Audio)try{var d=new Audio;"undefined"===typeof d.oncanplaythrough&&(b._canPlayEvent="canplay")}catch(e){b.noAudio=!0}else b.noAudio=!0;try{d=new Audio,d.muted&&(b.noAudio=!0)}catch(g){}b.noAudio||b._setupCodecs();return b},_setupCodecs:function(){var b=this||c,d=null;try{d="undefined"!==typeof Audio?new Audio:null}catch(e){return b}if(!d||"function"!==typeof d.canPlayType)return b;var g=
d.canPlayType("audio/mpeg;").replace(/^no$/,""),j=b._navigator&&b._navigator.userAgent.match(/OPR\/([0-6].)/g),j=j&&33>parseInt(j[0].split("/")[1],10);b._codecs={mp3:!(j||!g&&!d.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!g,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!d.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),
aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(d.canPlayType("audio/x-m4b;")||d.canPlayType("audio/m4b;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,
""),webm:!!d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")};return b},_unlockAudio:function(){var b=this||c;if(!b._audioUnlocked&&b.ctx){b._audioUnlocked=!1;b.autoUnlock=!1;!b._mobileUnloaded&&44100!==b.ctx.sampleRate&&(b._mobileUnloaded=!0,b.unload());b._scratchBuffer=b.ctx.createBuffer(1,1,22050);var d=function(){for(;b._html5AudioPool.length<
b.html5PoolSize;)try{var c=new Audio;c._unlocked=!0;b._releaseHtml5Audio(c)}catch(e){b.noAudio=!0;break}for(c=0;c<b._howls.length;c++)if(!b._howls[c]._webAudio)for(var g=b._howls[c]._getSoundIds(),j=0;j<g.length;j++){var l=b._howls[c]._soundById(g[j]);l&&(l._node&&!l._node._unlocked)&&(l._node._unlocked=!0,l._node.load())}b._autoResume();var p=b.ctx.createBufferSource();p.buffer=b._scratchBuffer;p.connect(b.ctx.destination);"undefined"===typeof p.start?p.noteOn(0):p.start(0);"function"===typeof b.ctx.resume&&
b.ctx.resume();p.onended=function(){p.disconnect(0);b._audioUnlocked=!0;document.removeEventListener("touchstart",d,!0);document.removeEventListener("touchend",d,!0);document.removeEventListener("click",d,!0);for(var c=0;c<b._howls.length;c++)b._howls[c]._emit("unlock")}};document.addEventListener("touchstart",d,!0);document.addEventListener("touchend",d,!0);document.addEventListener("click",d,!0);return b}},_obtainHtml5Audio:function(){var b=this||c;if(b._html5AudioPool.length)return b._html5AudioPool.pop();
(b=(new Audio).play())&&("undefined"!==typeof Promise&&(b instanceof Promise||"function"===typeof b.then))&&b.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")});return new Audio},_releaseHtml5Audio:function(b){var d=this||c;b._unlocked&&d._html5AudioPool.push(b);return d},_autoSuspend:function(){var b=this;if(b.autoSuspend&&b.ctx&&"undefined"!==typeof b.ctx.suspend&&c.usingWebAudio){for(var d=0;d<b._howls.length;d++)if(b._howls[d]._webAudio)for(var e=
0;e<b._howls[d]._sounds.length;e++)if(!b._howls[d]._sounds[e]._paused)return b;b._suspendTimer&&clearTimeout(b._suspendTimer);b._suspendTimer=setTimeout(function(){if(b.autoSuspend){b._suspendTimer=null;b.state="suspending";var c=function(){b.state="suspended";b._resumeAfterSuspend&&(delete b._resumeAfterSuspend,b._autoResume())};b.ctx.suspend().then(c,c)}},3E4);return b}},_autoResume:function(){var b=this;if(b.ctx&&"undefined"!==typeof b.ctx.resume&&c.usingWebAudio)return"running"===b.state&&"interrupted"!==
b.ctx.state&&b._suspendTimer?(clearTimeout(b._suspendTimer),b._suspendTimer=null):"suspended"===b.state||"running"===b.state&&"interrupted"===b.ctx.state?(b.ctx.resume().then(function(){b.state="running";for(var c=0;c<b._howls.length;c++)b._howls[c]._emit("resume")}),b._suspendTimer&&(clearTimeout(b._suspendTimer),b._suspendTimer=null)):"suspending"===b.state&&(b._resumeAfterSuspend=!0),b}};var c=new b,e=function(b){!b.src||0===b.src.length?console.error("An array of source files must be passed with any new Howl."):
this.init(b)};e.prototype={init:function(b){var d=this;c.ctx||l();d._autoplay=b.autoplay||!1;d._format="string"!==typeof b.format?b.format:[b.format];d._html5=b.html5||!1;d._muted=b.mute||!1;d._loop=b.loop||!1;d._pool=b.pool||5;d._preload="boolean"===typeof b.preload||"metadata"===b.preload?b.preload:!0;d._rate=b.rate||1;d._sprite=b.sprite||{};d._src="string"!==typeof b.src?b.src:[b.src];d._volume=void 0!==b.volume?b.volume:1;d._xhr={method:b.xhr&&b.xhr.method?b.xhr.method:"GET",headers:b.xhr&&b.xhr.headers?
b.xhr.headers:null,withCredentials:b.xhr&&b.xhr.withCredentials?b.xhr.withCredentials:!1};d._duration=0;d._state="unloaded";d._sounds=[];d._endTimers={};d._queue=[];d._playLock=!1;d._onend=b.onend?[{fn:b.onend}]:[];d._onfade=b.onfade?[{fn:b.onfade}]:[];d._onload=b.onload?[{fn:b.onload}]:[];d._onloaderror=b.onloaderror?[{fn:b.onloaderror}]:[];d._onplayerror=b.onplayerror?[{fn:b.onplayerror}]:[];d._onpause=b.onpause?[{fn:b.onpause}]:[];d._onplay=b.onplay?[{fn:b.onplay}]:[];d._onstop=b.onstop?[{fn:b.onstop}]:
[];d._onmute=b.onmute?[{fn:b.onmute}]:[];d._onvolume=b.onvolume?[{fn:b.onvolume}]:[];d._onrate=b.onrate?[{fn:b.onrate}]:[];d._onseek=b.onseek?[{fn:b.onseek}]:[];d._onunlock=b.onunlock?[{fn:b.onunlock}]:[];d._onresume=[];d._webAudio=c.usingWebAudio&&!d._html5;"undefined"!==typeof c.ctx&&(c.ctx&&c.autoUnlock)&&c._unlockAudio();c._howls.push(d);d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}});d._preload&&"none"!==d._preload&&d.load();return d},load:function(){var b=null;if(c.noAudio)this._emit("loaderror",
null,"No audio support.");else{"string"===typeof this._src&&(this._src=[this._src]);for(var e=0;e<this._src.length;e++){var n,l;if(this._format&&this._format[e])n=this._format[e];else{l=this._src[e];if("string"!==typeof l){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(n=/^data:audio\/([^;,]+);/i.exec(l))||(n=/\.([^.]+)$/.exec(l.split("?",1)[0]));n&&(n=n[1].toLowerCase())}n||console.warn('No file extension was found. Consider using the "format" property or specify an extension.');
if(n&&c.codecs(n)){b=this._src[e];break}}if(b){this._src=b;this._state="loading";"https:"===window.location.protocol&&"http:"===b.slice(0,5)&&(this._html5=!0,this._webAudio=!1);new d(this);if(this._webAudio){var s=this,t=s._src;if(j[t])s._duration=j[t].duration,p(s);else if(/^data:[^;]+;base64,/.test(t)){b=atob(t.split(",")[1]);e=new Uint8Array(b.length);for(n=0;n<b.length;++n)e[n]=b.charCodeAt(n);g(e.buffer,s)}else{var u=new XMLHttpRequest;u.open(s._xhr.method,t,!0);u.withCredentials=s._xhr.withCredentials;
u.responseType="arraybuffer";s._xhr.headers&&Object.keys(s._xhr.headers).forEach(function(b){u.setRequestHeader(b,s._xhr.headers[b])});u.onload=function(){var b=(u.status+"")[0];"0"!==b&&"2"!==b&&"3"!==b?s._emit("loaderror",null,"Failed loading audio file with status: "+u.status+"."):g(u.response,s)};u.onerror=function(){s._webAudio&&(s._html5=!0,s._webAudio=!1,s._sounds=[],delete j[t],s.load())};try{u.send()}catch(v){u.onerror()}}}return this}this._emit("loaderror",null,"No codec support for selected audio sources.")}},
play:function(b,d){var e=this,g=null;if("number"===typeof b)g=b,b=null;else{if("string"===typeof b&&"loaded"===e._state&&!e._sprite[b])return null;if("undefined"===typeof b&&(b="__default",!e._playLock)){for(var j=0,l=0;l<e._sounds.length;l++)e._sounds[l]._paused&&!e._sounds[l]._ended&&(j++,g=e._sounds[l]._id);1===j?b=null:g=null}}var p=g?e._soundById(g):e._inactiveSound();if(!p)return null;g&&!b&&(b=p._sprite||"__default");if("loaded"!==e._state){p._sprite=b;p._ended=!1;var v=p._id;e._queue.push({event:"play",
action:function(){e.play(v)}});return v}if(g&&!p._paused)return d||e._loadQueue("play"),p._id;e._webAudio&&c._autoResume();var z=Math.max(0,0<p._seek?p._seek:e._sprite[b][0]/1E3),x=Math.max(0,(e._sprite[b][0]+e._sprite[b][1])/1E3-z),C=1E3*x/Math.abs(p._rate),B=e._sprite[b][0]/1E3,E=(e._sprite[b][0]+e._sprite[b][1])/1E3;p._sprite=b;p._ended=!1;var I=function(){p._paused=!1;p._seek=z;p._start=B;p._stop=E;p._loop=!(!p._loop&&!e._sprite[b][2])};if(z>=E)e._ended(p);else{var y=p._node;if(e._webAudio)g=
function(){e._playLock=!1;I();e._refreshBuffer(p);y.gain.setValueAtTime(p._muted||e._muted?0:p._volume,c.ctx.currentTime);p._playStart=c.ctx.currentTime;"undefined"===typeof y.bufferSource.start?p._loop?y.bufferSource.noteGrainOn(0,z,86400):y.bufferSource.noteGrainOn(0,z,x):p._loop?y.bufferSource.start(0,z,86400):y.bufferSource.start(0,z,x);Infinity!==C&&(e._endTimers[p._id]=setTimeout(e._ended.bind(e,p),C));d||setTimeout(function(){e._emit("play",p._id);e._loadQueue()},0)},"running"===c.state&&"interrupted"!==
c.ctx.state?g():(e._playLock=!0,e.once("resume",g),e._clearTimer(p._id));else{var D=function(){y.currentTime=z;y.muted=p._muted||e._muted||c._muted||y.muted;y.volume=p._volume*c.volume();y.playbackRate=p._rate;try{var g=y.play();g&&"undefined"!==typeof Promise&&(g instanceof Promise||"function"===typeof g.then)?(e._playLock=!0,I(),g.then(function(){e._playLock=!1;y._unlocked=!0;d||(e._emit("play",p._id),e._loadQueue())}).catch(function(){e._playLock=!1;e._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");
p._ended=!0;p._paused=!0})):d||(e._playLock=!1,I(),e._emit("play",p._id),e._loadQueue());y.playbackRate=p._rate;y.paused?e._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."):"__default"!==b||p._loop?e._endTimers[p._id]=setTimeout(e._ended.bind(e,p),C):(e._endTimers[p._id]=function(){e._ended(p);y.removeEventListener("ended",e._endTimers[p._id],!1)},y.addEventListener("ended",e._endTimers[p._id],
!1))}catch(j){e._emit("playerror",p._id,j)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===y.src&&(y.src=e._src,y.load());g=window&&window.ejecta||!y.readyState&&c._navigator.isCocoonJS;if(3<=y.readyState||g)D();else{e._playLock=!0;var H=function(){D();y.removeEventListener(c._canPlayEvent,H,!1)};y.addEventListener(c._canPlayEvent,H,!1);e._clearTimer(p._id)}}return p._id}},pause:function(b,c){var d=this;if("loaded"!==d._state||d._playLock)return d._queue.push({event:"pause",
action:function(){d.pause(b)}}),d;for(var e=d._getSoundIds(b),g=0;g<e.length;g++){d._clearTimer(e[g]);var j=d._soundById(e[g]);if(j&&!j._paused&&(j._seek=d.seek(e[g]),j._rateSeek=0,j._paused=!0,d._stopFade(e[g]),j._node))if(d._webAudio){if(!j._node.bufferSource)continue;"undefined"===typeof j._node.bufferSource.stop?j._node.bufferSource.noteOff(0):j._node.bufferSource.stop(0);d._cleanBuffer(j._node)}else(!isNaN(j._node.duration)||Infinity===j._node.duration)&&j._node.pause();c||d._emit("pause",j?
j._id:null)}return d},stop:function(b,c){var d=this;if("loaded"!==d._state||d._playLock)return d._queue.push({event:"stop",action:function(){d.stop(b)}}),d;for(var e=d._getSoundIds(b),g=0;g<e.length;g++){d._clearTimer(e[g]);var j=d._soundById(e[g]);if(j){j._seek=j._start||0;j._rateSeek=0;j._paused=!0;j._ended=!0;d._stopFade(e[g]);if(j._node)if(d._webAudio)j._node.bufferSource&&("undefined"===typeof j._node.bufferSource.stop?j._node.bufferSource.noteOff(0):j._node.bufferSource.stop(0),d._cleanBuffer(j._node));
else if(!isNaN(j._node.duration)||Infinity===j._node.duration)j._node.currentTime=j._start||0,j._node.pause(),Infinity===j._node.duration&&d._clearSound(j._node);c||d._emit("stop",j._id)}}return d},mute:function(b,d){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"mute",action:function(){e.mute(b,d)}}),e;if("undefined"===typeof d)if("boolean"===typeof b)e._muted=b;else return e._muted;for(var g=e._getSoundIds(d),j=0;j<g.length;j++){var l=e._soundById(g[j]);l&&(l._muted=
b,l._interval&&e._stopFade(l._id),e._webAudio&&l._node?l._node.gain.setValueAtTime(b?0:l._volume,c.ctx.currentTime):l._node&&(l._node.muted=c._muted?!0:b),e._emit("mute",l._id))}return e},volume:function(){var b=this,d=arguments,e,g;if(0===d.length)return b._volume;1===d.length||2===d.length&&"undefined"===typeof d[1]?0<=b._getSoundIds().indexOf(d[0])?g=parseInt(d[0],10):e=parseFloat(d[0]):2<=d.length&&(e=parseFloat(d[0]),g=parseInt(d[1],10));var j;if("undefined"!==typeof e&&0<=e&&1>=e){if("loaded"!==
b._state||b._playLock)return b._queue.push({event:"volume",action:function(){b.volume.apply(b,d)}}),b;"undefined"===typeof g&&(b._volume=e);g=b._getSoundIds(g);for(var l=0;l<g.length;l++)if(j=b._soundById(g[l]))j._volume=e,d[2]||b._stopFade(g[l]),b._webAudio&&j._node&&!j._muted?j._node.gain.setValueAtTime(e,c.ctx.currentTime):j._node&&!j._muted&&(j._node.volume=e*c.volume()),b._emit("volume",j._id)}else return(j=g?b._soundById(g):b._sounds[0])?j._volume:0;return b},fade:function(b,d,e,g){var j=this;
if("loaded"!==j._state||j._playLock)return j._queue.push({event:"fade",action:function(){j.fade(b,d,e,g)}}),j;b=Math.min(Math.max(0,parseFloat(b)),1);d=Math.min(Math.max(0,parseFloat(d)),1);e=parseFloat(e);j.volume(b,g);for(var l=j._getSoundIds(g),p=0;p<l.length;p++){var v=j._soundById(l[p]);if(v){g||j._stopFade(l[p]);if(j._webAudio&&!v._muted){var z=c.ctx.currentTime,x=z+e/1E3;v._volume=b;v._node.gain.setValueAtTime(b,z);v._node.gain.linearRampToValueAtTime(d,x)}j._startFadeInterval(v,b,d,e,l[p],
"undefined"===typeof g)}}return j},_startFadeInterval:function(b,c,d,e,g,j){var l=this,p=c,z=d-c;g=Math.abs(z/0.01);g=Math.max(4,0<g?e/g:e);var x=Date.now();b._fadeTo=d;b._interval=setInterval(function(){var g=(Date.now()-x)/e;x=Date.now();p+=z*g;p=0>z?Math.max(d,p):Math.min(d,p);p=Math.round(100*p)/100;l._webAudio?b._volume=p:l.volume(p,b._id,!0);j&&(l._volume=p);if(d<c&&p<=d||d>c&&p>=d)clearInterval(b._interval),b._interval=null,b._fadeTo=null,l.volume(d,b._id),l._emit("fade",b._id)},g)},_stopFade:function(b){var d=
this._soundById(b);d&&d._interval&&(this._webAudio&&d._node.gain.cancelScheduledValues(c.ctx.currentTime),clearInterval(d._interval),d._interval=null,this.volume(d._fadeTo,b),d._fadeTo=null,this._emit("fade",b));return this},loop:function(){var b=arguments,c,d;if(0===b.length)return this._loop;if(1===b.length)if("boolean"===typeof b[0])this._loop=c=b[0];else return(b=this._soundById(parseInt(b[0],10)))?b._loop:!1;else 2===b.length&&(c=b[0],d=parseInt(b[1],10));d=this._getSoundIds(d);for(var e=0;e<
d.length;e++)if(b=this._soundById(d[e]))if(b._loop=c,this._webAudio&&(b._node&&b._node.bufferSource)&&(b._node.bufferSource.loop=c))b._node.bufferSource.loopStart=b._start||0,b._node.bufferSource.loopEnd=b._stop;return this},rate:function(){var b=this,d=arguments,e,g;0===d.length?g=b._sounds[0]._id:1===d.length?0<=b._getSoundIds().indexOf(d[0])?g=parseInt(d[0],10):e=parseFloat(d[0]):2===d.length&&(e=parseFloat(d[0]),g=parseInt(d[1],10));var j;if("number"===typeof e){if("loaded"!==b._state||b._playLock)return b._queue.push({event:"rate",
action:function(){b.rate.apply(b,d)}}),b;"undefined"===typeof g&&(b._rate=e);g=b._getSoundIds(g);for(var l=0;l<g.length;l++)if(j=b._soundById(g[l])){b.playing(g[l])&&(j._rateSeek=b.seek(g[l]),j._playStart=b._webAudio?c.ctx.currentTime:j._playStart);j._rate=e;b._webAudio&&j._node&&j._node.bufferSource?j._node.bufferSource.playbackRate.setValueAtTime(e,c.ctx.currentTime):j._node&&(j._node.playbackRate=e);var p=b.seek(g[l]),p=1E3*((b._sprite[j._sprite][0]+b._sprite[j._sprite][1])/1E3-p)/Math.abs(j._rate);
if(b._endTimers[g[l]]||!j._paused)b._clearTimer(g[l]),b._endTimers[g[l]]=setTimeout(b._ended.bind(b,j),p);b._emit("rate",j._id)}}else return(j=b._soundById(g))?j._rate:b._rate;return b},seek:function(){var b=this,d=arguments,e,g;0===d.length?g=b._sounds[0]._id:1===d.length?0<=b._getSoundIds().indexOf(d[0])?g=parseInt(d[0],10):b._sounds.length&&(g=b._sounds[0]._id,e=parseFloat(d[0])):2===d.length&&(e=parseFloat(d[0]),g=parseInt(d[1],10));if("undefined"===typeof g)return b;if("loaded"!==b._state||b._playLock)return b._queue.push({event:"seek",
action:function(){b.seek.apply(b,d)}}),b;var j=b._soundById(g);if(j)if("number"===typeof e&&0<=e){var l=b.playing(g);l&&b.pause(g,!0);j._seek=e;j._ended=!1;b._clearTimer(g);!b._webAudio&&(j._node&&!isNaN(j._node.duration))&&(j._node.currentTime=e);var p=function(){b._emit("seek",g);l&&b.play(g,!0)};if(l&&!b._webAudio){var v=function(){b._playLock?setTimeout(v,0):p()};setTimeout(v,0)}else p()}else return b._webAudio?(e=b.playing(g)?c.ctx.currentTime-j._playStart:0,j._seek+((j._rateSeek?j._rateSeek-
j._seek:0)+e*Math.abs(j._rate))):j._node.currentTime;return b},playing:function(b){if("number"===typeof b)return(b=this._soundById(b))?!b._paused:!1;for(b=0;b<this._sounds.length;b++)if(!this._sounds[b]._paused)return!0;return!1},duration:function(b){var c=this._duration;(b=this._soundById(b))&&(c=this._sprite[b._sprite][1]/1E3);return c},state:function(){return this._state},unload:function(){for(var b=this._sounds,d=0;d<b.length;d++)b[d]._paused||this.stop(b[d]._id),this._webAudio||(this._clearSound(b[d]._node),
b[d]._node.removeEventListener("error",b[d]._errorFn,!1),b[d]._node.removeEventListener(c._canPlayEvent,b[d]._loadFn,!1),c._releaseHtml5Audio(b[d]._node)),delete b[d]._node,this._clearTimer(b[d]._id);d=c._howls.indexOf(this);0<=d&&c._howls.splice(d,1);b=!0;for(d=0;d<c._howls.length;d++)if(c._howls[d]._src===this._src||0<=this._src.indexOf(c._howls[d]._src)){b=!1;break}j&&b&&delete j[this._src];c.noAudio=!1;this._state="unloaded";this._sounds=[];return null},on:function(b,c,d,e){b=this["_on"+b];"function"===
typeof c&&b.push(e?{id:d,fn:c,once:e}:{id:d,fn:c});return this},off:function(b,c,d){var e=this["_on"+b],g=0;"number"===typeof c&&(d=c,c=null);if(c||d)for(g=0;g<e.length;g++){if(b=d===e[g].id,c===e[g].fn&&b||!c&&b){e.splice(g,1);break}}else if(b)this["_on"+b]=[];else{c=Object.keys(this);for(g=0;g<c.length;g++)0===c[g].indexOf("_on")&&Array.isArray(this[c[g]])&&(this[c[g]]=[])}return this},once:function(b,c,d){this.on(b,c,d,1);return this},_emit:function(b,c,d){for(var e=this["_on"+b],g=e.length-1;0<=
g;g--)if(!e[g].id||e[g].id===c||"load"===b)setTimeout(function(b){b.call(this,c,d)}.bind(this,e[g].fn),0),e[g].once&&this.off(b,e[g].fn,e[g].id);this._loadQueue(b);return this},_loadQueue:function(b){if(0<this._queue.length){var c=this._queue[0];c.event===b&&(this._queue.shift(),this._loadQueue());b||c.action()}return this},_ended:function(b){var d=b._sprite;if(!this._webAudio&&b._node&&!b._node.paused&&!b._node.ended&&b._node.currentTime<b._stop)return setTimeout(this._ended.bind(this,b),100),this;
d=!(!b._loop&&!this._sprite[d][2]);this._emit("end",b._id);!this._webAudio&&d&&this.stop(b._id,!0).play(b._id);if(this._webAudio&&d){this._emit("play",b._id);b._seek=b._start||0;b._rateSeek=0;b._playStart=c.ctx.currentTime;var e=1E3*(b._stop-b._start)/Math.abs(b._rate);this._endTimers[b._id]=setTimeout(this._ended.bind(this,b),e)}this._webAudio&&!d&&(b._paused=!0,b._ended=!0,b._seek=b._start||0,b._rateSeek=0,this._clearTimer(b._id),this._cleanBuffer(b._node),c._autoSuspend());!this._webAudio&&!d&&
this.stop(b._id,!0);return this},_clearTimer:function(b){if(this._endTimers[b]){if("function"!==typeof this._endTimers[b])clearTimeout(this._endTimers[b]);else{var c=this._soundById(b);c&&c._node&&c._node.removeEventListener("ended",this._endTimers[b],!1)}delete this._endTimers[b]}return this},_soundById:function(b){for(var c=0;c<this._sounds.length;c++)if(b===this._sounds[c]._id)return this._sounds[c];return null},_inactiveSound:function(){this._drain();for(var b=0;b<this._sounds.length;b++)if(this._sounds[b]._ended)return this._sounds[b].reset();
return new d(this)},_drain:function(){var b=this._pool,c=0,d=0;if(!(this._sounds.length<b)){for(d=0;d<this._sounds.length;d++)this._sounds[d]._ended&&c++;for(d=this._sounds.length-1;0<=d&&!(c<=b);d--)this._sounds[d]._ended&&(this._webAudio&&this._sounds[d]._node&&this._sounds[d]._node.disconnect(0),this._sounds.splice(d,1),c--)}},_getSoundIds:function(b){if("undefined"===typeof b){b=[];for(var c=0;c<this._sounds.length;c++)b.push(this._sounds[c]._id);return b}return[b]},_refreshBuffer:function(b){b._node.bufferSource=
c.ctx.createBufferSource();b._node.bufferSource.buffer=j[this._src];b._panner?b._node.bufferSource.connect(b._panner):b._node.bufferSource.connect(b._node);if(b._node.bufferSource.loop=b._loop)b._node.bufferSource.loopStart=b._start||0,b._node.bufferSource.loopEnd=b._stop||0;b._node.bufferSource.playbackRate.setValueAtTime(b._rate,c.ctx.currentTime);return this},_cleanBuffer:function(b){var d=c._navigator&&0<=c._navigator.vendor.indexOf("Apple");if(c._scratchBuffer&&b.bufferSource&&(b.bufferSource.onended=
null,b.bufferSource.disconnect(0),d))try{b.bufferSource.buffer=c._scratchBuffer}catch(e){}b.bufferSource=null;return this},_clearSound:function(b){/MSIE |Trident\//.test(c._navigator&&c._navigator.userAgent)||(b.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var d=function(b){this._parent=b;this.init()};d.prototype={init:function(){var b=this._parent;this._muted=b._muted;this._loop=b._loop;this._volume=b._volume;this._rate=b._rate;this._seek=0;this._ended=
this._paused=!0;this._sprite="__default";this._id=++c._counter;b._sounds.push(this);this.create();return this},create:function(){var b=this._parent,d=c._muted||this._muted||this._parent._muted?0:this._volume;b._webAudio?(this._node="undefined"===typeof c.ctx.createGain?c.ctx.createGainNode():c.ctx.createGain(),this._node.gain.setValueAtTime(d,c.ctx.currentTime),this._node.paused=!0,this._node.connect(c.masterGain)):c.noAudio||(this._node=c._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),
this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(c._canPlayEvent,this._loadFn,!1),this._node.src=b._src,this._node.preload=!0===b._preload?"auto":b._preload,this._node.volume=d*c.volume(),this._node.load());return this},reset:function(){var b=this._parent;this._muted=b._muted;this._loop=b._loop;this._volume=b._volume;this._rate=b._rate;this._rateSeek=this._seek=0;this._ended=this._paused=!0;this._sprite="__default";this._id=
++c._counter;return this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0);this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var b=this._parent;b._duration=Math.ceil(10*this._node.duration)/10;0===Object.keys(b._sprite).length&&(b._sprite={__default:[0,1E3*b._duration]});"loaded"!==b._state&&(b._state="loaded",b._emit("load"),b._loadQueue());this._node.removeEventListener(c._canPlayEvent,this._loadFn,!1)}};
var j={},g=function(b,d){var e=function(){d._emit("loaderror",null,"Decoding audio data failed.")},g=function(b){b&&0<d._sounds.length?(j[d._src]=b,p(d,b)):e()};"undefined"!==typeof Promise&&1===c.ctx.decodeAudioData.length?c.ctx.decodeAudioData(b).then(g).catch(e):c.ctx.decodeAudioData(b,g,e)},p=function(b,c){c&&!b._duration&&(b._duration=c.duration);0===Object.keys(b._sprite).length&&(b._sprite={__default:[0,1E3*b._duration]});"loaded"!==b._state&&(b._state="loaded",b._emit("load"),b._loadQueue())},
l=function(){if(c.usingWebAudio){try{"undefined"!==typeof AudioContext?c.ctx=new AudioContext:"undefined"!==typeof webkitAudioContext?c.ctx=new webkitAudioContext:c.usingWebAudio=!1}catch(b){c.usingWebAudio=!1}c.ctx||(c.usingWebAudio=!1);var d=/iP(hone|od|ad)/.test(c._navigator&&c._navigator.platform),e=c._navigator&&c._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),e=e?parseInt(e[1],10):null;d&&(e&&9>e)&&(d=/safari/.test(c._navigator&&c._navigator.userAgent.toLowerCase()),c._navigator&&!d&&
(c.usingWebAudio=!1));c.usingWebAudio&&(c.masterGain="undefined"===typeof c.ctx.createGain?c.ctx.createGainNode():c.ctx.createGain(),c.masterGain.gain.setValueAtTime(c._muted?0:c._volume,c.ctx.currentTime),c.masterGain.connect(c.ctx.destination));c._setup()}};"function"===typeof define&&define.amd&&define([],function(){return{Howler:c,Howl:e}});"undefined"!==typeof exports&&(exports.Howler=c,exports.Howl=e);"undefined"!==typeof global?(global.HowlerGlobal=b,global.Howler=c,global.Howl=e,global.Sound=
d):"undefined"!==typeof window&&(window.HowlerGlobal=b,window.Howler=c,window.Howl=e,window.Sound=d)})();
(function(){HowlerGlobal.prototype._pos=[0,0,0];HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0];HowlerGlobal.prototype.stereo=function(b){if(!this.ctx||!this.ctx.listener)return this;for(var c=this._howls.length-1;0<=c;c--)this._howls[c].stereo(b);return this};HowlerGlobal.prototype.pos=function(b,c,d){if(!this.ctx||!this.ctx.listener)return this;c="number"!==typeof c?this._pos[1]:c;d="number"!==typeof d?this._pos[2]:d;if("number"===typeof b)this._pos=[b,c,d],"undefined"!==typeof this.ctx.listener.positionX?
(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,0.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,0.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,0.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]);else return this._pos;return this};HowlerGlobal.prototype.orientation=function(b,c,d,e,f,m){if(!this.ctx||!this.ctx.listener)return this;var n=this._orientation;c="number"!==
typeof c?n[1]:c;d="number"!==typeof d?n[2]:d;e="number"!==typeof e?n[3]:e;f="number"!==typeof f?n[4]:f;m="number"!==typeof m?n[5]:m;if("number"===typeof b)this._orientation=[b,c,d,e,f,m],"undefined"!==typeof this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(b,Howler.ctx.currentTime,0.1),this.ctx.listener.forwardY.setTargetAtTime(c,Howler.ctx.currentTime,0.1),this.ctx.listener.forwardZ.setTargetAtTime(d,Howler.ctx.currentTime,0.1),this.ctx.listener.upX.setTargetAtTime(e,Howler.ctx.currentTime,
0.1),this.ctx.listener.upY.setTargetAtTime(f,Howler.ctx.currentTime,0.1),this.ctx.listener.upZ.setTargetAtTime(m,Howler.ctx.currentTime,0.1)):this.ctx.listener.setOrientation(b,c,d,e,f,m);else return n;return this};var b=Howl.prototype.init;Howl.prototype.init=function(c){this._orientation=c.orientation||[1,0,0];this._stereo=c.stereo||null;this._pos=c.pos||null;this._pannerAttr={coneInnerAngle:"undefined"!==typeof c.coneInnerAngle?c.coneInnerAngle:360,coneOuterAngle:"undefined"!==typeof c.coneOuterAngle?
c.coneOuterAngle:360,coneOuterGain:"undefined"!==typeof c.coneOuterGain?c.coneOuterGain:0,distanceModel:"undefined"!==typeof c.distanceModel?c.distanceModel:"inverse",maxDistance:"undefined"!==typeof c.maxDistance?c.maxDistance:1E4,panningModel:"undefined"!==typeof c.panningModel?c.panningModel:"HRTF",refDistance:"undefined"!==typeof c.refDistance?c.refDistance:1,rolloffFactor:"undefined"!==typeof c.rolloffFactor?c.rolloffFactor:1};this._onstereo=c.onstereo?[{fn:c.onstereo}]:[];this._onpos=c.onpos?
[{fn:c.onpos}]:[];this._onorientation=c.onorientation?[{fn:c.onorientation}]:[];return b.call(this,c)};Howl.prototype.stereo=function(b,c){var e=this;if(!e._webAudio)return e;if("loaded"!==e._state)return e._queue.push({event:"stereo",action:function(){e.stereo(b,c)}}),e;var l="undefined"===typeof Howler.ctx.createStereoPanner?"spatial":"stereo";if("undefined"===typeof c)if("number"===typeof b)e._stereo=b,e._pos=[b,0,0];else return e._stereo;for(var f=e._getSoundIds(c),m=0;m<f.length;m++){var n=e._soundById(f[m]);
if(n)if("number"===typeof b)n._stereo=b,n._pos=[b,0,0],n._node&&(n._pannerAttr.panningModel="equalpower",(!n._panner||!n._panner.pan)&&d(n,l),"spatial"===l?"undefined"!==typeof n._panner.positionX?(n._panner.positionX.setValueAtTime(b,Howler.ctx.currentTime),n._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),n._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):n._panner.setPosition(b,0,0):n._panner.pan.setValueAtTime(b,Howler.ctx.currentTime)),e._emit("stereo",n._id);else return n._stereo}return e};
Howl.prototype.pos=function(b,c,e,l){var f=this;if(!f._webAudio)return f;if("loaded"!==f._state)return f._queue.push({event:"pos",action:function(){f.pos(b,c,e,l)}}),f;c="number"!==typeof c?0:c;e="number"!==typeof e?-0.5:e;if("undefined"===typeof l)if("number"===typeof b)f._pos=[b,c,e];else return f._pos;for(var m=f._getSoundIds(l),n=0;n<m.length;n++){var r=f._soundById(m[n]);if(r)if("number"===typeof b)r._pos=[b,c,e],r._node&&((!r._panner||r._panner.pan)&&d(r,"spatial"),"undefined"!==typeof r._panner.positionX?
(r._panner.positionX.setValueAtTime(b,Howler.ctx.currentTime),r._panner.positionY.setValueAtTime(c,Howler.ctx.currentTime),r._panner.positionZ.setValueAtTime(e,Howler.ctx.currentTime)):r._panner.setPosition(b,c,e)),f._emit("pos",r._id);else return r._pos}return f};Howl.prototype.orientation=function(b,c,e,l){var f=this;if(!f._webAudio)return f;if("loaded"!==f._state)return f._queue.push({event:"orientation",action:function(){f.orientation(b,c,e,l)}}),f;c="number"!==typeof c?f._orientation[1]:c;e=
"number"!==typeof e?f._orientation[2]:e;if("undefined"===typeof l)if("number"===typeof b)f._orientation=[b,c,e];else return f._orientation;for(var m=f._getSoundIds(l),n=0;n<m.length;n++){var r=f._soundById(m[n]);if(r)if("number"===typeof b)r._orientation=[b,c,e],r._node&&(r._panner||(r._pos||(r._pos=f._pos||[0,0,-0.5]),d(r,"spatial")),"undefined"!==typeof r._panner.orientationX?(r._panner.orientationX.setValueAtTime(b,Howler.ctx.currentTime),r._panner.orientationY.setValueAtTime(c,Howler.ctx.currentTime),
r._panner.orientationZ.setValueAtTime(e,Howler.ctx.currentTime)):r._panner.setOrientation(b,c,e)),f._emit("orientation",r._id);else return r._orientation}return f};Howl.prototype.pannerAttr=function(){var b=arguments,c,e;if(!this._webAudio)return this;if(0===b.length)return this._pannerAttr;if(1===b.length)if("object"===typeof b[0])c=b[0],"undefined"===typeof e&&(c.pannerAttr||(c.pannerAttr={coneInnerAngle:c.coneInnerAngle,coneOuterAngle:c.coneOuterAngle,coneOuterGain:c.coneOuterGain,distanceModel:c.distanceModel,
maxDistance:c.maxDistance,refDistance:c.refDistance,rolloffFactor:c.rolloffFactor,panningModel:c.panningModel}),this._pannerAttr={coneInnerAngle:"undefined"!==typeof c.pannerAttr.coneInnerAngle?c.pannerAttr.coneInnerAngle:this._coneInnerAngle,coneOuterAngle:"undefined"!==typeof c.pannerAttr.coneOuterAngle?c.pannerAttr.coneOuterAngle:this._coneOuterAngle,coneOuterGain:"undefined"!==typeof c.pannerAttr.coneOuterGain?c.pannerAttr.coneOuterGain:this._coneOuterGain,distanceModel:"undefined"!==typeof c.pannerAttr.distanceModel?
c.pannerAttr.distanceModel:this._distanceModel,maxDistance:"undefined"!==typeof c.pannerAttr.maxDistance?c.pannerAttr.maxDistance:this._maxDistance,refDistance:"undefined"!==typeof c.pannerAttr.refDistance?c.pannerAttr.refDistance:this._refDistance,rolloffFactor:"undefined"!==typeof c.pannerAttr.rolloffFactor?c.pannerAttr.rolloffFactor:this._rolloffFactor,panningModel:"undefined"!==typeof c.pannerAttr.panningModel?c.pannerAttr.panningModel:this._panningModel});else return(b=this._soundById(parseInt(b[0],
10)))?b._pannerAttr:this._pannerAttr;else 2===b.length&&(c=b[0],e=parseInt(b[1],10));e=this._getSoundIds(e);for(var l=0;l<e.length;l++)if(b=this._soundById(e[l])){var f=b._pannerAttr,f={coneInnerAngle:"undefined"!==typeof c.coneInnerAngle?c.coneInnerAngle:f.coneInnerAngle,coneOuterAngle:"undefined"!==typeof c.coneOuterAngle?c.coneOuterAngle:f.coneOuterAngle,coneOuterGain:"undefined"!==typeof c.coneOuterGain?c.coneOuterGain:f.coneOuterGain,distanceModel:"undefined"!==typeof c.distanceModel?c.distanceModel:
f.distanceModel,maxDistance:"undefined"!==typeof c.maxDistance?c.maxDistance:f.maxDistance,refDistance:"undefined"!==typeof c.refDistance?c.refDistance:f.refDistance,rolloffFactor:"undefined"!==typeof c.rolloffFactor?c.rolloffFactor:f.rolloffFactor,panningModel:"undefined"!==typeof c.panningModel?c.panningModel:f.panningModel},m=b._panner;m?(m.coneInnerAngle=f.coneInnerAngle,m.coneOuterAngle=f.coneOuterAngle,m.coneOuterGain=f.coneOuterGain,m.distanceModel=f.distanceModel,m.maxDistance=f.maxDistance,
m.refDistance=f.refDistance,m.rolloffFactor=f.rolloffFactor,m.panningModel=f.panningModel):(b._pos||(b._pos=this._pos||[0,0,-0.5]),d(b,"spatial"))}return this};var c=Sound.prototype.init;Sound.prototype.init=function(){var b=this._parent;this._orientation=b._orientation;this._stereo=b._stereo;this._pos=b._pos;this._pannerAttr=b._pannerAttr;c.call(this);this._stereo?b.stereo(this._stereo):this._pos&&b.pos(this._pos[0],this._pos[1],this._pos[2],this._id)};var e=Sound.prototype.reset;Sound.prototype.reset=
function(){var b=this._parent;this._orientation=b._orientation;this._stereo=b._stereo;this._pos=b._pos;this._pannerAttr=b._pannerAttr;this._stereo?b.stereo(this._stereo):this._pos?b.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,b._refreshBuffer(this));return e.call(this)};var d=function(b,c){"spatial"===(c||"spatial")?(b._panner=Howler.ctx.createPanner(),b._panner.coneInnerAngle=b._pannerAttr.coneInnerAngle,b._panner.coneOuterAngle=
b._pannerAttr.coneOuterAngle,b._panner.coneOuterGain=b._pannerAttr.coneOuterGain,b._panner.distanceModel=b._pannerAttr.distanceModel,b._panner.maxDistance=b._pannerAttr.maxDistance,b._panner.refDistance=b._pannerAttr.refDistance,b._panner.rolloffFactor=b._pannerAttr.rolloffFactor,b._panner.panningModel=b._pannerAttr.panningModel,"undefined"!==typeof b._panner.positionX?(b._panner.positionX.setValueAtTime(b._pos[0],Howler.ctx.currentTime),b._panner.positionY.setValueAtTime(b._pos[1],Howler.ctx.currentTime),
b._panner.positionZ.setValueAtTime(b._pos[2],Howler.ctx.currentTime)):b._panner.setPosition(b._pos[0],b._pos[1],b._pos[2]),"undefined"!==typeof b._panner.orientationX?(b._panner.orientationX.setValueAtTime(b._orientation[0],Howler.ctx.currentTime),b._panner.orientationY.setValueAtTime(b._orientation[1],Howler.ctx.currentTime),b._panner.orientationZ.setValueAtTime(b._orientation[2],Howler.ctx.currentTime)):b._panner.setOrientation(b._orientation[0],b._orientation[1],b._orientation[2])):(b._panner=
Howler.ctx.createStereoPanner(),b._panner.pan.setValueAtTime(b._stereo,Howler.ctx.currentTime));b._panner.connect(b._node);b._paused||b._parent.pause(b._id,!0).play(b._id,!0)}})();!function(b,c){"object"==typeof exports&&"undefined"!=typeof module?c():"function"==typeof define&&define.amd?define(c):c()}(0,function(){function b(b){var c=this.constructor;return this.then(function(d){return c.resolve(b()).then(function(){return d})},function(d){return c.resolve(b()).then(function(){return c.reject(d)})})}function c(){}function e(b){if(!(this instanceof e))throw new TypeError("Promises must be constructed via new");if("function"!=typeof b)throw new TypeError("not a function");
this._state=0;this._handled=!1;this._value=void 0;this._deferreds=[];l(b,this)}function d(b,c){for(;3===b._state;)b=b._value;0!==b._state?(b._handled=!0,e._immediateFn(function(){var d=1===b._state?c.onFulfilled:c.onRejected;if(null!==d){var e;try{e=d(b._value)}catch(f){return void g(c.promise,f)}j(c.promise,e)}else(1===b._state?j:g)(c.promise,b._value)})):b._deferreds.push(c)}function j(b,c){try{if(c===b)throw new TypeError("A promise cannot be resolved with itself.");if(c&&("object"==typeof c||
"function"==typeof c)){var d=c.then;if(c instanceof e)return b._state=3,b._value=c,void p(b);if("function"==typeof d)return void l(function(){d.apply(c,arguments)},b)}b._state=1;b._value=c;p(b)}catch(f){g(b,f)}}function g(b,c){b._state=2;b._value=c;p(b)}function p(b){2===b._state&&0===b._deferreds.length&&e._immediateFn(function(){b._handled||e._unhandledRejectionFn(b._value)});for(var c=0,f=b._deferreds.length;f>c;c++)d(b,b._deferreds[c]);b._deferreds=null}function l(b,c){var d=!1;try{b(function(b){d||
(d=!0,j(c,b))},function(b){d||(d=!0,g(c,b))})}catch(e){d||(d=!0,g(c,e))}}var f=setTimeout;e.prototype["catch"]=function(b){return this.then(null,b)};e.prototype.then=function(b,e){var f=new this.constructor(c);return d(this,new function(b,c,d){this.onFulfilled="function"==typeof b?b:null;this.onRejected="function"==typeof c?c:null;this.promise=d}(b,e,f)),f};e.prototype["finally"]=b;e.all=function(b){return new e(function(c,d){function e(b,j){try{if(j&&("object"==typeof j||"function"==typeof j)){var l=
j.then;if("function"==typeof l)return void l.call(j,function(c){e(b,c)},d)}f[b]=j;0==--g&&c(f)}catch(m){d(m)}}if(!b||"undefined"==typeof b.length)throw new TypeError("Promise.all accepts an array");var f=Array.prototype.slice.call(b);if(0===f.length)return c([]);for(var g=f.length,j=0;f.length>j;j++)e(j,f[j])})};e.resolve=function(b){return b&&"object"==typeof b&&b.constructor===e?b:new e(function(c){c(b)})};e.reject=function(b){return new e(function(c,d){d(b)})};e.race=function(b){return new e(function(c,
d){for(var e=0,f=b.length;f>e;e++)b[e].then(c,d)})};e._immediateFn="function"==typeof setImmediate&&function(b){setImmediate(b)}||function(b){f(b,0)};e._unhandledRejectionFn=function(b){void 0!==console&&console&&console.warn("Possible Unhandled Promise Rejection:",b)};var m=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("unable to locate global object");}();"Promise"in m?m.Promise.prototype["finally"]||
(m.Promise.prototype["finally"]=b):m.Promise=e});(function(){function b(b,c){document.addEventListener?b.addEventListener("scroll",c,!1):b.attachEvent("scroll",c)}function c(b){this.a=document.createElement("div");this.a.setAttribute("aria-hidden","true");this.a.appendChild(document.createTextNode(b));this.b=document.createElement("span");this.c=document.createElement("span");this.h=document.createElement("span");this.f=document.createElement("span");this.g=-1;this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";
this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;";this.b.appendChild(this.h);this.c.appendChild(this.f);this.a.appendChild(this.b);this.a.appendChild(this.c)}function e(b,c){b.a.style.cssText=
"max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+c+";"}function d(b){var c=b.a.offsetWidth,d=c+100;b.f.style.width=d+"px";b.c.scrollLeft=d;b.b.scrollLeft=b.b.scrollWidth+100;return b.g!==c?(b.g=c,!0):!1}function j(c,e){function f(){var b=g;d(b)&&b.a.parentNode&&e(b.g)}var g=c;b(c.b,f);b(c.c,f);d(c)}function g(b,c){var d=c||{};this.family=b;this.style=d.style||
"normal";this.weight=d.weight||"normal";this.stretch=d.stretch||"normal"}function p(){null===s&&(s=!!document.fonts);return s}function l(){if(null===r){var b=document.createElement("div");try{b.style.font="condensed 100px sans-serif"}catch(c){}r=""!==b.style.font}return r}function f(b,c){return[b.style,b.weight,l()?b.stretch:"","100px",c].join(" ")}var m=null,n=null,r=null,s=null;g.prototype.load=function(b,d){var g=this,l=b||"BESbswy",r=0,s=d||3E3,B=(new Date).getTime();return new Promise(function(b,
d){var t;if(t=p())null===n&&(p()&&/Apple/.test(window.navigator.vendor)?(t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),n=!!t&&603>parseInt(t[1],10)):n=!1),t=!n;if(t){t=new Promise(function(b,c){function d(){(new Date).getTime()-B>=s?c(Error(""+s+"ms timeout exceeded")):document.fonts.load(f(g,'"'+g.family+'"'),l).then(function(c){1<=c.length?b():setTimeout(d,25)},c)}d()});var u=new Promise(function(b,c){r=setTimeout(function(){c(Error(""+s+"ms timeout exceeded"))},
s)});Promise.race([u,t]).then(function(){clearTimeout(r);b(g)},d)}else{var H=function(){function n(){var c;if(c=-1!=D&&-1!=G||-1!=D&&-1!=F||-1!=G&&-1!=F)(c=D!=G&&D!=F&&G!=F)||(null===m&&(c=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),m=!!c&&(536>parseInt(c[1],10)||536===parseInt(c[1],10)&&11>=parseInt(c[2],10))),c=m&&(D==H&&G==H&&F==H||D==Z&&G==Z&&F==Z||D==N&&G==N&&F==N)),c=!c;c&&(T.parentNode&&T.parentNode.removeChild(T),clearTimeout(r),b(g))}function p(){if((new Date).getTime()-
B>=s)T.parentNode&&T.parentNode.removeChild(T),d(Error(""+s+"ms timeout exceeded"));else{var b=document.hidden;if(!0===b||void 0===b)D=t.a.offsetWidth,G=u.a.offsetWidth,F=y.a.offsetWidth,n();r=setTimeout(p,50)}}var t=new c(l),u=new c(l),y=new c(l),D=-1,G=-1,F=-1,H=-1,Z=-1,N=-1,T=document.createElement("div");T.dir="ltr";e(t,f(g,"sans-serif"));e(u,f(g,"serif"));e(y,f(g,"monospace"));T.appendChild(t.a);T.appendChild(u.a);T.appendChild(y.a);document.body.appendChild(T);H=t.a.offsetWidth;Z=u.a.offsetWidth;
N=y.a.offsetWidth;p();j(t,function(b){D=b;n()});e(t,f(g,'"'+g.family+'",sans-serif'));j(u,function(b){G=b;n()});e(u,f(g,'"'+g.family+'",serif'));j(y,function(b){F=b;n()});e(y,f(g,'"'+g.family+'",monospace'))};document.body?H():document.addEventListener?document.addEventListener("DOMContentLoaded",function S(){document.removeEventListener("DOMContentLoaded",S);H()}):document.attachEvent("onreadystatechange",function Q(){if("interactive"==document.readyState||"complete"==document.readyState)document.detachEvent("onreadystatechange",
Q),H()})}})};"object"===typeof module?module.exports=g:(window.FontFaceObserver=g,window.FontFaceObserver.prototype.load=g.prototype.load)})();(function(b){Number.prototype.map=function(b,c,d,e){return d+(e-d)*((this-b)/(c-b))};Number.prototype.limit=function(b,c){return Math.min(c,Math.max(b,this))};Number.prototype.round=function(b){b=Math.pow(10,b||0);return Math.round(this*b)/b};Number.prototype.floor=function(){return Math.floor(this)};Number.prototype.ceil=function(){return Math.ceil(this)};Number.prototype.toInt=function(){return this|0};Number.prototype.toRad=function(){return this/180*Math.PI};Number.prototype.toDeg=function(){return 180*
this/Math.PI};Object.defineProperty(Array.prototype,"erase",{value:function(b){for(var c=this.length;c--;)this[c]===b&&this.splice(c,1);return this}});Object.defineProperty(Array.prototype,"random",{value:function(){return this[Math.floor(Math.random()*this.length)]}});Function.prototype.bind=Function.prototype.bind||function(b){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var c=Array.prototype.slice.call(arguments,1),d=this,
e=function(){},g=function(){return d.apply(this instanceof e&&b?this:b,c.concat(Array.prototype.slice.call(arguments)))};e.prototype=this.prototype;g.prototype=new e;return g};b.ig={game:null,debug:null,version:"1.24",global:b,modules:{},resources:[],ready:!1,baked:!1,nocache:"",ua:{},prefix:b.ImpactPrefix||"",lib:"lib/",_current:null,_loadQueue:[],_waitForOnload:0,$:function(b){return"#"==b.charAt(0)?document.getElementById(b.substr(1)):document.getElementsByTagName(b)},$new:function(b){return document.createElement(b)},
copy:function(b){if(!b||"object"!=typeof b||b instanceof HTMLElement||b instanceof ig.Class)return b;if(b instanceof Array)for(var c=[],d=0,e=b.length;d<e;d++)c[d]=ig.copy(b[d]);else for(d in c={},b)c[d]=ig.copy(b[d]);return c},merge:function(b,c){for(var d in c){var e=c[d];if("object"!=typeof e||e instanceof HTMLElement||e instanceof ig.Class||null===e)b[d]=e;else{if(!b[d]||"object"!=typeof b[d])b[d]=e instanceof Array?[]:{};ig.merge(b[d],e)}}return b},ksort:function(b){if(!b||"object"!=typeof b)return[];
var c=[],d=[],e;for(e in b)c.push(e);c.sort();for(e=0;e<c.length;e++)d.push(b[c[e]]);return d},setVendorAttribute:function(b,c,d){var e=c.charAt(0).toUpperCase()+c.substr(1);b[c]=b["ms"+e]=b["moz"+e]=b["webkit"+e]=b["o"+e]=d},getVendorAttribute:function(b,c){var d=c.charAt(0).toUpperCase()+c.substr(1);return b[c]||b["ms"+d]||b["moz"+d]||b["webkit"+d]||b["o"+d]},normalizeVendorAttribute:function(b,c){var d=ig.getVendorAttribute(b,c);!b[c]&&d&&(b[c]=d)},getImagePixels:function(b,c,d,e,g){var j=ig.$new("canvas");
j.width=b.width;j.height=b.height;var p=j.getContext("2d");ig.System.SCALE.CRISP(j,p);var u=ig.getVendorAttribute(p,"backingStorePixelRatio")||1;ig.normalizeVendorAttribute(p,"getImageDataHD");var v=b.width/u,z=b.height/u;j.width=Math.ceil(v);j.height=Math.ceil(z);p.drawImage(b,0,0,v,z);return 1===u?p.getImageData(c,d,e,g):p.getImageDataHD(c,d,e,g)},module:function(b){if(ig._current)throw"Module '"+ig._current.name+"' defines nothing";if(ig.modules[b]&&ig.modules[b].body)throw"Module '"+b+"' is already defined";
ig._current={name:b,requires:[],loaded:!1,body:null};ig.modules[b]=ig._current;ig._loadQueue.push(ig._current);return ig},requires:function(){ig._current.requires=Array.prototype.slice.call(arguments);return ig},defines:function(b){ig._current.body=b;ig._current=null;ig._initDOMReady()},addResource:function(b){ig.resources.push(b)},setNocache:function(b){ig.nocache=b?"?"+Date.now():""},log:function(){},assert:function(){},show:function(){},mark:function(){},_loadScript:function(b,c){ig.modules[b]=
{name:b,requires:[],loaded:!1,body:null};ig._waitForOnload++;var d=ig.prefix+ig.lib+b.replace(/\./g,"/")+".js"+ig.nocache,e=ig.$new("script");e.type="text/javascript";e.src=d;e.onload=function(){ig._waitForOnload--;ig._execModules()};e.onerror=function(){throw"Failed to load module "+b+" at "+d+" required from "+c;};ig.$("head")[0].appendChild(e)},_execModules:function(){for(var b=!1,c=0;c<ig._loadQueue.length;c++){for(var d=ig._loadQueue[c],e=!0,g=0;g<d.requires.length;g++){var j=d.requires[g];ig.modules[j]?
ig.modules[j].loaded||(e=!1):(e=!1,ig._loadScript(j,d.name))}e&&d.body&&(ig._loadQueue.splice(c,1),d.loaded=!0,d.body(),b=!0,c--)}if(b)ig._execModules();else if(!ig.baked&&0==ig._waitForOnload&&0!=ig._loadQueue.length){b=[];for(c=0;c<ig._loadQueue.length;c++){e=[];j=ig._loadQueue[c].requires;for(g=0;g<j.length;g++)d=ig.modules[j[g]],(!d||!d.loaded)&&e.push(j[g]);b.push(ig._loadQueue[c].name+" (requires: "+e.join(", ")+")")}throw"Unresolved (or circular?) dependencies. Most likely there's a name/path mismatch for one of the listed modules or a previous syntax error prevents a module from loading:\n"+
b.join("\n");}},_DOMReady:function(){if(!ig.modules["dom.ready"].loaded){if(!document.body)return setTimeout(ig._DOMReady,13);ig.modules["dom.ready"].loaded=!0;ig._waitForOnload--;ig._execModules()}return 0},_boot:function(){document.location.href.match(/\?nocache/)&&ig.setNocache(!0);ig.ua.pixelRatio=b.devicePixelRatio||1;ig.ua.viewport={width:b.innerWidth,height:b.innerHeight};ig.ua.screen={width:b.screen.availWidth*ig.ua.pixelRatio,height:b.screen.availHeight*ig.ua.pixelRatio};ig.ua.iPhone=/iPhone|iPod/i.test(navigator.userAgent);
ig.ua.iPhone4=ig.ua.iPhone&&2==ig.ua.pixelRatio;ig.ua.iPad=/iPad/i.test(navigator.userAgent);ig.ua.android=/android/i.test(navigator.userAgent);ig.ua.winPhone=/Windows Phone/i.test(navigator.userAgent);ig.ua.iOS=ig.ua.iPhone||ig.ua.iPad;ig.ua.mobile=ig.ua.iOS||ig.ua.android||ig.ua.winPhone||/mobile/i.test(navigator.userAgent);ig.ua.touchDevice="ontouchstart"in b||b.navigator.msMaxTouchPoints},_initDOMReady:function(){ig.modules["dom.ready"]?ig._execModules():(ig._boot(),ig.modules["dom.ready"]={requires:[],
loaded:!1,body:null},ig._waitForOnload++,"complete"===document.readyState?ig._DOMReady():(document.addEventListener("DOMContentLoaded",ig._DOMReady,!1),b.addEventListener("load",ig._DOMReady,!1)))}};ig.normalizeVendorAttribute(b,"requestAnimationFrame");if(b.requestAnimationFrame){var c=1,e={};b.ig.setAnimation=function(d){var f=c++;e[f]=!0;var g=function(){e[f]&&(b.requestAnimationFrame(g),d())};b.requestAnimationFrame(g);return f};b.ig.clearAnimation=function(b){delete e[b]}}else b.ig.setAnimation=
function(c){return b.setInterval(c,1E3/60)},b.ig.clearAnimation=function(c){b.clearInterval(c)};var d=!1,j=/xyz/.test(function(){xyz})?/\bparent\b/:/.*/,g=0;b.ig.Class=function(){};var p=function(b){var c=this.prototype,d={},e;for(e in b)"function"==typeof b[e]&&"function"==typeof c[e]&&j.test(b[e])?(d[e]=c[e],c[e]=function(b,c){return function(){var e=this.parent;this.parent=d[b];var f=c.apply(this,arguments);this.parent=e;return f}}(e,b[e])):c[e]=b[e]};b.ig.Class.extend=function(c){function e(){if(!d){if(this.staticInstantiate){var b=
this.staticInstantiate.apply(this,arguments);if(b)return b}for(var c in this)"object"==typeof this[c]&&(this[c]=ig.copy(this[c]));this.init&&this.init.apply(this,arguments)}return this}var m=this.prototype;d=!0;var n=new this;d=!1;for(var r in c)n[r]="function"==typeof c[r]&&"function"==typeof m[r]&&j.test(c[r])?function(b,c){return function(){var d=this.parent;this.parent=m[b];var e=c.apply(this,arguments);this.parent=d;return e}}(r,c[r]):c[r];e.prototype=n;e.prototype.constructor=e;e.extend=b.ig.Class.extend;
e.inject=p;e.classId=n.classId=++g;return e};b.ImpactMixin&&ig.merge(ig,b.ImpactMixin)})(window);ig.baked=!0;
ig.module("impact.image").defines(function(){ig.Image=ig.Class.extend({data:null,width:0,height:0,loaded:!1,failed:!1,loadCallback:null,path:"",staticInstantiate:function(b){return ig.Image.cache[b]||null},init:function(b){this.path=b;this.load()},load:function(b){this.loaded?b&&b(this.path,!0):(!this.loaded&&ig.ready?(this.loadCallback=b||null,this.data=new Image,this.data.onload=this.onload.bind(this),this.data.onerror=this.onerror.bind(this),this.data.src=ig.prefix+this.path+ig.nocache):ig.addResource(this),
ig.Image.cache[this.path]=this)},reload:function(){this.loaded=!1;this.data=new Image;this.data.onload=this.onload.bind(this);this.data.src=this.path+"?"+Date.now()},onload:function(){this.width=this.data.width;this.height=this.data.height;this.loaded=!0;1!=ig.system.scale&&this.resize(ig.system.scale);this.loadCallback&&this.loadCallback(this.path,!0)},onerror:function(){this.failed=!0;this.loadCallback&&this.loadCallback(this.path,!1)},resize:function(b){var c=ig.getImagePixels(this.data,0,0,this.width,
this.height),e=this.width*b,d=this.height*b,j=ig.$new("canvas");j.width=e;j.height=d;for(var g=j.getContext("2d"),p=g.getImageData(0,0,e,d),l=0;l<d;l++)for(var f=0;f<e;f++){var m=4*(Math.floor(l/b)*this.width+Math.floor(f/b)),n=4*(l*e+f);p.data[n]=c.data[m];p.data[n+1]=c.data[m+1];p.data[n+2]=c.data[m+2];p.data[n+3]=c.data[m+3]}g.putImageData(p,0,0);this.data=j},draw:function(b,c,e,d,j,g){if(this.loaded){var p=ig.system.scale;j=(j?j:this.width)*p;g=(g?g:this.height)*p;ig.system.context.drawImage(this.data,
e?e*p:0,d?d*p:0,j,g,ig.system.getDrawPos(b),ig.system.getDrawPos(c),j,g);ig.Image.drawCount++}},drawTile:function(b,c,e,d,j,g,p){j=j?j:d;if(this.loaded&&!(d>this.width||j>this.height)){var l=ig.system.scale,f=Math.floor(d*l),m=Math.floor(j*l),n=g?-1:1,r=p?-1:1;if(g||p)ig.system.context.save(),ig.system.context.scale(n,r);ig.system.context.drawImage(this.data,Math.floor(e*d)%this.width*l,Math.floor(e*d/this.width)*j*l,f,m,ig.system.getDrawPos(b)*n-(g?f:0),ig.system.getDrawPos(c)*r-(p?m:0),f,m);(g||
p)&&ig.system.context.restore();ig.Image.drawCount++}}});ig.Image.drawCount=0;ig.Image.cache={};ig.Image.reloadCache=function(){for(var b in ig.Image.cache)ig.Image.cache[b].reload()}});ig.baked=!0;
ig.module("impact.font").requires("impact.image").defines(function(){ig.Font=ig.Image.extend({widthMap:[],indices:[],firstChar:32,alpha:1,letterSpacing:1,lineSpacing:0,onload:function(b){this._loadMetrics(this.data);this.parent(b);this.height-=2},widthForString:function(b){if(-1!==b.indexOf("\n")){b=b.split("\n");for(var c=0,e=0;e<b.length;e++)c=Math.max(c,this._widthForLine(b[e]));return c}return this._widthForLine(b)},_widthForLine:function(b){for(var c=0,e=0;e<b.length;e++)c+=this.widthMap[b.charCodeAt(e)-
this.firstChar];0<b.length&&(c+=this.letterSpacing*(b.length-1));return c},heightForString:function(b){return b.split("\n").length*(this.height+this.lineSpacing)},draw:function(b,c,e,d){"string"!=typeof b&&(b=b.toString());if(-1!==b.indexOf("\n")){b=b.split("\n");for(var j=this.height+this.lineSpacing,g=0;g<b.length;g++)this.draw(b[g],c,e+g*j,d)}else{if(d==ig.Font.ALIGN.RIGHT||d==ig.Font.ALIGN.CENTER)g=this._widthForLine(b),c-=d==ig.Font.ALIGN.CENTER?g/2:g;1!==this.alpha&&(ig.system.context.globalAlpha=
this.alpha);for(g=0;g<b.length;g++)d=b.charCodeAt(g),c+=this._drawChar(d-this.firstChar,c,e);1!==this.alpha&&(ig.system.context.globalAlpha=1);ig.Image.drawCount+=b.length}},_drawChar:function(b,c,e){if(!this.loaded||0>b||b>=this.indices.length)return 0;var d=ig.system.scale,j=this.widthMap[b]*d,g=this.height*d;ig.system.context.drawImage(this.data,this.indices[b]*d,0,j,g,ig.system.getDrawPos(c),ig.system.getDrawPos(e),j,g);return this.widthMap[b]+this.letterSpacing},_loadMetrics:function(b){this.widthMap=
[];this.indices=[];for(var c=ig.getImagePixels(b,0,b.height-1,b.width,1),e=0,d=0;d<b.width;d++){var j=4*d+3;127<c.data[j]?e++:128>c.data[j]&&e&&(this.widthMap.push(e),this.indices.push(d-e),e=0)}this.widthMap.push(e);this.indices.push(d-e)}});ig.Font.ALIGN={LEFT:0,RIGHT:1,CENTER:2}});ig.baked=!0;
ig.module("impact.sound").defines(function(){ig.SoundManager=ig.Class.extend({clips:{},volume:1,format:null,init:function(){if(!ig.Sound.enabled||!window.Audio)ig.Sound.enabled=!1;else{for(var b=new Audio,c=0;c<ig.Sound.use.length;c++){var e=ig.Sound.use[c];if(b.canPlayType(e.mime)){this.format=e;break}}this.format||(ig.Sound.enabled=!1);ig.Sound.enabled&&ig.Sound.useWebAudio&&(this.audioContext=new AudioContext,this.boundWebAudioUnlock=this.unlockWebAudio.bind(this),ig.system.canvas.addEventListener("touchstart",
this.boundWebAudioUnlock,!1),ig.system.canvas.addEventListener("mousedown",this.boundWebAudioUnlock,!1))}},unlockWebAudio:function(){ig.system.canvas.removeEventListener("touchstart",this.boundWebAudioUnlock,!1);ig.system.canvas.removeEventListener("mousedown",this.boundWebAudioUnlock,!1);var b=this.audioContext.createBuffer(1,1,22050),c=this.audioContext.createBufferSource();c.buffer=b;c.connect(this.audioContext.destination);c.start(0)},load:function(b,c,e){return c&&ig.Sound.useWebAudio?this.loadWebAudio(b,
c,e):this.loadHTML5Audio(b,c,e)},loadWebAudio:function(b,c,e){c=ig.prefix+b.replace(/[^\.]+$/,this.format.ext)+ig.nocache;if(this.clips[b])return this.clips[b];var d=new ig.Sound.WebAudioSource;this.clips[b]=d;var j=new XMLHttpRequest;j.open("GET",c,!0);j.responseType="arraybuffer";var g=this;j.onload=function(c){g.audioContext.decodeAudioData(j.response,function(g){d.buffer=g;e&&e(b,!0,c)},function(c){e&&e(b,!1,c)})};j.onerror=function(c){e&&e(b,!1,c)};j.send();return d},loadHTML5Audio:function(b,
c,e){var d=ig.prefix+b.replace(/[^\.]+$/,this.format.ext)+ig.nocache;if(this.clips[b]){if(this.clips[b]instanceof ig.Sound.WebAudioSource)return this.clips[b];if(c&&this.clips[b].length<ig.Sound.channels)for(c=this.clips[b].length;c<ig.Sound.channels;c++){var j=new Audio(d);j.load();this.clips[b].push(j)}return this.clips[b][0]}var g=new Audio(d);e&&(ig.ua.mobile?setTimeout(function(){e(b,!0,null)},0):(g.addEventListener("canplaythrough",function l(c){g.removeEventListener("canplaythrough",l,!1);
e(b,!0,c)},!1),g.addEventListener("error",function(c){e(b,!1,c)},!1)));g.preload="auto";g.load();this.clips[b]=[g];if(c)for(c=1;c<ig.Sound.channels;c++)j=new Audio(d),j.load(),this.clips[b].push(j);return g},get:function(b){if((b=this.clips[b])&&b instanceof ig.Sound.WebAudioSource)return b;for(var c=0,e;e=b[c++];)if(e.paused||e.ended)return e.ended&&(e.currentTime=0),e;b[0].pause();b[0].currentTime=0;return b[0]}});ig.Music=ig.Class.extend({tracks:[],namedTracks:{},currentTrack:null,currentIndex:0,
random:!1,_volume:1,_loop:!1,_fadeInterval:0,_fadeTimer:null,_endedCallbackBound:null,init:function(){this._endedCallbackBound=this._endedCallback.bind(this);Object.defineProperty(this,"volume",{get:this.getVolume.bind(this),set:this.setVolume.bind(this)});Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)})},add:function(b,c){if(ig.Sound.enabled){var e=b instanceof ig.Sound?b.path:b,d=ig.soundManager.load(e,!1);if(d instanceof ig.Sound.WebAudioSource)throw ig.system.stopRunLoop(),
"Sound '"+e+"' loaded as Multichannel but used for Music. Set the multiChannel param to false when loading, e.g.: new ig.Sound(path, false)";d.loop=this._loop;d.volume=this._volume;d.addEventListener("ended",this._endedCallbackBound,!1);this.tracks.push(d);c&&(this.namedTracks[c]=d);this.currentTrack||(this.currentTrack=d)}},next:function(){this.tracks.length&&(this.stop(),this.currentIndex=this.random?Math.floor(Math.random()*this.tracks.length):(this.currentIndex+1)%this.tracks.length,this.currentTrack=
this.tracks[this.currentIndex],this.play())},pause:function(){this.currentTrack&&this.currentTrack.pause()},stop:function(){this.currentTrack&&(this.currentTrack.pause(),this.currentTrack.currentTime=0)},play:function(b){if(b&&this.namedTracks[b])b=this.namedTracks[b],b!=this.currentTrack&&(this.stop(),this.currentTrack=b);else if(!this.currentTrack)return;this.currentTrack.play()},getLooping:function(){return this._loop},setLooping:function(b){this._loop=b;for(var c in this.tracks)this.tracks[c].loop=
b},getVolume:function(){return this._volume},setVolume:function(b){this._volume=b.limit(0,1);for(var c in this.tracks)this.tracks[c].volume=this._volume},fadeOut:function(b){this.currentTrack&&(clearInterval(this._fadeInterval),this._fadeTimer=new ig.Timer(b),this._fadeInterval=setInterval(this._fadeStep.bind(this),50))},_fadeStep:function(){var b=this._fadeTimer.delta().map(-this._fadeTimer.target,0,1,0).limit(0,1)*this._volume;0.01>=b?(this.stop(),this.currentTrack.volume=this._volume,clearInterval(this._fadeInterval)):
this.currentTrack.volume=b},_endedCallback:function(){this._loop?this.play():this.next()}});ig.Sound=ig.Class.extend({path:"",volume:1,currentClip:null,multiChannel:!0,_loop:!1,init:function(b,c){this.path=b;this.multiChannel=!1!==c;Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)});this.load()},getLooping:function(){return this._loop},setLooping:function(b){this._loop=b;this.currentClip&&(this.currentClip.loop=b)},load:function(b){ig.Sound.enabled?
ig.ready?ig.soundManager.load(this.path,this.multiChannel,b):ig.addResource(this):b&&b(this.path,!0)},play:function(){ig.Sound.enabled&&(this.currentClip=ig.soundManager.get(this.path),this.currentClip.loop=this._loop,this.currentClip.volume=ig.soundManager.volume*this.volume,this.currentClip.play())},stop:function(){this.currentClip&&(this.currentClip.pause(),this.currentClip.currentTime=0)}});ig.Sound.WebAudioSource=ig.Class.extend({sources:[],gain:null,buffer:null,_loop:!1,init:function(){this.gain=
ig.soundManager.audioContext.createGain();this.gain.connect(ig.soundManager.audioContext.destination);Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)});Object.defineProperty(this,"volume",{get:this.getVolume.bind(this),set:this.setVolume.bind(this)})},play:function(){if(this.buffer){var b=ig.soundManager.audioContext.createBufferSource();b.buffer=this.buffer;b.connect(this.gain);b.loop=this._loop;var c=this;this.sources.push(b);b.onended=function(){c.sources.erase(b)};
b.start(0)}},pause:function(){for(var b=0;b<this.sources.length;b++)try{this.sources[b].stop()}catch(c){}},getLooping:function(){return this._loop},setLooping:function(b){this._loop=b;for(var c=0;c<this.sources.length;c++)this.sources[c].loop=b},getVolume:function(){return this.gain.gain.value},setVolume:function(b){this.gain.gain.value=b}});ig.Sound.FORMAT={MP3:{ext:"mp3",mime:"audio/mpeg"},M4A:{ext:"m4a",mime:"audio/mp4; codecs=mp4a.40.2"},OGG:{ext:"ogg",mime:"audio/ogg; codecs=vorbis"},WEBM:{ext:"webm",
mime:"audio/webm; codecs=vorbis"},CAF:{ext:"caf",mime:"audio/x-caf"}};ig.Sound.use=[ig.Sound.FORMAT.OGG,ig.Sound.FORMAT.MP3];ig.Sound.channels=4;ig.Sound.enabled=!0;ig.normalizeVendorAttribute(window,"AudioContext");ig.Sound.useWebAudio=!!window.AudioContext});ig.baked=!0;
ig.module("impact.loader").requires("impact.image","impact.font","impact.sound").defines(function(){ig.Loader=ig.Class.extend({resources:[],gameClass:null,status:0,done:!1,_unloaded:[],_drawStatus:0,_intervalId:0,_loadCallbackBound:null,init:function(b,c){this.gameClass=b;this.resources=c;this._loadCallbackBound=this._loadCallback.bind(this);for(var e=0;e<this.resources.length;e++)this._unloaded.push(this.resources[e].path)},load:function(){ig.system.clear("#000");if(this.resources.length){for(var b=
0;b<this.resources.length;b++)this.loadResource(this.resources[b]);this._intervalId=setInterval(this.draw.bind(this),16)}else this.end()},loadResource:function(b){b.load(this._loadCallbackBound)},end:function(){this.done||(this.done=!0,clearInterval(this._intervalId),ig.system.setGame(this.gameClass))},draw:function(){this._drawStatus+=(this.status-this._drawStatus)/5;var b=ig.system.scale,c=(0.6*ig.system.width).floor(),e=(0.1*ig.system.height).floor(),d=(0.5*ig.system.width-c/2).floor(),j=(0.5*
ig.system.height-e/2).floor();ig.system.context.fillStyle="#000";ig.system.context.fillRect(0,0,ig.system.width,ig.system.height);ig.system.context.fillStyle="#fff";ig.system.context.fillRect(d*b,j*b,c*b,e*b);ig.system.context.fillStyle="#000";ig.system.context.fillRect(d*b+b,j*b+b,c*b-b-b,e*b-b-b);ig.system.context.fillStyle="#fff";ig.system.context.fillRect(d*b,j*b,c*b*this._drawStatus,e*b)},_loadCallback:function(b,c){if(c)this._unloaded.erase(b);else throw"Failed to load resource: "+b;this.status=
1-this._unloaded.length/this.resources.length;0==this._unloaded.length&&setTimeout(this.end.bind(this),250)}})});ig.baked=!0;
ig.module("impact.timer").defines(function(){ig.Timer=ig.Class.extend({target:0,base:0,last:0,pausedAt:0,init:function(b){this.last=this.base=ig.Timer.time;this.target=b||0},set:function(b){this.target=b||0;this.base=ig.Timer.time;this.pausedAt=0},reset:function(){this.base=ig.Timer.time;this.pausedAt=0},tick:function(){var b=ig.Timer.time-this.last;this.last=ig.Timer.time;return this.pausedAt?0:b},delta:function(){return(this.pausedAt||ig.Timer.time)-this.base-this.target},pause:function(){this.pausedAt||
(this.pausedAt=ig.Timer.time)},unpause:function(){this.pausedAt&&(this.base+=ig.Timer.time-this.pausedAt,this.pausedAt=0)}});ig.Timer._last=0;ig.Timer.time=Number.MIN_VALUE;ig.Timer.timeScale=1;ig.Timer.maxStep=0.05;ig.Timer.step=function(){var b=Date.now();ig.Timer.time+=Math.min((b-ig.Timer._last)/1E3,ig.Timer.maxStep)*ig.Timer.timeScale;ig.Timer._last=b}});ig.baked=!0;
ig.module("impact.system").requires("impact.timer","impact.image").defines(function(){ig.System=ig.Class.extend({fps:30,width:320,height:240,realWidth:320,realHeight:240,scale:1,tick:0,animationId:0,newGameClass:null,running:!1,delegate:null,clock:null,canvas:null,context:null,init:function(b,c,e,d,j){this.fps=c;this.clock=new ig.Timer;this.canvas=ig.$(b);this.resize(e,d,j);this.context=this.canvas.getContext("2d");this.getDrawPos=ig.System.drawMode;1!=this.scale&&(ig.System.scaleMode=ig.System.SCALE.CRISP);
ig.System.scaleMode(this.canvas,this.context)},resize:function(b,c,e){this.width=b;this.height=c;this.scale=e||this.scale;this.realWidth=this.width*this.scale;this.realHeight=this.height*this.scale;this.canvas.width=this.realWidth;this.canvas.height=this.realHeight},setGame:function(b){this.running?this.newGameClass=b:this.setGameNow(b)},setGameNow:function(b){ig.game=new b;ig.system.setDelegate(ig.game)},setDelegate:function(b){if("function"==typeof b.run)this.delegate=b,this.startRunLoop();else throw"System.setDelegate: No run() function in object";
},stopRunLoop:function(){ig.clearAnimation(this.animationId);this.running=!1},startRunLoop:function(){this.stopRunLoop();this.animationId=ig.setAnimation(this.run.bind(this));this.running=!0},clear:function(b){this.context.fillStyle=b;this.context.fillRect(0,0,this.realWidth,this.realHeight)},run:function(){ig.Timer.step();this.tick=this.clock.tick();this.delegate.run();ig.input.clearPressed();this.newGameClass&&(this.setGameNow(this.newGameClass),this.newGameClass=null)},getDrawPos:null});ig.System.DRAW=
{AUTHENTIC:function(b){return Math.round(b)*this.scale},SMOOTH:function(b){return Math.round(b*this.scale)},SUBPIXEL:function(b){return b*this.scale}};ig.System.drawMode=ig.System.DRAW.SMOOTH;ig.System.SCALE={CRISP:function(b,c){ig.setVendorAttribute(c,"imageSmoothingEnabled",!1);b.style.imageRendering="-moz-crisp-edges";b.style.imageRendering="-o-crisp-edges";b.style.imageRendering="-webkit-optimize-contrast";b.style.imageRendering="crisp-edges";b.style.msInterpolationMode="nearest-neighbor"},SMOOTH:function(b,
c){ig.setVendorAttribute(c,"imageSmoothingEnabled",!0);b.style.imageRendering="";b.style.msInterpolationMode=""}};ig.System.scaleMode=ig.System.SCALE.SMOOTH});ig.baked=!0;
ig.module("impact.input").defines(function(){ig.KEY={MOUSE1:-1,MOUSE2:-3,MWHEEL_UP:-4,MWHEEL_DOWN:-5,BACKSPACE:8,TAB:9,ENTER:13,PAUSE:19,CAPS:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,_0:48,_1:49,_2:50,_3:51,_4:52,_5:53,_6:54,_7:55,_8:56,_9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,
NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SHIFT:16,CTRL:17,ALT:18,PLUS:187,COMMA:188,MINUS:189,PERIOD:190};ig.Input=ig.Class.extend({bindings:{},actions:{},presses:{},locks:{},delayedKeyup:{},isUsingMouse:!1,isUsingKeyboard:!1,isUsingAccelerometer:!1,mouse:{x:0,y:0},accel:{x:0,y:0,z:0},initMouse:function(){this.isUsingMouse||
(this.isUsingMouse=!0,ig.system.canvas.addEventListener("wheel",this.mousewheel.bind(this),!1),ig.system.canvas.addEventListener("contextmenu",this.contextmenu.bind(this),!1),ig.system.canvas.addEventListener("mousedown",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("mouseup",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("mousemove",this.mousemove.bind(this),!1),ig.ua.touchDevice&&(ig.system.canvas.addEventListener("touchstart",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("touchend",
this.keyup.bind(this),!1),ig.system.canvas.addEventListener("touchcancel",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.mousemove.bind(this),!1),ig.system.canvas.addEventListener("MSPointerDown",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("MSPointerUp",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",this.mousemove.bind(this),!1),ig.system.canvas.style.msTouchAction="none"))},initKeyboard:function(){this.isUsingKeyboard||
(this.isUsingKeyboard=!0,window.addEventListener("keydown",this.keydown.bind(this),!1),window.addEventListener("keyup",this.keyup.bind(this),!1))},initAccelerometer:function(){this.isUsingAccelerometer||(this.isUsingAccelerometer=!0,window.addEventListener("devicemotion",this.devicemotion.bind(this),!1))},mousewheel:function(b){var c=this.bindings[0>b.deltaY?ig.KEY.MWHEEL_UP:ig.KEY.MWHEEL_DOWN];c&&(this.actions[c]=!0,this.presses[c]=!0,this.delayedKeyup[c]=!0,b.stopPropagation(),b.preventDefault())},
mousemove:function(b){var c=ig.system.scale*((ig.system.canvas.offsetWidth||ig.system.realWidth)/ig.system.realWidth),e={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());b=b.touches?b.touches[0]:b;this.mouse.x=(b.clientX-e.left)/c;this.mouse.y=(b.clientY-e.top)/c},contextmenu:function(b){this.bindings[ig.KEY.MOUSE2]&&(b.stopPropagation(),b.preventDefault())},keydown:function(b){var c=b.target.tagName;if(!("INPUT"==c||"TEXTAREA"==c))if(c="keydown"==
b.type?b.keyCode:2==b.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1,0>c&&!ig.ua.mobile&&window.focus(),("touchstart"==b.type||"mousedown"==b.type)&&this.mousemove(b),c=this.bindings[c])this.actions[c]=!0,this.locks[c]||(this.presses[c]=!0,this.locks[c]=!0),b.preventDefault()},keyup:function(b){var c=b.target.tagName;if(!("INPUT"==c||"TEXTAREA"==c))if(c=this.bindings["keyup"==b.type?b.keyCode:2==b.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1])this.delayedKeyup[c]=!0,b.preventDefault()},devicemotion:function(b){this.accel=
b.accelerationIncludingGravity},bind:function(b,c){0>b?this.initMouse():0<b&&this.initKeyboard();this.bindings[b]=c},bindTouch:function(b,c){var e=ig.$(b),d=this;e.addEventListener("touchstart",function(b){d.touchStart(b,c)},!1);e.addEventListener("touchend",function(b){d.touchEnd(b,c)},!1);e.addEventListener("MSPointerDown",function(b){d.touchStart(b,c)},!1);e.addEventListener("MSPointerUp",function(b){d.touchEnd(b,c)},!1)},unbind:function(b){this.delayedKeyup[this.bindings[b]]=!0;this.bindings[b]=
null},unbindAll:function(){this.bindings={};this.actions={};this.presses={};this.locks={};this.delayedKeyup={}},state:function(b){return this.actions[b]},pressed:function(b){return this.presses[b]},released:function(b){return!!this.delayedKeyup[b]},clearPressed:function(){for(var b in this.delayedKeyup)this.actions[b]=!1,this.locks[b]=!1;this.delayedKeyup={};this.presses={}},touchStart:function(b,c){this.actions[c]=!0;this.presses[c]=!0;b.stopPropagation();b.preventDefault();return!1},touchEnd:function(b,
c){this.delayedKeyup[c]=!0;b.stopPropagation();b.preventDefault();return!1}})});ig.baked=!0;ig.module("impact.impact").requires("dom.ready","impact.loader","impact.system","impact.input","impact.sound").defines(function(){ig.main=function(b,c,e,d,j,g,p){ig.system=new ig.System(b,e,d,j,g||1);ig.input=new ig.Input;ig.soundManager=new ig.SoundManager;ig.music=new ig.Music;ig.ready=!0;(new (p||ig.Loader)(c,ig.resources)).load()}});ig.baked=!0;
ig.module("impact.animation").requires("impact.timer","impact.image").defines(function(){ig.AnimationSheet=ig.Class.extend({width:8,height:8,image:null,init:function(b,c,e){this.width=c;this.height=e;this.image=new ig.Image(b)}});ig.Animation=ig.Class.extend({sheet:null,timer:null,sequence:[],flip:{x:!1,y:!1},pivot:{x:0,y:0},frameTime:0,frame:0,tile:0,stop:!1,loopCount:0,alpha:1,angle:0,init:function(b,c,e,d){this.sheet=b;this.pivot={x:b.width/2,y:b.height/2};this.timer=new ig.Timer;this.frameTime=
c;this.sequence=e;this.stop=!!d;this.tile=this.sequence[0]},rewind:function(){this.timer.set();this.frame=this.loopCount=0;this.tile=this.sequence[0];return this},gotoFrame:function(b){this.timer.set(this.frameTime*-b-1E-4);this.update()},gotoRandomFrame:function(){this.gotoFrame(Math.floor(Math.random()*this.sequence.length))},update:function(){var b=Math.floor(this.timer.delta()/this.frameTime);this.loopCount=Math.floor(b/this.sequence.length);this.frame=this.stop&&0<this.loopCount?this.sequence.length-
1:b%this.sequence.length;this.tile=this.sequence[this.frame]},draw:function(b,c){var e=Math.max(this.sheet.width,this.sheet.height);b>ig.system.width||(c>ig.system.height||0>b+e||0>c+e)||(1!=this.alpha&&(ig.system.context.globalAlpha=this.alpha),0==this.angle?this.sheet.image.drawTile(b,c,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y):(ig.system.context.save(),ig.system.context.translate(ig.system.getDrawPos(b+this.pivot.x),ig.system.getDrawPos(c+this.pivot.y)),ig.system.context.rotate(this.angle),
this.sheet.image.drawTile(-this.pivot.x,-this.pivot.y,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y),ig.system.context.restore()),1!=this.alpha&&(ig.system.context.globalAlpha=1))}})});ig.baked=!0;
ig.module("impact.entity").requires("impact.animation","impact.impact").defines(function(){ig.Entity=ig.Class.extend({id:0,settings:{},size:{x:16,y:16},offset:{x:0,y:0},pos:{x:0,y:0},last:{x:0,y:0},vel:{x:0,y:0},accel:{x:0,y:0},friction:{x:0,y:0},maxVel:{x:100,y:100},zIndex:0,gravityFactor:1,standing:!1,bounciness:0,minBounceVelocity:40,anims:{},animSheet:null,currentAnim:null,health:10,type:0,checkAgainst:0,collides:0,_killed:!1,slopeStanding:{min:(44).toRad(),max:(136).toRad()},init:function(b,
c,e){this.id=++ig.Entity._lastId;this.pos.x=this.last.x=b;this.pos.y=this.last.y=c;ig.merge(this,e)},reset:function(b,c,e){var d=this.constructor.prototype;this.pos.x=b;this.pos.y=c;this.last.x=b;this.last.y=c;this.vel.x=d.vel.x;this.vel.y=d.vel.y;this.accel.x=d.accel.x;this.accel.y=d.accel.y;this.health=d.health;this._killed=d._killed;this.standing=d.standing;this.type=d.type;this.checkAgainst=d.checkAgainst;this.collides=d.collides;ig.merge(this,e)},addAnim:function(b,c,e,d){if(!this.animSheet)throw"No animSheet to add the animation "+
b+" to.";c=new ig.Animation(this.animSheet,c,e,d);this.anims[b]=c;this.currentAnim||(this.currentAnim=c);return c},update:function(){this.last.x=this.pos.x;this.last.y=this.pos.y;this.vel.y+=ig.game.gravity*ig.system.tick*this.gravityFactor;this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x);this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y,this.friction.y,this.maxVel.y);var b=ig.game.collisionMap.trace(this.pos.x,this.pos.y,this.vel.x*ig.system.tick,this.vel.y*
ig.system.tick,this.size.x,this.size.y);this.handleMovementTrace(b);this.currentAnim&&this.currentAnim.update()},getNewVelocity:function(b,c,e,d){return c?(b+c*ig.system.tick).limit(-d,d):e?(c=e*ig.system.tick,0<b-c?b-c:0>b+c?b+c:0):b.limit(-d,d)},handleMovementTrace:function(b){this.standing=!1;b.collision.y&&(0<this.bounciness&&Math.abs(this.vel.y)>this.minBounceVelocity?this.vel.y*=-this.bounciness:(0<this.vel.y&&(this.standing=!0),this.vel.y=0));b.collision.x&&(this.vel.x=0<this.bounciness&&Math.abs(this.vel.x)>
this.minBounceVelocity?this.vel.x*-this.bounciness:0);if(b.collision.slope){var c=b.collision.slope;if(0<this.bounciness){var e=this.vel.x*c.nx+this.vel.y*c.ny;this.vel.x=(this.vel.x-2*c.nx*e)*this.bounciness;this.vel.y=(this.vel.y-2*c.ny*e)*this.bounciness}else e=(this.vel.x*c.x+this.vel.y*c.y)/(c.x*c.x+c.y*c.y),this.vel.x=c.x*e,this.vel.y=c.y*e,c=Math.atan2(c.x,c.y),c>this.slopeStanding.min&&c<this.slopeStanding.max&&(this.standing=!0)}this.pos=b.pos},draw:function(){this.currentAnim&&this.currentAnim.draw(this.pos.x-
this.offset.x-ig.game._rscreen.x,this.pos.y-this.offset.y-ig.game._rscreen.y)},kill:function(){ig.game.removeEntity(this)},receiveDamage:function(b){this.health-=b;0>=this.health&&this.kill()},touches:function(b){return!(this.pos.x>=b.pos.x+b.size.x||this.pos.x+this.size.x<=b.pos.x||this.pos.y>=b.pos.y+b.size.y||this.pos.y+this.size.y<=b.pos.y)},distanceTo:function(b){var c=this.pos.x+this.size.x/2-(b.pos.x+b.size.x/2);b=this.pos.y+this.size.y/2-(b.pos.y+b.size.y/2);return Math.sqrt(c*c+b*b)},angleTo:function(b){return Math.atan2(b.pos.y+
b.size.y/2-(this.pos.y+this.size.y/2),b.pos.x+b.size.x/2-(this.pos.x+this.size.x/2))},check:function(){},collideWith:function(){},ready:function(){},erase:function(){}});ig.Entity._lastId=0;ig.Entity.COLLIDES={NEVER:0,LITE:1,PASSIVE:2,ACTIVE:4,FIXED:8};ig.Entity.TYPE={NONE:0,A:1,B:2,BOTH:3};ig.Entity.checkPair=function(b,c){b.checkAgainst&c.type&&b.check(c);c.checkAgainst&b.type&&c.check(b);b.collides&&(c.collides&&b.collides+c.collides>ig.Entity.COLLIDES.ACTIVE)&&ig.Entity.solveCollision(b,c)};ig.Entity.solveCollision=
function(b,c){var e=null;if(b.collides==ig.Entity.COLLIDES.LITE||c.collides==ig.Entity.COLLIDES.FIXED)e=b;else if(c.collides==ig.Entity.COLLIDES.LITE||b.collides==ig.Entity.COLLIDES.FIXED)e=c;b.last.x+b.size.x>c.last.x&&b.last.x<c.last.x+c.size.x?(b.last.y<c.last.y?ig.Entity.seperateOnYAxis(b,c,e):ig.Entity.seperateOnYAxis(c,b,e),b.collideWith(c,"y"),c.collideWith(b,"y")):b.last.y+b.size.y>c.last.y&&b.last.y<c.last.y+c.size.y&&(b.last.x<c.last.x?ig.Entity.seperateOnXAxis(b,c,e):ig.Entity.seperateOnXAxis(c,
b,e),b.collideWith(c,"x"),c.collideWith(b,"x"))};ig.Entity.seperateOnXAxis=function(b,c,e){var d=b.pos.x+b.size.x-c.pos.x;e?(e.vel.x=-e.vel.x*e.bounciness+(b===e?c:b).vel.x,c=ig.game.collisionMap.trace(e.pos.x,e.pos.y,e==b?-d:d,0,e.size.x,e.size.y),e.pos.x=c.pos.x):(e=(b.vel.x-c.vel.x)/2,b.vel.x=-e,c.vel.x=e,e=ig.game.collisionMap.trace(b.pos.x,b.pos.y,-d/2,0,b.size.x,b.size.y),b.pos.x=Math.floor(e.pos.x),b=ig.game.collisionMap.trace(c.pos.x,c.pos.y,d/2,0,c.size.x,c.size.y),c.pos.x=Math.ceil(b.pos.x))};
ig.Entity.seperateOnYAxis=function(b,c,e){var d=b.pos.y+b.size.y-c.pos.y;if(e){c=b===e?c:b;e.vel.y=-e.vel.y*e.bounciness+c.vel.y;var j=0;e==b&&Math.abs(e.vel.y-c.vel.y)<e.minBounceVelocity&&(e.standing=!0,j=c.vel.x*ig.system.tick);b=ig.game.collisionMap.trace(e.pos.x,e.pos.y,j,e==b?-d:d,e.size.x,e.size.y);e.pos.y=b.pos.y;e.pos.x=b.pos.x}else ig.game.gravity&&(c.standing||0<b.vel.y)?(e=ig.game.collisionMap.trace(b.pos.x,b.pos.y,0,-(b.pos.y+b.size.y-c.pos.y),b.size.x,b.size.y),b.pos.y=e.pos.y,0<b.bounciness&&
b.vel.y>b.minBounceVelocity?b.vel.y*=-b.bounciness:(b.standing=!0,b.vel.y=0)):(e=(b.vel.y-c.vel.y)/2,b.vel.y=-e,c.vel.y=e,j=c.vel.x*ig.system.tick,e=ig.game.collisionMap.trace(b.pos.x,b.pos.y,j,-d/2,b.size.x,b.size.y),b.pos.y=e.pos.y,b=ig.game.collisionMap.trace(c.pos.x,c.pos.y,0,d/2,c.size.x,c.size.y),c.pos.y=b.pos.y)}});ig.baked=!0;
ig.module("impact.map").defines(function(){ig.Map=ig.Class.extend({tilesize:8,width:1,height:1,pxWidth:1,pxHeight:1,data:[[]],name:null,init:function(b,c){this.tilesize=b;this.data=c;this.height=c.length;this.width=c[0].length;this.pxWidth=this.width*this.tilesize;this.pxHeight=this.height*this.tilesize},getTile:function(b,c){var e=Math.floor(b/this.tilesize),d=Math.floor(c/this.tilesize);return 0<=e&&e<this.width&&0<=d&&d<this.height?this.data[d][e]:0},setTile:function(b,c,e){b=Math.floor(b/this.tilesize);
c=Math.floor(c/this.tilesize);0<=b&&b<this.width&&(0<=c&&c<this.height)&&(this.data[c][b]=e)}})});ig.baked=!0;
ig.module("impact.collision-map").requires("impact.map").defines(function(){ig.CollisionMap=ig.Map.extend({lastSlope:1,tiledef:null,init:function(b,c,j){this.parent(b,c);this.tiledef=j||ig.CollisionMap.defaultTileDef;for(var g in this.tiledef)g|0>this.lastSlope&&(this.lastSlope=g|0)},trace:function(b,c,j,g,p,l){var f={collision:{x:!1,y:!1,slope:!1},pos:{x:b,y:c},tile:{x:0,y:0}},m=Math.ceil((Math.max(Math.abs(j),Math.abs(g))+0.1)/this.tilesize);if(1<m)for(var n=j/m,r=g/m,s=0;s<m&&(n||r)&&!(this._traceStep(f,
b,c,n,r,p,l,j,g,s),b=f.pos.x,c=f.pos.y,f.collision.x&&(j=n=0),f.collision.y&&(g=r=0),f.collision.slope);s++);else this._traceStep(f,b,c,j,g,p,l,j,g,0);return f},_traceStep:function(b,c,j,g,p,l,f,m,n,r){b.pos.x+=g;b.pos.y+=p;var s=0;if(g){var t=0<g?l:0,u=0>g?this.tilesize:0,s=Math.max(Math.floor(j/this.tilesize),0),v=Math.min(Math.ceil((j+f)/this.tilesize),this.height);g=Math.floor((b.pos.x+t)/this.tilesize);var z=Math.floor((c+t)/this.tilesize);if(0<r||g==z||0>z||z>=this.width)z=-1;if(0<=g&&g<this.width)for(var x=
s;x<v&&!(-1!=z&&(s=this.data[x][z],1<s&&s<=this.lastSlope&&this._checkTileDef(b,s,c,j,m,n,l,f,z,x)));x++)if(s=this.data[x][g],1==s||s>this.lastSlope||1<s&&this._checkTileDef(b,s,c,j,m,n,l,f,g,x)){if(1<s&&s<=this.lastSlope&&b.collision.slope)break;b.collision.x=!0;b.tile.x=s;c=b.pos.x=g*this.tilesize-t+u;m=0;break}}if(p){t=0<p?f:0;p=0>p?this.tilesize:0;s=Math.max(Math.floor(b.pos.x/this.tilesize),0);u=Math.min(Math.ceil((b.pos.x+l)/this.tilesize),this.width);x=Math.floor((b.pos.y+t)/this.tilesize);
v=Math.floor((j+t)/this.tilesize);if(0<r||x==v||0>v||v>=this.height)v=-1;if(0<=x&&x<this.height)for(g=s;g<u&&!(-1!=v&&(s=this.data[v][g],1<s&&s<=this.lastSlope&&this._checkTileDef(b,s,c,j,m,n,l,f,g,v)));g++)if(s=this.data[x][g],1==s||s>this.lastSlope||1<s&&this._checkTileDef(b,s,c,j,m,n,l,f,g,x)){if(1<s&&s<=this.lastSlope&&b.collision.slope)break;b.collision.y=!0;b.tile.y=s;b.pos.y=x*this.tilesize-t+p;break}}},_checkTileDef:function(b,c,j,g,p,l,f,m,n,r){var s=this.tiledef[c];if(!s)return!1;c=(s[2]-
s[0])*this.tilesize;var t=(s[3]-s[1])*this.tilesize,u=s[4];f=j+p+(0>t?f:0)-(n+s[0])*this.tilesize;m=g+l+(0<c?m:0)-(r+s[1])*this.tilesize;if(0<c*m-t*f){if(0>p*-t+l*c)return u;n=Math.sqrt(c*c+t*t);r=t/n;n=-c/n;var v=f*r+m*n,s=r*v,v=n*v;if(s*s+v*v>=p*p+l*l)return u||0.5>c*(m-l)-t*(f-p);b.pos.x=j+p-s;b.pos.y=g+l-v;b.collision.slope={x:c,y:t,nx:r,ny:n};return!0}return!1}});var b=1/3,c=2/3;ig.CollisionMap.defaultTileDef={5:[0,1,1,c,!0],6:[0,c,1,b,!0],7:[0,b,1,0,!0],3:[0,1,1,0.5,!0],4:[0,0.5,1,0,!0],2:[0,
1,1,0,!0],10:[0.5,1,1,0,!0],21:[0,1,0.5,0,!0],32:[c,1,1,0,!0],43:[b,1,c,0,!0],54:[0,1,b,0,!0],27:[0,0,1,b,!0],28:[0,b,1,c,!0],29:[0,c,1,1,!0],25:[0,0,1,0.5,!0],26:[0,0.5,1,1,!0],24:[0,0,1,1,!0],11:[0,0,0.5,1,!0],22:[0.5,0,1,1,!0],33:[0,0,b,1,!0],44:[b,0,c,1,!0],55:[c,0,1,1,!0],16:[1,b,0,0,!0],17:[1,c,0,b,!0],18:[1,1,0,c,!0],14:[1,0.5,0,0,!0],15:[1,1,0,0.5,!0],13:[1,1,0,0,!0],8:[0.5,1,0,0,!0],19:[1,1,0.5,0,!0],30:[b,1,0,0,!0],41:[c,1,b,0,!0],52:[1,1,c,0,!0],38:[1,c,0,1,!0],39:[1,b,0,c,!0],40:[1,0,
0,b,!0],36:[1,0.5,0,1,!0],37:[1,0,0,0.5,!0],35:[1,0,0,1,!0],9:[1,0,0.5,1,!0],20:[0.5,0,0,1,!0],31:[1,0,c,1,!0],42:[c,0,b,1,!0],53:[b,0,0,1,!0],12:[0,0,1,0,!1],23:[1,1,0,1,!1],34:[1,0,1,1,!1],45:[0,1,0,0,!1]};ig.CollisionMap.staticNoCollision={trace:function(b,c,j,g){return{collision:{x:!1,y:!1,slope:!1},pos:{x:b+j,y:c+g},tile:{x:0,y:0}}}}});ig.baked=!0;
ig.module("impact.background-map").requires("impact.map","impact.image").defines(function(){ig.BackgroundMap=ig.Map.extend({tiles:null,scroll:{x:0,y:0},distance:1,repeat:!1,tilesetName:"",foreground:!1,enabled:!0,preRender:!1,preRenderedChunks:null,chunkSize:512,debugChunks:!1,anims:{},init:function(b,c,e){this.parent(b,c);this.setTileset(e)},setTileset:function(b){this.tilesetName=b instanceof ig.Image?b.path:b;this.tiles=new ig.Image(this.tilesetName);this.preRenderedChunks=null},setScreenPos:function(b,
c){this.scroll.x=b/this.distance;this.scroll.y=c/this.distance},preRenderMapToChunks:function(){var b=this.width*this.tilesize*ig.system.scale,c=this.height*this.tilesize*ig.system.scale;this.chunkSize=Math.min(Math.max(b,c),this.chunkSize);var e=Math.ceil(b/this.chunkSize),d=Math.ceil(c/this.chunkSize);this.preRenderedChunks=[];for(var j=0;j<d;j++){this.preRenderedChunks[j]=[];for(var g=0;g<e;g++)this.preRenderedChunks[j][g]=this.preRenderChunk(g,j,g==e-1?b-g*this.chunkSize:this.chunkSize,j==d-1?
c-j*this.chunkSize:this.chunkSize)}},preRenderChunk:function(b,c,e,d){var j=e/this.tilesize/ig.system.scale+1,g=d/this.tilesize/ig.system.scale+1,p=b*this.chunkSize/ig.system.scale%this.tilesize,l=c*this.chunkSize/ig.system.scale%this.tilesize;b=Math.floor(b*this.chunkSize/this.tilesize/ig.system.scale);var f=Math.floor(c*this.chunkSize/this.tilesize/ig.system.scale);c=ig.$new("canvas");c.width=e;c.height=d;c.retinaResolutionEnabled=!1;d=c.getContext("2d");ig.System.scaleMode(c,d);e=ig.system.context;
ig.system.context=d;for(d=0;d<j;d++)for(var m=0;m<g;m++)if(d+b<this.width&&m+f<this.height){var n=this.data[m+f][d+b];n&&this.tiles.drawTile(d*this.tilesize-p,m*this.tilesize-l,n-1,this.tilesize)}ig.system.context=e;j=new Image;j.src=c.toDataURL();j.width=c.width;j.height=c.height;return j},draw:function(){this.tiles.loaded&&this.enabled&&(this.preRender?this.drawPreRendered():this.drawTiled())},drawPreRendered:function(){this.preRenderedChunks||this.preRenderMapToChunks();var b=ig.system.getDrawPos(this.scroll.x),
c=ig.system.getDrawPos(this.scroll.y);if(this.repeat)var e=this.width*this.tilesize*ig.system.scale,b=(b%e+e)%e,e=this.height*this.tilesize*ig.system.scale,c=(c%e+e)%e;var e=Math.max(Math.floor(b/this.chunkSize),0),d=Math.max(Math.floor(c/this.chunkSize),0),j=Math.ceil((b+ig.system.realWidth)/this.chunkSize),g=Math.ceil((c+ig.system.realHeight)/this.chunkSize),p=this.preRenderedChunks[0].length,l=this.preRenderedChunks.length;this.repeat||(j=Math.min(j,p),g=Math.min(g,l));for(var f=0,m=d;m<g;m++){for(var n=
0,r=e;r<j;r++){var s=this.preRenderedChunks[m%l][r%p],t=-b+r*this.chunkSize-n,u=-c+m*this.chunkSize-f;ig.system.context.drawImage(s,t,u);ig.Image.drawCount++;this.debugChunks&&(ig.system.context.strokeStyle="#f0f",ig.system.context.strokeRect(t,u,this.chunkSize,this.chunkSize));this.repeat&&(s.width<this.chunkSize&&t+s.width<ig.system.realWidth)&&(n+=this.chunkSize-s.width,m==d&&j++)}this.repeat&&(s.height<this.chunkSize&&u+s.height<ig.system.realHeight)&&(f+=this.chunkSize-s.height,g++)}},drawTiled:function(){for(var b=
0,c=null,e=(this.scroll.x/this.tilesize).toInt(),d=(this.scroll.y/this.tilesize).toInt(),j=this.scroll.x%this.tilesize,g=this.scroll.y%this.tilesize,p=-j-this.tilesize,j=ig.system.width+this.tilesize-j,l=ig.system.height+this.tilesize-g,f=-1,g=-g-this.tilesize;g<l;f++,g+=this.tilesize){var m=f+d;if(m>=this.height||0>m){if(!this.repeat)continue;m=(m%this.height+this.height)%this.height}for(var n=-1,r=p;r<j;n++,r+=this.tilesize){b=n+e;if(b>=this.width||0>b){if(!this.repeat)continue;b=(b%this.width+
this.width)%this.width}if(b=this.data[m][b])(c=this.anims[b-1])?c.draw(r,g):this.tiles.drawTile(r,g,b-1,this.tilesize)}}}})});ig.baked=!0;
ig.module("impact.game").requires("impact.impact","impact.entity","impact.collision-map","impact.background-map").defines(function(){ig.Game=ig.Class.extend({clearColor:"#000000",gravity:0,screen:{x:0,y:0},_rscreen:{x:0,y:0},entities:[],namedEntities:{},collisionMap:ig.CollisionMap.staticNoCollision,backgroundMaps:[],backgroundAnims:{},autoSort:!1,sortBy:null,cellSize:64,_deferredKill:[],_levelToLoad:null,_doSortEntities:!1,staticInstantiate:function(){this.sortBy=this.sortBy||ig.Game.SORT.Z_INDEX;
ig.game=this;return null},loadLevel:function(b){this.screen={x:0,y:0};this.entities=[];this.namedEntities={};for(var c=0;c<b.entities.length;c++){var e=b.entities[c];this.spawnEntity(e.type,e.x,e.y,e.settings)}this.sortEntities();this.collisionMap=ig.CollisionMap.staticNoCollision;this.backgroundMaps=[];for(c=0;c<b.layer.length;c++)if(e=b.layer[c],"collision"==e.name)this.collisionMap=new ig.CollisionMap(e.tilesize,e.data);else{var d=new ig.BackgroundMap(e.tilesize,e.data,e.tilesetName);d.anims=this.backgroundAnims[e.tilesetName]||
{};d.repeat=e.repeat;d.distance=e.distance;d.foreground=!!e.foreground;d.preRender=!!e.preRender;d.name=e.name;this.backgroundMaps.push(d)}for(c=0;c<this.entities.length;c++)this.entities[c].ready()},loadLevelDeferred:function(b){this._levelToLoad=b},getMapByName:function(b){if("collision"==b)return this.collisionMap;for(var c=0;c<this.backgroundMaps.length;c++)if(this.backgroundMaps[c].name==b)return this.backgroundMaps[c];return null},getEntityByName:function(b){return this.namedEntities[b]},getEntitiesByType:function(b){b=
"string"===typeof b?ig.global[b]:b;for(var c=[],e=0;e<this.entities.length;e++){var d=this.entities[e];d instanceof b&&!d._killed&&c.push(d)}return c},spawnEntity:function(b,c,e,d){var j="string"===typeof b?ig.global[b]:b;if(!j)throw"Can't spawn entity of type "+b;b=new j(c,e,d||{});this.entities.push(b);b.name&&(this.namedEntities[b.name]=b);return b},sortEntities:function(){this.entities.sort(this.sortBy)},sortEntitiesDeferred:function(){this._doSortEntities=!0},removeEntity:function(b){b.name&&
delete this.namedEntities[b.name];b._killed=!0;b.type=ig.Entity.TYPE.NONE;b.checkAgainst=ig.Entity.TYPE.NONE;b.collides=ig.Entity.COLLIDES.NEVER;this._deferredKill.push(b)},run:function(){this.update();this.draw()},update:function(){this._levelToLoad&&(this.loadLevel(this._levelToLoad),this._levelToLoad=null);this.updateEntities();this.checkEntities();for(var b=0;b<this._deferredKill.length;b++)this._deferredKill[b].erase(),this.entities.erase(this._deferredKill[b]);this._deferredKill=[];if(this._doSortEntities||
this.autoSort)this.sortEntities(),this._doSortEntities=!1;for(var c in this.backgroundAnims){var b=this.backgroundAnims[c],e;for(e in b)b[e].update()}},updateEntities:function(){for(var b=0;b<this.entities.length;b++){var c=this.entities[b];c._killed||c.update()}},draw:function(){this.clearColor&&ig.system.clear(this.clearColor);this._rscreen.x=ig.system.getDrawPos(this.screen.x)/ig.system.scale;this._rscreen.y=ig.system.getDrawPos(this.screen.y)/ig.system.scale;var b;for(b=0;b<this.backgroundMaps.length;b++){var c=
this.backgroundMaps[b];if(c.foreground)break;c.setScreenPos(this.screen.x,this.screen.y);c.draw()}this.drawEntities();for(b;b<this.backgroundMaps.length;b++)c=this.backgroundMaps[b],c.setScreenPos(this.screen.x,this.screen.y),c.draw()},drawEntities:function(){for(var b=0;b<this.entities.length;b++)this.entities[b].draw()},checkEntities:function(){for(var b={},c=0;c<this.entities.length;c++){var e=this.entities[c];if(!(e.type==ig.Entity.TYPE.NONE&&e.checkAgainst==ig.Entity.TYPE.NONE&&e.collides==ig.Entity.COLLIDES.NEVER))for(var d=
{},j=Math.floor(e.pos.y/this.cellSize),g=Math.floor((e.pos.x+e.size.x)/this.cellSize)+1,p=Math.floor((e.pos.y+e.size.y)/this.cellSize)+1,l=Math.floor(e.pos.x/this.cellSize);l<g;l++)for(var f=j;f<p;f++)if(b[l])if(b[l][f]){for(var m=b[l][f],n=0;n<m.length;n++)e.touches(m[n])&&!d[m[n].id]&&(d[m[n].id]=!0,ig.Entity.checkPair(e,m[n]));m.push(e)}else b[l][f]=[e];else b[l]={},b[l][f]=[e]}}});ig.Game.SORT={Z_INDEX:function(b,c){return b.zIndex-c.zIndex},POS_X:function(b,c){return b.pos.x+b.size.x-(c.pos.x+
c.size.x)},POS_Y:function(b,c){return b.pos.y+b.size.y-(c.pos.y+c.size.y)}}});ig.baked=!0;ig.module("plugins.patches.impact-patch").requires("impact.impact").defines(function(){var b=["_mesh","_camera"];window.ig.merge=function(c,e){for(var d in e)if(!(0<=b.indexOf(d))){var j=e[d];if("object"!=typeof j||j instanceof HTMLElement||j instanceof ig.Class||null===j)c[d]=j;else{if(!c[d]||"object"!=typeof c[d])c[d]=j instanceof Array?[]:{};ig.merge(c[d],j)}}return c}});ig.baked=!0;
ig.module("plugins.patches.fps-limit-patch").requires("impact.system","impact.impact").defines(function(){ig.System.inject({fps:60});ig.system&&(ig.system.fps=60);ig.normalizeVendorAttribute(window,"requestAnimationFrame");if(window.requestAnimationFrame){var b=1,c={};window.ig.setAnimation=function(e,d){var j=b++;c[j]=!0;var g=1E3/60,p=60,l=0,f=0,m=0,n=0,r=function(){c[j]&&(timestamp=Date.now(),f=l,l=timestamp,n=l-f,p=0.8*p+0.2*(1E3/n),60<p&&63<=p?(m=Math.min(Math.max(2*g+f-timestamp,0),g),setTimeout(function(){window.requestAnimationFrame(r,
d)},m),e(timestamp)):(window.requestAnimationFrame(r,d),e()))};window.requestAnimationFrame(r,d);return j};window.ig.clearAnimation=function(b){delete c[b]}}else window.ig.setAnimation=function(b){return window.setInterval(b,1E3/60)},window.ig.clearAnimation=function(b){window.clearInterval(b)}});ig.baked=!0;
ig.module("plugins.patches.timer-patch").requires("impact.timer").defines(function(){ig.Timer.step=function(){var b=Date.now(),c=(b-ig.Timer._last)/1E3;0>c&&(c=0);ig.Timer.time+=Math.min(c,ig.Timer.maxStep)*ig.Timer.timeScale;ig.Timer._last=b}});ig.baked=!0;
ig.module("plugins.patches.user-agent-patch").requires("impact.impact").defines(function(){ig.ua.is_uiwebview=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);ig.ua.is_safari_or_uiwebview=/(iPhone|iPod|iPad).*AppleWebKit/i.test(navigator.userAgent);ig.ua.iOS6_tag=/OS 6_/i.test(navigator.userAgent);ig.ua.iOS6=(ig.ua.iPhone||ig.ua.iPad)&&ig.ua.iOS6_tag;ig.ua.iOSgt5=ig.ua.iOS&&5<parseInt(navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/)[1]);ig.ua.HTCONE=/HTC_One/i.test(navigator.userAgent);
ig.ua.Kindle=/Silk/i.test(navigator.userAgent);ig.ua.touchDevice="ontouchstart"in window||window.navigator.msMaxTouchPoints||window.navigator.maxTouchPoints;ig.ua.is_mac="MacIntel"===navigator.platform;ig.ua.iOS=ig.ua.touchDevice&&ig.ua.is_mac||ig.ua.iOS;ig.ua.mobile=ig.ua.iOS||ig.ua.android||ig.ua.iOS6||ig.ua.winPhone||ig.ua.Kindle||/mobile/i.test(navigator.userAgent)});ig.baked=!0;
ig.module("plugins.patches.webkit-image-smoothing-patch").defines(function(){ig.System&&(ig.System.SCALE={CRISP:function(b,c){c.imageSmoothingEnabled=c.msImageSmoothingEnabled=c.mozImageSmoothingEnabled=c.oImageSmoothingEnabled=!1;b.style.imageRendering="-moz-crisp-edges";b.style.imageRendering="-o-crisp-edges";b.style.imageRendering="-webkit-optimize-contrast";b.style.imageRendering="crisp-edges";b.style.msInterpolationMode="nearest-neighbor"},SMOOTH:function(b,c){c.imageSmoothingEnabled=c.msImageSmoothingEnabled=
c.oImageSmoothingEnabled=!0;b.style.imageRendering="";b.style.msInterpolationMode=""}},ig.System.scaleMode=ig.System.SCALE.SMOOTH)});ig.baked=!0;
ig.module("plugins.patches.windowfocus-onMouseDown-patch").requires("impact.input").defines(function(){var b=!1;try{b=window.self!==window.top,!1===b&&(b=0<window.frames.length)}catch(c){b=!0}ig.Input.inject({keydown:function(c){var d=c.target.tagName;if(!("INPUT"==d||"TEXTAREA"==d))if(d="keydown"==c.type?c.keyCode:2==c.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1,b&&0>d&&window.focus(),("touchstart"==c.type||"mousedown"==c.type)&&this.mousemove(c),d=this.bindings[d])this.actions[d]=!0,this.locks[d]||(this.presses[d]=
!0,this.locks[d]=!0),c.stopPropagation(),c.preventDefault()}})});ig.baked=!0;
ig.module("plugins.patches.input-patch").requires("impact.input").defines(function(){ig.Input.inject({move:new BABYLON.Vector2(0,0),initMouse:function(){this.parent();ig.system.canvas.addEventListener("mouseleave",this.mouseleave.bind(this),!1)},mousemove:function(b){this.parent(b);try{ig.soundHandler.unlockWebAudio()}catch(c){}},keyup:function(b){this.parent(b);if(ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(c){}},mouseleave:function(){this.clearState("click")},
clearState:function(b){this.actions[b]=!1},clearAllState:function(){for(var b in this.actions)this.clearState(b)}})});ig.baked=!0;
ig.module("plugins.data.vector").defines(function(){Vector2=function(b,c){this.x=b||0;this.y=c||0};Vector2.prototype={valType:"number",neg:function(){this.x=-this.x;this.y=-this.y;return this},row:function(b){typeof b===this.valType&&(this.y=b);return this.y},col:function(b){typeof b===this.valType&&(this.x=b);return this.x},add:function(b){b instanceof Vector2?(this.x+=b.x,this.y+=b.y):(this.x+=b,this.y+=b);return this},sub:function(b){b instanceof Vector2?(this.x-=b.x,this.y-=b.y):(this.x-=b,this.y-=
b);return this},mul:function(b){b instanceof Vector2?(this.x*=b.x,this.y*=b.y):(this.x*=b,this.y*=b);return this},div:function(b){b instanceof Vector2?(0!=b.x&&(this.x/=b.x),0!=b.y&&(this.y/=b.y)):0!=b&&(this.x/=b,this.y/=b);return this},equals:function(b){return this.x==b.x&&this.y==b.y},dot:function(b){return this.x*b.x+this.y*b.y},cross:function(b){return this.x*b.y-this.y*b.x},length:function(){return Math.sqrt(this.dot(this))},norm:function(){return this.div(this.length())},min:function(){return Math.min(this.x,
this.y)},max:function(){return Math.max(this.x,this.y)},toAngles:function(){return-Math.atan2(-this.y,this.x)},angleTo:function(b){return Math.acos(this.dot(b)/(this.length()*b.length()))},toArray:function(b){return[this.x,this.y].slice(0,b||2)},clone:function(){return new Vector2(this.x,this.y)},set:function(b,c){this.x=b;this.y=c;return this},unit:function(){var b=this.length();if(0<b)return new Vector2(this.x/b,this.y/b);throw"Divide by 0 error in unitVector function of vector:"+this;},turnRight:function(){var b=
this.x;this.x=-this.y;this.y=b;return this},turnLeft:function(){var b=this.x;this.x=this.y;this.y=-b;return this},rotate:function(b){var c=this.clone();this.x=c.x*Math.cos(b)-c.y*Math.sin(b);this.y=c.x*Math.sin(b)+c.y*Math.cos(b);return this}};Vector2.negative=function(b){return new Vector2(-b.x,-b.y)};Vector2.add=function(b,c){return c instanceof Vector2?new Vector2(b.x+c.x,b.y+c.y):new Vector2(b.x+c,b.y+c)};Vector2.subtract=function(b,c){return c instanceof Vector2?new Vector2(b.x-c.x,b.y-c.y):
new Vector2(b.x-c,b.y-c)};Vector2.multiply=function(b,c){return c instanceof Vector2?new Vector2(b.x*c.x,b.y*c.y):new Vector2(b.x*c,b.y*c)};Vector2.divide=function(b,c){return c instanceof Vector2?new Vector2(b.x/c.x,b.y/c.y):new Vector2(b.x/c,b.y/c)};Vector2.equals=function(b,c){return b.x==c.x&&b.y==c.y};Vector2.dot=function(b,c){return b.x*c.x+b.y*c.y};Vector2.cross=function(b,c){return b.x*c.y-b.y*c.x}});ig.baked=!0;
ig.module("plugins.data.color-rgb").defines(function(){ColorRGB=function(b,c,e,d){this.r=b||0;this.g=c||0;this.b=e||0;this.a=d||0};ColorRGB.prototype={setRandomColor:function(){this.r=Math.round(255*Math.random());this.g=Math.round(255*Math.random());this.b=Math.round(255*Math.random())},getStyle:function(){return"rgba("+this.r+","+this.g+","+this.b+","+this.a+")"},getHex:function(){for(var b=this.r.toString(16),c=this.g.toString(16),e=this.b.toString(16);2>b.length;)b="0"+b;for(;2>c.length;)c="0"+
c;for(;2>e.length;)e="0"+e;return"#"+b+c+e},getInvertedColor:function(){return new ColorRGB(255-this.r,255-this.g,255-this.b,255-this.a)},clone:function(){return new ColorRGB(this.r,this.g,this.b,this.a)}}});ig.baked=!0;
ig.module("plugins.font.font-info").requires("impact.impact").defines(function(){ig.FontInfo=ig.Class.extend({fonts:[{name:"typo",source:"media/fonts/typo"},{name:"ash",source:"media/fonts/ash"},{name:"noirpro-bold",source:"media/fonts/noirpro-bold"}],init:function(){this.registerCssFont()},getKeys:function(){for(var b={},c=0;c<this.fonts.length;c++){for(var e=this.fonts[c].name,d=e.split("-"),j="",g=0;g<d.length;g++)j+=d[g];b[j]=e}return b},registerCssFont:function(){if(0<this.fonts.length){var b=
document.createElement("style");b.type="text/css";for(var c="",e=0;e<this.fonts.length;e++)var d=this.fonts[e],c=c+("@font-face {font-family: '"+d.name+"';src: url('"+d.source+".eot');src: url('"+d.source+".eot?#iefix') format('embedded-opentype'),url('"+d.source+".woff2') format('woff2'),url('"+d.source+".woff') format('woff'),url('"+d.source+".ttf') format('truetype'),url('"+d.source+".svg#svgFontName') format('svg')}");b.appendChild(document.createTextNode(c));document.head.appendChild(b)}},isValid:function(){for(var b=
0;b<this.fonts.length;b++)if(!this._isValidName(this.fonts[b].source))return!1;return!0},_isValidName:function(b){return-1==b.search(/^[a-z0-9-\/]+$/)?!1:!0}})});ig.baked=!0;
ig.module("plugins.font.font-loader").requires("impact.impact","plugins.font.font-info","impact.loader").defines(function(){ig.FontLoader=ig.Class.extend({fontInfo:new ig.FontInfo,onload:!1,onerror:!1,init:function(b,c){this.onload=b;this.onerror=c},load:function(){this.fontInfo.isValid()?this._loadByLib():console.error("Only lowercased alphanumeric and dash are allowed for font file name!. Please check the font path")},_loadByLib:function(){for(var b=[],c=0;c<this.fontInfo.fonts.length;c++){var e=
new FontFaceObserver(this.fontInfo.fonts[c].name);b.push(e.load())}Promise.all(b).then(this.onload).catch(this.onerror)}});ig.Loader.inject({parentLoad:!1,load:function(){this.parentLoad=this.parent;this.fontLoader=(new ig.FontLoader(this.onFontLoad.bind(this),this.onFontError.bind(this))).load()},onFontLoad:function(){this.parentLoad()},onFontError:function(){console.error("Font is not loaded")}})});ig.baked=!0;
ig.module("plugins.handlers.dom-handler").defines(function(){ig.DomHandler=ig.Class.extend({version:"1.1.2",JQUERYAVAILABLE:!1,init:function(){this.JQUERYAVAILABLE=this._jqueryAvailable()},_jqueryAvailable:function(){return"undefined"!==typeof jQuery},addEvent:function(b,c,e,d){if(this.JQUERYAVAILABLE)b.on(c,e);else b.addEventListener(c,e,d)},create:function(b){return this.JQUERYAVAILABLE?$("<"+b+">"):ig.$new(b)},getElementByClass:function(b){return this.JQUERYAVAILABLE?$("."+b):document.getElementsByClassName(b)},
getElementById:function(b){return this.JQUERYAVAILABLE?0<$(b).length?$(b):null:ig.$(b)},appendChild:function(b,c){this.JQUERYAVAILABLE?b.append(c):b.appendChild(c)},appendToBody:function(b){this.JQUERYAVAILABLE?$("body").append(b):document.body.appendChild(b)},appendToHead:function(b){this.JQUERYAVAILABLE?$("head").append(b):document.head.appendChild(b)},removeChild:function(b,c){this.JQUERYAVAILABLE?b.remove(c):b.removeChild(c)},removeFromBody:function(b){this.JQUERYAVAILABLE?$(b).remove():document.body.removeChild(b)},
removeFromHead:function(b){this.JQUERYAVAILABLE?$(b).remove():document.head.removeChild(b)},text:function(b,c){this.JQUERYAVAILABLE?b.text(c):b.innerText=c},val:function(b,c){this.JQUERYAVAILABLE?b.val(c):b.value=c},getVal:function(b){return this.JQUERYAVAILABLE?b.val():b.value},getAttr:function(b,c){return this.JQUERYAVAILABLE?b.attr(c):b.getAttribute(c)},getText:function(b){return this.JQUERYAVAILABLE?b.text():b.innerText},html:function(b,c){this.JQUERYAVAILABLE?b.html(c):b.innerHTML=c},resize:function(b,
c,e){if(this.JQUERYAVAILABLE)b.width(c.toFixed(2)),b.height(e.toFixed(2));else{var d=b.style.visibility;c="width:"+c.toFixed(2)+"px; height:"+e.toFixed(2)+"px;";this.attr(b,"style",c);b.style.visibility=d}},resizeOffsetLeft:function(b,c,e,d){if(this.JQUERYAVAILABLE)b.width(c.toFixed(2)),b.height(e.toFixed(2)),b.css("left",d);else{var j=b.style.visibility;c="width:"+c.toFixed(2)+"px; height:"+e.toFixed(2)+"px; left: "+d.toFixed(2)+"px;";this.attr(b,"style",c);b.style.visibility=j}},resizeOffset:function(b,
c,e,d,j){if(this.JQUERYAVAILABLE)b.width(c.toFixed(2)),b.height(e.toFixed(2)),b.css("left",d),b.css("top",j);else{var g=b.style.visibility;c="width:"+c.toFixed(2)+"px; height:"+e.toFixed(2)+"px; left: "+d.toFixed(2)+"px; top: "+j.toFixed(2)+"px;";this.attr(b,"style",c);b.style.visibility=g}},css:function(b,c){if(this.JQUERYAVAILABLE)b.css(c);else{var e="",d;for(d in c)e+=d+":"+c[d]+";";this.attr(b,"style",e)}},getOffsets:function(b){return this.JQUERYAVAILABLE?(b=b.offset(),{left:b.left,top:b.top}):
{left:b.offsetLeft,top:b.offsetTop}},attr:function(b,c,e){if("undefined"===typeof e)return this.JQUERYAVAILABLE?b.attr(c):b.getAttribute(c);this.JQUERYAVAILABLE?b.attr(c,e):b.setAttribute(c,e)},show:function(b){b&&"undefined"!==typeof b&&(this.JQUERYAVAILABLE?(b.show(),b.css("visibility","visible")):b&&(b.style?b.style.visibility="visible":b[0]&&(b[0].style.visibility="visible")))},hide:function(b){b&&"undefined"!==typeof b&&(this.JQUERYAVAILABLE?(b.hide(),b.css("visibility","hidden")):b&&(b.style?
b.style.visibility="hidden":b[0]&&(b[0].style.visibility="hidden")))},getQueryVariable:function(b){for(var c=window.location.search.substring(1).split("&"),e=0;e<c.length;e++){var d=c[e].match(/([^=]+?)=(.+)/);if(d&&decodeURIComponent(d[1])==b)return decodeURIComponent(d[2])}},forcedDeviceDetection:function(){var b=this.getQueryVariable("device");if(b)switch(b){case "mobile":console.log("serving mobile version ...");ig.ua.mobile=!0;break;case "desktop":console.log("serving desktop version ...");ig.ua.mobile=
!1;break;default:console.log("serving universal version ...")}else console.log("serving universal version ...")},forcedDeviceRotation:function(){var b=this.getQueryVariable("force-rotate");if(b)switch(b){case "portrait":console.log("force rotate to portrait");window.orientation=0;break;case "landscape":console.log("force rotate to horizontal");window.orientation=90;break;default:alert("wrong command/type in param force-rotate. Defaulting value to portrait"),window.orientation=0}},setZIndex:function(b,
c){this.JQUERYAVAILABLE?b.css("zIndex",c):b&&(b.style?b.style.zIndex=c:b[0]&&(b[0].style.zIndex=c))}})});ig.baked=!0;
ig.module("plugins.handlers.size-handler").defines(function(){ig.SizeHandler=ig.Class.extend({portraitMode:!0,disableStretchToFitOnMobileFlag:!1,enableStretchToFitOnAntiPortraitModeFlag:!0,enableScalingLimitsOnMobileFlag:!1,minScalingOnMobile:0,maxScalingOnMobile:1,enableStretchToFitOnDesktopFlag:!1,enableScalingLimitsOnDesktopFlag:!1,minScalingOnDesktop:0,maxScalingOnDesktop:1,desktop:{actualSize:new BABYLON.Vector2(window.innerWidth,window.innerHeight),actualResolution:new BABYLON.Vector2(1600,
1600)},mobile:{actualSize:new BABYLON.Vector2(window.innerWidth,window.innerHeight),actualResolution:new BABYLON.Vector2(1600,1600)},windowSize:new BABYLON.Vector2(window.innerWidth,window.innerHeight),scaleRatioMultiplier:new BABYLON.Vector2(1,1),sizeRatio:new BABYLON.Vector2(1,1),scale:1,domHandler:null,dynamicClickableEntityDivs:{},coreDivsToResize:["#webglcanvas","#canvas","#play","#orientate"],adsToResize:{MobileAdInGamePreroll:{"box-width":_SETTINGS.Ad.Mobile.Preroll.Width+2,"box-height":_SETTINGS.Ad.Mobile.Preroll.Height+
20},MobileAdInGameEnd:{"box-width":_SETTINGS.Ad.Mobile.End.Width+2,"box-height":_SETTINGS.Ad.Mobile.End.Height+20},MobileAdInGamePreroll2:{"box-width":_SETTINGS.Ad.Mobile.Preroll.Width+2,"box-height":_SETTINGS.Ad.Mobile.Preroll.Height+20},MobileAdInGameEnd2:{"box-width":_SETTINGS.Ad.Mobile.End.Width+2,"box-height":_SETTINGS.Ad.Mobile.End.Height+20},MobileAdInGamePreroll3:{"box-width":_SETTINGS.Ad.Mobile.Preroll.Width+2,"box-height":_SETTINGS.Ad.Mobile.Preroll.Height+20},MobileAdInGameEnd3:{"box-width":_SETTINGS.Ad.Mobile.End.Width+
2,"box-height":_SETTINGS.Ad.Mobile.End.Height+20}},init:function(b){this.domHandler=b;if("undefined"===typeof b)throw"undefined Dom Handler for Size Handler";this.sizeCalcs();this.eventListenerSetup();this.samsungFix()},sizeCalcs:function(){this.windowSize=new Vector2(window.innerWidth,window.innerHeight);if(ig.ua.mobile){this.mobile.actualSize=new Vector2(window.innerWidth,window.innerHeight);var b=new Vector2(this.mobile.actualResolution.x,this.mobile.actualResolution.y);this.scaleRatioMultiplier=
new Vector2(this.mobile.actualSize.x/b.x,this.mobile.actualSize.y/b.y);if(this.disableStretchToFitOnMobileFlag){var c=Math.min(this.scaleRatioMultiplier.x,this.scaleRatioMultiplier.y);this.enableScalingLimitsOnMobileFlag&&(c=c.limit(this.minScalingOnMobile,this.maxScalingOnMobile));this.mobile.actualSize.x=b.x*c;this.mobile.actualSize.y=b.y*c;this.scaleRatioMultiplier.x=c;this.scaleRatioMultiplier.y=c}else this.sizeRatio.x=this.scaleRatioMultiplier.x,this.sizeRatio.y=this.scaleRatioMultiplier.y,this.scaleRatioMultiplier.x=
1,this.scaleRatioMultiplier.y=1}else this.desktop.actualSize=new Vector2(window.innerWidth,window.innerHeight),b=new Vector2(this.desktop.actualResolution.x,this.desktop.actualResolution.y),this.scaleRatioMultiplier=new Vector2(this.desktop.actualSize.x/b.x,this.desktop.actualSize.y/b.y),this.enableStretchToFitOnDesktopFlag?(this.sizeRatio.x=this.scaleRatioMultiplier.x,this.sizeRatio.y=this.scaleRatioMultiplier.y,this.scaleRatioMultiplier.x=1,this.scaleRatioMultiplier.y=1):(c=Math.min(this.scaleRatioMultiplier.x,
this.scaleRatioMultiplier.y),this.enableScalingLimitsOnDesktopFlag&&(c=c.limit(this.minScalingOnDesktop,this.maxScalingOnDesktop)),this.desktop.actualSize.x=b.x*c,this.desktop.actualSize.y=b.y*c,this.scaleRatioMultiplier.x=c,this.scaleRatioMultiplier.y=c)},resizeLayers:function(){for(var b=0;b<this.coreDivsToResize.length;b++){var c=ig.domHandler.getElementById(this.coreDivsToResize[b]);if(ig.ua.mobile)if(this.disableStretchToFitOnMobileFlag){var e=Math.floor(ig.sizeHandler.windowSize.x/2-ig.sizeHandler.mobile.actualSize.x/
2),d=Math.floor(ig.sizeHandler.windowSize.y/2-ig.sizeHandler.mobile.actualSize.y/2);0>e&&(e=0);0>d&&(d=0);ig.domHandler.resizeOffset(c,Math.floor(ig.sizeHandler.mobile.actualSize.x),Math.floor(ig.sizeHandler.mobile.actualSize.y),e,d);var j=!1;if(j=this.portraitMode?window.innerHeight<window.innerWidth:window.innerHeight>window.innerWidth)if(this.enableStretchToFitOnAntiPortraitModeFlag)ig.domHandler.resizeOffset(c,Math.floor(window.innerWidth),Math.floor(window.innerHeight),0,0);else{var j=new Vector2(window.innerWidth/
this.mobile.actualResolution.y,window.innerHeight/this.mobile.actualResolution.x),e=Math.min(j.x,j.y),j=this.mobile.actualResolution.y*e,g=this.mobile.actualResolution.x*e,e=Math.floor(ig.sizeHandler.windowSize.x/2-j/2),d=Math.floor(ig.sizeHandler.windowSize.y/2-g/2);0>e&&(e=0);0>d&&(d=0);ig.domHandler.resizeOffset(c,Math.floor(j),Math.floor(g),e,d)}}else ig.domHandler.resize(c,Math.floor(ig.sizeHandler.mobile.actualSize.x),Math.floor(ig.sizeHandler.mobile.actualSize.y));else this.enableStretchToFitOnDesktopFlag?
ig.domHandler.resize(c,Math.floor(ig.sizeHandler.desktop.actualSize.x),Math.floor(ig.sizeHandler.desktop.actualSize.y)):(e=Math.floor(ig.sizeHandler.windowSize.x/2-ig.sizeHandler.desktop.actualSize.x/2),d=Math.floor(ig.sizeHandler.windowSize.y/2-ig.sizeHandler.desktop.actualSize.y/2),0>e&&(e=0),0>d&&(d=0),ig.domHandler.resizeOffset(c,Math.floor(ig.sizeHandler.desktop.actualSize.x),Math.floor(ig.sizeHandler.desktop.actualSize.y),e,d))}for(var p in this.adsToResize)b=ig.domHandler.getElementById("#"+
p),c=ig.domHandler.getElementById("#"+p+"-Box"),j=(window.innerWidth-this.adsToResize[p]["box-width"])/2+"px",e=(window.innerHeight-this.adsToResize[p]["box-height"])/2+"px",b&&ig.domHandler.css(b,{width:window.innerWidth,height:window.innerHeight}),c&&ig.domHandler.css(c,{left:j,top:e});b=ig.domHandler.getElementById("#canvas");c=ig.domHandler.getOffsets(b);b=c.left;c=c.top;j=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);for(p in this.dynamicClickableEntityDivs){e=
ig.domHandler.getElementById("#"+p);if(ig.ua.mobile){var g=this.dynamicClickableEntityDivs[p].entity_pos_x,l=this.dynamicClickableEntityDivs[p].entity_pos_y,f=this.dynamicClickableEntityDivs[p].width,d=this.dynamicClickableEntityDivs[p].height;this.disableStretchToFitOnMobileFlag?(g=Math.floor(b+g*this.scaleRatioMultiplier.x)+"px",l=Math.floor(c+l*this.scaleRatioMultiplier.y)+"px",f=Math.floor(f*this.scaleRatioMultiplier.x)+"px",d=Math.floor(d*this.scaleRatioMultiplier.y)+"px"):(g=Math.floor(g*this.sizeRatio.x)+
"px",l=Math.floor(l*this.sizeRatio.y)+"px",f=Math.floor(f*this.sizeRatio.x)+"px",d=Math.floor(d*this.sizeRatio.y)+"px")}else g=this.dynamicClickableEntityDivs[p].entity_pos_x,l=this.dynamicClickableEntityDivs[p].entity_pos_y,f=this.dynamicClickableEntityDivs[p].width,d=this.dynamicClickableEntityDivs[p].height,this.enableStretchToFitOnDesktopFlag?(g=Math.floor(g*this.sizeRatio.x)+"px",l=Math.floor(l*this.sizeRatio.y)+"px",f=Math.floor(f*this.sizeRatio.x)+"px",d=Math.floor(d*this.sizeRatio.y)+"px"):
(g=Math.floor(b+g*this.scaleRatioMultiplier.x)+"px",l=Math.floor(c+l*this.scaleRatioMultiplier.y)+"px",f=Math.floor(f*this.scaleRatioMultiplier.x)+"px",d=Math.floor(d*this.scaleRatioMultiplier.y)+"px");ig.domHandler.css(e,{"float":"left",position:"absolute",left:g,top:l,width:f,height:d,"z-index":3});this.dynamicClickableEntityDivs[p]["font-size"]&&ig.domHandler.css(e,{"font-size":this.dynamicClickableEntityDivs[p]["font-size"]*j+"px"})}$("#ajaxbar").width(this.windowSize.x);$("#ajaxbar").height(this.windowSize.y)},
resize:function(){this.sizeCalcs();this.resizeLayers()},reorient:function(){console.log("changing orientation ...");if(ig.ua.mobile){var b=!1,b=this.portraitMode?window.innerHeight<window.innerWidth:window.innerHeight>window.innerWidth,c=this.domHandler.getElementById("#orientate"),e=this.domHandler.getElementById("#game");if(b){if(this.domHandler.show(c),this.domHandler.hide(e),console.log("portrait"+window.innerWidth+","+window.innerHeight),null!==ig.visibilityHandler&&"undefined"!==typeof ig.visibilityHandler&&
null!==ig.visibilityHandler.onOverlayShow&&"function"===typeof ig.visibilityHandler.onOverlayShow)if(1<=c.length)ig.visibilityHandler.onOverlayShow(c[0]);else ig.visibilityHandler.onOverlayShow("orientate")}else if(this.domHandler.show(e),this.domHandler.hide(c),console.log("landscape"+window.innerWidth+","+window.innerHeight),null!==ig.visibilityHandler&&"undefined"!==typeof ig.visibilityHandler&&null!==ig.visibilityHandler.onOverlayHide&&"function"===typeof ig.visibilityHandler.onOverlayHide)if(1<=
c.length)ig.visibilityHandler.onOverlayHide(c[0]);else ig.visibilityHandler.onOverlayHide("orientate")}ig.ua.mobile?(this.resize(),this.resizeAds(),"undefined"!==typeof wgl&&null!=wgl&&"function"===typeof wgl.system.engine.setSize&&wgl.system.engine.setSize(this.mobile.actualResolution.x,this.mobile.actualResolution.y)):(this.resize(),"undefined"!==typeof wgl&&null!=wgl&&"function"===typeof wgl.system.engine.setSize&&wgl.system.engine.setSize(this.desktop.actualResolution.x,this.desktop.actualResolution.y))},
resizeAds:function(){for(var b in this.adsToResize){var c=ig.domHandler.getElementById("#"+b),e=ig.domHandler.getElementById("#"+b+"-Box"),d=(window.innerWidth-this.adsToResize[b]["box-width"]>>1)+"px",j=(window.innerHeight-this.adsToResize[b]["box-height"]>>1)+"px";c&&ig.domHandler.css(c,{width:window.innerWidth,height:window.innerHeight});e&&ig.domHandler.css(e,{left:d,top:j})}},samsungFix:function(){ig.ua.android&&(!(4.2>parseFloat(navigator.userAgent.slice(navigator.userAgent.indexOf("Android")+
8,navigator.userAgent.indexOf("Android")+11)))&&!(0>navigator.userAgent.indexOf("GT"))&&!(0<navigator.userAgent.indexOf("Chrome"))&&!(0<navigator.userAgent.indexOf("Firefox")))&&(document.addEventListener("touchstart",function(b){b.preventDefault();return!1},!1),document.addEventListener("touchmove",function(b){b.preventDefault();return!1},!1),document.addEventListener("touchend",function(b){b.preventDefault();return!1},!1))},orientationInterval:null,orientationTimeout:null,orientationHandler:function(){this.reorient();
window.scrollTo(0,1)},orientationDelayHandler:function(){null==this.orientationInterval&&(this.orientationInterval=window.setInterval(this.orientationHandler.bind(this),100));null==this.orientationTimeout&&(this.orientationTimeout=window.setTimeout(function(){this.clearAllIntervals()}.bind(this),2E3))},clearAllIntervals:function(){window.clearInterval(this.orientationInterval);this.orientationInterval=null;window.clearTimeout(this.orientationTimeout);this.orientationTimeout=null},eventListenerSetup:function(){ig.isXiaomiBrowser=
/XiaoMi/i.test(navigator.userAgent)||/MiuiBrowser/i.test(navigator.userAgent)||/Mint/i.test(navigator.userAgent);ig.ua.iOS||ig.isXiaomiBrowser?(window.addEventListener("orientationchange",this.orientationDelayHandler.bind(this)),window.addEventListener("resize",this.orientationDelayHandler.bind(this))):(window.addEventListener("orientationchange",this.orientationHandler.bind(this)),window.addEventListener("resize",this.orientationHandler.bind(this)));document.addEventListener("touchmove",function(b){window.scrollTo(0,
1);b.preventDefault()},{passive:!1});this.chromePullDownRefreshFix()},chromePullDownRefreshFix:function(){var b=window.chrome||navigator.userAgent.match("CriOS"),c="ontouchstart"in document.documentElement;if(b&&c){var e=b=!1,d=0,j=!1;try{CSS.supports("overscroll-behavior-y","contain")&&(b=!0)}catch(g){}try{if(b)return document.body.style.overscrollBehaviorY="contain"}catch(p){}b=document.head||document.body;c=document.createElement("style");c.type="text/css";c.styleSheet?c.styleSheet.cssText="\n      ::-webkit-scrollbar {\n        width: 500x;\n      }\n      ::-webkit-scrollbar-thumb {\n        border-radius: 500px;\n        background-color: rgba(0, 0, 0, 0.2);\n      }\n      body {\n        -webkit-overflow-scrolling: auto!important;\n      }\n    ":
c.appendChild(document.createTextNode("\n      ::-webkit-scrollbar {\n        width: 500px;\n      }\n      ::-webkit-scrollbar-thumb {\n        border-radius: 500px;\n        background-color: rgba(0, 0, 0, 0.2);\n      }\n      body {\n        -webkit-overflow-scrolling: auto!important;\n      }\n    "));b.appendChild(c);try{addEventListener("test",null,{get passive(){e=!0}})}catch(l){}document.addEventListener("touchstart",function(b){1===b.touches.length&&(d=b.touches[0].clientY,j=0===window.pageYOffset)},
!!e&&{passive:!0});document.addEventListener("touchmove",function(b){var c;if(c=j){j=!1;c=b.touches[0].clientY;var e=c-d;c=(d=c,0<e)}if(c)return b.preventDefault()},!!e&&{passive:!1})}}})});ig.baked=!0;
ig.module("plugins.handlers.api-handler").defines(function(){ig.ApiHandler=ig.Class.extend({apiAvailable:{MJSPreroll:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS&&_SETTINGS.Ad.Mobile.Preroll.Enabled&&MobileAdInGamePreroll.Initialize()},MJSHeader:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS.Ad.Mobile.Header.Enabled&&MobileAdInGameHeader.Initialize()},MJSFooter:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS.Ad.Mobile.Footer.Enabled&&MobileAdInGameFooter.Initialize()},
MJSEnd:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS.Ad.Mobile.End.Enabled&&MobileAdInGameEnd.Initialize()}},run:function(b,c){if(this.apiAvailable[b])this.apiAvailable[b](c)}})});ig.baked=!0;
ig.module("plugins.audio.sound-player").defines(function(){SoundPlayer=ig.Class.extend({tagName:"SoundPlayer",stayMuteFlag:!1,debug:!1,init:function(){this.debug&&console.log(this.tagName)},play:function(b){this.debug&&console.log("play sound ",b)},stop:function(){this.debug&&console.log("stop sound ")},volume:function(){this.debug&&console.log("set volume")},mute:function(b){this.debug&&console.log("mute");"undefined"===typeof b?this.stayMuteFlag=!0:b&&(this.stayMuteFlag=!0)},unmute:function(b){this.debug&&
console.log("unmute");"undefined"===typeof b?this.stayMuteFlag=!1:b&&(this.stayMuteFlag=!1)}})});ig.baked=!0;
ig.module("plugins.audio.impact-music-player").requires("plugins.audio.sound-player").defines(function(){ImpactMusicPlayer=SoundPlayer.extend({tagName:"ImpactMusicPlayer",bgmPlaying:!1,soundList:{},init:function(b,c){this.parent(b,c);for(var e in b)this.soundList[e]=e,ig.music.add(b[e].path+".*",e);c&&c.loop&&(ig.music.loop=c.loop)},play:function(b){this.stayMuteFlag||(this.bgmPlaying=!0,"undefined"===typeof b?ig.music.play(b):ig.music.play())},stop:function(){this.bgmPlaying=!1;ig.music.pause()},
volume:function(b){console.log("impactmusic:",b);ig.music.volume=0>b?0:isNaN(b)?1:1<b?1:b},getVolume:function(){return ig.music.volume},mute:function(b){this.parent(b);this.bgmPlaying&&this.stop()},unmute:function(b){this.parent(b);this.play()}})});ig.baked=!0;
ig.module("plugins.audio.impact-sound-player").requires("plugins.audio.sound-player").defines(function(){ImpactSoundPlayer=SoundPlayer.extend({tagName:"ImpactSoundPlayer",soundList:{},init:function(b,c){this.parent(b,c);for(var e in b){var d=new ig.Sound(b[e].path+".*");this.soundList[e]=d}},play:function(b){this.stayMuteFlag||("object"===typeof b?(console.log(b+" exists"),b.play()):"string"===typeof b&&this.soundList[b].play())},stop:function(b){this.parent(b);b.stop()},volume:function(b){ig.soundManager.volume=
0>b?0:isNaN(b)?1:1<b?1:b},getVolume:function(){return ig.soundManager.volume},mute:function(b){this.parent(b);ig.Sound.enabled=!1},unmute:function(b){this.parent(b);ig.Sound.enabled=!0}})});ig.baked=!0;
ig.module("plugins.audio.howler-player").requires("plugins.audio.sound-player").defines(function(){HowlerPlayer=SoundPlayer.extend({tagName:"HowlerPlayer",soundList:{},init:function(b,c){this.parent(b,c);for(var e in b){var d=b[e].path,d=new Howl({src:[d+"."+ig.Sound.FORMAT.OGG.ext,d+"."+ig.Sound.FORMAT.MP3.ext]});this.soundList[e]=d}},play:function(b){if(Howler.ctx&&"running"!==Howler.ctx.state)return Howler.ctx.resume();this.stayMuteFlag||("object"===typeof b?b.play():"string"===typeof b&&this.soundList[b].play())},
stop:function(b){this.parent(b);"object"===typeof b?b.stop():"string"===typeof b&&this.soundList[b].stop()},volume:function(b){for(var c in this.soundList){if(0>b){this.soundList[c].volume(0);break}isNaN(b)?this.soundList[c].volume(1):1<b?this.soundList[c].volume(1):this.soundList[c].volume(b)}},getVolume:function(){for(var b in this.soundList)return this.soundList[b].volume()},mute:function(b){this.parent(b);Howler.mute(!0)},unmute:function(b){this.parent(b);Howler.mute(!1)}})});ig.baked=!0;
ig.module("plugins.audio.howler-music-player").requires("plugins.audio.sound-player").defines(function(){HowlerMusicPlayer=SoundPlayer.extend({tagName:"HowlerMusicPlayer",bgmPlaying:!1,soundList:{},init:function(b,c){this.parent(b,c);for(var e in b){var d=b[e].path,d=new Howl({src:[d+"."+ig.Sound.FORMAT.OGG.ext,d+"."+ig.Sound.FORMAT.MP3.ext],loop:!0,autoplay:!1,onend:function(){}.bind(this)});this.soundList[e]=d}},play:function(b){if(!this.stayMuteFlag&&!this.bgmPlaying)if("object"===typeof b)this.bgmPlaying=
!0,b.play();else if("string"===typeof b)this.bgmPlaying=!0,this.soundList[b].play();else for(var c in this.soundList){this.soundList[c].play();this.bgmPlaying=!0;break}},stop:function(b){this.parent(b);if(this.bgmPlaying){for(var c in this.soundList)this.soundList[c].stop();this.bgmPlaying=!1}},volume:function(b){for(var c in this.soundList){if(0>b){this.soundList[c].volume(0);break}isNaN(b)?this.soundList[c].volume(1):1<b?this.soundList[c].volume(1):this.soundList[c].volume(b)}},getVolume:function(){for(var b in this.soundList)return this.soundList[b].volume()},
mute:function(b){this.parent(b);Howler.mute(!0)},unmute:function(b){this.parent(b);Howler.mute(!1)}})});ig.baked=!0;
ig.module("plugins.audio.jukebox-player").requires("plugins.audio.sound-player").defines(function(){JukeboxPlayer=SoundPlayer.extend({tagName:"JukeboxPlayer",bgmPlaying:!1,soundList:{},jukeboxPlayer:null,pausePosition:0,premuteVolume:0,minVolume:0.001,init:function(b,c){this.parent(b,c);for(var e in b){this.soundList[e]=e;var d=b[e].path;this.jukeboxPlayer=new jukebox.Player({resources:[d+"."+ig.Sound.FORMAT.OGG.ext,d+"."+ig.Sound.FORMAT.MP3.ext],autoplay:!1,spritemap:{music:{start:b[e].startMp3,
end:b[e].endMp3,loop:!0}}})}},play:function(){this.stayMuteFlag||(this.bgmPlaying=!0,this.pausePosition?(console.log("resume"),this.jukeboxPlayer.resume(this.pausePosition)):(console.log("play"),this.jukeboxPlayer.play(this.jukeboxPlayer.settings.spritemap.music.start,!0)),this.premuteVolume=this.getVolume())},stop:function(){this.bgmPlaying=!1;this.pausePosition=this.jukeboxPlayer.pause()},volume:function(b){console.log("jukebox:",b);0>=b?this.jukeboxPlayer.setVolume(this.minVolume):isNaN(b)?this.jukeboxPlayer.setVolume(1):
1<b?this.jukeboxPlayer.setVolume(1):this.jukeboxPlayer.setVolume(b)},getVolume:function(){return this.jukeboxPlayer.getVolume()},mute:function(b){this.parent(b);this.bgmPlaying&&(console.log("jukebox",this.premuteVolume),this.stayMuteFlag||(this.premuteVolume=this.getVolume()),this.jukeboxPlayer.pause(),this.jukeboxPlayer.setVolume(this.minVolume))},unmute:function(b){this.parent(b);this.stayMuteFlag||(console.log("jukebox",this.premuteVolume),this.jukeboxPlayer.setVolume(this.premuteVolume),this.jukeboxPlayer.resume())}})});
ig.baked=!0;
ig.module("plugins.audio.webaudio-music-player").requires("plugins.audio.sound-player").defines(function(){WebaudioMusicPlayer=SoundPlayer.extend({tagName:"WebaudioMusicPlayer",bgmPlaying:!1,isSupported:!1,muteFlag:!1,pausedTime:0,webaudio:null,useHTML5Audio:!1,audio:null,inactiveAudio:null,codecs:null,reinitOnPlay:!1,inputList:null,_volume:1,soundList:{},init:function(b){this.webaudio={compatibility:{},gainNode:null,buffer:null,source_loop:{},source_once:{}};try{Howler&&Howler.ctx?this.webaudio.context=Howler.ctx:
ig&&ig.webaudio_ctx?this.webaudio.context=ig.webaudio_ctx:(this.AudioContext=window.AudioContext||window.webkitAudioContext,this.webaudio.context=new this.AudioContext,ig.webaudio_ctx=this.webaudio.context),this.isSupported=!0}catch(c){console.log("Web Audio API not supported in this browser."),this.webaudio=null,this.useHTML5Audio=!0}if(this.useHTML5Audio)if("undefined"!==typeof Audio)try{new Audio}catch(e){this.useHTML5Audio=!1}else this.useHTML5Audio=!1;this.useHTML5Audio&&(this.audio=new Audio,
this.isSupported=!0,this.initHTML5Audio(b));if(!this.isSupported)return null;this.webaudio&&(this.inputList=b,this.initWebAudio(b))},initWebAudio:function(b){ig.ua.iOS&&this.initIOSWebAudioUnlock();this.webaudio.gainNode=this.webaudio.context.createGain();this.webaudio.gainNode.connect(this.webaudio.context.destination);this.webaudio.gainNode.gain.value=this._volume;this.webaudio.buffer=null;var c="start",e="stop",d=this.webaudio.context.createBufferSource();"function"!==typeof d.start&&(c="noteOn");
this.webaudio.compatibility.start=c;"function"!==typeof d.stop&&(e="noteOff");this.webaudio.compatibility.stop=e;for(var j in b){this.soundList[j]=j;var e=b[j].path,c=e+"."+ig.Sound.FORMAT.MP3.ext,g=e+"."+ig.Sound.FORMAT.OGG.ext;ig.ua.mobile?ig.ua.iOS&&(g=c):(e=navigator.userAgent.toLowerCase(),-1!=e.indexOf("safari")&&-1>=e.indexOf("chrome")&&(g=c),e.indexOf("win64")&&(g=c));var p=new XMLHttpRequest;p.open("GET",g,!0);p.responseType="arraybuffer";p.onload=function(){this.webaudio.context.decodeAudioData(p.response,
function(b){this.webaudio.buffer=b;this.webaudio.source_loop={};this.bgmPlaying?this.play(null,!0):this.stop()}.bind(this),function(){console.log('Error decoding audio "'+g+'".')})}.bind(this);p.send();if(4==p.readyState&&"undefined"!==typeof Audio){this.useHTML5Audio=!0;try{new Audio}catch(l){this.useHTML5Audio=!1}this.useHTML5Audio&&(console.log("Using HTML5 Audio"),this.webaudio=null,this.audio=new Audio,this.isSupported=!0,this.initHTML5Audio(b))}break}},initIOSWebAudioUnlock:function(){if(this.webaudio){webaudio=
this.webaudio;var b=function(){var c=webaudio.context,e=c.createBuffer(1,1,22050),d=c.createBufferSource();d.buffer=e;d.connect(c.destination);"undefined"===typeof d.start?d.noteOn(0):d.start(0);setTimeout(function(){(d.playbackState===d.PLAYING_STATE||d.playbackState===d.FINISHED_STATE)&&window.removeEventListener("touchend",b,!1)}.bind(this),0)};window.addEventListener("touchend",b,!1)}},initHTML5Audio:function(b){if(this.useHTML5Audio&&this.audio){var c=this.audio;this.codecs={};this.codecs={mp3:!!c.canPlayType("audio/mpeg;").replace(/^no$/,
""),opus:!!c.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!c.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!c.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!c.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(c.canPlayType("audio/x-m4a;")||c.canPlayType("audio/m4a;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(c.canPlayType("audio/x-mp4;")||c.canPlayType("audio/mp4;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!c.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,
"")};this.is={ff:Boolean(null!=window.mozInnerScreenX&&/firefox/.test(navigator.userAgent.toLowerCase())),ie:Boolean(document.all&&!window.opera),opera:Boolean(window.opera),chrome:Boolean(window.chrome),safari:Boolean(!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase())&&window.getComputedStyle&&!window.globalStorage&&!window.opera)};this.playDelay=-60;this.stopDelay=30;this.is.chrome&&(this.playDelay=-25);this.is.chrome&&(this.stopDelay=25);this.is.ff&&(this.playDelay=-25);this.is.ff&&
(this.stopDelay=85);this.is.opera&&(this.playDelay=5);this.is.opera&&(this.stopDelay=0);for(var e in b){this.soundList[e]=e;var d=b[e].path,c=d+"."+ig.Sound.FORMAT.OGG.ext,d=d+"."+ig.Sound.FORMAT.MP3.ext,j=null;this.codecs[ig.Sound.FORMAT.OGG.ext.toLowerCase()]?j=c:this.codecs[ig.Sound.FORMAT.MP3.ext.toLowerCase()]&&(j=d);if(j){ig.ua.mobile?ig.ua.iOS&&(j=d):(b=navigator.userAgent.toLowerCase(),-1!=b.indexOf("safari")&&-1>=b.indexOf("chrome")&&(j=d));this.audio.addEventListener("error",function(){this.audio.error&&
4===this.audio.error.code&&(this.isSupported=!1)},!1);this.audio.src=j;this.audio._pos=0;this.audio.preload="auto";this.audio.volume=this._volume;this.inactiveAudio=new Audio;this.inactiveAudio.src=j;this.inactiveAudio._pos=0;this.inactiveAudio.preload="auto";this.inactiveAudio.volume=this._volume;this.inactiveAudio.load();var g=function(){this._duration=this.audio.duration;this._loaded||(this._loaded=!0);this.bgmPlaying?this.play(null,!0):this.stop();this.audio.removeEventListener("canplaythrough",
g,!1)}.bind(this);this.audio.addEventListener("canplaythrough",g,!1);this.audio.load();break}}}},play:function(b,c){if(this.isSupported)if(this.bgmPlaying=!0,this.webaudio){if(!c&&this.reinitOnPlay&&this.webaudio.source_loop.buffer==this.webaudio.buffer){if(this.webaudio.source_loop._playing&&(this.webaudio.source_loop[this.webaudio.compatibility.stop](0),this.webaudio.source_loop._playing=!1,this.pausedTime+=this.webaudio.context.currentTime-this.webaudio.source_loop._startTime,this.pausedTime%=
this.webaudio.source_loop.buffer.duration,this.webaudio.source_loop._startTime=0,"noteOn"===this.webaudio.compatibility.start))this.webaudio.source_once[this.webaudio.compatibility.stop](0);try{this.webaudio.context.close();this.webaudio.context=new this.AudioContext;this.webaudio.gainNode=this.webaudio.context.createGain();this.webaudio.gainNode.connect(this.webaudio.context.destination);this.webaudio.gainNode.gain.value=this._volume;var e="start",d="stop",j=this.webaudio.context.createBufferSource();
"function"!==typeof j.start&&(e="noteOn");this.webaudio.compatibility.start=e;"function"!==typeof j.stop&&(d="noteOff");this.webaudio.compatibility.stop=d;this.webaudio.source_loop={};this.play(null,!0)}catch(g){}}if(this.webaudio.buffer){if(!this.muteFlag&&(this.bgmPlaying=!0,!this.webaudio.source_loop._playing)){this.webaudio.source_loop=this.webaudio.context.createBufferSource();this.webaudio.source_loop.buffer=this.webaudio.buffer;this.webaudio.source_loop.loop=!0;this.webaudio.source_loop.connect(this.webaudio.gainNode);
if(null==b||isNaN(b))b=0,this.pausedTime&&(b=this.pausedTime);this.webaudio.source_loop._startTime=this.webaudio.context.currentTime;if("noteOn"===this.webaudio.compatibility.start)this.webaudio.source_once=this.webaudio.context.createBufferSource(),this.webaudio.source_once.buffer=this.webaudio.buffer,this.webaudio.source_once.connect(this.webaudio.gainNode),this.webaudio.source_once.noteGrainOn(0,b,this.webaudio.buffer.duration-b),this.webaudio.source_loop[this.webaudio.compatibility.start](this.webaudio.context.currentTime+
(this.webaudio.buffer.duration-b));else this.webaudio.source_loop[this.webaudio.compatibility.start](0,b);this.webaudio.source_loop._playing=!0}}else this.bgmPlaying=!0}else if(this.audio){var p=this.audio;if(!this.muteFlag)if(this.bgmPlaying=!0,isNaN(b)&&(b=0,this.pausedTime&&(b=this.pausedTime)),e=this._duration-b,this._onEndTimer&&(clearTimeout(this._onEndTimer),this._onEndTimer=null),this._onEndTimer=setTimeout(function(){this.audio.currentTime=0;this.audio.pause();this.pausedTime=0;if(this.inactiveAudio){var b=
this.audio;this.audio=this.inactiveAudio;this.inactiveAudio=b}this.play()}.bind(this),1E3*e+this.playDelay),4===p.readyState||!p.readyState&&navigator.isCocoonJS)p.readyState=4,p.currentTime=b,p.muted=this.muteFlag||p.muted,p.volume=this._volume,setTimeout(function(){p.play()},0);else{clearTimeout(this._onEndTimer);this._onEndTimer=null;var l=function(){typeof("function"==this.play)&&(this.play(),p.removeEventListener("canplaythrough",l,!1))}.bind(this);p.addEventListener("canplaythrough",l,!1)}}},
stop:function(){this.bgmPlaying=!1;if(this.isSupported)if(this.webaudio){if(this.webaudio.source_loop._playing&&(this.webaudio.source_loop[this.webaudio.compatibility.stop](0),this.webaudio.source_loop._playing=!1,this.pausedTime+=this.webaudio.context.currentTime-this.webaudio.source_loop._startTime,this.pausedTime%=this.webaudio.source_loop.buffer.duration,this.webaudio.source_loop._startTime=0,"noteOn"===this.webaudio.compatibility.start))this.webaudio.source_once[this.webaudio.compatibility.stop](0)}else if(this.audio){var b=
this.audio;4==b.readyState&&(this.pausedTime=b.currentTime,b.currentTime=0,b.pause(),clearTimeout(this._onEndTimer),this._onEndTimer=null)}},volume:function(b){if(isNaN(b)||null==b)return this.getVolume();this.isSupported&&(this._volume=b,0>this._volume?this._volume=0:1<this._volume&&(this._volume=1),this.webaudio?this.webaudio.gainNode&&(this.webaudio.gainNode.gain.value=this._volume):this.audio&&(this.audio.volume=this._volume,this.inactiveAudio&&(this.inactiveAudio.volume=this._volume)))},getVolume:function(){return!this.isSupported?
0:this._volume},mute:function(b){this.parent(b);!1==this.muteFlag&&(this.muteFlag=!0,this.bgmPlaying&&(this.stop(),this.bgmPlaying=!0))},unmute:function(b){this.parent(b);!this.stayMuteFlag&&!0==this.muteFlag&&(this.muteFlag=!1,this.bgmPlaying&&this.play())}})});ig.baked=!0;
ig.module("plugins.audio.sound-info").defines(function(){SoundInfo=ig.Class.extend({FORMATS:{OGG:".ogg",MP3:".mp3"},sfx:{staticSound:{path:"media/audio/play/static"},logosplash1:{path:"media/audio/opening/logosplash1"},logosplash2:{path:"media/audio/opening/logosplash2"},button1:{path:"media/audio/button1"},gameover:{path:"media/audio/combo"},combo1:{path:"media/audio/combo1"},combo2:{path:"media/audio/combo2"},combo3:{path:"media/audio/combo3"},combo4:{path:"media/audio/combo4"},combo5:{path:"media/audio/combo5"}},
bgm:{background:{path:"media/audio/bgm",startOgg:0,endOgg:21.463,startMp3:0,endMp3:21.463}}})});ig.baked=!0;
ig.module("plugins.audio.sound-handler").requires("plugins.audio.impact-music-player","plugins.audio.impact-sound-player","plugins.audio.howler-player","plugins.audio.howler-music-player","plugins.audio.jukebox-player","plugins.audio.webaudio-music-player","plugins.audio.sound-info").defines(function(){ig.SoundHandler=ig.Class.extend({bgmPlayer:null,sfxPlayer:null,focusBlurMute:!1,soundInfo:new SoundInfo,init:function(){console.log("Initiating sound handler");this.sfxPlayer=new HowlerPlayer(this.soundInfo.sfx);
ig.ua.mobile?(this.initPowerButtonFix(),this.bgmPlayer=new WebaudioMusicPlayer(this.soundInfo.bgm,{loop:!0}),this.bgmPlayer.isSupported||(this.bgmPlayer=new JukeboxPlayer(this.soundInfo.bgm,{loop:!0}))):(this.bgmPlayer=new WebaudioMusicPlayer(this.soundInfo.bgm,{loop:!0}),this.bgmPlayer.isSupported||(this.bgmPlayer=new ImpactMusicPlayer(this.soundInfo.bgm,{loop:!0})))},unlockWebAudio:function(){Howler&&(Howler.ctx&&"running"!==Howler.ctx.state&&Howler.ctx.resume(),Howler._audioUnlocked||"function"===
typeof Howler._unlockAudio&&Howler._unlockAudio());ig&&ig.webaudio_ctx&&ig.webaudio_ctx.state&&"running"!==ig.webaudio_ctx.state&&ig.webaudio_ctx.resume();this.bgmPlayer.webaudio&&this.bgmPlayer.webaudio.context&&this.bgmPlayer.webaudio.context.state&&"running"!==this.bgmPlayer.webaudio.context.state&&this.bgmPlayer.webaudio.context.resume()},checkBGM:function(){return this.bgmPlayer.stayMuteFlag},checkSFX:function(){return this.sfxPlayer.stayMuteFlag},muteSFX:function(b){this.sfxPlayer&&this.sfxPlayer.mute(b)},
muteBGM:function(b){this.bgmPlayer&&this.bgmPlayer.mute(b)},unmuteSFX:function(b){this.sfxPlayer&&this.sfxPlayer.unmute(b)},unmuteBGM:function(b){this.bgmPlayer&&this.bgmPlayer.unmute(b)},muteAll:function(b){this.muteSFX(b);this.muteBGM(b)},unmuteAll:function(b){this.unlockWebAudio();this.unmuteSFX(b);this.unmuteBGM(b)},forceMuteAll:function(){this.focusBlurMute||this.muteAll(!1);this.focusBlurMute=!0},forceUnMuteAll:function(){this.focusBlurMute&&(this.unmuteAll(!1),this.focusBlurMute=!1)},initWindowHandler:function(){"true"===
ig.domHandler.getQueryVariable("webview")?($(window).focus(function(){wgl.system&&wgl.system.startRender();ig.soundHandler&&ig.soundHandler.forceUnMuteAll()}),$(window).blur(function(){wgl.system&&wgl.system.stopRender();ig.soundHandler&&ig.soundHandler.forceMuteAll()})):(window.onfocus=function(){wgl.system&&wgl.system.startRender();ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},window.onblur=function(){wgl.system&&wgl.system.stopRender();ig.soundHandler&&ig.soundHandler.forceMuteAll()})},initPowerButtonFix:function(){var b=
this.getHiddenProp();b&&(b=b.replace(/[H|h]idden/,"")+"visibilitychange",document.addEventListener(b,this.visChange));window.addEventListener("pagehide",function(){ig.soundHandler&&ig.soundHandler.forceMuteAll()},!1);window.addEventListener("pageshow",function(){ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},!1)},getHiddenProp:function(){var b=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var c=0;c<b.length;c++)if(b[c]+"Hidden"in document)return b[c]+"Hidden";return null},
isHidden:function(){var b=this.getHiddenProp();return!b?!1:document[b]},visChange:function(){ig.soundHandler.isHidden()?ig.soundHandler&&ig.soundHandler.forceMuteAll():ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},saveVolume:function(){this.sfxPlayer&&ig.game.io.storageSet("soundVolume",this.sfxPlayer.getVolume());this.bgmPlayer&&ig.game.io.storageSet("musicVolume",this.bgmPlayer.getVolume())},forceLoopBGM:function(){var b;if(!this.focusBlurMute&&this.bgmPlayer.bgmPlaying&&this.bgmPlayer){var c=
this.bgmPlayer.jukeboxPlayer;if(c){null!=window.mozInnerScreenX&&/firefox/.test(navigator.userAgent.toLowerCase());b=Boolean(window.chrome);!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase());var e=0.1;ig.ua.mobile&&(e=0.115,ig.ua.android&&(e=0.45,b&&(e=0.3)));c.settings.spritemap.music&&(b=c.settings.spritemap.music.end-e,c.getCurrentTime()>=b&&(b=c.settings.spritemap.music.start,ig.ua.android?this.forcelooped||(c.play(b,!0),this.forcelooped=!0,setTimeout(function(){ig.soundHandler.forcelooped=
!1},e)):c.setCurrentTime(b)))}else"ImpactMusicPlayer"==this.bgmPlayer.tagName&&(null!=window.mozInnerScreenX&&/firefox/.test(navigator.userAgent.toLowerCase()),b=Boolean(window.chrome),!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase()),e=0.1,ig.ua.mobile&&(e=0.115,ig.ua.android&&(e=0.45,b&&(e=0.3))),c=0,"mp3"==ig.soundManager.format.ext&&(c=0.05),ig.music.currentTrack&&(b=ig.music.currentTrack.duration-e,ig.music.currentTrack.currentTime>=b&&(ig.ua.android?this.forcelooped||(ig.music.currentTrack.pause(),
ig.music.currentTrack.currentTime=c,ig.music.currentTrack.play(),this.forcelooped=!0,setTimeout(function(){ig.soundHandler.forcelooped=!1},e)):ig.music.currentTrack.currentTime=c)))}}})});ig.baked=!0;
ig.module("plugins.handlers.visibility-handler").requires("plugins.audio.sound-handler").defines(function(){ig.VisibilityHandler=ig.Class.extend({version:"1.2.1",config:{muteOnBlur:!0,pauseOnBlur:!0,clearInputStateOnBlur:!0,allowResumeWithoutFocus:{desktop:!0,mobile:{kaios:!1,"default":!0}},handlerDelay:{desktop:0,mobile:{kaios:0,"default":0}},autoFocusOnResume:{desktop:!0,mobile:{kaios:!1,"default":!0}},autoFocusAfterResume:{desktop:!0,mobile:{kaios:!1,"default":!0}}},browserPrefixes:["o","ms","moz",
"webkit"],activeOverlays:[],browserPrefix:null,hiddenPropertyName:null,visibilityEventName:null,visibilityStateName:null,isShowingOverlay:!1,isFocused:!1,isPaused:!1,init:function(){this.initVisibilityHandler();this.initFocusHandler();this.initPageTransitionHandler();ig.visibilityHandler=this},pauseHandler:function(){!0===this.config.clearInputStateOnBlur&&"undefined"!==typeof ig.input&&null!==ig.input&&"function"===typeof ig.input.clearAllState&&ig.input.clearAllState();!0===this.config.pauseOnBlur&&
("undefined"!==typeof wgl&&null!==wgl&&null!==wgl.system&&"undefined"!==typeof wgl.system&&"function"===typeof wgl.system.stopRender&&wgl.system.stopRender(),"undefined"!==typeof ig.game&&null!==ig.game&&"undefined"!==typeof ig.game.pauseGame&&ig.game.pauseGame());!0===this.config.muteOnBlur&&"undefined"!==typeof ig.soundHandler&&null!==ig.soundHandler&&"function"===typeof ig.soundHandler.forceMuteAll&&ig.soundHandler.forceMuteAll()},resumeHandler:function(){"undefined"!==typeof ig.input&&null!==
ig.input&&"function"===typeof ig.input.clearAllState&&ig.input.clearAllState();"undefined"!==typeof ig.game&&null!==ig.game&&("undefined"!==typeof ig.game.resumeGame&&ig.game.resumeGame(),"undefined"!==typeof wgl&&null!==wgl&&null!==wgl.system&&"undefined"!==typeof wgl.system&&"function"===typeof wgl.system.startRender&&wgl.system.startRender());"undefined"!==typeof ig.soundHandler&&null!==ig.soundHandler&&"function"===typeof ig.soundHandler.forceUnMuteAll&&ig.soundHandler.forceUnMuteAll()},initVisibilityHandler:function(){this.browserPrefix=
this.getBrowserPrefix();this.hiddenPropertyName=this.getHiddenPropertyName(this.browserPrefix);this.visibilityEventName=this.getVisibilityEventName(this.browserPrefix);this.visibilityStateName=this.getVisibilityStateName(this.browserPrefix);this.visibilityEventName&&document.addEventListener(this.visibilityEventName,this.onChange.bind(this),!0)},initFocusHandler:function(){window.addEventListener("blur",this.onChange.bind(this),!0);document.addEventListener("blur",this.onChange.bind(this),!0);document.addEventListener("focusout",
this.onChange.bind(this),!0);window.addEventListener("focus",this.onChange.bind(this),!0);document.addEventListener("focus",this.onChange.bind(this),!0);document.addEventListener("focusin",this.onChange.bind(this),!0)},initPageTransitionHandler:function(){window.addEventListener("pagehide",this.onChange.bind(this),!0);window.addEventListener("pageshow",this.onChange.bind(this),!0)},getBrowserPrefix:function(){var b=null;this.browserPrefixes.forEach(function(c){if(this.getHiddenPropertyName(c)in document)return b=
c}.bind(this));return b},getHiddenPropertyName:function(b){return b?b+"Hidden":"hidden"},getVisibilityEventName:function(b){return(b?b:"")+"visibilitychange"},getVisibilityStateName:function(b){return b?b+"VisibilityState":"visibilityState"},hasView:function(){return!(document[this.hiddenPropertyName]||"visible"!==document[this.visibilityStateName])},hasFocus:function(){return document.hasFocus()||this.isFocused},addActiveOverlay:function(b){if(null===this.activeOverlays||"undefined"===typeof this.activeOverlays)this.activeOverlays=
[];null===b||"undefined"===typeof b||!0!==this.activeOverlays.includes(b)&&this.activeOverlays.push(b)},removeActiveOverlay:function(b){if(null===this.activeOverlays||"undefined"===typeof this.activeOverlays)this.activeOverlays=[];0>=this.activeOverlays.length||null===b||"undefined"===typeof b||!0===this.activeOverlays.includes(b)&&this.activeOverlays.splice(this.activeOverlays.indexOf(b),1)},onOverlayShow:function(b){null!==b&&"undefined"!==typeof b&&this.addActiveOverlay(b);0<this.activeOverlays.length&&
(this.systemPaused(),this.isShowingOverlay=!0)},onOverlayHide:function(b){null!==b&&"undefined"!==typeof b&&this.removeActiveOverlay(b);0>=this.activeOverlays.length&&(this.isShowingOverlay=!1,this.systemResumed())},systemPaused:function(){if(this.isPaused)return!1;this.pauseHandler();return this.isPaused=!0},systemResumed:function(){if(!this.isPaused||!this.hasView()||this.isShowingOverlay)return!1;if(!this.hasFocus())if(ig.ua.mobile)if(this.isKaiOS()){if(!this.config.allowResumeWithoutFocus.mobile.kaios)return!1}else{if(!this.config.allowResumeWithoutFocus.mobile.default)return!1}else if(!this.config.allowResumeWithoutFocus.desktop)return!1;
this.focusOnResume();this.resumeHandler();this.focusAfterResume();this.isPaused=!1;return!0},isKaiOS:function(){return/KAIOS/.test(navigator.userAgent)||!1},focusOnResume:function(){var b=!1;return b=ig.ua.mobile?this.isKaiOS()?this.config.autoFocusOnResume.mobile.kaios:this.config.autoFocusOnResume.mobile.default:this.config.autoFocusOnResume.desktop},focusAfterResume:function(){var b=!1;return b=ig.ua.mobile?this.isKaiOS()?this.config.autoFocusAfterResume.mobile.kaios:this.config.autoFocusAfterResume.mobile.default:
this.config.autoFocusAfterResume.desktop},focus:function(b){window.focus&&b&&(document.activeElement&&"function"===typeof document.activeElement.blur&&document.activeElement.blur(),window.focus())},handleDelayedEvent:function(b){if(!this.hasView()||"pause"===b.type||"pageHide"===b.type||"blur"===b.type||"focusout"===b.type){if("blur"===b.type||"focusout"===b.type){var c=b.path||b.composedPath&&b.composedPath();if(c&&2<c.length||b.srcElement&&("INPUT"===b.srcElement.tagName||"TEXTAREA"===b.srcElement.tagName))return!1;
this.isFocused=!1}return this.systemPaused(b)}if("focus"===b.type||"focusin"===b.type)this.isFocused=!0;return this.systemResumed(b)},startDelayedEventHandler:function(b){ig.ua.mobile?this.isKaiOS()?0<this.config.handlerDelay.mobile.kaios?window.setTimeout(function(b){this.handleDelayedEvent(b)}.bind(this,b),this.config.handlerDelay.mobile):this.handleDelayedEvent(b):0<this.config.handlerDelay.mobile.default?window.setTimeout(function(b){this.handleDelayedEvent(b)}.bind(this,b),this.config.handlerDelay.mobile):
this.handleDelayedEvent(b):0<this.config.handlerDelay.desktop?window.setTimeout(function(b){this.handleDelayedEvent(b)}.bind(this,b),this.config.handlerDelay.desktop):this.handleDelayedEvent(b)},onChange:function(b){this.startDelayedEventHandler(b)}})});ig.baked=!0;
ig.module("plugins.io.storage").defines(function(){ig.Storage=ig.Class.extend({staticInstantiate:function(){return!ig.Storage.instance?null:ig.Storage.instance},init:function(){ig.Storage.instance=this},isCapable:function(){return"undefined"!==typeof window.localStorage},isSet:function(b){return null!==this.get(b)},initUnset:function(b,c){null===this.get(b)&&this.set(b,c)},get:function(b){if(!this.isCapable())return null;try{return JSON.parse(localStorage.getItem(b))}catch(c){return window.localStorage.getItem(b)}},
getInt:function(b){return~~this.get(b)},getFloat:function(b){return parseFloat(this.get(b))},getBool:function(b){return!!this.get(b)},key:function(b){return this.isCapable()?window.localStorage.key(b):null},set:function(b,c){if(!this.isCapable())return null;try{window.localStorage.setItem(b,JSON.stringify(c))}catch(e){console.log(e)}},setHighest:function(b,c){c>this.getFloat(b)&&this.set(b,c)},remove:function(b){if(!this.isCapable())return null;window.localStorage.removeItem(b)},clear:function(){if(!this.isCapable())return null;
window.localStorage.clear()}})});ig.baked=!0;
ig.module("plugins.io.mouse").requires("plugins.data.vector").defines(function(){Mouse=ig.Class.extend({bindings:{click:[ig.KEY.MOUSE1]},pos:new BABYLON.Vector2.Zero,init:function(){ig.input.initMouse();for(var b in this.bindings){this[b]=b;for(var c=0;c<this.bindings[b].length;c++)ig.input.bind(this.bindings[b][c],b)}},getWglPos:function(){var b=ig.sizeHandler.mobile.actualResolution.x,c=ig.sizeHandler.mobile.actualResolution.y,e=wgl.system.engine.getRenderWidth(),d=wgl.system.engine.getRenderHeight(),
b=e/b,c=d/c,d=ig.game.io.getClickPos();ig.ua.mobile?(b=d.x*ig.sizeHandler.sizeRatio.x,c=d.y*ig.sizeHandler.sizeRatio.y):(b*=d.x,c*=d.y);return new BABYLON.Vector2(b,c)},getLast:function(){return this.pos},getPos:function(){var b=ig.system.scale*((ig.system.canvas.offsetWidth||ig.system.realWidth)/ig.system.realWidth);this.pos=new BABYLON.Vector2(ig.input.mouse.x*b/ig.sizeHandler.sizeRatio.x/ig.sizeHandler.scaleRatioMultiplier.x,ig.input.mouse.y*b/ig.sizeHandler.sizeRatio.y/ig.sizeHandler.scaleRatioMultiplier.y);
return this.pos.clone()}})});ig.baked=!0;
ig.module("plugins.io.keyboard").defines(function(){Keyboard=ig.Class.extend({bindings:{PREVENT_PAGE_SCROLLING_OVER_IFRAME:[ig.KEY.UP_ARROW,ig.KEY.DOWN_ARROW,ig.KEY.LEFT_ARROW,ig.KEY.RIGHT_ARROW,ig.KEY.PAGE_UP,ig.KEY.PAGE_DOWN],up:[ig.KEY.W,ig.KEY.UP_ARROW],right:[ig.KEY.D,ig.KEY.RIGHT_ARROW],left:[ig.KEY.A,ig.KEY.LEFT_ARROW],down:[ig.KEY.S,ig.KEY.DOWN_ARROW,ig.KEY.SPACE]},init:function(){for(var b in this.bindings){this[b]=b;for(var c=0;c<this.bindings[b].length;c++)ig.input.bind(this.bindings[b][c],b)}}})});
ig.baked=!0;
ig.module("plugins.io.gamepad-input").defines(function(){ig.PADKEY={BUTTON_0:0,PADBUTTON_1:1,BUTTON_2:2,BUTTON_3:3,BUTTON_LEFT_BUMPER:4,BUTTON_RIGHT_BUMPER:5,BUTTON_LEFT_TRIGGER:6,BUTTON_RIGHT_TRIGGER:7,BUTTON_LEFT_JOYSTICK:10,BUTTON_RIGHT_JOYSTICK:11,BUTTON_DPAD_UP:12,BUTTON_DPAD_DOWN:13,BUTTON_DPAD_LEFT:14,BUTTON_DPAD_RIGHT:15,BUTTON_MENU:16,AXIS_LEFT_JOYSTICK_X:0,AXIS_LEFT_JOYSTICK_Y:1,AXIS_RIGHT_JOYSTICK_X:2,AXIS_RIGHT_JOYSTICK_Y:3};ig.GamepadInput=ig.Class.extend({isInit:!1,isSupported:!1,list:[],
bindings:{},states:{},presses:{},releases:{},downLocks:{},upLocks:{},leftStick:{x:0,y:0},rightStick:{x:0,y:0},start:function(){if(!this.isInit){this.isInit=!0;var b=navigator.getGamepads||navigator.webkitGetGamepads;b&&(!navigator.getGamepads&&navigator.webkitGetGamepads&&(navigator.getGamepads=navigator.webkitGetGamepads),this.list=navigator.getGamepads());this.isSupported=b}},isAvailable:function(){return this.isInit&&this.isSupported},buttonPressed:function(b){return"object"==typeof b?b.pressed:
1==b},buttonDown:function(b){if(b=this.bindings[b])this.states[b]=!0,this.downLocks[b]||(this.presses[b]=!0,this.downLocks[b]=!0)},buttonUp:function(b){if((b=this.bindings[b])&&this.downLocks[b]&&!this.upLocks[b])this.states[b]=!1,this.releases[b]=!0,this.upLocks[b]=!0},clearPressed:function(){for(var b in this.releases)this.states[b]=!1,this.downLocks[b]=!1;this.releases={};this.presses={};this.upLocks={}},bind:function(b,c){this.bindings[b]=c},unbind:function(b){this.releases[this.bindings[b]]=
!0;this.bindings[b]=null},unbindAll:function(){this.bindings={};this.states={};this.presses={};this.releases={};this.downLocks={};this.upLocks={}},state:function(b){return this.states[b]},pressed:function(b){return this.presses[b]},released:function(b){return this.releases[b]},clamp:function(b,c,e){return b<c?c:b>e?e:b},pollGamepads:function(){if(this.isSupported){this.leftStick.x=0;this.leftStick.y=0;this.rightStick.x=0;this.rightStick.y=0;this.list=navigator.getGamepads();for(var b in this.bindings){for(var c=
!1,e=0;e<this.list.length;e++){var d=this.list[e];if(d&&d.buttons&&this.buttonPressed(d.buttons[b])){c=!0;break}}c?this.buttonDown(b):this.buttonUp(b)}for(e=0;e<this.list.length;e++)if((d=this.list[e])&&d.axes){b=d.axes[ig.GAMEPADINPUT.AXIS_LEFT_JOYSTICK_X];var c=d.axes[ig.GAMEPADINPUT.AXIS_LEFT_JOYSTICK_Y],j=d.axes[ig.GAMEPADINPUT.AXIS_RIGHT_JOYSTICK_X],d=d.axes[ig.GAMEPADINPUT.AXIS_RIGHT_JOYSTICK_Y];this.leftStick.x+=isNaN(b)?0:b;this.leftStick.y+=isNaN(c)?0:c;this.rightStick.x+=isNaN(j)?0:j;this.rightStick.y+=
isNaN(d)?0:d}0<this.list.length&&(this.leftStick.x=this.clamp(this.leftStick.x,-1,1),this.leftStick.y=this.clamp(this.leftStick.y,-1,1),this.rightStick.x=this.clamp(this.rightStick.x,-1,1),this.rightStick.y=this.clamp(this.rightStick.y,-1,1))}}})});ig.baked=!0;
ig.module("plugins.io.gamepad").requires("plugins.io.gamepad-input").defines(function(){Gamepad=ig.Class.extend({bindings:{padJump:[ig.PADKEY.BUTTON_0]},init:function(){ig.gamepadInput.start();for(var b in this.bindings)for(var c=0;c<this.bindings[b].length;c++)ig.gamepadInput.bind(this.bindings[b][c],b)},press:function(){},held:function(){},release:function(){}})});ig.baked=!0;
ig.module("plugins.io.multitouch").defines(function(){Multitouch=ig.Class.extend({init:function(){ig.multitouchInput.start()},getTouchesPos:function(){if(ig.ua.mobile){if(0<ig.multitouchInput.touches.length){for(var b=[],c=0;c<ig.multitouchInput.touches.length;c++){var e=ig.multitouchInput.touches[c];b.push({x:e.x,y:e.y})}return b}return null}}})});ig.baked=!0;
ig.module("plugins.io.multitouch-input").defines(function(){ig.MultitouchInput=ig.Class.extend({isStart:!1,touches:{},pressed:[],state:[],released:[],multitouchCapable:!1,lastEventUp:null,internalWidth:1,internalHeight:1,scaleX:1,scaleY:1,start:function(){this.isStart||(this.isStart=!0,navigator.maxTouchPoints&&1<navigator.maxTouchPoints&&(this.multitouchCapable=!0),ig.ua.touchDevice&&(window.navigator.msPointerEnabled&&(ig.system.canvas.addEventListener("MSPointerDown",this.touchdown.bind(this),
!1),ig.system.canvas.addEventListener("MSPointerUp",this.touchup.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",this.touchmove.bind(this),!1),ig.system.canvas.style.msContentZooming="none",ig.system.canvas.style.msTouchAction="none"),ig.system.canvas.addEventListener("touchstart",this.touchdown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.touchup.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.touchmove.bind(this),!1)))},touchdown:function(b){if(ig.ua.touchDevice)if(this.updateSizeProperties(),
window.navigator.msPointerEnabled)this.windowKeyDown(b);else if(b.touches){this.pollMultitouch(b.touches.length);this.updateSizeProperties();var c={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(c=ig.system.canvas.getBoundingClientRect());for(var e=[],d=0;d<b.touches.length;d++)e.push(b.touches[d]);this.spliceFromArray(e,this.pressed);this.spliceFromArray(e,this.state);this.spliceFromArray(e,this.released);for(d=0;d<e.length;d++)b=e[d],this.pressed.push({identifier:b.identifier,x:(b.clientX-
c.left)/this.scaleX,y:(b.clientY-c.top)/this.scaleY})}},touchmove:function(b){if(ig.ua.touchDevice){this.updateSizeProperties();if(window.navigator.msPointerEnabled)this.windowMove(b);else if(b.touches){this.pollMultitouch(b.touches.length);for(var c=0;c<b.touches.length;c++){var e=b.touches[c];this.upgrade(this.pressed,this.state,e);this.updateArray(this.state,e)}}try{ig.soundHandler.unlockWebAudio()}catch(d){}}},touchup:function(b){if(ig.ua.touchDevice){this.updateSizeProperties();if(window.navigator.msPointerEnabled)this.windowKeyUp(b);
else if(this.lastEventUp=b,b.touches)for(var c=0;c<b.changedTouches.length;c++){var e=b.changedTouches[c];this.upgrade(this.state,this.released,e);this.upgrade(this.pressed,this.released,e)}if(ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(d){}}},windowKeyDown:function(b){b=b.changedTouches?b.changedTouches:[b];this.pollMultitouch(b.length);this.updateSizeProperties();for(var c=[],e=0;e<b.length;e++)c.push(b[e]);var d={left:0,top:0};ig.system.canvas.getBoundingClientRect&&
(d=ig.system.canvas.getBoundingClientRect());this.spliceFromArray(c,this.pressed);this.spliceFromArray(c,this.state);this.spliceFromArray(c,this.released);for(e=0;e<c.length;e++){var j=b[e];this.pressed.push({identifier:"undefined"!=typeof j.identifier?j.identifier:"undefined"!=typeof j.pointerId?j.pointerId:1,x:(j.clientX-d.left)/this.scaleX,y:(j.clientY-d.top)/this.scaleY})}},windowKeyUp:function(b){this.lastEventUp=b;b=b.changedTouches?b.changedTouches:[b];for(var c=0;c<b.length;c++){var e=b[c],
e={identifier:"undefined"!=typeof e.identifier?e.identifier:"undefined"!=typeof e.pointerId?e.pointerId:1,clientX:e.clientX,clientY:e.clientY};this.upgrade(this.state,this.released,e);this.upgrade(this.pressed,this.released,e)}if(ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(d){}},windowMove:function(b){b=b.changedTouches?b.changedTouches:[b];this.pollMultitouch(b.length);for(var c=0;c<b.length;c++){var e=b[c],e={identifier:e.pointerId,clientX:e.clientX,
clientY:e.clientY};this.upgrade(this.pressed,this.state,e);this.updateArray(this.state,e)}try{ig.soundHandler.unlockWebAudio()}catch(d){}},clear:function(){for(var b=0;b<this.released.length;++b)this.released[b]&&(this.released.splice(b,1),b--)},pollMultitouch:function(b){!this.multitouchCapable&&1<b&&(this.multitouchCapable=!0)},spliceFromArray:function(b,c){for(var e=0;e<c.length;e++)for(var d=0;d<b.length;d++)b[d].identifier===c[e].identifier&&(b.splice(d,1),d--)},updateSizeProperties:function(){var b=
parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth,c=parseInt(ig.system.canvas.offsetHeight)||ig.system.realHeight;this.scaleX=ig.system.scale*(b/ig.system.realWidth);this.scaleY=ig.system.scale*(c/ig.system.realHeight)},upgrade:function(b,c,e){var d={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(d=ig.system.canvas.getBoundingClientRect());for(var j=(e.clientX-d.left)/this.scaleX,d=(e.clientY-d.top)/this.scaleY,g=0;g<b.length;g++)if(void 0!==typeof b[g].identifier&&void 0!==typeof e.identifier&&
e.identifier===b[g].identifier){b.splice(g,1);c.push({identifier:e.identifier,x:j,y:d});break}},updateArray:function(b,c){var e={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());for(var d=(c.clientX-e.left)/this.scaleX,e=(c.clientY-e.top)/this.scaleY,j=0;j<b.length;j++)if(void 0!==typeof b[j].identifier&&void 0!==typeof c.identifier&&c.identifier===b[j].identifier){b[j].x=d;b[j].y=e;break}}})});ig.baked=!0;
ig.module("plugins.io.fake-storage").requires("impact.game").defines(function(){ig.FakeStorage=ig.Class.extend({tempData:{},init:function(){ig.FakeStorage.instance=this},initUnset:function(b,c){null===this.get(b)&&this.set(b,c)},set:function(b,c){this.tempData[b]=JSON.stringify(c)},setItem:function(b,c){this.tempData[b]=JSON.stringify(c)},setHighest:function(b,c){c>this.getFloat(b)&&this.set(b,c)},get:function(b){return"undefined"==typeof this.tempData[b]?null:JSON.parse(this.tempData[b])},getItem:function(b){return"undefined"==
typeof this.tempData[b]?null:JSON.parse(this.tempData[b])},getInt:function(b){return~~this.get(b)},getFloat:function(b){return parseFloat(this.get(b))},getBool:function(b){return!!this.get(b)},isSet:function(b){return null!==this.get(b)},remove:function(b){delete this.tempData[b]},removeItem:function(b){delete this.tempData[b]},clear:function(){this.tempData={}}})});ig.baked=!0;
ig.module("plugins.io.io-manager").requires("plugins.io.storage","plugins.io.mouse","plugins.io.keyboard","plugins.io.gamepad","plugins.io.multitouch","plugins.io.multitouch-input","plugins.io.gamepad-input","plugins.io.fake-storage").defines(function(){IoManager=ig.Class.extend({version:"1.0.0",storage:null,localStorageSupport:!1,mouse:null,keyboard:null,multitouch:null,gamepad:null,init:function(){ig.multitouchInput=new ig.MultitouchInput;ig.gamepadInput=new ig.GamepadInput;this.unbindAll();this.initStorage();
this.initMouse();this.initKeyboard()},unbindAll:function(){ig.input.unbindAll();ig.gamepadInput.unbindAll()},initStorage:function(){try{window.localStorage.setItem("test","test"),window.localStorage.removeItem("test"),this.storage=new ig.Storage}catch(b){console.log("using fake storage"),this.storage=new ig.FakeStorage}},initMouse:function(){this.mouse=new Mouse},initKeyboard:function(){this.keyboard=new Keyboard},initMultitouch:function(){this.multitouch=new Multitouch},initGamepad:function(){this.gamepad=
new Gamepad},press:function(b){return ig.input.pressed(b)||this.gamepad&&this.gamepad.press(b)?!0:!1},held:function(b){return ig.input.state(b)||this.gamepad&&this.gamepad.state(b)?!0:!1},release:function(b){return ig.input.released(b)||this.gamepad&&this.gamepad.released(b)?!0:!1},getClickPos:function(){return this.mouse.getPos()},getLastClickPos:function(){return this.mouse.getLast()},getTouchesPos:function(){return this.multitouch.getTouchesPos()},checkOverlap:function(b,c,e,d,j){return b.x>c+
d||b.x<c||b.y>e+j||b.y<e?!1:!0},clear:function(){ig.multitouchInput.clear()},_supportsLocalStorage:function(){try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),this.localStorageSupport="localStorage"in window&&null!==window.localStorage}catch(b){return this.localStorageSupport}},storageIsSet:function(b){return"function"===typeof this.storage.isSet?this.storage.isSet(b):null},storageGet:function(b){return"function"===typeof this.storage.get?this.storage.get(b):null},storageSet:function(b,
c){return"function"===typeof this.storage.set?this.storage.set(b,c):null},assert:function(b,c,e){if(c!==e)throw"actualValue:"+c+" not equal to testValue:"+e+" at "+b;}})});ig.baked=!0;
ig.module("plugins.io.storage-manager").requires("impact.game","plugins.io.io-manager").defines(function(){ig.Game.prototype.name="rainbow-stacker-responsive-hd";ig.Game.prototype.version="1.0";ig.Game.prototype.sessionData={};ig.Game.prototype.initData=function(){return this.sessionData={sound:1,music:1,score:0}};ig.Game.prototype.setupStorageManager=function(){"undefined"===typeof this.name?console.error("Cannot found Game Name, Storage Manager Cancelled."):"undefined"===typeof this.version?console.error("Cannot found Game Version, Storage Manager Cancelled."):
(this.io||(this.io=new IoManager,console.log("IO Manager doesn't existed. Initialize...")),console.log("Plug in Storage Manager"),this.storage=this.io.storage,this.storageName=this.name+"-v"+this.version,this.loadAll())};ig.Game.prototype.loadAll=function(){var b=this.storage.get(this.storageName);if(null===b||"undefined"===typeof b)b=this.initData();for(var c in b)this.sessionData[c]=b[c];this.storage.set(this.storageName,b)};ig.Game.prototype.saveAll=function(){var b=this.storage.get(this.storageName),
c;for(c in b)b[c]=this.sessionData[c];this.storage.set(this.storageName,b)};ig.Game.prototype.load=function(b){return this.storage.get(this.storageName)[b]};ig.Game.prototype.save=function(b,c){var e=this.storage.get(this.storageName);e[b]=c;this.storage.set(this.storageName,e)}});ig.baked=!0;
ig.module("plugins.splash-loader").requires("impact.loader","impact.animation").defines(function(){ig.SplashLoader=ig.Loader.extend({loaderStatus:0,tapToStartDivId:"tap-to-start",loadingBar:new ig.Image("media/graphics/sprites/0_loading-bar.png"),loadingBarFill:new ig.Image("media/graphics/sprites/0_loading-bar-fill.png"),ctx:null,rainbowLetters:[],stackerLetters:[],rainbow0:{},rainbow1:{},rainbow2:{},rainbow3:{},rainbow4:{},rainbow5:{},rainbow6:{},titleTurnIndex:0,titleAlp:1,minus:!0,h:0,rainbowX:[33*
1.6,102*1.6,248,332.8,277*1.6,555.2,688],stackerX:[11,79,151,220,293,365,435],init:function(b,c){this.parent(b,c);var e=ig.domHandler.getElementById("#game"),d=ig.domHandler.getElementById("#webgl");ig.domHandler.setZIndex(e,1);ig.domHandler.setZIndex(d,0);this.processText();ig.apiHandler.run("MJSPreroll");this.ctx=ig.system.context},end:function(){this._endParent=this.parent;this.loaderStatus=this._drawStatus=1;if(wgl.game.ready)if(wgl.game.setScene("forest"),_SETTINGS.TapToStartAudioUnlock.Enabled)this.tapToStartDiv(function(){this._endParent();
if("undefined"===typeof ig.game||null==ig.game)ig.system.setGame(this.gameClass),this.loaderStatus=2}.bind(this));else{if(this._endParent(),"undefined"===typeof ig.game||null==ig.game)ig.system.setGame(this.gameClass),this.loaderStatus=2}else this.isLoading3dScene=!0,setTimeout(function(){this.draw()}.bind(this),300)},tapToStartDiv:function(b){this.desktopCoverDIV=document.getElementById(this.desktopCoverDIVID);if(!this.desktopCoverDIV){this.desktopCoverDIV=document.createElement("div");this.desktopCoverDIV.id=
this.desktopCoverDIVID;this.desktopCoverDIV.setAttribute("class","play");this.desktopCoverDIV.setAttribute("style","position: absolute; display: block; z-index: 999999; background-color: rgba(23, 32, 53, 0.7); visibility: visible; font-size: 10vmin; text-align: center; vertical-align: middle; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;");this.desktopCoverDIV.innerHTML="<div style='color:white;background-color: rgba(255, 255, 255, 0.3); border: 2px solid #fff; font-size:20px; border-radius: 5px; position: relative; float: left; top: 50%; left: 50%; transform: translate(-50%, -50%);'><div style='padding:20px 50px; font-family: montserrat;'>"+
_STRINGS.Splash.TapToStart+"</div></div>";(document.getElementById("play").parentNode||document.getElementById("ajaxbar")).appendChild(this.desktopCoverDIV);try{"undefined"!==typeof ig.sizeHandler?"undefined"!==typeof ig.sizeHandler.coreDivsToResize&&(ig.sizeHandler.coreDivsToResize.push("#"+this.desktopCoverDIVID),"function"===typeof ig.sizeHandler.reorient&&ig.sizeHandler.reorient()):"undefined"!==typeof coreDivsToResize&&(coreDivsToResize.push(this.desktopCoverDIVID),"function"===typeof sizeHandler&&
sizeHandler())}catch(c){console.log(c)}this.desktopCoverDIV.addEventListener("click",function(){ig.soundHandler.unlockWebAudio();this.setAttribute("style","visibility: hidden;");"function"===typeof b&&b()})}},processText:function(){this.rainbowText="RAINBOW";this.stackerText="STACKER";this.textSet(80,"white");this.rainbowWidth=763.2;this.rainbowStart=ig.system.width/2-this.rainbowWidth/2;for(var b=this.rainbowText.split(""),c=0;c<b.length;c++)this["rainbow"+c]={tx:b[c],x:this.rainbowX[c],offX:0,scX:1,
scY:1,h:360*(c/7)},this.rainbowLetters.push(this["rainbow"+c]);this.textSet(60,"white");this.stackerWidth=179*1.6;b=this.stackerText.split("");this.stackerGap=Math.floor((0.95*this.rainbowWidth-this.stackerWidth)/(this.stackerText.length-1));this.stackerStart=ig.system.width/2-0.95*(this.rainbowWidth/2);for(c=0;c<b.length;c++)this.stackerLetters.push({tx:b[c],x:1.6*this.stackerX[c],offX:0,scX:1,scY:1,alp:this.titleAlp})},drawTitle:function(){for(var b=0;7>b;b++)this.textDraw({tx:this.rainbowLetters[b].tx,
px:120,x:this.rainbowStart+this.rainbowLetters[b].x,y:0.24*ig.system.height,col:"hsl("+this.rainbowLetters[b].h+",80%,80%)",alp:this.titleAlp,scX:1.6*this.rainbowLetters[b].scX,scY:1.36});for(b=0;7>b;b++)this.textDraw({tx:this.stackerLetters[b].tx,px:100,x:this.stackerStart+this.stackerLetters[b].x,y:ig.ua.mobile?0.24*ig.system.height+130:0.31*ig.system.height,col:"white",alp:this.titleAlp})},textSet:function(b,c,e,d){this.ctxRef=d=d||ig.system.context;d.font=b+"px "+(e||"typo");d.fillStyle=c},textW:function(b){return this.ctxRef.measureText(b).width},
draw:function(){this.ctx.fillStyle="#46384a";this.ctx.fillRect(0,0,ig.responsive.width,ig.responsive.height);this._drawStatus+=(this.status-this._drawStatus)/5;this.drawTitle();var b=ig.responsive.toAnchor(0,320,"center-middle");this.ctx.drawImage(this.loadingBar.data,0,0,this.loadingBar.width,this.loadingBar.height,b.x-this.loadingBar.width/2,b.y-this.loadingBar.height/2,this.loadingBar.width,this.loadingBar.height);this.ctx.drawImage(this.loadingBarFill.data,0,0,this.loadingBarFill.width*this._drawStatus,
this.loadingBarFill.height,b.x-this.loadingBarFill.width/2,b.y-this.loadingBarFill.height/2,this.loadingBarFill.width*this._drawStatus,this.loadingBarFill.height);this.ctx.restore();this.isLoading3dScene&&(wgl.game.ready?setTimeout(function(){this.end()}.bind(this),300):this.end())},textDraw:function(b){var c=b.rot?b.rot:0,e=b.tx?b.tx:0,d=b.x?b.x:0,j=b.y?b.y:0,g=void 0==b.scX?1:b.scX,p=void 0==b.scY?1:b.scY,l=void 0==b.scX?1:b.scX,f=void 0==b.scY?1:b.scY,m=b.stroke?b.stroke:!1,n=void 0==b.strokeAlp?
1:b.strokeAlp,r=b.strokeColour?b.strokeColour:"black",s=void 0==b.alp?1:b.alp,t=b.col?b.col:this.ctx.fillStyle,u=b.font||"typo",v=b.px||10,z=b.strokeLine||3,x=b.align||"center";if(0!=s){var C=b.ctx||ig.system.context;this.ctxRef=b.ctx||ig.system.context;C.font=v+"px "+u;void 0!=b.maxWidth&&this.textW(e)*g>b.maxWidth&&(l=b.maxWidth/this.textW(e),f=p/g*l);"left"==x?d+=0.5*this.textW(e)*l:"right"==x&&(d-=0.5*this.textW(e)*l);C.save();b=C.measureText("M").width*f;C.translate(d,j+b/2);C.scale(l,f);C.rotate(c?
2*Math.PI/360*c:0);C.fillStyle=t;!0==m&&(C.globalAlpha=n,C.lineWidth=z,C.lineCap="round",C.strokeStyle=r,C.strokeText(e,-this.textW(e)/2,0));C.globalAlpha=s;C.fillText(e,-this.textW(e)/2,0);C.restore()}}})});ig.baked=!0;
ig.module("plugins.tween").requires("impact.entity").defines(function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(b){for(var c=0;c<this.length;++c)if(this[c]===b)return c;return-1});ig.Entity.prototype.tweens=[];ig.Entity.prototype._preTweenUpdate=ig.Entity.prototype.update;ig.Entity.prototype.update=function(){this._preTweenUpdate();if(0<this.tweens.length){for(var b=[],c=0;c<this.tweens.length;c++)this.tweens[c].update(),this.tweens[c].complete||b.push(this.tweens[c]);this.tweens=
b}};ig.Entity.prototype.tween=function(b,c,e){b=new ig.Tween(this,b,c,e);this.tweens.push(b);return b};ig.Entity.prototype.pauseTweens=function(){for(var b=0;b<this.tweens.length;b++)this.tweens[b].pause()};ig.Entity.prototype.resumeTweens=function(){for(var b=0;b<this.tweens.length;b++)this.tweens[b].resume()};ig.Entity.prototype.stopTweens=function(b){for(var c=0;c<this.tweens.length;c++)this.tweens[c].stop(b)};ig.Tween=function(b,c,e,d){var j={},g={},p={},l=0,f=!1,m=!1,n=!1;this.duration=e;this.paused=
this.complete=!1;this.easing=ig.Tween.Easing.Linear.EaseNone;this.onComplete=!1;this.loop=this.delay=0;this.loopCount=-1;ig.merge(this,d);this.loopNum=this.loopCount;this.chain=function(b){n=b};this.initEnd=function(b,c,d){if("object"!==typeof c[b])d[b]=c[b];else for(subprop in c[b])d[b]||(d[b]={}),this.initEnd(subprop,c[b],d[b])};this.initStart=function(b,c,d,e){if("object"!==typeof d[b])"undefined"!==typeof c[b]&&(e[b]=d[b]);else for(subprop in d[b])e[b]||(e[b]={}),"undefined"!==typeof c[b]&&this.initStart(subprop,
c[b],d[b],e[b])};this.start=function(){this.paused=this.complete=!1;this.loopNum=this.loopCount;l=0;-1==b.tweens.indexOf(this)&&b.tweens.push(this);m=!0;f=new ig.Timer;for(var d in c)this.initEnd(d,c,g);for(d in g)this.initStart(d,g,b,j),this.initDelta(d,p,b,g)};this.initDelta=function(b,c,d,e){if("object"!==typeof e[b])c[b]=e[b]-d[b];else for(subprop in e[b])c[b]||(c[b]={}),this.initDelta(subprop,c[b],d[b],e[b])};this.propUpdate=function(b,c,d,e,f){if("object"!==typeof d[b])c[b]="undefined"!=typeof d[b]?
d[b]+e[b]*f:c[b];else for(subprop in d[b])this.propUpdate(subprop,c[b],d[b],e[b],f)};this.propSet=function(b,c,d){if("object"!==typeof c[b])d[b]=c[b];else for(subprop in c[b])d[b]||(d[b]={}),this.propSet(subprop,c[b],d[b])};this.update=function(){if(!m)return!1;if(this.delay){if(f.delta()<this.delay)return;this.delay=0;f.reset()}if(this.paused||this.complete)return!1;var c=(f.delta()+l)/this.duration,c=1<c?1:c,d=this.easing(c);for(property in p)this.propUpdate(property,b,j,p,d);if(1<=c){if(0==this.loopNum||
!this.loop){this.complete=!0;if(this.onComplete)this.onComplete();n&&n.start();return!1}if(this.loop==ig.Tween.Loop.Revert){for(property in j)this.propSet(property,j,b);l=0;f.reset();-1!=this.loopNum&&this.loopNum--}else if(this.loop==ig.Tween.Loop.Reverse){c={};d={};ig.merge(c,g);ig.merge(d,j);ig.merge(j,c);ig.merge(g,d);for(property in g)this.initDelta(property,p,b,g);l=0;f.reset();-1!=this.loopNum&&this.loopNum--}}};this.pause=function(){this.paused=!0;f&&f.delta&&(l+=f.delta())};this.resume=function(){this.paused=
!1;f&&f.reset&&f.reset()};this.stop=function(b){b&&(this.loop=this.complete=this.paused=!1,l+=e,this.update());this.complete=!0}};ig.Tween.Loop={Revert:1,Reverse:2};ig.Tween.Easing={Linear:{},Quadratic:{},Cubic:{},Quartic:{},Quintic:{},Sinusoidal:{},Exponential:{},Circular:{},Elastic:{},Back:{},Bounce:{}};ig.Tween.Easing.Linear.EaseNone=function(b){return b};ig.Tween.Easing.Quadratic.EaseIn=function(b){return b*b};ig.Tween.Easing.Quadratic.EaseOut=function(b){return-b*(b-2)};ig.Tween.Easing.Quadratic.EaseInOut=
function(b){return 1>(b*=2)?0.5*b*b:-0.5*(--b*(b-2)-1)};ig.Tween.Easing.Cubic.EaseIn=function(b){return b*b*b};ig.Tween.Easing.Cubic.EaseOut=function(b){return--b*b*b+1};ig.Tween.Easing.Cubic.EaseInOut=function(b){return 1>(b*=2)?0.5*b*b*b:0.5*((b-=2)*b*b+2)};ig.Tween.Easing.Quartic.EaseIn=function(b){return b*b*b*b};ig.Tween.Easing.Quartic.EaseOut=function(b){return-(--b*b*b*b-1)};ig.Tween.Easing.Quartic.EaseInOut=function(b){return 1>(b*=2)?0.5*b*b*b*b:-0.5*((b-=2)*b*b*b-2)};ig.Tween.Easing.Quintic.EaseIn=
function(b){return b*b*b*b*b};ig.Tween.Easing.Quintic.EaseOut=function(b){return(b-=1)*b*b*b*b+1};ig.Tween.Easing.Quintic.EaseInOut=function(b){return 1>(b*=2)?0.5*b*b*b*b*b:0.5*((b-=2)*b*b*b*b+2)};ig.Tween.Easing.Sinusoidal.EaseIn=function(b){return-Math.cos(b*Math.PI/2)+1};ig.Tween.Easing.Sinusoidal.EaseOut=function(b){return Math.sin(b*Math.PI/2)};ig.Tween.Easing.Sinusoidal.EaseInOut=function(b){return-0.5*(Math.cos(Math.PI*b)-1)};ig.Tween.Easing.Exponential.EaseIn=function(b){return 0==b?0:Math.pow(2,
10*(b-1))};ig.Tween.Easing.Exponential.EaseOut=function(b){return 1==b?1:-Math.pow(2,-10*b)+1};ig.Tween.Easing.Exponential.EaseInOut=function(b){return 0==b?0:1==b?1:1>(b*=2)?0.5*Math.pow(2,10*(b-1)):0.5*(-Math.pow(2,-10*(b-1))+2)};ig.Tween.Easing.Circular.EaseIn=function(b){return-(Math.sqrt(1-b*b)-1)};ig.Tween.Easing.Circular.EaseOut=function(b){return Math.sqrt(1- --b*b)};ig.Tween.Easing.Circular.EaseInOut=function(b){return 1>(b/=0.5)?-0.5*(Math.sqrt(1-b*b)-1):0.5*(Math.sqrt(1-(b-=2)*b)+1)};ig.Tween.Easing.Elastic.EaseIn=
function(b){var c,e=0.1,d=0.4;if(0==b)return 0;if(1==b)return 1;d||(d=0.3);!e||1>e?(e=1,c=d/4):c=d/(2*Math.PI)*Math.asin(1/e);return-(e*Math.pow(2,10*(b-=1))*Math.sin((b-c)*2*Math.PI/d))};ig.Tween.Easing.Elastic.EaseOut=function(b){var c,e=0.1,d=0.4;if(0==b)return 0;if(1==b)return 1;d||(d=0.3);!e||1>e?(e=1,c=d/4):c=d/(2*Math.PI)*Math.asin(1/e);return e*Math.pow(2,-10*b)*Math.sin((b-c)*2*Math.PI/d)+1};ig.Tween.Easing.Elastic.EaseInOut=function(b){var c,e=0.1,d=0.4;if(0==b)return 0;if(1==b)return 1;
d||(d=0.3);!e||1>e?(e=1,c=d/4):c=d/(2*Math.PI)*Math.asin(1/e);return 1>(b*=2)?-0.5*e*Math.pow(2,10*(b-=1))*Math.sin((b-c)*2*Math.PI/d):0.5*e*Math.pow(2,-10*(b-=1))*Math.sin((b-c)*2*Math.PI/d)+1};ig.Tween.Easing.Back.EaseIn=function(b){return b*b*(2.70158*b-1.70158)};ig.Tween.Easing.Back.EaseOut=function(b){return(b-=1)*b*(2.70158*b+1.70158)+1};ig.Tween.Easing.Back.EaseInOut=function(b){return 1>(b*=2)?0.5*b*b*(3.5949095*b-2.5949095):0.5*((b-=2)*b*(3.5949095*b+2.5949095)+2)};ig.Tween.Easing.Bounce.EaseIn=
function(b){return 1-ig.Tween.Easing.Bounce.EaseOut(1-b)};ig.Tween.Easing.Bounce.EaseOut=function(b){return(b/=1)<1/2.75?7.5625*b*b:b<2/2.75?7.5625*(b-=1.5/2.75)*b+0.75:b<2.5/2.75?7.5625*(b-=2.25/2.75)*b+0.9375:7.5625*(b-=2.625/2.75)*b+0.984375};ig.Tween.Easing.Bounce.EaseInOut=function(b){return 0.5>b?0.5*ig.Tween.Easing.Bounce.EaseIn(2*b):0.5*ig.Tween.Easing.Bounce.EaseOut(2*b-1)+0.5};ig.Tween.Interpolation={Linear:function(b,c){var e=b.length-1,d=e*c,j=Math.floor(d),g=TWEEN.Interpolation.Utils.Linear;
return 0>c?g(b[0],b[1],d):1<c?g(b[e],b[e-1],e-d):g(b[j],b[j+1>e?e:j+1],d-j)}}});ig.baked=!0;
ig.module("plugins.patches.entity-patch").requires("impact.entity").defines(function(){ig.Entity.inject({handleMovementTrace:function(b){this.standing=!1;b.collision.y&&(0<this.bounciness&&Math.abs(this.vel.y)>this.minBounceVelocity?this.vel.y*=-this.bounciness:(0<this.vel.y&&(this.standing=!0),this.vel.y=0));b.collision.x&&(this.vel.x=0<this.bounciness&&Math.abs(this.vel.x)>this.minBounceVelocity?this.vel.x*-this.bounciness:0);if(b.collision.slope){var c=b.collision.slope;if(0<this.bounciness){var e=
this.vel.x*c.nx+this.vel.y*c.ny;this.vel.x=(this.vel.x-2*c.nx*e)*this.bounciness;this.vel.y=(this.vel.y-2*c.ny*e)*this.bounciness}else e=(this.vel.x*c.x+this.vel.y*c.y)/(c.x*c.x+c.y*c.y),this.vel.x=c.x*e,this.vel.y=c.y*e,c=Math.atan2(c.x,c.y),c>this.slopeStanding.min&&c<this.slopeStanding.max&&(this.standing=!0)}this.pos.x=b.pos.x;this.pos.y=b.pos.y}})});ig.baked=!0;
ig.module("plugins.tweens-handler").requires("impact.entity","plugins.tween","plugins.patches.entity-patch").defines(function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(b){for(var e=0;e<this.length;++e)if(this[e]===b)return e;return-1});ig.TweensHandler=ig.Class.extend({_tweens:[],_systemPausedTweens:[],init:function(){},getAll:function(){return this._tweens},removeAll:function(){this._tweens=[]},add:function(b){this._tweens.push(b)},remove:function(b){b=this._tweens.indexOf(b);
-1!==b&&this._tweens.splice(b,1)},onSystemPause:function(){if(0===this._tweens.length)return!1;for(var b=0,e=null;b<this._tweens.length;)e=this._tweens[b],e._isPlaying&&(this._systemPausedTweens.push(e),e.pause()),b++;return!0},onSystemResume:function(){if(0===this._systemPausedTweens.length)return!1;for(var b=0;b<this._systemPausedTweens.length;)this._systemPausedTweens[b].resume(),b++;this._systemPausedTweens=[];return!0},update:function(b,e){if(0===this._tweens.length)return!1;var d=0;for(b=void 0!==
b?b:ig.game.tweens.now();d<this._tweens.length;)this._tweens[d].update(b)||e?d++:this._tweens.splice(d,1);return!0},now:function(){return Date.now()}});ig.TweenDef=ig.Class.extend({_ent:null,_valuesStart:{},_valuesEnd:{},_valuesStartRepeat:{},_duration:1E3,_repeat:0,_yoyo:!1,_isPlaying:!1,_reversed:!1,_delayTime:0,_startTime:null,_pauseTime:null,_easingFunction:ig.Tween.Easing.Linear.EaseNone,_interpolationFunction:ig.Tween.Interpolation.Linear,_chainedTweens:[],_onStartCallback:null,_onStartCallbackFired:!1,
_onUpdateCallback:null,_onCompleteCallback:null,_onStopCallback:null,_onPauseCallback:null,_onResumeCallback:null,_currentElapsed:0,init:function(b){this._object=b},to:function(b,e){this._valuesEnd=b;void 0!==e&&(this._duration=e);return this},start:function(b){if(this._isPlaying)return this;ig.game.tweens.add(this);this._isPlaying=!0;this._onStartCallbackFired=!1;this._startTime=void 0!==b?b:ig.game.tweens.now();this._startTime+=this._delayTime;for(var e in this._valuesEnd){if(this._valuesEnd[e]instanceof
Array){if(0===this._valuesEnd[e].length)continue;this._valuesEnd[e]=[this._object[e]].concat(this._valuesEnd[e])}void 0!==this._object[e]&&(this._valuesStart[e]=this._object[e],!1===this._valuesStart[e]instanceof Array&&(this._valuesStart[e]*=1),this._valuesStartRepeat[e]=this._valuesStart[e]||0)}return this},stop:function(){if(!this._isPlaying)return this;ig.game.tweens.remove(this);this._isPlaying=!1;null!==this._onStopCallback&&this._onStopCallback.call(this._object,this._object);this.stopChainedTweens();
return this},pause:function(){if(!this._isPlaying)return this;ig.game.tweens.remove(this);this._isPlaying=!1;this._pauseTime=ig.game.tweens.now();null!==this._onPauseCallback&&this._onPauseCallback.call(this._object,this._object);return this},resume:function(){if(this._isPlaying||!this._pauseTime)return this;var b=ig.game.tweens.now()-this._pauseTime;this._startTime+=b;ig.game.tweens.add(this);this._isPlaying=!0;null!==this._onResumeCallback&&this._onResumeCallback.call(this._object,this._object);
this._pauseTime=null;return this},end:function(){this.update(this._startTime+this._duration);return this},stopChainedTweens:function(){for(var b=0,e=this._chainedTweens.length;b<e;b++)this._chainedTweens[b].stop()},delay:function(b){this._delayTime=b;return this},repeat:function(b){this._repeat=b;return this},repeatDelay:function(b){this._repeatDelayTime=b;return this},yoyo:function(b){this._yoyo=b;return this},easing:function(b){this._easingFunction=b;return this},interpolation:function(b){this._interpolationFunction=
b;return this},chain:function(){this._chainedTweens=arguments;return this},onStart:function(b){this._onStartCallback=b;return this},onUpdate:function(b){this._onUpdateCallback=b;return this},onComplete:function(b){this._onCompleteCallback=b;return this},onStop:function(b){this._onStopCallback=b;return this},onPause:function(b){this._onPauseCallback=b;return this},onResume:function(b){this._onResumeCallback=b;return this},update:function(b){var e,d,j;if(b<this._startTime)return!0;!1===this._onStartCallbackFired&&
(null!==this._onStartCallback&&this._onStartCallback.call(this._object,this._object),this._onStartCallbackFired=!0);d=(b-this._startTime)/this._duration;this._currentElapsed=d=1<d?1:d;j=this._easingFunction(d);for(e in this._valuesEnd)if(void 0!==this._valuesStart[e]){var g=this._valuesStart[e]||0,p=this._valuesEnd[e];p instanceof Array?this._object[e]=this._interpolationFunction(p,j):("string"===typeof p&&(p="+"===p.charAt(0)||"-"===p.charAt(0)?g+parseFloat(p):parseFloat(p)),"number"===typeof p&&
(this._object[e]=g+(p-g)*j))}null!==this._onUpdateCallback&&this._onUpdateCallback.call(this._object,this._object,j);if(1===d)if(0<this._repeat){isFinite(this._repeat)&&this._repeat--;for(e in this._valuesStartRepeat)"string"===typeof this._valuesEnd[e]&&(this._valuesStartRepeat[e]=_valuesStartRepeat[e]+parseFloat(_valuesEnd[e])),this._yoyo&&(d=this._valuesStartRepeat[e],this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=d),this._valuesStart[e]=this._valuesStartRepeat[e];this._yoyo&&
(this._reversed=!this._reversed);this._startTime=void 0!==this._repeatDelayTime?b+this._repeatDelayTime:b+this._delayTime}else{null!==this._onCompleteCallback&&this._onCompleteCallback.call(this._object,this._object);b=0;for(e=this._chainedTweens.length;b<e;b++)this._chainedTweens[b].start(this._startTime+this._duration);return!1}return!0}});var b=[1];ig.Tween.Interpolation={Linear:function(b,e){var d=b.length-1,j=d*e,g=Math.floor(j),p=ig.Tween.Interpolation.Utils.Linear;return 0>e?p(b[0],b[1],j):
1<e?p(b[d],b[d-1],d-j):p(b[g],b[g+1>d?d:g+1],j-g)},Bezier:function(b,e){for(var d=0,j=b.length-1,g=Math.pow,p=ig.Tween.Interpolation.Utils.Bernstein,l=0;l<=j;l++)d+=g(1-e,j-l)*g(e,l)*b[l]*p(j,l);return d},CatmullRom:function(b,e){var d=b.length-1,j=d*e,g=Math.floor(j),p=ig.Tween.Interpolation.Utils.CatmullRom;return b[0]===b[d]?(0>e&&(g=Math.floor(j=d*(1+e))),p(b[(g-1+d)%d],b[g],b[(g+1)%d],b[(g+2)%d],j-g)):0>e?b[0]-(p(b[0],b[0],b[1],b[1],-j)-b[0]):1<e?b[d]-(p(b[d],b[d],b[d-1],b[d-1],j-d)-b[d]):p(b[g?
g-1:0],b[g],b[d<g+1?d:g+1],b[d<g+2?d:g+2],j-g)},Utils:{Linear:function(b,e,d){return(e-b)*d+b},Bernstein:function(b,e){var d=ig.Tween.Interpolation.Utils.Factorial;return d(b)/d(e)/d(b-e)},Factorial:function(c){var e=1;if(b[c])return b[c];for(var d=c;1<d;d--)e*=d;return b[c]=e},CatmullRom:function(b,e,d,j,g){b=0.5*(d-b);j=0.5*(j-e);var p=g*g;return(2*e-2*d+b+j)*g*p+(-3*e+3*d-2*b-j)*p+b*g+e}}}});ig.baked=!0;
ig.module("plugins.url-parameters").defines(function(){ig.UrlParameters=ig.Class.extend({init:function(){switch(getQueryVariable("iphone")){case "true":ig.ua.iPhone=!0,console.log("iPhone mode")}var b=getQueryVariable("webview");if(b)switch(b){case "true":ig.ua.is_uiwebview=!0,console.log("webview mode")}if(b=getQueryVariable("debug"))switch(b){case "true":ig.game.showDebugMenu(),console.log("debug mode")}if(b=getQueryVariable("debugwgl"))switch(b){case "true":wgl.debug.debug=!0,console.log("wgl debug mode")}switch(getQueryVariable("view")){case "stats":ig.game.resetPlayerStats(),
ig.game.endGame()}getQueryVariable("ad")}})});ig.baked=!0;
ig.module("plugins.director").requires("impact.impact").defines(function(){ig.Director=ig.Class.extend({init:function(b,c){this.game=b;this.levels=[];this.currentLevel=0;this.append(c)},loadLevel:function(b){for(var c in ig.sizeHandler.dynamicClickableEntityDivs){var e=ig.domHandler.getElementById("#"+c);ig.domHandler.hide(e)}this.currentLevel=b;this.game.loadLevel(this.levels[b]);return!0},loadLevelWithoutEntities:function(b){this.currentLevel=b;this.game.loadLevelWithoutEntities(this.levels[b]);
return!0},append:function(b){newLevels=[];return"object"===typeof b?(b.constructor===[].constructor?newLevels=b:newLevels[0]=b,this.levels=this.levels.concat(newLevels),!0):!1},nextLevel:function(){return this.currentLevel+1<this.levels.length?this.loadLevel(this.currentLevel+1):!1},previousLevel:function(){return 0<=this.currentLevel-1?this.loadLevel(this.currentLevel-1):!1},jumpTo:function(b){var c=null;for(i=0;i<this.levels.length;i++)this.levels[i]==b&&(c=i);return 0<=c?this.loadLevel(c):!1},
firstLevel:function(){return this.loadLevel(0)},lastLevel:function(){return this.loadLevel(this.levels.length-1)},reloadLevel:function(){return this.loadLevel(this.currentLevel)}})});ig.baked=!0;
ig.module("plugins.impact-storage").requires("impact.game").defines(function(){ig.Storage=ig.Class.extend({staticInstantiate:function(){return!ig.Storage.instance?null:ig.Storage.instance},init:function(){ig.Storage.instance=this},isCapable:function(){return"undefined"!==typeof window.localStorage},isSet:function(b){return null!==this.get(b)},initUnset:function(b,c){null===this.get(b)&&this.set(b,c)},get:function(b){if(!this.isCapable())return null;try{return JSON.parse(localStorage.getItem(b))}catch(c){return window.localStorage.getItem(b)}},
getInt:function(b){return~~this.get(b)},getFloat:function(b){return parseFloat(this.get(b))},getBool:function(b){return!!this.get(b)},key:function(b){return this.isCapable()?window.localStorage.key(b):null},set:function(b,c){if(!this.isCapable())return null;try{window.localStorage.setItem(b,JSON.stringify(c))}catch(e){console.log(e)}},setHighest:function(b,c){c>this.getFloat(b)&&this.set(b,c)},remove:function(b){if(!this.isCapable())return null;window.localStorage.removeItem(b)},clear:function(){if(!this.isCapable())return null;
window.localStorage.clear()}})});ig.baked=!0;
ig.module("plugins.responsive.responsive-utils").requires("impact.system").defines(function(){ig.responsive={width:0,height:0,halfWidth:0,halfHeight:0,originalWidth:0,originalHeight:0,fillScale:1,scaleX:1,scaleY:1,toAnchor:function(b,c,e){switch(e){case "top-left":case "left-top":return this.toAnchorTopLeft(b,c);case "top-center":case "center-top":case "top":return this.toAnchorTopCenter(b,c);case "top-right":case "right-top":return this.toAnchorTopRight(b,c);case "left-middle":case "middle-left":case "left":return this.toAnchorLeftMiddle(b,
c);case "center-middle":case "middle-center":case "middle":case "center":return this.toAnchorCenterMiddle(b,c);case "right-middle":case "middle-right":case "right":return this.toAnchorRightMiddle(b,c);case "bottom-left":case "left-bottom":return this.toAnchorBottomLeft(b,c);case "bottom-center":case "center-bottom":case "bottom":return this.toAnchorBottomCenter(b,c);case "bottom-right":case "right-bottom":return this.toAnchorBottomRight(b,c);default:return this.toAnchorDefault(b,c)}},toAnchorDefault:function(b,
c){return{x:b+(this.width-this.originalWidth)/2,y:c+(this.height-this.originalHeight)/2}},toAnchorCenterMiddle:function(b,c){return{x:b+this.halfWidth,y:c+this.halfHeight}},toAnchorLeftMiddle:function(b,c){return{x:b,y:c+this.halfHeight}},toAnchorTopCenter:function(b,c){return{x:b+this.halfWidth,y:c}},toAnchorRightMiddle:function(b,c){return{x:b+this.width,y:c+this.halfHeight}},toAnchorBottomCenter:function(b,c){return{x:b+this.halfWidth,y:c+this.height}},toAnchorTopLeft:function(b,c){return{x:b,
y:c}},toAnchorBottomLeft:function(b,c){return{x:b,y:c+this.height}},toAnchorTopRight:function(b,c){return{x:b+this.width,y:c}},toAnchorBottomRight:function(b,c){return{x:b+this.width,y:c+this.height}},fromPos:function(){},fromPosDefault:function(){},fromPosCenterMiddle:function(){},fromPosLeftMiddle:function(){},fromPosTopCenter:function(){},fromPosRightMiddle:function(){},fromPosBottomCenter:function(){},fromPosTopLeft:function(){},fromPosBottomLeft:function(){},fromPosTopRight:function(){},fromPosBottomRight:function(){},
drawScaledImage:function(b,c,e,d,j,g,p){g||(g=0);p||(p=0);var l=ig.system.context;l.save();l.translate(c,e);(1!=d||1!=j)&&l.scale(d,j);b.draw(-b.width*g,-b.height*p);l.restore()}}});ig.baked=!0;
ig.module("plugins.responsive.responsive-plugin").requires("impact.system","impact.entity","plugins.handlers.size-handler","plugins.responsive.responsive-utils").defines(function(){console.log("Responsive Plugin 1.4");ig.SizeHandler.inject({resize:function(){this.parent()},sizeCalcs:function(){this.originalResolution||(this.originalResolution=new Vector2(this.desktop.actualResolution.x,this.desktop.actualResolution.y),ig.responsive.originalWidth=this.desktop.actualResolution.x,ig.responsive.originalHeight=
this.desktop.actualResolution.y);var b=window.innerWidth,c=window.innerHeight,e=b/c,d=this.originalResolution.x/this.originalResolution.y,j=0,g=0;this.windowSize=new Vector2(b,c);e<d?(j=this.originalResolution.x,g=j/e,ig.responsive.scaleX=1,ig.responsive.scaleY=g/this.originalResolution.y):(g=this.originalResolution.y,j=g*e,ig.responsive.scaleX=j/this.originalResolution.x,ig.responsive.scaleY=1);this.scaleRatioMultiplier=new Vector2(b/j,c/g);this.desktop.actualResolution=new Vector2(j,g);this.mobile.actualResolution=
new Vector2(j,g);this.desktop.actualSize=new Vector2(b,c);this.mobile.actualSize=new Vector2(b,c);ig.responsive.width=j;ig.responsive.height=g;ig.responsive.halfWidth=j/2;ig.responsive.halfHeight=g/2;ig.responsive.fillScale=Math.max(ig.responsive.scaleX,ig.responsive.scaleY)},resizeLayers:function(){ig.system.resize(ig.sizeHandler.desktop.actualResolution.x,ig.sizeHandler.desktop.actualResolution.y);for(var b=0;b<this.coreDivsToResize.length;b++){var c=ig.domHandler.getElementById(this.coreDivsToResize[b]),
e=Math.floor(ig.sizeHandler.windowSize.x/2-ig.sizeHandler.desktop.actualSize.x/2),d=Math.floor(ig.sizeHandler.windowSize.y/2-ig.sizeHandler.desktop.actualSize.y/2);0>e&&(e=0);0>d&&(d=0);ig.domHandler.resizeOffset(c,Math.floor(ig.sizeHandler.desktop.actualSize.x),Math.floor(ig.sizeHandler.desktop.actualSize.y),e,d)}for(var j in this.adsToResize)b=ig.domHandler.getElementById("#"+j),c=ig.domHandler.getElementById("#"+j+"-Box"),e=(window.innerWidth-this.adsToResize[j]["box-width"])/2+"px",d=(window.innerHeight-
this.adsToResize[j]["box-height"])/2+"px",b&&ig.domHandler.css(b,{width:window.innerWidth,height:window.innerHeight}),c&&ig.domHandler.css(c,{left:e,top:d});b=ig.domHandler.getElementById("#canvas");c=ig.domHandler.getOffsets(b);b=c.left;c=c.top;e=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);for(j in this.dynamicClickableEntityDivs)d=ig.domHandler.getElementById("#"+j),ig.domHandler.css(d,{"float":"left",position:"absolute",left:Math.floor(b+this.dynamicClickableEntityDivs[j].entity_pos_x*
this.scaleRatioMultiplier.x)+"px",top:Math.floor(c+this.dynamicClickableEntityDivs[j].entity_pos_y*this.scaleRatioMultiplier.y)+"px",width:Math.floor(this.dynamicClickableEntityDivs[j].width*this.scaleRatioMultiplier.x)+"px",height:Math.floor(this.dynamicClickableEntityDivs[j].height*this.scaleRatioMultiplier.y)+"px","z-index":3}),this.dynamicClickableEntityDivs[j]["font-size"]&&ig.domHandler.css(d,{"font-size":this.dynamicClickableEntityDivs[j]["font-size"]*e+"px"});$("#ajaxbar").width(this.windowSize.x);
$("#ajaxbar").height(this.windowSize.y)},reorient:function(){ig.ua.mobile?(this.resize(),this.resizeAds()):this.resize();("undefined"!==typeof BABYLON||window.BABYLON)&&this.resizeBabylon();ig.game&&(ig.game.update(),ig.game.draw())},resizeBabylon:function(){var b=window.innerWidth,c=window.innerHeight,e=b/c,d=ig.responsive.originalWidth,j=ig.responsive.originalHeight,g=d/j,p=Math.max(d,j);ig.ua.mobile&&(p=640);minSize=Math.min(d,j);e>g?(c>j&&(c=j),b=Math.floor(window.innerWidth/window.innerHeight*
c),b>p&&(b=p),c=Math.floor(window.innerHeight/window.innerWidth*b)):(b>d&&(b=d),c=Math.floor(window.innerHeight/window.innerWidth*b),c>p&&(c=p),b=Math.floor(window.innerWidth/window.innerHeight*c));d=e=1;window.innerWidth>p&&(e=window.innerWidth/p);window.innerHeight>p&&(d=window.innerHeight/p);wgl.system.engine.setSize(b,c);wgl.system.engine.resize();wgl.system.engine.setHardwareScalingLevel(Math.max(e,d));ig.wglW=b;ig.wglH=c;ig.wglInnerW=window.innerWidth;ig.wglInnerH=window.innerHeight}});ig.Entity.inject({init:function(b,
c,e){this.parent(b,c,e);!this.anchorType&&!e.anchorType&&(this.anchorType="none");this.anchoredPositionX=b;this.anchoredPositionY=c},setAnchoredPosition:function(b,c,e){e||(e="default");this.anchorType=e;this.anchoredPositionX=b;this.anchoredPositionY=c},update:function(){this.parent();if(""!=this.anchorType&&"none"!=this.anchorType){var b=ig.responsive.toAnchor(this.anchoredPositionX,this.anchoredPositionY,this.anchorType);this.pos.x=b.x;this.pos.y=b.y}}})});this.START_BRANDING_SPLASH;ig.baked=!0;
ig.module("plugins.branding.splash").requires("impact.impact","impact.entity").defines(function(){ig.BrandingSplash=ig.Class.extend({init:function(){ig.game.spawnEntity(EntityBranding,0,0)}});EntityBranding=ig.Entity.extend({autoUpdateScale:!1,gravityFactor:0,size:{x:32,y:32},splash:new ig.Image("branding/splash1.png"),init:function(b,c,e){this.parent(b,c,e);320>=ig.system.width?(this.size.x=320,this.size.y=200):(this.size.x=480,this.size.y=240);this.pos.x=(ig.system.width-this.size.x)/2;this.pos.y=
-this.size.y-200;this.endPosY=(ig.system.height-this.size.y)/2;b=this.tween({pos:{y:this.endPosY}},0.5,{easing:ig.Tween.Easing.Bounce.EaseIn});c=this.tween({},2.5,{onComplete:function(){ig.game.director.loadLevel(ig.game.director.currentLevel)}});b.chain(c);b.start();this.currentAnim=this.anims.idle},createClickableLayer:function(){console.log("Build clickable layer");this.checkClickableLayer("branding-splash",_SETTINGS.Branding.Logo.Link,_SETTINGS.Branding.Logo.NewWindow)},doesClickableLayerExist:function(b){for(k in dynamicClickableEntityDivs)if(k==
b)return!0;return!1},checkClickableLayer:function(b,c,e){"undefined"==typeof wm&&(this.doesClickableLayerExist(b)?(ig.game.showOverlay([b]),$("#"+b).find("[href]").attr("href",c)):this.createClickableOutboundLayer(b,c,"media/graphics/misc/invisible.png",e))},createClickableOutboundLayer:function(b,c,e,d){var j=ig.$new("div");j.id=b;document.body.appendChild(j);j=$("#"+j.id);j.css("float","left");j.css("position","absolute");if(ig.ua.mobile){var g=window.innerHeight/mobileHeight,p=window.innerWidth/
mobileWidth;j.css("left",this.pos.x*p);j.css("top",this.pos.y*g);j.css("width",this.size.x*p);j.css("height",this.size.y*g)}else g=w/2-destW/2,p=h/2-destH/2,console.log(g,p),j.css("left",g+this.pos.x*multiplier),j.css("top",p+this.pos.y*multiplier),j.css("width",this.size.x*multiplier),j.css("height",this.size.y*multiplier);d?j.html("<a target='_blank' href='"+c+"'><img style='width:100%;height:100%' src='"+e+"'></a>"):j.html("<a href='"+c+"'><img style='width:100%;height:100%' src='"+e+"'></a>");
dynamicClickableEntityDivs[b]={};dynamicClickableEntityDivs[b].width=this.size.x*multiplier;dynamicClickableEntityDivs[b].height=this.size.y*multiplier;dynamicClickableEntityDivs[b].entity_pos_x=this.pos.x;dynamicClickableEntityDivs[b].entity_pos_y=this.pos.y},draw:function(){ig.system.context.fillStyle="#ffffff";ig.system.context.fillRect(0,0,ig.system.width,ig.system.height);ig.system.context.fillStyle="#000";ig.system.context.font="12px Arial";ig.system.context.textAlign="left";320>=ig.system.width?
ig.system.context.fillText("powered by MarketJS.com",ig.system.width-150,ig.system.height-15):ig.system.context.fillText("powered by MarketJS.com",ig.system.width-160,ig.system.height-15);this.parent();this.splash&&ig.system.context.drawImage(this.splash.data,0,0,this.splash.data.width,this.splash.data.height,this.pos.x,this.pos.y,this.size.x,this.size.y)}})});this.END_BRANDING_SPLASH;ig.baked=!0;
ig.module("plugins.datastructure.binary-heap").defines(function(){BinaryHeap=ig.Class.extend({content:[],getValue:null,minHeap:!0,tagName:"BinaryHeap",init:function(b,c){this.getValue=b;c&&(this.minHeap=!1)},push:function(b){this.content.push(b);this.sinkDown(this.content.length-1)},pop:function(){var b=this.content[0],c=this.content.pop();0<this.content.length&&(this.content[0]=c,this.bubbleUp(0));return b},remove:function(b){var c=this.content.indexOf(b),e=this.content.pop();c!==this.content.length-
1&&(this.content[c]=e,this.minHeap?this.getValue(e)<this.getValue(b)?this.sinkDown(c):this.bubbleUp(c):this.getValue(e)>this.getValue(b)?this.sinkDown(c):this.bubbleUp(c))},size:function(){return this.content.length},rescoreElement:function(b){this.sinkDown(this.content.indexOf(b))},sinkDown:function(b){for(var c=this.content[b];0<b;){var e=(b+1>>1)-1,d=this.content[e];if(this.minHeap)if(this.getValue(c)<this.getValue(d))this.content[e]=c,this.content[b]=d,b=e;else break;else if(this.getValue(c)>
this.getValue(d))this.content[e]=c,this.content[b]=d,b=e;else break}},bubbleUp:function(b){for(var c=this.content.length,e=this.content[b],d=this.getValue(e);;){var j=b+1<<1,g=j-1,p=null,l;g<c&&(l=this.getValue(this.content[g]),this.minHeap?l<d&&(p=g):l>d&&(p=g));if(j<c)if(g=this.getValue(this.content[j]),this.minHeap){if(g<(null===p?d:l))p=j}else if(g>(null===p?d:l))p=j;if(null!==p)this.content[b]=this.content[p],this.content[p]=e,b=p;else break}},empty:function(){for(;0<this.content.length;)this.content.pop()}})});
ig.baked=!0;
ig.module("game.entities.buttons.button").requires("impact.entity").defines(function(){EntityButton=ig.Entity.extend({collides:ig.Entity.COLLIDES.NEVER,type:ig.Entity.TYPE.A,size:new BABYLON.Vector2(48,48),fillColor:null,zIndex:95E3,pos:{x:0,y:0},name:"button",init:function(b,c,e){this.parent(b,c,e);!ig.global.wm&&(e&&!isNaN(e.zIndex))&&(this.zIndex=e.zIndex);b=Math.floor(256*Math.random());c=Math.floor(256*Math.random());e=Math.floor(256*Math.random());this.fillColor="rgba("+b+","+e+","+c+",1)"},
clicked:function(){throw"no implementation on clicked()";},clicking:function(){throw"no implementation on clicking()";},released:function(){throw"no implementation on released()";}})});ig.baked=!0;
ig.module("plugins.clickable-div-layer").defines(function(){ClickableDivLayer=ig.Class.extend({pos:new BABYLON.Vector2(0,0),size:new BABYLON.Vector2(0,0),identifier:null,invisImagePath:"media/graphics/misc/invisible.png",init:function(b){this.pos=new BABYLON.Vector2(b.pos.x,b.pos.y);this.size=new BABYLON.Vector2(b.size.x,b.size.y);var c="more-games",e="www.google.com",d=!1;b.div_layer_name&&(c=b.div_layer_name);b.link&&(e=b.link);b.newWindow&&(d=b.newWindow);this.createClickableLayer(c,e,d)},createClickableLayer:function(b,
c,e){this.identifier=b;var d=ig.domHandler.getElementById("#"+b);d?(ig.domHandler.show(d),ig.domHandler.attr(d,"href",c)):this.createClickableOutboundLayer(b,c,this.invisImagePath,e)},update:function(b,c,e,d){this.pos.x==b&&this.pos.y==c||(this.pos.x=b,this.pos.y=c,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier]={},ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].width=e,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].height=d,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].entity_pos_x=
this.pos.x,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].entity_pos_y=this.pos.y,ig.sizeHandler.resizeLayers())},createClickableOutboundLayer:function(b,c,e,d){var j=ig.domHandler.create("div");ig.domHandler.attr(j,"id",b);var g=ig.domHandler.create("a");ig.domHandler.addEvent(j,"mousedown",function(b){b.preventDefault()});d?(ig.domHandler.attr(g,"href",c),ig.domHandler.attr(g,"target","_blank")):ig.domHandler.attr(g,"href",c);c=ig.domHandler.create("img");ig.domHandler.css(c,{width:"100%",
height:"100%"});ig.domHandler.attr(c,"src",e);e=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);if(ig.ua.mobile){d=Math.floor(this.pos.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px";var p=Math.floor(this.pos.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px",l=Math.floor(this.size.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px";e=Math.floor(this.size.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px"}else d=ig.domHandler.getElementById("#canvas"),d=ig.domHandler.getOffsets(d),
p=d.top,d=Math.floor(d.left+this.pos.x*e)+"px",p=Math.floor(p+this.pos.y*e)+"px",l=Math.floor(this.size.x*e)+"px",e=Math.floor(this.size.y*e)+"px";ig.domHandler.css(j,{"float":"left",position:"absolute",left:d,top:p,width:l,height:e,"z-index":3});ig.domHandler.addEvent(j,"mousemove",ig.input.mousemove.bind(ig.input),!1);ig.domHandler.appendChild(g,c);ig.domHandler.appendChild(j,g);ig.domHandler.appendToBody(j);ig.sizeHandler.dynamicClickableEntityDivs[b]={};ig.sizeHandler.dynamicClickableEntityDivs[b].width=
this.size.x;ig.sizeHandler.dynamicClickableEntityDivs[b].height=this.size.y;ig.sizeHandler.dynamicClickableEntityDivs[b].entity_pos_x=this.pos.x;ig.sizeHandler.dynamicClickableEntityDivs[b].entity_pos_y=this.pos.y}})});ig.baked=!0;
ig.module("game.entities.buttons.button-branding-logo").requires("game.entities.buttons.button","plugins.clickable-div-layer").defines(function(){EntityButtonBrandingLogo=EntityButton.extend({type:ig.Entity.TYPE.A,gravityFactor:0,logo:new ig.AnimationSheet("branding/logo.png",_SETTINGS.Branding.Logo.Width,_SETTINGS.Branding.Logo.Height),zIndex:10001,size:{x:64,y:66},clickableLayer:null,link:null,newWindow:!1,div_layer_name:"branding-logo",name:"brandinglogo",init:function(b,c,e){this.parent(b,c,e);
if(!ig.global.wm){ig.responsive&&(this.anchorType="default");if("undefined"==typeof wm)if(_SETTINGS.Branding.Logo.Enabled)this.size.x=_SETTINGS.Branding.Logo.Width,this.size.y=_SETTINGS.Branding.Logo.Height,this.anims.idle=new ig.Animation(this.logo,0,[0],!0),this.currentAnim=this.anims.idle,e&&e.centralize&&(this.pos.x=(ig.system.width>>>1)-(this.size.x>>>1),console.log("centralize true ... centering branded logo ...")),_SETTINGS.Branding.Logo.LinkEnabled&&(this.link=_SETTINGS.Branding.Logo.Link,
this.newWindow=_SETTINGS.Branding.Logo.NewWindow,this.clickableLayer=new ClickableDivLayer(this));else{this.kill();return}this.div_layer_name=e.div_layer_name?e.div_layer_name:"branding-logo"}},show:function(){var b=ig.domHandler.getElementById("#"+this.div_layer_name);ig.domHandler.show(b)},hide:function(){var b=ig.domHandler.getElementById("#"+this.div_layer_name);ig.domHandler.hide(b)},clicked:function(){},clicking:function(){},released:function(){}})});ig.baked=!0;
ig.module("game.entities.branding-logo-placeholder").requires("impact.entity","game.entities.buttons.button-branding-logo").defines(function(){EntityBrandingLogoPlaceholder=ig.Entity.extend({gravityFactor:0,size:{x:32,y:32},_wmDrawBox:!0,_wmBoxColor:"rgba(0, 0, 255, 0.7)",init:function(b,c,e){this.parent(b,c,e);ig.responsive&&(this.anchorType="default");if(e)switch(console.log("settings found ... using that div layer name"),b=e.div_layer_name,console.log("settings.centralize:",e.centralize),e.centralize){case "true":console.log("centralize true");
centralize=!0;break;case "false":console.log("centralize false");centralize=!1;break;default:console.log("default ... centralize false"),centralize=!1}else b="branding-logo",centralize=!1;if("undefined"==typeof wm){if(_SETTINGS.Branding.Logo.Enabled)try{ig.game.spawnEntity(EntityButtonBrandingLogo,this.pos.x,this.pos.y,{div_layer_name:b,centralize:centralize})}catch(d){console.log(d)}this.kill()}}})});ig.baked=!0;
ig.module("game.entities.buttons.button-more-games").requires("game.entities.buttons.button","plugins.clickable-div-layer").defines(function(){EntityButtonMoreGames=EntityButton.extend({type:ig.Entity.TYPE.A,gravityFactor:0,icon:new ig.Image("media/graphics/sprites/0_btn-moregames.png"),size:new BABYLON.Vector2(140,160),clickableLayer:null,link:null,newWindow:!1,div_layer_name:"more-games",name:"moregames",value:null,init:function(b,c,e){this.size=ig.ua.mobile?new BABYLON.Vector2(180,200):new BABYLON.Vector2(140,
160);this.parent(b,c,e);ig.global.wm||(this.div_layer_name=e.div_layer_name?e.div_layer_name:"more-games",_SETTINGS.MoreGames.Enabled?(_SETTINGS.MoreGames.Link&&(this.link=_SETTINGS.MoreGames.Link),_SETTINGS.MoreGames.NewWindow&&(this.newWindow=_SETTINGS.MoreGames.NewWindow),this.clickableLayer=new ClickableDivLayer(this)):this.kill(),ig.game.sortEntitiesDeferred())},draw:function(){this.parent();if(this.control.uiStatus){var b=ig.system.context;b.strokeStyle="rgba(0,0,0,1)";b.save();b.drawImage(this.icon.data,
0,0,this.icon.width,this.icon.height,this.pos.x,this.pos.y,this.size.x,this.size.y);b.restore()}},update:function(){this.parent();this.clickableLayer&&this.clickableLayer.update(this.pos.x,this.pos.y,this.size.x,this.size.y)},show:function(){var b=ig.domHandler.getElementById("#"+this.div_layer_name);b&&ig.domHandler.show(b)},hide:function(){var b=ig.domHandler.getElementById("#"+this.div_layer_name);b&&ig.domHandler.hide(b)},clicked:function(){ig.game.pausedStatus||ig.game.buttonSfx()},clicking:function(){},
released:function(){}})});ig.baked=!0;
ig.module("game.entities.pointer").requires("impact.entity").defines(function(){EntityPointer=ig.Entity.extend({checkAgainst:ig.Entity.TYPE.BOTH,size:new Vector2(1,1),isFirstPressed:!1,isPressed:!1,isReleased:!1,isHovering:!1,hoveringItem:null,objectArray:[],clickedObjectList:[],ignorePause:!0,zIndex:5500,name:"pointer",check:function(b){this.objectArray.push(b)},clickObject:function(b){this.isFirstPressed&&"function"==typeof b.clicked&&(b.clicked(),this.addToClickedObjectList(b));this.isPressed&&
!this.isReleased&&"function"==typeof b.clicking&&b.clicking();this.isReleased&&"function"==typeof b.released&&(b.released(),this.removeFromClickedObjectList(b))},refreshPos:function(){this.pos=ig.game.io.getClickPos()},update:function(){this.parent();this.refreshPos();var b=null,c=-1;for(a=this.objectArray.length-1;-1<a;a--)this.objectArray[a].zIndex>c&&(c=this.objectArray[a].zIndex,b=this.objectArray[a]);if(null!=b)null!=this.hoveringItem?this.hoveringItem!=b&&("function"==typeof this.hoveringItem.leave&&
this.hoveringItem.leave(),"function"==typeof b.over&&b.over()):"function"==typeof b.over&&b.over(),this.hoveringItem=b,this.clickObject(b),this.objectArray=[];else if(null!=this.hoveringItem&&"function"==typeof this.hoveringItem.leave&&(this.hoveringItem.leave(),this.hoveringItem=null),this.isReleased){for(b=0;b<this.clickedObjectList.length;b++)c=this.clickedObjectList[b],"function"==typeof c.releasedOutside&&c.releasedOutside();this.clickedObjectList=[]}this.isFirstPressed=ig.input.pressed("click");
this.isReleased=ig.input.released("click");this.isPressed=ig.input.state("click")},addToClickedObjectList:function(b){this.clickedObjectList.push(b)},removeFromClickedObjectList:function(b){for(var c=[],e=0;e<this.clickedObjectList.length;e++){var d=this.clickedObjectList[e];d!=b&&c.push(d)}this.clickedObjectList=c}})});ig.baked=!0;
ig.module("game.entities.pointer-selector").requires("game.entities.pointer").defines(function(){EntityPointerSelector=EntityPointer.extend({zIndex:1E3,_wmDrawBox:!0,_wmBoxColor:"rgba(0, 0, 255, 0.7)",size:{x:20,y:20},init:function(b,c,e){this.parent(b,c,e)}})});ig.baked=!0;
ig.module("game.entities.select").requires("impact.entity").defines(function(){EntitySelect=ig.Entity.extend({type:ig.Entity.TYPE.B,checkAgainst:ig.Entity.TYPE.A,collides:ig.Entity.COLLIDES.NEVER,canSelect:!1,canSelectTimerDuration:0.35,zIndex:99999,isHovering:!1,isSelected:!1,init:function(b,c,e){this.parent(b,c,e);this.canSelectTimer=new ig.Timer(this.canSelectTimerDuration)},doesClickableLayerExist:function(b){for(k in dynamicClickableEntityDivs)if(k==b)return!0;return!1},checkClickableLayer:function(b,
c,e){"undefined"==typeof wm&&(this.doesClickableLayerExist(b)?(ig.game.showOverlay([b]),$("#"+b).find("[href]").attr("href",c)):this.createClickableOutboundLayer(b,c,"media/graphics/misc/invisible.png",e))},createClickableOutboundLayer:function(b,c,e,d){var j=ig.$new("div");j.id=b;document.body.appendChild(j);$("#"+j.id).css("float","left");$("#"+j.id).css("width",this.size.x*multiplier);$("#"+j.id).css("height",this.size.y*multiplier);$("#"+j.id).css("position","absolute");var g=w/2-destW/2,p=h/
2-destH/2;w==mobileWidth?($("#"+j.id).css("left",this.pos.x),$("#"+j.id).css("top",this.pos.y)):($("#"+j.id).css("left",g+this.pos.x*multiplier),$("#"+j.id).css("top",p+this.pos.y*multiplier));d?$("#"+j.id).html("<a target='_blank' href='"+c+"'><img style='width:100%;height:100%' src='"+e+"'></a>"):$("#"+j.id).html("<a href='"+c+"'><img style='width:100%;height:100%' src='"+e+"'></a>");dynamicClickableEntityDivs[b]={};dynamicClickableEntityDivs[b].width=$("#"+j.id).width();dynamicClickableEntityDivs[b].height=
$("#"+j.id).height();dynamicClickableEntityDivs[b].entity_pos_x=this.pos.x;dynamicClickableEntityDivs[b].entity_pos_y=this.pos.y},hovered:function(){this.isHovering=!0;this.dehoverOthers()},dehoverOthers:function(){var b=ig.game.getEntitiesByType(EntitySelect);for(i=0;i<b.length;i++)b[i]!=this&&(b[i].isHovering=!1)},deselectOthers:function(){var b=ig.game.getEntitiesByType(EntitySelect);for(i=0;i<b.length;i++)b[i]!=this&&(b[i].isSelected=!1)},update:function(){this.parent();this.canSelectTimer&&0<
this.canSelectTimer.delta()&&(this.canSelect=!0,this.canSelectTimer=null)}})});ig.baked=!0;
ig.module("game.entities.buttons.button-start").requires("game.entities.buttons.button").defines(function(){EntityButtonStart=EntityButton.extend({type:ig.Entity.TYPE.A,gravityFactor:0,size:new BABYLON.Vector2(250,330),value:null,caption:"",offsetY:0,bgcolor:"#00cc44",fontcolor:"#ffffff",icon:new ig.Image("media/graphics/sprites/play.png"),init:function(b,c,e){this.size=ig.ua.mobile?new BABYLON.Vector2(500,660):new BABYLON.Vector2(250,330);this.parent(b,c,e);this.posx=this.pos.x-this.size.x/2;this.posy=
this.pos.y-this.size.y/2},update:function(){this.parent();this.control.uiStatus&&(this.pos.x=this.posx,this.pos.y=this.posy+this.offsetY,ig.input.pressed("SPACE")&&this.released())},draw:function(){this.parent();if(this.control.uiStatus){var b=ig.system.context;b.save();b.drawImage(this.icon.data,0,0,this.icon.width,this.icon.height,this.pos.x,this.pos.y,this.size.x,this.size.y);b.restore()}},clicked:function(){this.offsetY=5},clicking:function(){this.offsetY=5},released:function(){this.control.uiStatus&&
!ig.game.pausedStatus&&(this.offsetY=0,ig.game.buttonSfx(),this.control.startGameplay())},leave:function(){this.offsetY=0}})});ig.baked=!0;
ig.module("game.entities.plain").requires("impact.entity").defines(function(){EntityPlain=ig.Entity.extend({sc:{x:1,y:1},sheetX:1,sheetY:1,gravityFactor:0,clearColor:null,tweening:!1,which:0,size:{x:50,y:50},halfSize:{x:50,y:50},oriPos:{x:0,y:0},ctxRef:null,init:function(b,c,e){this.parent(b,c,e);ig.global.wm||(this.ctx=ig.system.context)},sounder:function(b){try{ig.soundHandler.sfxPlayer.play(b)}catch(c){console.log(c)}},setIdle:function(){this.animSheet=new ig.AnimationSheet(this.im.path,this.im.width/
this.sheetX,this.im.height/this.sheetY);this.addAnim("idle",0.03,[0],!0);this.currentAnim=this.anims.idle},abCheck:function(b){var c=ig.game.getEntitiesByType(EntityPointer)[0];return c.pos.x>b.pos.x&&c.pos.y>b.pos.y&&c.pos.x<b.pos.x+b.size.x&&c.pos.y<b.pos.y+b.size.y?!0:!1},setSize:function(){this.size.x=this.im.width/this.sheetX;this.size.y=this.im.height/this.sheetY},setSheet:function(){this.size.x=this.im.width/this.sheetX;this.size.y=this.im.height/this.sheetY;this.animSheet=new ig.AnimationSheet(this.im.path,
this.size.x,this.size.y)},getDistance:function(b,c){var e=b.x-c.x,d=b.y-c.y;return Math.sqrt(e*e+d*d)},getPos:function(){console.log(this.pointer.pos.x,this.pointer.pos.y)},posXY:function(b){b.pos.x=this.pointer.pos.x;b.pos.y=this.pointer.pos.y;console.log(this.pos.x,this.pos.y)},resetFrame:function(b){this[b].ended=!1;this[b].frame=0},runAnim:function(b){void 0==this[b]&&(this[b]={});this[b].ended=this[b].ended||!1;this[b].loop=this[b].loop||!1;this[b].frame=this[b].frame||0;this[b].frameTimer=this[b].frameTimer||
new ig.Timer;this[b].frameTime=this[b].frameTime||0.03;!0!=this[b].ended&&(!1==this[b].loop&&this[b].frame==this[b].frames.length-1?(this[b].ended=!0,this.done&&this.done(b)):1<this[b].frames.length&&this[b].frameTimer.delta()>this[b].frameTime&&(this[b].frameTimer.reset(),this[b].frame=(this[b].frame+1)%this[b].frames.length))},tweener:function(b,c,e,d,j){var g={};g[b]=c;null==j&&(j=0);null==d&&(d="none");this.tween("this"==b?c:g,e,{delay:j,targ:b,seq:d,onComplete:function(){null!=d&&this.tweenF(d,
b)}.bind(this),easing:ig.Tween.Easing.Quadratic.EaseOut}).start()},tweener2:function(b,c,e,d,j){var g={};g[b]=c;null==j&&(j=0);null==d&&(d="none");this.tween("this"==b?c:g,e,{delay:j,targ:b,seq:d,onComplete:function(){null!=d&&this.tweenF(d,b)}.bind(this),easing:ig.Tween.Easing.Linear.EaseNone}).start()},tweener3:function(b,c,e,d,j){var g={};g[b]=c;null==j&&(j=0);null==d&&(d="none");this.tween("this"==b?c:g,e,{delay:j,targ:b,seq:d,onComplete:function(){null!=d&&this.tweenF(d,b)}.bind(this),easing:ig.Tween.Easing.Elastic.EaseIn}).start()},
sizer:function(b,c,e,d,j,g,p,l){this.size.x=b.width/c*this.base.oriSc+(p||0);this.size.y=b.height/e*this.base.oriSc+(l||0);!0==g?(this.pos.x=d-this.size.x/2,this.pos.y=j-this.size.y/2):(this.pos.x=d,this.pos.y=j)},ctxDrawer:function(b){var c=b.ctx||ig.system.context,e=b.offX||0,d=b.offY||0,j=b.cent||!1,g=null==b.scX?1:b.scX,p=null==b.scY?1:b.scY,l=null==b.alp&&0!=b.alp?1:b.alp,f=null==b.rot?0:b.rot,m=b.sx,n=b.sy,r=b.sw,s=b.sh,t=r*g,u=s*p;if(!(0>=l))if(0<f||0>g||0>p){var v=b.x,z=b.y,e=j?-r/2+e:e||
0,d=j?-s/2+d:d||0;0<r&&0<s&&(c.save(),c.translate(v,z),c.scale(g,p),c.rotate(2*Math.PI/360*f),c.globalAlpha=l,c.drawImage(b.pic,m,n,r,s,e,d,r,s),c.restore())}else v=j?b.x-t/2+e:b.x+e,z=j?b.y-u/2+d:b.y+d,0<r&&0<s&&(c.globalAlpha=l,c.drawImage(b.pic,m,n,r,s,v,z,t,u),c.globalAlpha=1)},frameDrawer:function(b){var c=b.ctx||ig.system.context,e=b.offX||0,d=b.offY||0,j=b.cent||!1,g=null==b.scX?1:b.scX,p=null==b.scY?1:b.scY,l=null==b.alp&&0!=b.alp?1:b.alp,f=null==b.rot?0:b.rot,m=b.frame.x,n=b.frame.y,r=b.frame.w,
s=b.frame.h,t=r*g,u=s*p;if(!(0>=l))if(0<f||0>g||0>p){var v=b.x,z=b.y,e=j?-r/2+e:e||0,d=j?-s/2+d:d||0;0<r&&0<s&&(c.save(),c.translate(v,z),c.scale(g,p),c.rotate(2*Math.PI/360*f),c.globalAlpha=l,c.drawImage(b.pic,m,n,r,s,e,d,r,s),c.restore())}else v=j?b.x-t/2+e:b.x+e,z=j?b.y-u/2+d:b.y+d,0<r&&0<s&&(c.globalAlpha=l,c.drawImage(b.pic,m,n,r,s,v,z,t,u),c.globalAlpha=1)},quickDraw:function(b){!0==this[b].animate&&!1==this.main.gamePaused&&this.runAnim(b);this.drawer({pic:this[b].im,x:this[b].x,y:this[b].y,
frameX:this[b].frameX,frameY:this[b].frameY,frame:!1==this.checkFrame(b)?0:this[b].frames[this[b].frame],cent:this[b].cent,rot:void 0==this[b].rot?this.rot:this[b].rot,offX:this[b].off.x,offY:this[b].off.y,scX:this.scX*this[b].scX,scY:this.scY*this[b].scY})},drawer:function(b){var c=null==b.alp&&0!=b.alp?1:b.alp,e=null==b.scX?1:b.scX,d=null==b.scY?1:b.scY;if(!(0==c||0==e||0==d)){var j=b.ctx||ig.system.context,g=b.offX||0,p=b.offY||0,l=b.cent||!1,f=null==b.rot?0:b.rot,m=b.frameX||1,n=b.frameY||1,r=
b.frame||0,s=b.pic.width/m*(r%m),r=b.pic.height/n*Math.floor(r/m),t=b.pic.width/m,u=b.pic.height/n,m=b.pic.width/m*e,n=b.pic.height/n*d;0>=c||(m=l?b.x-m/2+g:b.x+g,l=l?b.y-n/2+p:b.y+p,0<t&&0<u&&(j.save(),j.translate(m,l),j.scale(e,d),j.rotate(b.rad?b.rad:2*Math.PI/360*f),j.globalAlpha=c,j.drawImage(b.pic.data,s,r,t,u,g,p,t,u),j.restore()))}},textSet:function(b,c,e,d){this.ctxRef=d=d||ig.system.context;d.font=b+"px "+(e||"patriot");d.fillStyle=c},textW:function(b){return this.ctxRef.measureText(b).width},
textMax:function(b){this.textSet(b.px,"white");return this.textW(b.tx)>b.maxWidth?b.maxWidth/this.textW(b.tx):1},textDraw:function(b){var c=b.rot?b.rot:0,e=b.tx?b.tx:0,d=b.x?b.x:0,j=b.y?b.y:0,g=void 0==b.scX?1:b.scX,p=void 0==b.scY?1:b.scY,l=b.stroke?b.stroke:!1,f=void 0==b.strokeAlp?1:b.strokeAlp,m=b.strokeColour?b.strokeColour:"black",n=void 0==b.alp?1:b.alp,r=b.col?b.col:this.ctx.fillStyle,s=b.font||"typo",t=b.px||10,u=b.strokeLine||3,v=b.align||"center";if(0!=n){var z=b.ctx||ig.system.context;
this.ctxRef=b.ctx||ig.system.context;z.font=t+"px "+s;void 0!=b.maxWidth&&this.textW(e)>b.maxWidth&&(t=Math.floor(b.maxWidth/this.textW(e)*t),z.font=t+"px "+s);"left"==v?d+=0.5*this.textW(e)*g:"right"==v&&(d-=0.5*this.textW(e)*g);z.save();b=z.measureText("M").width*p;z.translate(d,j+b/2);z.scale(g,p);z.rotate(c?2*Math.PI/360*c:0);z.fillStyle=r;!0==l&&(z.globalAlpha=f,z.lineWidth=u,z.lineCap="round",z.strokeStyle=m,z.strokeText(e,-this.textW(e)/2,0));z.globalAlpha=n;z.fillText(e,-this.textW(e)/2,0);
z.restore()}},checkStorage:function(){try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),"localStorage"in window&&null!==window.localStorage}catch(b){return!1}},shuffleArray:function(b){for(var c=b.length,e,d;0<c;)d=Math.floor(Math.random()*c),c--,e=b[c],b[c]=b[d],b[d]=e;return b}})});ig.baked=!0;
ig.module("game.entities.gui").requires("game.entities.plain").defines(function(){EntityGui=EntityPlain.extend({size:{x:40,y:40},pos:{x:1,y:1},zIndex:10,comboOffX:0,comboAlp:0,scoreSc:1,scoreAlp:0,bestAlp:0,rainbowLetters:[],stackerLetters:[],rainbow0:{},rainbow1:{},rainbow2:{},rainbow3:{},rainbow4:{},rainbow5:{},rainbow6:{},titleTurnIndex:0,titleAlp:1,rainbowX:[33*1.6,102*1.6,248,332.8,277*1.6,555.2,688],stackerX:[11,79,151,220,293,365,435],rainbowWidth:477,init:function(b,c,e){this.parent(b,c,e);
ig.global.wm||(this.ctx=ig.system.context,this.processText(),this.tweenF("turnLetter0"))},updatePosition:function(){this.rainbowStart=ig.system.width/2-this.rainbowWidth/2;this.stackerStart=ig.system.width/2-0.95*(this.rainbowWidth/2)},processText:function(){this.rainbowText="RAINBOW";this.stackerText="STACKER";this.rainbowWidth=763.2;this.rainbowStart=ig.system.width/2-this.rainbowWidth/2;for(var b=this.rainbowText.split(""),c=0;c<b.length;c++)this["rainbow"+c]={tx:b[c],x:this.rainbowX[c],offX:0,
scX:1,scY:1,h:360*(c/7)},this.rainbowLetters.push(this["rainbow"+c]);this.textSet(40,"white");this.stackerWidth=179;b=this.stackerText.split("");this.stackerGap=Math.floor((0.95*this.rainbowWidth-this.stackerWidth)/(this.stackerText.length-1));this.stackerStart=ig.system.width/2-0.95*(this.rainbowWidth/2);for(c=0;c<b.length;c++)this.stackerLetters.push({tx:b[c],x:1.6*this.stackerX[c],offX:0,scX:1.6,scY:1.6,alp:this.titleAlp})},tweenF:function(b){switch(b){case "combo":this.comboAlp=1;this.comboOffX=
0;this.tweener("this",{comboAlp:0,comboOffX:-30},0.1,"combo3",0.3);break;case "combo3":this.main.score+=this.main.combo;this.tweener("this",{scoreSc:1.2},0.1,"combo4");break;case "combo4":this.tweener("this",{scoreSc:1},0.2);break;case "best":this.tweener("this",{bestAlp:1},0.2);break;case "score":this.tweener("this",{scoreAlp:1},0.3);break;case "turnLetter0":this.tweener("rainbow"+this.titleTurnIndex,{scX:-1},0.2,"turnLetter1");break;case "turnLetter1":this.tweener("rainbow"+this.titleTurnIndex,
{scX:1},0.3,"turnLetter2",0.2);break;case "turnLetter2":b=Math.floor(7*Math.random());this.titleTurnIndex=this.titleTurnIndex==b?(this.titleTurnIndex+2)%7:b%7;this.tweenF("turnLetter0");break;case "fadeOutTitle":this.tweener("this",{titleAlp:0},0.4,"startGame");break;case "startGame":this.tweenF("score"),this.main.startGame()}},update:function(){this.parent();this.updatePosition()},drawTitle:function(){for(var b=0;7>b;b++)this.textDraw({tx:this.rainbowLetters[b].tx,px:120,x:this.rainbowStart+this.rainbowLetters[b].x,
y:0.24*ig.system.height,col:"hsl("+this.rainbowLetters[b].h+",80%,80%)",alp:this.titleAlp,scX:1.6*this.rainbowLetters[b].scX,scY:1.36});for(b=0;7>b;b++)this.textDraw({tx:this.stackerLetters[b].tx,px:100,x:this.stackerStart+this.stackerLetters[b].x,y:ig.ua.mobile?0.24*ig.system.height+130:0.31*ig.system.height,col:"white",alp:this.titleAlp})},draw:function(){this.parent();this.control.uiStatus&&(ig.global.wm||this.drawTitle())}})});ig.baked=!0;
ig.module("game.entities.objects.stars").requires("impact.entity").defines(function(){EntityStars=ig.Entity.extend({size:{x:14,y:14},size2:{x:14,y:14},scale:1,alpha:0.4,init:function(b,c,e){this.parent(b,c,e);this.posx=this.pos.x-this.size.x/2;this.posy=this.pos.y-this.size.y/2;this.color=this.control.baseColor;ig.ua.mobile?(this.hightargetScale=2,this.lowtargetScale=0.6):(this.hightargetScale=1.2,this.lowtargetScale=0.4);this.startRoling()},startRoling:function(){var b={r:0};this.angle=0;this.rotate=
(new ig.TweenDef(b)).to({r:360},1E4).onUpdate(function(b){this.angle=b.r.toRad()}.bind(this)).onComplete(function(){}.bind(this)).easing(ig.Tween.Easing.Linear.EaseNone);this.rotate.start();b={s:0.5,a:0.1};this.scale=0.6;this.scale1=(new ig.TweenDef(b)).to({s:this.hightargetScale,a:0.8},3E3).onUpdate(function(b){this.scale=b.s;this.alpha=b.a}.bind(this)).onComplete(function(){}.bind(this)).easing(ig.Tween.Easing.Linear.EaseNone);this.scale2=(new ig.TweenDef(b)).to({s:this.hightargetScale,a:0.8},4E3).onUpdate(function(b){this.scale=
b.s;this.alpha=b.a}.bind(this)).onComplete(function(){}.bind(this)).easing(ig.Tween.Easing.Linear.EaseNone);this.scale3=(new ig.TweenDef(b)).to({s:this.lowtargetScale,a:0},3E3).onUpdate(function(b){this.scale=b.s;this.alpha=b.a}.bind(this)).onComplete(function(){this.kill()}.bind(this)).easing(ig.Tween.Easing.Linear.EaseNone);this.scale1.chain(this.scale2);this.scale2.chain(this.scale3);this.scale1.start();b={y:this.posy};this.moveY=(new ig.TweenDef(b)).to({y:this.posy-400},1E4).onUpdate(function(b){this.posy=
b.y}.bind(this)).onComplete(function(){}.bind(this)).easing(ig.Tween.Easing.Linear.EaseNone);this.moveY.start()},update:function(){this.parent();this.pos.x=this.posx;this.pos.y=this.posy;this.size2.x=this.size.x*this.scale;this.size2.y=this.size.y*this.scale},draw:function(){this.parent();var b=ig.system.context;b.save();b.translate(this.pos.x+this.size2.x/2,this.pos.y+this.size2.y/2);b.rotate(this.angle);b.translate(-this.pos.x-this.size2.x/2,-this.pos.y-this.size2.y/2);b.lineWidth=8;b.strokeStyle=
"rgba(255,255,255,0.2)";b.strokeRect(this.pos.x-0.6*this.size2.x,this.pos.y-0.6*this.size2.y,this.size2.x+1.2*this.size2.x,this.size2.y+1.2*this.size2.y);var c=Math.floor(255*this.color.r)+70,e=Math.floor(255*this.color.g)+70,d=Math.floor(255*this.color.b)+70;b.fillStyle="rgba("+c+","+e+","+d+","+this.alpha+")";b.fillRect(this.pos.x-0.3*this.size2.x,this.pos.y-0.3*this.size2.y,this.size2.x+0.6*this.size2.x,this.size2.y+0.6*this.size2.y);b.fillStyle="rgba("+c+","+e+","+d+","+(this.alpha+0.2)+")";b.fillRect(this.pos.x,
this.pos.y,this.size2.x,this.size2.y);b.restore()}})});ig.baked=!0;
ig.module("game.entities.buttons.button-replay").requires("game.entities.buttons.button").defines(function(){EntityButtonReplay=EntityButton.extend({type:ig.Entity.TYPE.A,gravityFactor:0,size:new BABYLON.Vector2(220,280),offsetY:0,bgImg:new ig.Image("media/graphics/sprites/replay.png"),init:function(b,c,e){this.size=ig.ua.mobile?new BABYLON.Vector2(440,560):new BABYLON.Vector2(220,280);this.parent(b,c,e);this.posx=this.pos.x-this.size.x/2;this.posy=this.pos.y-this.size.y/2;ig.game.sortEntitiesDeferred()},
update:function(){this.parent();ig.input.pressed("SPACE")&&this.released();this.pos.x=this.posx;this.pos.y=this.posy+this.offsetY},draw:function(){this.parent();ig.system.context.drawImage(this.bgImg.data,0,0,this.bgImg.width,this.bgImg.height,this.pos.x,this.pos.y,this.size.x,this.size.y)},clicked:function(){this.offsetY=5},clicking:function(){this.offsetY=5},released:function(){this.offsetY=0;ig.game.buttonSfx();this.control.goHome()},leave:function(){this.offsetY=0}})});ig.baked=!0;
ig.module("game.entities.buttons.button-mute").requires("game.entities.buttons.button").defines(function(){EntityButtonMute=EntityButton.extend({type:ig.Entity.TYPE.A,gravityFactor:0,size:new BABYLON.Vector2(120,120),value:null,caption:"",offsetY:0,bgcolor:"#0033cc",fontcolor:"#ffffff",icon1:new ig.Image("media/graphics/sprites/btn-volume-on.png"),icon2:new ig.Image("media/graphics/sprites/btn-volume-off.png"),currentActive:0,init:function(b,c,e){this.size=ig.ua.mobile?new BABYLON.Vector2(200,200):
new BABYLON.Vector2(120,120);this.parent(b,c,e);this.posx=this.pos.x-this.size.x/2;this.posy=this.pos.y-this.size.y/2;ig.game.sortEntitiesDeferred();this.setData()},setData:function(){this.music=ig.game.load("music");this.sound=ig.game.load("sound");ig.soundHandler.bgmPlayer.volume(this.music);ig.soundHandler.sfxPlayer.volume(this.sound);this.currentActive=1==this.music||1==this.sound?0:1},update:function(){this.parent();this.control.uiStatus&&(this.pos.x=this.posx,this.pos.y=this.posy+this.offsetY)},
draw:function(){this.parent();var b=ig.system.context;this.control.uiStatus&&(0==this.currentActive?(b.save(),b.drawImage(this.icon1.data,0,0,this.icon1.width,this.icon1.height,this.pos.x,this.pos.y,1*this.size.x,1*this.size.y)):(b.save(),b.drawImage(this.icon2.data,0,0,this.icon2.width,this.icon2.height,this.pos.x,this.pos.y,1.05*this.size.x,this.size.y)),b.restore())},clicked:function(){this.control.uiStatus&&!ig.game.pausedStatus&&(this.offsetY=5)},clicking:function(){this.control.uiStatus&&!ig.game.pausedStatus&&
(this.offsetY=5)},released:function(){this.offsetY=0;this.control.uiStatus&&(0==this.currentActive?(ig.game.save("music",0),ig.game.save("sound",0),this.setData(),this.currentActive=1):(ig.game.save("music",1),ig.game.save("sound",1),this.setData(),this.currentActive=0),ig.game.buttonSfx())},leave:function(){this.offsetY=0}})});ig.baked=!0;
ig.module("game.entities.controllers.controller").requires("impact.entity","game.entities.buttons.button-start","game.entities.buttons.button-more-games","game.entities.gui","game.entities.objects.stars","game.entities.buttons.button-replay","game.entities.buttons.button-mute").defines(function(){EntityController=ig.Entity.extend({wglControllerName:"gameScene",uiStatus:!0,collides:ig.Entity.COLLIDES.NEVER,type:ig.Entity.TYPE.A,zIndex:0,zIndexFake:1,child:null,childOrigin:1,score:0,bestScore:0,bonus:0,
bonusAlpha:0,bonusText:"",bonusScale:0,gameOver:!1,scoreAlpha:0,scoreLiveAlpha:0,animbtPlay:!0,animbtreplay:!0,starsItem:[],splitBox:!1,baseColor:{r:0.2,g:0.6,b:0.2},combo:0,h:250,s:35,l:50,disabledClick:!1,drawBonusStatus:null,resizeStatus:!1,boxHeight:0.2,boxWidth:1,camSpeed:0.8/60,deviation:0.05,blockSpeed:-2/60,fallingSpeed:2/60,currentDirection:"z",stackLength:1,started:!1,over:!1,fallingBoxes:[],camPosY:0,box2List:[],currentCombo:0,maxCombo:0,init:function(b,c,e){this.size=new BABYLON.Vector2(ig.system.width,
ig.system.height);this.parent(b,c,e);this.h=Math.floor(360*Math.random());this.nextColor();this.bestScore=ig.game.load("score");ig.game.pausedStatus=!1;ig.game.gameOver=!1;this.initButton();this.initStars();this.initLight();wgl.system.startRender();this.wglController=ig[this.wglControllerName];this.gui=ig.game.spawnEntity(EntityGui,0,0,{main:this,control:this});this.camera=this.wglController.camera;this.camera.position.y=7;b=new BABYLON.Vector3(0,0,0);this.camera.setTarget(b);this.addFirstBlock();
this.spawnMainbox();ig.input.bind(ig.KEY.SPACE,"SPACE");b=new BABYLON.CannonJSPlugin;b.world.gravity=new BABYLON.Vector3(0,-6,0);wgl.game.currentScene.enablePhysics(new BABYLON.Vector3(0,-6,0),b);ig.game.sortEntitiesDeferred()},spawnMainbox:function(){var b=wgl.game.currentScene;this.mainbox=BABYLON.MeshBuilder.CreateBox("bigbox",{width:1,depth:1,height:2},b);this.mainbox.position=new BABYLON.Vector3(0,-1.1,0);this.meshPosition=this.mainbox.position;this.mainbox.checkCollisions=!0;var c=new BABYLON.StandardMaterial("boxMaterial",
b);c.albedoColor=new BABYLON.Color3(this.baseColor.r,this.baseColor.g,this.baseColor.b);c.emissiveTexture=c.albedoTexture;c.emissiveColor=c.albedoColor;c.emissiveIntensity=1;c.alpha=1;this.mainbox.material=c;this.mainbox.physicsImpostor=new BABYLON.PhysicsImpostor(this.mainbox,BABYLON.PhysicsImpostor.BoxImpostor,{mass:0,restitution:0.2,friction:0.2},b)},addFirstBlock:function(){this.lastBlock=BABYLON.MeshBuilder.CreateBox("box"+this.stackLength,{width:this.boxWidth,height:this.boxHeight,depth:this.boxWidth},
wgl.scene);var b=new BABYLON.StandardMaterial("boxMat"+this.stackLength);b.albedoColor=this.baseColor;b.emissiveTexture=b.albedoTexture;b.emissiveColor=b.albedoColor;b.emissiveIntensity=1;this.lastBlock.material=b;this.mergeMesh(this.lastBlock)},addBlock:function(){this.nextColor();this.stackLength++;this.currentBlock=this.lastBlock.clone();var b=new BABYLON.StandardMaterial("boxMat"+this.stackLength);b.albedoColor=this.baseColor;b.emissiveTexture=b.albedoTexture;b.emissiveColor=b.albedoColor;b.emissiveIntensity=
1;this.currentBlock.material=b;this.currentBlock.position[this.currentDirection]="z"==this.currentDirection?2-this.deviation:-2+this.deviation;this.currentBlock.position.y+=this.boxHeight},moveDown:function(){this.score+=2;this.camPosY+=0.2;this.move=(new ig.TweenDef({y:this.camera.position.y})).to({y:this.camera.position.y+0.2},300).onUpdate(function(b){this.camera.position.y=b.y}.bind(this)).onComplete(function(){}.bind(this)).easing(ig.Tween.Easing.Linear.EaseNone);this.move.start()},perfectAnim:function(){this.addBonus();
this.perfectBox=this.currentBlock.clone();var b=new BABYLON.StandardMaterial("boxPerfectMaterial"+this.stackLength);b.albedoColor=this.baseColor;b.emissiveTexture=b.albedoTexture;b.emissiveColor=b.albedoColor;b.emissiveIntensity=1;this.perfectBox.material=b;this.mergeMesh(this.perfectBox);this.bonusbox=this.currentBlock.clone();b=new BABYLON.StandardMaterial("bonusMaterial"+this.stackLength);b.albedoColor=new BABYLON.Color3(1,1,1);b.emissiveTexture=b.albedoTexture;b.emissiveColor=b.albedoColor;b.emissiveIntensity=
1;this.bonusbox.material=b;this.bonusbox.scaling.y=0.01;this.bonusbox.position.y-=0.1;scale=(new ig.TweenDef({x:this.lastBlock.scaling.x,y:0.011,z:this.lastBlock.scaling.z,a:1,posY:-0.15})).to({x:2*this.lastBlock.scaling.x,y:0.01,z:2*this.lastBlock.scaling.z,a:0},300).onUpdate(function(b){this.bonusbox.scaling.x=b.x;this.bonusbox.scaling.y=b.y;this.bonusbox.scaling.z=b.z;this.bonusbox.material.alpha=b.a}.bind(this)).onComplete(function(){setTimeout(function(){this.bonusbox.dispose()}.bind(this),300)}.bind(this)).easing(ig.Tween.Easing.Quadratic.EaseInOut);
scale.start()},checkOverlap:function(){var b=wgl.game.currentScene,c=new BABYLON.CannonJSPlugin;b.enablePhysics(new BABYLON.Vector3(0,-1,0),c);var c=this.lastBlock.position[this.currentDirection]-this.currentBlock.position[this.currentDirection],e=Math.abs(c),d=this.lastBlock.scaling[this.currentDirection];if(e>d-this.deviation)this.gameOverAnim();else{if(e<this.deviation)this.currentBlock.position[this.currentDirection]=this.lastBlock.position[this.currentDirection],this.perfectAnim();else{this.currentCombo=
0;var d=d-e,j=this.currentBlock.clone(),g=new BABYLON.StandardMaterial("fallBoxMaterial"+this.stackLength);g.albedoColor=this.baseColor;g.emissiveTexture=g.albedoTexture;g.emissiveColor=g.albedoColor;g.emissiveIntensity=1;j.material=g;var p=g=0;"z"==this.currentDirection&&0>c?(g=-0.02,p=1):"z"==this.currentDirection&&0<c?(g=0.02,p=2):"x"==this.currentDirection&&0<c?(g=0.02,p=3):"x"==this.currentDirection&&0>c&&(g=-0.02,p=4);j.scaling[this.currentDirection]=e;j.position[this.currentDirection]-=c/e*
d/2+g;j.physicsImpostor=new BABYLON.PhysicsImpostor(j,BABYLON.PhysicsImpostor.BoxImpostor,{mass:1,restitution:0.2,friction:0.2},b);this.fallingBoxes.push(j);this.rotateFallingBox(j,p);this.currentBlock.scaling[this.currentDirection]=d;this.currentBlock.position[this.currentDirection]+=c/2}this.currentDirection="x"==this.currentDirection?"z":"x";this.lastBlock=this.currentBlock;this.mergeMesh(this.lastBlock);this.addBlock();this.moveDown()}},fallPosY:0,rotateFallingBox:function(b,c){var e={rx:b.rotation.x,
ry:b.rotation.y,rz:b.rotation.z,y:b.position.y,a:1};if(1==c)var d=ig.game.randomIntFromInterval(30,90),j=b.rotation.z;else 2==c?(d=-ig.game.randomIntFromInterval(30,90),j=b.rotation.z):3==c?(d=b.rotation.x,j=ig.game.randomIntFromInterval(30,90)):4==c&&(d=b.rotation.x,j=-ig.game.randomIntFromInterval(30,90));d=(new ig.TweenDef(e)).to({rx:d,rz:j,y:b.position.y-1},200).onUpdate(function(c){b&&b.physicsImpostor&&b.physicsImpostor.setAngularVelocity(new BABYLON.Quaternion(c.rx.toRad(),0,c.rz.toRad(),0))}.bind(this)).onComplete(function(){}.bind(this)).easing(ig.Tween.Easing.Linear.EaseNone);
j=(new ig.TweenDef(e)).to({},800).onUpdate(function(){}.bind(this)).onComplete(function(){}.bind(this)).easing(ig.Tween.Easing.Linear.EaseNone);e=(new ig.TweenDef(e)).to({a:0},200).onUpdate(function(c){b.material.alpha=c.a}.bind(this)).onComplete(function(){b.dispose()}.bind(this)).easing(ig.Tween.Easing.Linear.EaseNone);d.start();d.chain(j);j.chain(e)},mergeMesh:function(b){var c=wgl.game.currentScene;this.box2List.push(b);if(20<this.box2List.length)for(b=0;b<this.box2List.length-20;b++)if(null!=
this.box2List[b]){c.getMeshByName("bigbox");var e=[c.getMeshByName("bigbox"),this.box2List[b]];BABYLON.Mesh.MergeMeshes(e,!0,!0,void 0,!1,!0).name="bigbox";this.box2List[b].dispose();this.box2List[b]=null}if(1<this.box2List.length)for(b=this.box2List.length-2;b<this.box2List.length-1;b++)null!=this.box2List[b]&&(this.box2List[b].physicsImpostor=new BABYLON.PhysicsImpostor(this.box2List[b],BABYLON.PhysicsImpostor.BoxImpostor,{mass:0,restitution:0.2,friction:0.2},c))},nextColor:function(){this.h=(this.h+
10)%360;this.rgb=this.hslToRgb(this.h/360,this.s/100,this.l/100);this.baseColor={r:this.rgb.r/255,g:this.rgb.g/255,b:this.rgb.b/255}},initLight:function(){var b=wgl.game.currentScene;this.light1=new BABYLON.HemisphericLight("light1",new BABYLON.Vector3(2,0,0),b);this.light1.intensity=0.1;this.light2=new BABYLON.HemisphericLight("light2",new BABYLON.Vector3(0,0,2),b);this.light2.intensity=0.2},initStars:function(){if(!this.gameOver){for(i=0;4>=i;i++)this.starsItem.push(setTimeout(function(){this.createStars()}.bind(this),
2E3*i));setTimeout(function(){this.initStars()}.bind(this),15E3)}},createStars:function(){var b=[];b.push(ig.game.randomIntFromInterval(200,Math.floor(ig.system.width/2-200)));b.push(ig.game.randomIntFromInterval(Math.floor(ig.system.width/2+200),Math.floor(ig.system.width)-200));b.push(ig.game.randomIntFromInterval(Math.floor(ig.system.width/2-200),Math.floor(ig.system.width/2+200)));var c=ig.game.randomIntFromInterval(0,2),b=b[c],c=2==c?ig.game.randomIntFromInterval(100,Math.floor(ig.system.height/
2)-200):ig.game.randomIntFromInterval(100,Math.floor(ig.system.height)-20);ig.game.spawnEntity(EntityStars,b,c,{control:this,zIndex:this.zIndexFake+1})},initButton:function(){var b=ig.responsive.toAnchor(0,460,"center-middle");this.btstart=ig.game.spawnEntity(EntityButtonStart,b.x,b.y+ig.system.height/2,{control:this,zIndex:this.zIndexFake+2});b=ig.responsive.toAnchor(10,10,"top-left");this.btmute=ig.game.spawnEntity(EntityButtonMute,b.x+200,b.y+400,{control:this,zIndex:this.zIndexFake+2});b=ig.responsive.toAnchor(-200,
10,"top-right");_SETTINGS.MoreGames.Enabled&&(this.btmoregames=ig.game.spawnEntity(EntityButtonMoreGames,b.x-200,b.y,{control:this,zIndex:this.zIndexFake+2}));this.btfullscreen=ig.game.spawnEntity(ig.FullscreenButton,b.x,b.y,{control:this});b=ig.responsive.toAnchor(0,370,"center-middle").y-this.btstart.size.y/2;this.movebtplay=(new ig.TweenDef({y:this.btstart.pos.y})).to({y:b},500).onUpdate(function(b){this.btstart.posy=b.y}.bind(this)).onComplete(function(){this.animbtPlay=!1}.bind(this)).easing(ig.Tween.Easing.Linear.EaseNone);
this.movebtplay.start()},showUI:function(){this.uiStatus=!1;this.initButton()},hideUI:function(){this.uiStatus=!1;this.btstart.kill();this.btmute.kill();this.btfullscreen.kill();this.btmoregames&&(this.btmoregames.hide(),this.btmoregames.kill())},goHome:function(){for(var b=0;b<this.box2List.length;b++)this.box2List[b]&&this.box2List[b].dispose();for(b=0;b<this.fallingBoxes.length;b++)this.fallingBoxes[b]&&this.fallingBoxes[b].dispose();(b=wgl.game.currentScene.getMeshByName("bigbox"))&&b.dispose();
this.light1.dispose();this.light2.dispose();this.scoreLiveAlpha=0;this.camera.position.y=7;this.camera.fov=0.4;ig.game.director.loadLevel(1)},startGameplay:function(){this.animbtPlay||(this.scoreLiveAlpha=1,this.hideUI(),this.addBlock())},updatePosition:function(){if(this.btstart&&!this.animbtPlay){var b=ig.responsive.toAnchor(0,370,"center-middle");this.btstart.posx=b.x-this.btstart.size.x/2;this.btstart.posy=b.y-this.btstart.size.y/2}this.btreplay&&!this.animbtreplay&&(b=ig.responsive.toAnchor(0,
380,"center-middle"),this.btreplay.posx=b.x-this.btreplay.size.x/2,this.btreplay.posy=b.y-this.btreplay.size.y/2);this.btmoregames&&(b=ig.ua.mobile?ig.ua.iOS?ig.responsive.toAnchor(-220,40,"top-right"):ig.responsive.toAnchor(-460,40,"top-right"):ig.responsive.toAnchor(-360,40,"top-right"),this.btmoregames.pos.x=b.x,this.btmoregames.pos.y=b.y);this.btmute&&(b=ig.responsive.toAnchor(40,30,"top-left"),this.btmute.posx=b.x,this.btmute.posy=b.y);this.btfullscreen&&(b=ig.ua.mobile?ig.responsive.toAnchor(-220,
40,"top-right"):ig.responsive.toAnchor(-180,40,"top-right"),this.btfullscreen.pos.x=b.x,this.btfullscreen.pos.y=b.y);this.resize()},resize:function(){this.resizeStatus||(this.resizeStatus=!0,this.size=new BABYLON.Vector2(ig.system.width,ig.system.height),setTimeout(function(){this.resizeStatus=!1}.bind(this),1E3))},update:function(){this.parent();ig.input.pressed("SPACE")&&this.clicked();this.currentBlock&&(this.currentBlock.position[this.currentDirection]+=this.blockSpeed,2<this.currentBlock.position[this.currentDirection]&&
(this.blockSpeed*=-1),-2>this.currentBlock.position[this.currentDirection]&&(this.blockSpeed*=-1));this.updatePosition()},clicked:function(){this.uiStatus||this.gameOver||this.splitBox||this.disabledClick||this.checkOverlap()},clicking:function(){},released:function(){},gameOverAnim:function(){var b={x:this.currentBlock.position.x,y:this.currentBlock.position.y,z:this.currentBlock.position.z,rx:this.currentBlock.rotation.x,ry:this.currentBlock.rotation.y,rz:this.currentBlock.rotation.z,a:1};this.disapear=
(new ig.TweenDef(b)).to({x:-45,y:2,z:40,a:0,rx:ig.game.randomIntFromInterval(0,360),ry:ig.game.randomIntFromInterval(0,360),rz:ig.game.randomIntFromInterval(0,360)},1E3).onUpdate(function(b){this.currentBlock.position.x=b.x;this.currentBlock.position.y=b.y;this.currentBlock.position.z=b.z;this.currentBlock.rotation.x=b.rx.toRad();this.currentBlock.rotation.z=b.rz.toRad();this.currentBlock.material.alpha=b.a}.bind(this)).onComplete(function(){this.currentBlock.dispose()}.bind(this)).easing(ig.Tween.Easing.Linear.EaseNone);
this.disapear.start();this.bestScore<this.score&&(this.bestScore=this.score,ig.game.save("score",this.score));this.gameOver=!0;b={a:0};this.scoreShow=(new ig.TweenDef(b)).to({a:1},800).onUpdate(function(b){this.scoreAlpha=b.a}.bind(this)).onComplete(function(){this.mainboxMoveBack()}.bind(this)).easing(ig.Tween.Easing.Linear.EaseNone);this.scoreShow.start();ig.game.playSfx("gameover")},mainboxMoveBack:function(){move=(new ig.TweenDef({y:this.camera.position.y,p:0.4})).to({y:7+this.camPosY/2,p:0.8},
500).onUpdate(function(b){this.camera.position.y=b.y;this.camera.fov=b.p}.bind(this)).onComplete(function(){this.spawnReplayButton()}.bind(this)).easing(ig.Tween.Easing.Cubic.EaseInOut);move.start()},spawnReplayButton:function(){var b=ig.responsive.toAnchor(0,380,"center-middle");this.btreplay=ig.game.spawnEntity(EntityButtonReplay,b.x,b.y+ig.system.height/2,{control:this,zIndex:this.zIndex+1});b=ig.responsive.toAnchor(0,380,"center-middle").y-this.btreplay.size.y/2;this.movebtreplay=(new ig.TweenDef({y:this.btreplay.pos.y})).to({y:b},
500).onUpdate(function(b){this.btreplay.posy=b.y}.bind(this)).onComplete(function(){this.animbtreplay=!1}.bind(this)).easing(ig.Tween.Easing.Linear.EaseNone);this.movebtreplay.start()},addBonus:function(){this.bonusAlpha=1;scale=(new ig.TweenDef({s:0})).to({s:1},200).onUpdate(function(b){this.bonusScale=b.s}.bind(this)).onComplete(function(){}.bind(this)).easing(ig.Tween.Easing.Cubic.EaseInOut);scale.start();this.combo+=1;this.currentCombo+=1;1==this.currentCombo?(ig.game.playSfx("combo1"),this.score+=
2,this.bonusText=_STRINGS.Game.Combo+" +2"):2==this.currentCombo?(ig.game.playSfx("combo2"),this.score+=4,this.bonusText=_STRINGS.Game.Combo+" +4"):3==this.currentCombo?(ig.game.playSfx("combo3"),this.score+=8,this.bonusText=_STRINGS.Game.Combo+" +8"):4==this.currentCombo?(ig.game.playSfx("combo4"),this.score+=16,this.bonusText=_STRINGS.Game.Perfect+" +16"):5<=this.currentCombo&&(ig.game.playSfx("combo5"),this.score+=Math.pow(2,this.currentCombo),this.bonusText=_STRINGS.Game.Perfect+" +"+Math.pow(2,
this.currentCombo));this.maxCombo<this.currentCombo&&(this.maxCombo=this.currentCombo);clearTimeout(this.drawBonusStatus);this.drawBonusStatus=setTimeout(function(){this.bonusAlpha=0}.bind(this),2E3)},hslToRgb:function(b,c,e){if(0==c)e=c=b=e;else{var d=function(b,c,d){0>d&&(d+=1);1<d&&(d-=1);return d<1/6?b+6*(c-b)*d:0.5>d?c:d<2/3?b+6*(c-b)*(2/3-d):b},j=0.5>e?e*(1+c):e+c-e*c,g=2*e-j;e=d(g,j,b+1/3);c=d(g,j,b);b=d(g,j,b-1/3)}return{r:Math.round(255*e),g:Math.round(255*c),b:Math.round(255*b)}},draw:function(){this.parent();
this.ctx=ig.system.context;this.ctx.clearRect(0,0,ig.system.width,ig.system.height);this.gameOver?ig.ua.mobile?this.drawGameOverScoreMobile():this.drawGameOverScore():ig.ua.mobile?(this.drawLiveScoreMobile(),0<this.bonusAlpha&&this.drawBonusMobile()):(this.drawLiveScore(),0<this.bonusAlpha&&this.drawBonus())},drawGameOverScore:function(){this.ctx.save();var b=ig.responsive.toAnchor(0,-490,"center-middle");this.ctx.fillStyle="#101010";this.ctx.globalAlpha=0.5;ig.game.roundRect(this.ctx,b.x-250,b.y-
200,500,370,40,!0,!1);this.ctx.restore();this.ctx.save();this.ctx.globalAlpha=this.scoreAlpha;this.ctx.textAlign="center";b=ig.responsive.toAnchor(0,-450,"center-middle");this.ctx.font="50px typo";this.ctx.fillStyle="#ffffff";this.ctx.fillText(_STRINGS.Game.MaxCombo+" "+this.maxCombo,b.x,b.y-160);this.ctx.font="180px typo";this.ctx.fillStyle="#ffffff";this.ctx.fillText(this.score,b.x,b.y);this.ctx.font="60px typo";this.ctx.fillText(_STRINGS.Game.BestScore+" "+this.bestScore,b.x,b.y+90);this.ctx.restore()},
drawGameOverScoreMobile:function(){this.ctx.save();var b=ig.responsive.toAnchor(0,460,"center-top");this.ctx.fillStyle="#101010";this.ctx.globalAlpha=0.5;ig.game.roundRect(this.ctx,b.x-420,b.y-340,840,640,40,!0,!1);this.ctx.restore();this.ctx.save();this.ctx.globalAlpha=this.scoreAlpha;this.ctx.textAlign="center";b=ig.responsive.toAnchor(0,500,"center-top");this.ctx.font="90px typo";this.ctx.fillStyle="#ffffff";this.ctx.fillText(_STRINGS.Game.MaxCombo+" "+this.maxCombo,b.x,b.y-260);this.ctx.font=
"220px typo";this.ctx.fillStyle="#ffffff";this.ctx.fillText(this.score,b.x,b.y);this.ctx.font="100px typo";this.ctx.fillText(_STRINGS.Game.BestScore+" "+this.bestScore,b.x,b.y+190);this.ctx.restore()},drawLiveScore:function(){this.ctx.save();this.ctx.globalAlpha=this.scoreLiveAlpha;this.ctx.font="180px typo";this.ctx.fillStyle="#ffffff";this.ctx.textAlign="center";var b=ig.responsive.toAnchor(0,260,"center-top");this.ctx.fillText(this.score,b.x,b.y);this.ctx.restore()},drawBonus:function(){this.ctx.save();
this.ctx.globalAlpha=this.bonusAlpha;this.ctx.font=60*this.bonusScale+"px typo";this.ctx.fillStyle="#ffffff";this.ctx.textAlign="center";var b=ig.responsive.toAnchor(0,350,"center-top");this.ctx.fillText(this.bonusText,b.x,b.y);this.ctx.restore()},drawLiveScoreMobile:function(){this.ctx.save();this.ctx.globalAlpha=this.scoreLiveAlpha;this.ctx.font="220px typo";this.ctx.fillStyle="#ffffff";this.ctx.textAlign="center";var b=ig.responsive.toAnchor(0,500,"center-top");this.ctx.fillText(this.score,b.x,
b.y);this.ctx.restore()},drawBonusMobile:function(){this.ctx.save();this.ctx.globalAlpha=this.bonusAlpha;this.ctx.font=100*this.bonusScale+"px typo";this.ctx.fillStyle="#ffffff";this.ctx.textAlign="center";var b=ig.responsive.toAnchor(0,650,"center-top");this.ctx.fillText(this.bonusText,b.x,b.y);this.ctx.restore()}})});ig.baked=!0;
ig.module("game.levels.game").requires("game.entities.controllers.controller","game.entities.pointer").defines(function(){LevelGame={entities:[{type:"EntityController",x:0,y:0},{type:"EntityPointer",x:0,y:0}],layer:[]}});ig.baked=!0;
ig.module("game.entities.marketjs-splash").requires("impact.entity").defines(function(){EntityMarketJSSplash=ig.Entity.extend({logoImage:new ig.Image("media/graphics/splash/marketjs/logo.png"),letterImage:new ig.Image("media/graphics/splash/marketjs/letter-m.png"),brandingText:new ig.Image("media/graphics/splash/marketjs/branding-text.png"),scale:{x:1,y:1},init:function(){if(_SETTINGS.DeveloperBranding.Splash.Enabled){this.updateScale();this.originX=0;this.logo={scale:0.02,alpha:0,x:-this.logoImage.width/
2,y:-this.logoImage.height/2};var b=this.tween({logo:{scale:1,alpha:1}},0.48,{delay:0.3,easing:ig.Tween.Easing.Back.EaseOut,onComplete:function(){ig.soundHandler.sfxPlayer.play("logosplash1");this.tween({},0.59,{onComplete:function(){ig.soundHandler.sfxPlayer.play("logosplash2")}}).start()}.bind(this)});this.letterM={scale:0.02,alpha:0,x:-this.letterImage.width/2,y:-this.letterImage.height/2-10};var c=this.tween({letterM:{scale:1,alpha:1}},0.48,{easing:ig.Tween.Easing.Back.EaseOut});this.text={alpha:1,
x:-this.brandingText.width/2,y:-this.brandingText.height/2,coverW:2*this.brandingText.width,coverH:2*this.brandingText.height};this.text.originX=-this.brandingText.width/2-270;this.text.cx=-this.text.coverW-260;this.text.cy=-this.brandingText.height;var e=this.tween({originX:-450,logo:{scale:0.82},letterM:{scale:0.82},text:{originX:150}},0.78,{delay:0.4,easing:ig.Tween.Easing.Back.EaseOut}),d=this.tween({logo:{alpha:0},letterM:{alpha:0},text:{alpha:0}},0.9,{delay:1.5,onComplete:function(){this.goToMenu()}.bind(this)});
b.chain(c);c.chain(e);e.chain(d);b.start();this.tween({},0.25,{onComplete:function(){ig.soundHandler.sfxPlayer.play("logosplash1")}}).start()}else this.goToMenu()},goToMenu:function(){ig.soundHandler.sfxPlayer.soundList.logosplash1.mute(!0);ig.soundHandler.sfxPlayer.soundList.logosplash2.mute(!0);ig.soundHandler.bgmPlayer.play("background");ig.game.director.nextLevel();this.kill()},update:function(){if(0<this.tweens.length){for(var b=[],c=0;c<this.tweens.length;c++)this.tweens[c].update(),this.tweens[c].complete||
b.push(this.tweens[c]);this.tweens=b}this.updateScale()},draw:function(){var b=ig.system.context;b.fillStyle="#FFF";b.fillRect(0,0,ig.system.width,ig.system.height);b.save();b.translate(ig.system.width/2,ig.system.height/2);b.scale(this.scale.x,this.scale.y);b.imageSmoothingEnabled=!0;b.globalAlpha=this.text.alpha;this.brandingText.draw(this.text.originX+this.text.x,this.text.y);b.globalAlpha=1;b.fillRect(this.text.cx,this.text.cy,this.originX-this.text.cx,this.text.coverH);b.save();b.globalAlpha=
this.logo.alpha;b.scale(this.logo.scale,this.logo.scale);this.logoImage.draw(this.originX+this.logo.x,this.logo.y);b.restore();b.save();b.globalAlpha=this.letterM.alpha;b.scale(this.letterM.scale,this.letterM.scale);this.letterImage.draw(this.originX+this.letterM.x,this.letterM.y);b.restore();b.restore()},updateScale:function(){if(!this.skipUpdateScale){var b=window.innerWidth/window.innerHeight,c=ig.system.height/1280,e=ig.system.width/1280;if(ig.responsive)this.scale.x=this.scale.y=1<b?c:e;else if(ig.ua.mobile&&
!ig.sizeHandler.disableStretchToFitOnMobileFlag){var d=ig.system.width/ig.system.height;1<b?(this.scale.x=d/b*c,this.scale.y=c):(this.scale.x=e,this.scale.y=b/d*e)}else this.skipUpdateScale=!0,e=ig.system.width/1080,this.scale.x=this.scale.y=c<e?c:e;1<this.scale.x&&(this.scale.x=1);1<this.scale.y&&(this.scale.y=1)}}})});ig.baked=!0;
ig.module("game.levels.opening").requires("impact.image","game.entities.marketjs-splash").defines(function(){LevelOpening={entities:[{type:"EntityMarketJSSplash",x:0,y:0}],layer:[]}});ig.baked=!0;
ig.module("babylon.plugins.wgl-game").defines(function(){wgl.Game=ig.Class.extend({entities:[],ready:!1,init:function(){},update:function(){console.log("update wgl:"+this.entities.length);this.entitiesIndexToKill=[];for(var b=0;b<this.entities.length;b++)this.entities[b]&&(this.entities[b].update(),this.entities[b]._killed&&this.entitiesIndexToKill.push(b));for(b=this.entitiesIndexToKill.length-1;0<=b;b--)this.entities.splice(this.entitiesIndexToKill[b],1)},render:function(){this.currentScene&&this.currentScene.render()},
spawnEntity:function(b,c,e,d,j){b=new b(c,e,d,j);this.entities.push(b);return b},getEntityByName:function(b){for(var c=[],e=0;e<this.entities.length;e++)console.log(this.entities[e].name),this.entities[e].name===b&&c.push(this.entities[e]);return c},getMeshByName:function(b){for(var c=0;c<this.currentScene.meshes.length;c++)if(this.currentScene.meshes[c].name===b)return this.currentScene.meshes[c];return null},resizeAll:function(){for(var b=0;b<this.entities.length;b++)this.entities[b].resize()}})});
ig.baked=!0;
ig.module("babylon.plugins.wgl-timer").defines(function(){wgl.Timer=ig.Class.extend({target:0,base:0,last:0,pausedAt:0,init:function(b){this.last=this.base=wgl.Timer.time;this.target=b||0},set:function(b){this.target=b||0;this.base=wgl.Timer.time;this.pausedAt=0},reset:function(){this.base=wgl.Timer.time;this.pausedAt=0},tick:function(){var b=wgl.Timer.time-this.last;this.last=wgl.Timer.time;return this.pausedAt?0:b},delta:function(){return(this.pausedAt||wgl.Timer.time)-this.base-this.target},pause:function(){this.pausedAt||
(this.pausedAt=wgl.Timer.time)},unpause:function(){this.pausedAt&&(this.base+=wgl.Timer.time-this.pausedAt,this.pausedAt=0)}});wgl.Timer._last=0;wgl.Timer.time=Number.MIN_VALUE;wgl.Timer.timeScale=1;wgl.Timer.maxStep=0.05;wgl.Timer.step=function(){var b=Date.now();wgl.Timer.time+=Math.min((b-wgl.Timer._last)/1E3,wgl.Timer.maxStep)*wgl.Timer.timeScale;wgl.Timer._last=b}});ig.baked=!0;
ig.module("babylon.plugins.wgl-system").requires("babylon.plugins.wgl-timer").defines(function(){wgl.System=ig.Class.extend({fps:null,tick:0,loader:null,assets:{},canvas:null,engine:null,progress:0,babylonJSSupport:!1,tempNewScene:null,canvas:null,started:!1,loadSceneIndex:0,rootUrl:null,scenesData:null,scenes:[],init:function(b,c){this.fps=c;this.canvas=ig.$(b);if(BABYLON.Engine.isSupported())this.engine=new BABYLON.Engine(this.canvas,!0,{},!0),this.babylonJSSupport=!0;else throw"BabylonJS not supported";
},loadScenes:function(b,c){wgl.game.ready=!1;this.rootUrl=b;this.scenesData=c;if(this.babylonJSSupport)BABYLON.SceneLoader.Load(b,c[this.loadSceneIndex].path,this.engine,this.onLoadSuccess.bind(this),this.progressCallback.bind(this),this.onLoadError.bind(this));else throw"Unable to load scene because BabylonJS is not supported";},progressCallback:function(b){this.progress=b},onLoadSuccess:function(b){console.log("load scene "+this.loadSceneIndex+" success");(new BABYLON.UniversalCamera("UniversalCamera",
new BABYLON.Vector3(0,30,-50),b)).setTarget(BABYLON.Vector3.Zero());b.sceneController=this.scenesData[this.loadSceneIndex].sceneController;this.scenes.push(b);b.executeWhenReady(this.onSceneReady.bind(this));var c=new BABYLON.CannonJSPlugin;c.setGravity(new BABYLON.Vector3(0,-0.1,0));b.enablePhysics(new BABYLON.Vector3(0,-1,0),c)},onLoadError:function(){console.log("ERROR: at scene "+this.loadSceneIndex);this.loadSceneIndex++;this.loadSceneIndex<this.scenesData.length?this.loadScenes(this.rootUrl,
this.scenesData):this.allScenesLoaded()},onSceneReady:function(){console.log("scene "+this.loadSceneIndex+" ready");this.scenes[this.loadSceneIndex].glb={};ig.glbLoader.init(this.scenesData[this.loadSceneIndex].glb,this.onGLBLoaded.bind(this))},onGLBLoaded:function(){console.log("scene "+this.loadSceneIndex+" glb ready");if(this.scenesData[this.loadSceneIndex].preloadTextures)this.scenesData[this.loadSceneIndex].preloadTextures(0,this.scenes[this.loadSceneIndex],this.onPreloadTextureLoaded.bind(this));
else this.onPreloadTextureLoaded()},onPreloadTextureLoaded:function(){console.log("scene "+this.loadSceneIndex+" preload texture ready");this.loadSceneIndex++;this.loadSceneIndex<this.scenesData.length?this.loadScenes(this.rootUrl,this.scenesData):this.allScenesLoaded()},allScenesLoaded:function(){wgl.debug.debug&&wgl.debug.enableDebug();wgl.game.currentScene=this.scenes[0];this.startRender();wgl.system.engine.hideLoadingUI();wgl.game.ready=!0;ig[wgl.game.currentScene.sceneController].init()},startRender:function(){this.engine.runRenderLoop(wgl.game.render.bind(wgl.game))},
stopRender:function(){this.engine.stopRenderLoop()}})});ig.baked=!0;
ig.module("babylon.plugins.wgl-debug").defines(function(){wgl.Debug=ig.Class.extend({debug:!1,init:function(){},enableDebug:function(){wgl.game.currentScene.debugLayer.show()},axis2:function(b,c){var e=BABYLON.Mesh.CreateCylinder("x",c,0.1,0.1,6,4,b,!1);e.material=new BABYLON.StandardMaterial("xColor",b);e.material.diffuseColor=new BABYLON.Color3(1,0,0);e.position=new BABYLON.Vector3(c/2,0,0);e.rotation.z=Math.PI>>>1;e=BABYLON.Mesh.CreateCylinder("y",c,0.1,0.1,6,4,b,!1);e.material=new BABYLON.StandardMaterial("yColor",
b);e.material.diffuseColor=new BABYLON.Color3(0,1,0);e.position=new BABYLON.Vector3(0,c/2,0);e=BABYLON.Mesh.CreateCylinder("z",c,0.1,0.1,6,4,b,!1);e.material=new BABYLON.StandardMaterial("zColor",b);e.material.diffuseColor=new BABYLON.Color3(0,0,1);e.position=new BABYLON.Vector3(0,0,c/2);e.rotation.x=Math.PI>>>1}})});ig.baked=!0;
ig.module("babylon.game.glb-loader").defines(function(){ig.glbLoader={root:"media/scenes/glb/",files:null,callback:null,init:function(b,c){this.files=b;this.callback=c;this.loadGlb(0)},loadGlb:function(b){if(b==this.files.length)this.completed();else{var c=this.files[b];BABYLON.SceneLoader.LoadAssetContainer(this.root,c+".glb",wgl.system.scenes[wgl.system.loadSceneIndex],function(e){e.scene.glb[c]=e;this.loadGlb(b+1)}.bind(this))}},completed:function(){this.callback()}}});ig.baked=!0;
ig.module("babylon.scene.scene-game").defines(function(){ig.gameScene={isSceneControllerLoaded:!1,init:function(){this.isSceneControllerLoaded||(this.isSceneControllerLoaded=!0,wgl.system.engine.performanceMonitor.enable(),this.construct(),wgl.game.currentScene.autoClear=!1,wgl.game.currentScene.autoClearDepthAndStencil=!1)},construct:function(){this.initCamera();this.initLight();this.initSky()},initCamera:function(){this.camera=wgl.game.currentScene.cameras[0];this.camera.fov=0.4;this.camera.maxZ=
1024;this.camera.inputs.addMouseWheel();this.camera.setTarget(BABYLON.Vector3.Zero());this.camera.attachControl(!0)},initLight:function(){this.sun=wgl.game.currentScene.getLightByName("Light");this.sun.intensity=1.35;this.sun.position.x*=60;this.sun.position.y*=60;this.sun.position.z*=60;this.shadowGenerator=new BABYLON.ShadowGenerator(1024,this.sun);this.shadowGenerator.setDarkness(0.2)},initSky:function(){var b=wgl.game.currentScene,c=BABYLON.MeshBuilder.CreateBox("skyBox",{size:500},b),e=new BABYLON.StandardMaterial("skyBox",
b);e.backFaceCulling=!1;e.reflectionTexture=b.getTextureByName("media/scenes/sky/sky");e.reflectionTexture.coordinatesMode=BABYLON.Texture.SKYBOX_MODE;e.diffuseColor=new BABYLON.Color3(0,0,0);e.specularColor=new BABYLON.Color3(0,0,0);c.material=e},createFloorSky:function(){var b=wgl.game.currentScene;b.fogMode=BABYLON.Scene.FOGMODE_LINEAR;b.fogColor=new BABYLON.Color3(0.9,0.9,0.85);b.fogStart=150;b.fogEnd=200},setEmissiveColor:function(b){b&&b.albedoColor?(b.emissiveColor=b.albedoColor,b.emissiveIntensity=
1):b&&b.subMaterials&&this.setEmissiveColorSubMaterial(b.subMaterials)},setEmissiveColorSubMaterial:function(b){for(var c=0;c<b.length;c++)b[c].albedoColor?(b[c].emissiveColor=b[c].albedoColor,b[c].emissiveIntensity=1):b[c].subMaterials&&this.setEmissiveColorSubMaterial(b[c].subMaterials)},setAlpha:function(b,c){b&&b.subMaterials?this.setAlphaSubMaterial(b.subMaterials,c):b.alpha=c},setAlphaSubMaterial:function(b,c){for(var e=0;e<b.length;e++)b[e].subMaterials?this.setAlphaSubMaterial(b[e].subMaterials,
c):b[e].alpha=c}}});ig.baked=!0;
ig.module("babylon.game.wgl-main").requires("babylon.plugins.wgl-game","babylon.plugins.wgl-system","babylon.plugins.wgl-debug","babylon.plugins.wgl-game","babylon.game.glb-loader","babylon.scene.scene-game").defines(function(){MyWGLGame=wgl.Game.extend({scenesData:[{id:"game",path:"game-scene.babylon",sceneController:"gameScene",glb:[],preloadTextures:function(b,c,e){switch(b){case 0:new BABYLON.CubeTexture("media/scenes/sky/sky",c,null,!1,null,function(){wgl.system.scenesData[wgl.system.loadSceneIndex].preloadTextures(b+1,
c,e)});break;default:e()}}}],root:"media/scenes/",init:function(){},loadScenes:function(){wgl.system.loadScenes(this.root,this.scenesData)},setScene:function(b){wgl.system.stopRender();for(var c=0,e=0;e<this.scenesData.length;e++)if(this.scenesData[e].id==b){c=e;break}wgl.game.currentScene=wgl.system.scenes[c];if(!wgl.game.currentScene.cameras||wgl.game.currentScene.cameras&&0==wgl.game.currentScene.cameras.length)b=wgl.game.currentScene,(new BABYLON.UniversalCamera("UniversalCamera",new BABYLON.Vector3(0,
30,-50),b)).setTarget(BABYLON.Vector3.Zero());ig[wgl.game.currentScene.sceneController].init();wgl.system.startRender()}});wgl.webglmain=function(b,c){wgl.debug=new wgl.Debug;wgl.system=new wgl.System(b,c);wgl.game=new MyWGLGame}});ig.baked=!0;
ig.module("plugins.fullscreen").requires("impact.entity","plugins.handlers.size-handler","plugins.director").defines(function(){ig.Fullscreen={enableFullscreenButton:!0,_isEnabled:"notChecked",isEnabled:function(){"notChecked"==this._isEnabled&&(this._isEnabled=document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled?!0:!1);return this._isEnabled},isFullscreen:function(){return ig.Fullscreen.isEnabled()&&(document.fullscreenElement||
document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)?!0:!1},toggleFullscreen:function(){ig.Fullscreen.isFullscreen()?ig.Fullscreen.exitFullscreen():ig.Fullscreen.requestFullscreen();ig.sizeHandler.orientationDelayHandler();if(ig&&ig.visibilityHandler)ig.visibilityHandler.onChange("focus");try{ig.soundHandler.unlockWebAudio()}catch(b){}},requestFullscreen:function(){ig.game.buttonSfx();var b=document.documentElement;b.requestFullscreen?b.requestFullscreen():
b.webkitRequestFullscreen?b.webkitRequestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.msRequestFullscreen?b.msRequestFullscreen():console.log("no request fullscreen method available")},exitFullscreen:function(){ig.game.buttonSfx();document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():console.log("no exit fullscreen method available")},
divs:{}};ig.Director.inject({loadLevel:function(b){var c=ig.Fullscreen.divs,e;for(e in c)c=ig.domHandler.getElementById("#"+e),ig.domHandler.hide(c);return this.parent(b)}});ig.SizeHandler.inject({resize:function(){this.parent();var b=ig.Fullscreen.divs,c;for(c in b){var e=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y),d=ig.domHandler.getElementById("#"+c),j=b[c].entity_pos_x,g=b[c].entity_pos_y,p=b[c].width,l=b[c].height,f=ig.domHandler.getElementById("#canvas"),
f=ig.domHandler.getOffsets(f);ig.domHandler.css(d,{"float":"left",position:"absolute",left:Math.floor(f.left+j*e)+"px",top:Math.floor(f.top+g*e)+"px",width:Math.floor(p*e)+"px",height:Math.floor(l*e)+"px","z-index":3})}}});ig.FullscreenButton=ig.Entity.extend({enterImage:new ig.Image("media/graphics/sprites/0_btn-expand.png"),exitImage:new ig.Image("media/graphics/sprites/0_btn-shrink.png"),isReady:!1,zIndex:999999,size:new BABYLON.Vector2(140,160),identifier:null,prevPos:{x:0,y:0},invisImagePath:"media/graphics/misc/invisible.png",
init:function(b,c,e){this.size=ig.ua.mobile?new BABYLON.Vector2(180,200):new BABYLON.Vector2(140,160);this.parent(b,c,e);ig.Fullscreen.isEnabled()&&ig.Fullscreen.enableFullscreenButton?this.enterImage.loaded?this.initSize():this.enterImage.loadCallback=function(){this.initSize()}.bind(this):this.kill()},kill:function(){this.parent();this.identifier="fullscreen-button-layer";var b=ig.domHandler.getElementById("#"+this.identifier);ig.domHandler.hide(b)},destroy:function(){this.parent();console.log("destroy")},
initSize:function(){this.createClickableLayer();this.isReady=!0},createClickableLayer:function(){this.identifier="fullscreen-button-layer";var b=ig.domHandler.getElementById("#"+this.identifier);b?(ig.domHandler.show(b),ig.domHandler.attr(b,"onclick","ig.Fullscreen.toggleFullscreen()")):this.createClickableOutboundLayer()},update:function(b,c){this.parent();b=this.pos.x;c=this.pos.y;this.isReady&&!(this.prevPos.x==b&&this.prevPos.y==c)&&(this.prevPos.x=b,this.prevPos.y=c,ig.Fullscreen.divs[this.identifier]=
{},ig.Fullscreen.divs[this.identifier].width=this.size.x,ig.Fullscreen.divs[this.identifier].height=this.size.y,ig.Fullscreen.divs[this.identifier].entity_pos_x=this.pos.x,ig.Fullscreen.divs[this.identifier].entity_pos_y=this.pos.y,ig.sizeHandler.resize())},draw:function(){var b=ig.system.context;this.isReady&&(ig.Fullscreen.isFullscreen()?(b.save(),b.drawImage(this.exitImage.data,0,0,this.exitImage.width,this.exitImage.height,this.pos.x,this.pos.y,this.size.x,this.size.y)):(b.save(),b.drawImage(this.enterImage.data,
0,0,this.enterImage.width,this.enterImage.height,this.pos.x,this.pos.y,this.size.x,this.size.y)),b.restore())},createClickableOutboundLayer:function(){var b=this.identifier,c=this.invisImagePath,e=ig.domHandler.create("div");ig.domHandler.attr(e,"id",b);ig.domHandler.attr(e,"onclick","ig.Fullscreen.toggleFullscreen()");var d=ig.domHandler.create("a"),j=ig.domHandler.create("img");ig.domHandler.css(j,{width:"100%",height:"100%"});ig.domHandler.attr(j,"src",c);c=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,
ig.sizeHandler.scaleRatioMultiplier.y);if(ig.ua.mobile){var g=ig.domHandler.getElementById("#canvas"),p=ig.domHandler.getOffsets(g),g=p.left,p=p.top;if(ig.sizeHandler.disableStretchToFitOnMobileFlag)var g=Math.floor(g+this.pos.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px",p=Math.floor(p+this.pos.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px",l=Math.floor(this.size.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px",c=Math.floor(this.size.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px";else g=Math.floor(this.pos.x*
ig.sizeHandler.sizeRatio.x)+"px",p=Math.floor(this.pos.y*ig.sizeHandler.sizeRatio.y)+"px",l=Math.floor(this.size.x*ig.sizeHandler.sizeRatio.x)+"px",c=Math.floor(this.size.y*ig.sizeHandler.sizeRatio.y)+"px"}else g=ig.domHandler.getElementById("#canvas"),p=ig.domHandler.getOffsets(g),g=p.left,p=p.top,ig.sizeHandler.enableStretchToFitOnDesktopFlag?(g=Math.floor(g+this.pos.x*ig.sizeHandler.sizeRatio.x)+"px",p=Math.floor(p+this.pos.y*ig.sizeHandler.sizeRatio.y)+"px",l=Math.floor(this.size.x*ig.sizeHandler.sizeRatio.x)+
"px",c=Math.floor(this.size.y*ig.sizeHandler.sizeRatio.y)+"px"):(g=Math.floor(g+this.pos.x*c)+"px",p=Math.floor(p+this.pos.y*c)+"px",l=Math.floor(this.size.x*c)+"px",c=Math.floor(this.size.y*c)+"px");ig.domHandler.css(e,{"float":"left",position:"absolute",left:g,top:p,width:l,height:c,"z-index":3});ig.domHandler.addEvent(e,"mousemove",ig.input.mousemove.bind(ig.input),!1);ig.domHandler.appendChild(d,j);ig.domHandler.appendChild(e,d);ig.domHandler.appendToBody(e);ig.Fullscreen.divs[b]={};ig.Fullscreen.divs[b].width=
this.size.x;ig.Fullscreen.divs[b].height=this.size.y;ig.Fullscreen.divs[b].entity_pos_x=this.pos.x;ig.Fullscreen.divs[b].entity_pos_y=this.pos.y}})});ig.baked=!0;
ig.module("game.main").requires("impact.game","plugins.patches.impact-patch","plugins.patches.fps-limit-patch","plugins.patches.timer-patch","plugins.patches.user-agent-patch","plugins.patches.webkit-image-smoothing-patch","plugins.patches.windowfocus-onMouseDown-patch","plugins.patches.input-patch","plugins.data.vector","plugins.data.color-rgb","plugins.font.font-loader","plugins.handlers.dom-handler","plugins.handlers.size-handler","plugins.handlers.api-handler","plugins.handlers.visibility-handler",
"plugins.audio.sound-handler","plugins.io.io-manager","plugins.io.storage-manager","plugins.splash-loader","plugins.tween","plugins.tweens-handler","plugins.url-parameters","plugins.director","plugins.impact-storage","plugins.responsive.responsive-plugin","plugins.branding.splash","plugins.datastructure.binary-heap","game.entities.branding-logo-placeholder","game.entities.buttons.button-more-games","game.entities.pointer","game.entities.pointer-selector","game.entities.select","game.levels.game",
"game.levels.opening","babylon.game.wgl-main","plugins.fullscreen").defines(function(){this.START_OBFUSCATION;this.FRAMEBREAKER;MyGame=ig.Game.extend({name:"rainbow-stacker-responsive-hd",version:"1.0.0",frameworkVersion:"1.5.2",io:null,pausedStatus:!1,lastDraw:[],scorelist:null,score:0,zIndexes:{mobileControllerContainer:8,mobileController:12,mobileControllerKnob:16,tutorial:24,result:30},gameOver:!1,init:function(){this.tweens=new ig.TweensHandler;this.io=new IoManager;this.setupStorageManager();
this.setupUrlParams=new ig.UrlParameters;this.removeLoadingWheel();this.finalize();this.initStorage()},initStorage:function(){this.sessionData.music=ig.game.load("music");this.sessionData.sound=ig.game.load("sound");this.sessionData.score=ig.game.load("score")||0;ig.soundHandler.bgmPlayer.volume(this.sessionData.music);ig.soundHandler.sfxPlayer.volume(this.sessionData.sound)},finalize:function(){this.start();ig.sizeHandler.reorient()},roundRect:function(b,c,e,d,j,g,p,l){"undefined"==typeof l&&(l=
!0);"undefined"===typeof g&&(g=5);b.beginPath();b.moveTo(c+g,e);b.lineTo(c+d-g,e);b.quadraticCurveTo(c+d,e,c+d,e+g);b.lineTo(c+d,e+j-g);b.quadraticCurveTo(c+d,e+j,c+d-g,e+j);b.lineTo(c+g,e+j);b.quadraticCurveTo(c,e+j,c,e+j-g);b.lineTo(c,e+g);b.quadraticCurveTo(c,e,c+g,e);b.closePath();l&&b.stroke();p&&b.fill()},pos3dtopos2d:function(b){var c=wgl.game.currentScene,e=c.cameras[0],c=c.getTransformMatrix(),e=e.viewport.toGlobal(ig.system.width,ig.system.height);return new BABYLON.Vector3.Project(b,BABYLON.Matrix.Identity(),
c,e)},buttonSfx:function(){ig.game.playSfx("button1")},removeLoadingWheel:function(){try{$("#ajaxbar").css("background","none")}catch(b){console.log(b)}},showDebugMenu:function(){console.log("showing debug menu ...");ig.Entity._debugShowBoxes=!0;$(".ig_debug").show()},start:function(){this.resetPlayerStats();this.director=new ig.Director(this,[LevelOpening,LevelGame]);if(_SETTINGS.Branding.Splash.Enabled)try{this.branding=new ig.BrandingSplash}catch(b){console.log(b),console.log("Loading original levels ..."),
this.director.loadLevel(this.director.currentLevel)}else this.director.loadLevel(this.director.currentLevel)},fpsCount:function(){this.fpsTimer||(this.fpsTimer=new ig.Timer(1));this.fpsTimer&&0>this.fpsTimer.delta()?null!=this.fpsCounter?this.fpsCounter++:this.fpsCounter=0:(ig.game.fps=this.fpsCounter,this.fpsCounter=0,this.fpsTimer.reset())},endGame:function(){console.log("End game");ig.soundHandler.bgmPlayer.stop();ig.apiHandler.run("MJSEnd")},resetPlayerStats:function(){ig.log("resetting player stats ...");
this.playerStats={id:this.playerStats?this.playerStats.id:null}},splashClick:function(){var b=ig.domHandler.getElementById("#play");ig.domHandler.hide(b);ig.apiHandler.run("MJSFooter");ig.apiHandler.run("MJSHeader");ig.game.start()},pauseGame:function(){ig.system.stopRunLoop.call(ig.system);ig.game.tweens.onSystemPause();console.log("Game Paused")},resumeGame:function(){ig.system.startRunLoop.call(ig.system);ig.game.tweens.onSystemResume();console.log("Game Resumed")},showOverlay:function(b){for(i=
0;i<b.length;i++)$("#"+b[i])&&$("#"+b[i]).show(),document.getElementById(b[i])&&(document.getElementById(b[i]).style.visibility="visible")},hideOverlay:function(b){for(i=0;i<b.length;i++)$("#"+b[i])&&$("#"+b[i]).hide(),document.getElementById(b[i])&&(document.getElementById(b[i]).style.visibility="hidden")},currentBGMVolume:1,addition:0.1,update:function(){this.paused?(this.updateWhilePaused(),this.checkEntities()):(this.parent(),this.tweens.update(this.tweens.now()),ig.ua.mobile&&ig.soundHandler&&
ig.soundHandler.forceLoopBGM());this.io.clear()},updateWhilePaused:function(){for(var b=0;b<this.entities.length;b++)this.entities[b].ignorePause&&this.entities[b].update()},draw:function(){this.parent();for(var b=0;b<this.lastDraw.length;b++)this.lastDraw[b]();this.dctf()},dctf:function(){this.COPYRIGHT},drawFPS:function(){var b=Math.round(1E3/ig.debug.debugTickAvg);ig.system.context.fillText("FPS:"+b,500,50);this.fillStrokeText("[ WEBGL "+wgl.system.engine.webGLVersion+" ][ FPS C "+b+" ][ FPS B "+
wgl.system.engine.performanceMonitor.averageFPS.toFixed()+" ]",5,953)},fillStrokeText:function(b,c,e){var d=ig.system.context,j=d.measureText(b).width;d.fillStyle="#333333";d.fillRect(c,e-14,j,16);d.fillStyle="#ffffff";d.fillText(b,c,e)},clearCanvas:function(b,c,e){var d=b.canvas;b.clearRect(0,0,c,e);d.style.display="none";d.offsetHeight;d.style.display="inherit"},drawDebug:function(){if(!ig.global.wm&&(this.debugEnable(),this.viewDebug&&(ig.system.context.fillStyle="#000000",ig.system.context.globalAlpha=
0.35,ig.system.context.fillRect(0,0,ig.system.width/4,ig.system.height),ig.system.context.globalAlpha=1,this.debug&&0<this.debug.length)))for(i=0;i<this.debug.length;i++)ig.system.context.font="10px Arial",ig.system.context.fillStyle="#ffffff",ig.system.context.fillText(this.debugLine-this.debug.length+i+": "+this.debug[i],10,50+10*i)},debugCL:function(b){this.debug?(50>this.debug.length||this.debug.splice(0,1),this.debug.push(b),this.debugLine++):(this.debug=[],this.debugLine=1,this.debug.push(b));
console.log(b)},debugEnable:function(){ig.input.pressed("click")&&(this.debugEnableTimer=new ig.Timer(2));this.debugEnableTimer&&0>this.debugEnableTimer.delta()?ig.input.released("click")&&(this.debugEnableTimer=null):this.debugEnableTimer&&0<this.debugEnableTimer.delta()&&(this.debugEnableTimer=null,this.viewDebug=this.viewDebug?!1:!0)},randomIntFromInterval:function(b,c){return Math.floor(Math.random()*(c-b+1)+b)},dst2points:function(b,c,e,d){b-=e;c-=d;return Math.sqrt(b*b+c*c)},playSfx:function(b){ig.soundHandler.sfxPlayer.play(b)},
stopSfx:function(b){ig.soundHandler.sfxPlayer.stop(b)},drawTextWithBreak:function(b,c,e,d,j){var g=0;c=c.split("\n");for(var p=0;p<c.length;p++)b.fillText(c[p],e,d+p*j),g+=j;return g},drawStrokeTextWithBreak:function(b,c,e,d,j){var g=0;c=c.split("\n");for(var p=0;p<c.length;p++)b.strokeText(c[p],e,d+p*j),g+=j;return g},updateGameCamera:function(){null!=ig.game.controller&&ig.game.controller.updateCamera()},randomchance:function(b){return Math.random()<b},randombool:function(){return 0.5>Math.random()},
randomint:function(b,c){return b+Math.floor((c-b+1)*Math.random())},randomfloat:function(b,c){return b+(c-b)*Math.random()},randomstring:function(b,c){void 0===c&&(c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789");for(var e="",d=0;d<b;d++)e+=c.charAt(Random.int(0,c.length-1));return e},randomfromArray:function(b){return null!=b&&0<b.length?b[this.int(0,b.length-1)]:null},randomshuffle:function(b){if(null!=b)for(var c=0;c<b.length;c++){var e=this.int(0,b.length-1),d=b[c];b[c]=b[e];
b[e]=d}return b}});ig.babylonJSSupport=!0;ig.domHandler=null;ig.domHandler=new ig.DomHandler;ig.domHandler.forcedDeviceDetection();ig.domHandler.forcedDeviceRotation();ig.apiHandler=new ig.ApiHandler;ig.sizeHandler=new ig.SizeHandler(ig.domHandler);ig.visibilityHandler=new ig.VisibilityHandler;ig.soundHandler=null;ig.soundHandler=new ig.SoundHandler;ig.fontInfo=null;ig.fontInfo=new ig.FontInfo;ig.main("#canvas",MyGame,60,ig.sizeHandler.desktop.actualResolution.x,ig.sizeHandler.desktop.actualResolution.y,
ig.sizeHandler.scale,ig.SplashLoader);wgl.webglmain("#webglcanvas",60);wgl.game.loadScenes();ig.sizeHandler.reorient();this.DOMAINLOCK_BREAKOUT_ATTEMPT;this.END_OBFUSCATION});
